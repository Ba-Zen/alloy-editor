{"version":3,"sources":["webpack://AlloyEditor/webpack/bootstrap","webpack://AlloyEditor/external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\",\"umd\":\"react\"}","webpack://AlloyEditor/./src/components/base/button-state-classes.js","webpack://AlloyEditor/./src/components/base/button-command.js","webpack://AlloyEditor/external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\",\"umd\":\"react-dom\"}","webpack://AlloyEditor/./src/oop/lang.js","webpack://AlloyEditor/./src/components/base/button-style.js","webpack://AlloyEditor/./src/components/base/button-command-active.js","webpack://AlloyEditor/./src/components/base/widget-focus-manager.js","webpack://AlloyEditor/./src/components/buttons/button-commands-list.jsx","webpack://AlloyEditor/./src/components/base/button-keystroke.js","webpack://AlloyEditor/./src/components/buttons/button-dropdown.jsx","webpack://AlloyEditor/./src/components/base/button-action-style.js","webpack://AlloyEditor/./src/components/base/widget-dropdown.js","webpack://AlloyEditor/./src/components/base/widget-exclusive.js","webpack://AlloyEditor/./src/oop/oop.js","webpack://AlloyEditor/./src/selections/selection-test.js","webpack://AlloyEditor/./src/components/base/widget-position.js","webpack://AlloyEditor/./src/components/base/widget-arrow-box.js","webpack://AlloyEditor/./src/components/base/toolbar-buttons.js","webpack://AlloyEditor/./src/components/buttons/button-table-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-header.jsx","webpack://AlloyEditor/./src/components/buttons/button-target-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-target-edit.jsx","webpack://AlloyEditor/./src/components/base/button-props.js","webpack://AlloyEditor/./src/components/buttons/button-link-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-autocomplete-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-command-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera-image.jsx","webpack://AlloyEditor/./src/selections/selection-position.js","webpack://AlloyEditor/./src/selections/selection-arrowbox.js","webpack://AlloyEditor/./src/selections/selections.js","webpack://AlloyEditor/./src/oop/attribute.js","webpack://AlloyEditor/./src/components/toolbars/toolbar-styles.jsx","webpack://AlloyEditor/./src/components/toolbars/toolbar-add.jsx","webpack://AlloyEditor/./src/components/toolbars/index.js","webpack://AlloyEditor/./src/components/buttons/button-underline.jsx","webpack://AlloyEditor/./src/components/buttons/button-ul.jsx","webpack://AlloyEditor/./src/components/buttons/button-twitter.jsx","webpack://AlloyEditor/./src/components/buttons/button-table.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-row.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-heading.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-column.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-cell.jsx","webpack://AlloyEditor/./src/components/buttons/button-superscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-subscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles.jsx","webpack://AlloyEditor/./src/components/buttons/button-strike.jsx","webpack://AlloyEditor/./src/components/buttons/button-remove-format.jsx","webpack://AlloyEditor/./src/components/buttons/button-quote.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-justify.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-outdent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-ol.jsx","webpack://AlloyEditor/./src/components/buttons/button-link.jsx","webpack://AlloyEditor/./src/components/buttons/button-italic.jsx","webpack://AlloyEditor/./src/components/buttons/button-indent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-image.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-hline.jsx","webpack://AlloyEditor/./src/components/buttons/button-h2.jsx","webpack://AlloyEditor/./src/components/buttons/button-h1.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed.jsx","webpack://AlloyEditor/./src/components/buttons/button-code.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera.jsx","webpack://AlloyEditor/./src/components/buttons/button-bold.jsx","webpack://AlloyEditor/./src/components/buttons/index.js","webpack://AlloyEditor/./src/components/main.jsx","webpack://AlloyEditor/./src/oop/base.js","webpack://AlloyEditor/./src/components/uibridge/uibridge.js","webpack://AlloyEditor/./src/plugins/tabletools.js","webpack://AlloyEditor/./src/plugins/tableresize.js","webpack://AlloyEditor/./src/plugins/selectionkeystrokes.js","webpack://AlloyEditor/./src/plugins/placeholder.js","webpack://AlloyEditor/./src/plugins/pasteimages.js","webpack://AlloyEditor/./src/plugins/imagealignment.js","webpack://AlloyEditor/./src/plugins/embed.js","webpack://AlloyEditor/./src/plugins/dragresize_ie.js","webpack://AlloyEditor/./src/plugins/dragresize.js","webpack://AlloyEditor/./src/plugins/autolist.js","webpack://AlloyEditor/./src/plugins/autolink.js","webpack://AlloyEditor/./src/plugins/addimages.js","webpack://AlloyEditor/./src/plugins/index.js","webpack://AlloyEditor/./src/core/uicore.js","webpack://AlloyEditor/./src/core/tools.js","webpack://AlloyEditor/./src/core/table.js","webpack://AlloyEditor/./src/core/selection-region.js","webpack://AlloyEditor/./src/core/plugins.js","webpack://AlloyEditor/./src/core/link.js","webpack://AlloyEditor/./src/core/debounce.js","webpack://AlloyEditor/./src/core/index.js","webpack://AlloyEditor/./src/adapter/core.js","webpack://AlloyEditor/./src/adapter/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","e","t","window","undefined","a","WrappedComponent","_WrappedComponent","_class","TypeError","this","__proto__","getPrototypeOf","apply","arguments","create","constructor","writable","setPrototypeOf","_createClass","key","stateClasses","_lang2","isFunction","isActive","isDisabled","length","data","editor","props","execCommand","command","modifiesSelection","selectionChange","fire","Lang","isArray","toString","isBoolean","isNull","isNumber","isFinite","isObject","valueType","_typeof","isString","mix","receiver","supplier","toInt","parseInt","_get","style","parts","split","currentMember","config","shift","_style","CKEDITOR","elementPath","getStyle","checkActive","getCommand","state","TRISTATE_ON","Function","getOwnPropertyDescriptor","_refresh","event","_isValidTarget","target","_descendants","activeDescendantEl","_activeDescendant","document","activeElement","focusFirstChild","indexOf","focus","stopPropagation","preventDefault","action","_getFocusAction","type","_moveFocus","direction","onDismiss","keys","_getFocusMoveDirection","dismissAction","_getFocusDismissAction","dismiss","focusMoveDirection","_isValidKey","keyCode","dismissNext","dismissPrev","circular","next","prev","shifKey","element","tagName","toLowerCase","numDescendants","descendant","setAttribute","Math","max","min","domNode","_reactDom2","findDOMNode","descendants","querySelectorAll","priorityDescendants","Array","slice","forEach","item","getAttribute","push","bind","sort","b","concat","some","index","ButtonCommandsList","_react2","Component","createElement","className","onFocus","onKeyDown","handleKey","tabIndex","id","listId","role","_renderActions","commands","items","map","_buttonCommandListItem2","description","label","defaultProps","_widgetFocusManager2","nativeEditor","keystroke","commandName","random","exec","keystrokeFn","fn","addCommand","_defaultKeystrokeCommand","keystrokeHandler","keystrokes","setKeystroke","ButtonDropdown","children","getSelection","lock","removeStyle","applyStyle","unlock","assign","_this","_extends","dropdownTrigger","itemDropdown","nextProps","setState","obj","itemKey","tools","merge","expanded","toggleDropdown","toggleDirection","moveFocus","itemExclusive","filter","cancelExclusive","renderExclusive","requestExclusive","protoProps","staticProps","supplierProto","receiverProto","superclass","SelectionTest","embed","payload","selectionData","image","getName","isReadOnly","link","range","getRanges","isSelectionEmpty","Link","getFromSelection","getText","endOffset","equals","startContainer","endContainer","startOffset","table","Table","isEditable","text","selectionEmpty","region","getCommonAncestor","_temp","cancelAnimationFrame","_animationFrameId","attrs","viewPaneSize","dom","getViewPaneSize","x","left","y","top","width","eventPayload","editorEvent","nativeEvent","pos","pageX","endRect","startRect","SELECTION_BOTTOM_TO_TOP","_getXPoint","_getYPoint","SELECTION_TOP_TO_BOTTOM","eventX","right","abs","elementTarget","$","offsetTop","offsetHeight","bottom","gutter","offsetWidth","SELECTION_LEFT_TO_RIGHT","SELECTION_RIGHT_TO_LEFT","hasClass","startPoint","endPoint","domElement","setStyles","opacity","removeClass","_animate","addClass","isVisible","interactionPoint","getInteractionPoint","finalX","finalY","initialX","initialY","parseFloat","constrainToViewport","res","getConstrainedPosition","height","moveToPoint","xy","getWidgetXYPoint","callback","requestAnimationFrame","arrowBoxClasses","buttons","additionalProps","buttonProps","buttonCfg","filterExclusive","button","AlloyEditor","Buttons","cfg","mergeExclusiveProps","tabKey","trigger","mergeDropdownProps","ButtonTableEdit","rowsRef","createRef","colsRef","cols","rows","current","tableAttributes","inputName","_createTable","time","Date","now","rowsId","colsId","htmlFor","Strings","onChange","_handleChange","_handleKeyDown","placeholder","ref","columns","aria-label","onClick","border","cellPadding","cellSpacing","f","u","ButtonStylesList","blockStyles","inlineStyles","objectStyles","styles","STYLE_BLOCK","STYLE_INLINE","STYLE_OBJECT","_blockStyles","_inlineStyles","_objectStyles","removeStylesItem","showRemoveStylesItem","_buttonStylesListItemRemove2","_buttonDropdown2","_buttonStylesListHeader2","_renderStylesItems","_buttonStylesListItem2","activeStyle","ButtonStylesListItem","styleCfg","margin","_preview","buildPreview","dangerouslySetInnerHTML","__html","_onClick","_buttonActionStyle2","_buttonStyle2","ButtonStylesListItemRemove","_removeStyles","normal","removeBlocks","blockItem","blockStyle","ButtonsStylesListHeader","ButtonTargetList","listTargets","_renderListTargets","allowedLinkTargets","linkTargetDefault","linkTargetSelf","linkTargetBlank","linkTargetParent","linkTargetTop","targets","_getAllowedTargetItems","handleLinkTargetChange","selectedTarget","data-value","ButtonLinkTargetEdit","allowedTargets","aria-expanded","title","_buttonTargetList2","linkEdit","ButtonLinkEdit","linkInput","_getInitialState","manualSelection","_focusLinkInput","autocompleteDropdown","buttonClearLink","targetSelector","_handleLinkTargetChange","linkTarget","_buttonLinkTargetEdit2","dataFn","autocompleteDropdownProps","autocompleteSelected","handleLinkAutocompleteClick","_handleLinkAutocompleteClick","setAutocompleteState","_setAutocompleteState","term","linkHref","_buttonLinkAutocompleteList2","clearInput","_clearLink","clear","placeholderProp","env","ie","editLink","removeLink","disabled","_removeLink","remove","showTargetSelector","_handleLinkHrefChange","confirm","_isValidState","_updateLink","_props","defaultLinkTarget","href","initialLink","instance","focusLinkEl","setTimeout","advanceSelection","linkUtils","selection","bookmarks","createBookmarks","advance","selectBookmarks","selected","appendProtocol","linkAttrs","modifySelection","update","autocompleteUrl","customIndexStart","_buttonProps2","_widgetDropdown2","ButtonLinkAutocompleteList","clearTimeout","_timeout","_updateItems","delay","_renderAutocompleteItems","nextState","url","Promise","resolve","then","ButtonEmbedEdit","getInitialState","selectedElement","getSelectedElement","findOne","clearLinkStyle","deleteEmbed","data-type","_removeEmbed","_embedLink","getAscendant","ButtonCommandListItem","_getClassName","icon","_buttonCommand2","ButtonCameraImage","refs","buttonTakePhoto","_stream","stop","getVideoTracks","track","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","video","audio","_handleStreamSuccess","_handleStreamError","takePhoto","videoEl","videoContainer","canvasEl","canvasContainer","context","getContext","_videoHeight","videoWidth","drawImage","imgURL","toDataURL","el","createFromHtml","insertElement","error","alert","stream","addEventListener","videoHeight","isNaN","mozSrcObject","src","URL","webkitURL","createObjectURL","play","DEFAULT_GUTTER","centerToolbar","toolbar","rect","toolbarNode","halfNodeWidth","scrollPosition","getScrollPosition","widgetXY","SelectionSetPosition","getClientRect","SelectionGetArrowBoxClasses","Selections","test","_selectionTest2","setPosition","_selectionPosition2","getArrowBoxClasses","_selectionArrowbox2","Attribute","__config__","__ATTRS__","attr","currentAttr","ATTRS","_isInitialized","_init","curValue","_callStringOrFunction","set","readOnly","writeOnce","validator","setter","stringOrFunction","args","result","hasDefaultValue","hasPassedValueViaConfig","valueFn","ToolbarStyles","_updatePosition","prevProps","prevState","currentSelection","_getCurrentSelection","getArrowBoxClassesFn","_getSelectionFunction","cssClasses","getToolbarButtons","selectionType","data-tabindex","selectionFn","selectionFunction","selections","testFn","setPositionFn","updatePosition","show","_widgetArrowBox2","_widgetExclusive2","_widgetPosition2","_toolbarButtons2","ToolbarAdd","isContentEditable","_getButtons","_getToolbarClassName","add","cssClass","offsetLeft","clientRect","editable","position","gutterExclusive","floor","cancelAnimation","_toolbarAdd2","_toolbarStyles2","ButtonUnderline","getStateClasses","underline","aria-pressed","CTRL","_buttonKeystroke2","_buttonStateClasses2","ButtonUnorderedlist","bulletedlist","ButtonTwitter","_getHref","class","twitter","handleClick","selectedText","getSelectedText","via","twitterHref","ButtonTable","_buttonTableEdit2","ButtonTableRow","buttonCommandsList","buttonCommandsListId","_buttonCommandsList2","_getCommands","row","aria-owns","rowInsertBefore","rowInsertAfter","rowDelete","ButtonTableRemove","deleteTable","_removeTable","ButtonTableHeading","activeHeading","getHeading","activeHeadingIntro","headers","activeHeadingLabel","headersNone","headersRow","headersColumn","headersBoth","ButtonTableColumn","column","columnInsertBefore","columnInsertAfter","columnDelete","ButtonTableCell","cell","cellInsertBefore","cellInsertAfter","cellDelete","cellMerge","cellMergeDown","cellMergeRight","cellSplitHorizontal","cellSplitVertical","ButtonSuperscript","superscript","ButtonSubscript","subscript","ButtonStyles","buttonStylesList","_getStyles","_checkActive","_buttonStylesList2","styleConfig","h1","h2","formatted","cite","code","ButtonStrike","strike","ButtonRemoveFormat","removeformat","ButtonQuote","quote","ButtonParagraphJustify","alignJustify","_buttonCommandActive2","ButtonParagraphCenter","alignCenter","ButtonParagraphAlignRight","alignRight","ButtonParagraphAlignLeft","alignLeft","ButtonOutdentBlock","outdent","ButtonOrderedList","numberedlist","ButtonLink","mergeButtonCfgProps","_buttonLinkEdit2","_requestExclusive","ButtonItalic","italic","ButtonIndentBlock","indent","ButtonImage","fileInput","accept","_onInputChange","display","click","inputEl","files","reader","FileReader","file","onload","imageFiles","imageData","readAsDataURL","ButtonImageAlignRight","ButtonImageAlignLeft","ButtonImageAlignCenter","ButtonHline","horizontalrule","ButtonH2","ButtonH1","ButtonEmbed","_buttonEmbedEdit2","SHIFT","ButtonCode","ButtonCamera","_buttonCameraImage2","location","protocol","cameraDisabled","camera","ButtonBold","bold","Z","h","g","v","_","E","O","w","k","C","T","S","P","D","I","j","R","A","K","N","M","L","F","H","z","B","U","W","q","G","V","Y","X","J","Q","ee","_buttonBold2","_buttonCamera2","_buttonCode2","_buttonEmbed2","_buttonH2","_buttonH4","_buttonHline2","_buttonImageAlignCenter2","_buttonImageAlignLeft2","_buttonImageAlignRight2","_buttonImage2","_buttonIndentBlock2","_buttonItalic2","_buttonLink2","_buttonOl2","_buttonOutdentBlock2","_buttonParagraphAlignLeft2","_buttonParagraphAlignRight2","_buttonParagraphCenter2","_buttonParagraphJustify2","_buttonQuote2","_buttonRemoveFormat2","_buttonStrike2","_buttonStyles2","_buttonSubscript2","_buttonSuperscript2","_buttonTableCell2","_buttonTableColumn2","_buttonTableHeading2","_buttonTableRemove2","_buttonTableRow2","_buttonTable2","_buttonTwitter2","_buttonUl2","_buttonUnderline2","UI","hidden","on","_onEditorInteraction","_onActionPerformed","_onEditorKey","_mousedownListener","_setUIHidden","_keyDownListener","debounce","eventsDelay","message","_getAvailableToolbarsMessage","ariaUpdate","_ariaUpdateTemplates","template","_getAriaUpdates","ariaUpdates","noToolbar","ariaUpdateNoToolbar","oneToolbar","ariaUpdateOneToolbar","manyToolbars","ariaUpdateManyToolbars","toolbarsNodeList","toolbarNames","_getAriaUpdateTemplate","output","toolbars","join","replace","removeEventListener","detach","Toolbars","_onDismissToolbarFocus","getSelectionData","domEvent","altKey","targetNode","node","contains","Base","init","_attribute2","_callChain","destroy","wat","arr","ctor","reverse","plugins","beforeInit","originalUIAddFn","ui","definition","typeHandler","handlers","registerBridgeButton","__processingPlugin__","plugin","cellNodeRegex","createDef","def","extend","contextSensitive","refresh","path","td","th","TRISTATE_OFF","TRISTATE_DISABLED","addCmd","cmd","addFeature","lang","requiredContent","placeCursorInCell","deleteRows","selectionOrRow","cells","getSelectedCells","buildTableMap","startRowIndex","getParent","rowIndex","lastCell","endRowIndex","rowSpan","rowsToDelete","mapRow","cellRowIndex","nextMapRow","insertAfter","append","colSpan","cursorPosition","parentNode","insertRow","selectionOrCell","startColIndex","endColIndex","firstCell","firstRowCells","insertColumn","deleteCells","cellsToDelete","cellToFocus","focusedCell","tr","last","database","setMarker","getPrevious","getCustomData","getNext","clearAllMarkers","getLast","getChild","getChildCount","allowedContent","mergeCells","isDetect","newCell","newRowSpan","newCellRowSpan","newRowIndex","colIndex","cellInRow","ceil","candidateCell","newCellTr","newCellRow","clone","insertBefore","cellsInSameRow","appendBogus","removeAttribute","newColSpan","newCellColSpan","cellsInSameCol","tableMap","oCol","insertCell","ranges","retval","moveOutOfCellGuard","NODE_ELEMENT","collapsed","startNode","nearestCell","walker","guard","is","dtd","parent","doc","getDocument","startRow","endRow","cloneRow","nextRow","newRow","getCellColIndex","isStart","rowCells","mapCell","getColumnsIndices","Infinity","startCol","lastCol","cloneCol","nextCol","nextCell","startElement","getStartElement","trimCell","bogus","getBogus","trim","placeAtEnd","docInner","docOuter","version","selectNodeContents","collapse","select","oRow","mergeDirection","commonAncestor","mapHeight","mapWidth","startColumn","targetCell","rowspan","colspan","er","lastRowIndex","totalRowSpan","totalColSpan","frag","documentFragment","dimension","cellFirstChild","getFirst","getChildren","count","isBlockBoundary","br","whitespaces","moveChildren","setHtml","trs","nodeList","tailTr","getItem","aRows","aMap","oCell","iColSpan","iRowSpan","rs","cs","pxUnit","cssLength","requires","resizer","attachListener","isInline","evt","getTarget","pillars","getPageOffset","move","cancel","setCustomData","pillarIndex","rtl","getComputedStyle","$tr","cellsCount","$elected","$rows","maxCells","len","tbody","tBodies","tbodyPosition","getDocumentPosition","pillarLeft","pillarRight","pillarWidth","nextTd","getBorderWidth","clearPillarsCache","pillar","positionX","columnResizer","attachTo","getWidth","clientWidth","side","computed","borderMap","thin","medium","thick","isResizing","currentShift","leftSideCells","rightSideCells","leftShiftBoundary","rightShiftBoundary","resizeEnd","setOpacity","leftCell","rightCell","leftOldWidth","rightOldWidth","tableWidth","sizeShift","setStyle","removeCustomData","removeListener","onMouseDown","columnIndex","leftColumnCells","rightColumnCells","leftMinSize","Number","MAX_VALUE","rightMinSize","onMouseMove","onMouseUp","getDocumentElement","targetPillar","getBody","posX","resizerNewPosition","round","dest","relatedTarget","toElement","selectionKeystrokes","selectionKeystroke","brFiller","needsBrFiller","enterModeEmptyValue","1","2","3","_checkEmptyData","_removePlaceholderClass","once","editableNode","innerHtml","innerHTML","enterMode","placeholderClass","_onPaste","clipboardData","pastedData","listenerData","imageFile","getAsFile","IMAGE_ALIGNMENT","ALIGN_VALUES","CENTERED_IMAGE_STYLE","getImageAlignment","imageAlignment","every","styleCheck","vendorPrefixes","vendorPrefix","removeImageAlignment","afterInit","self","refreshCommands","lastElement","REGEX_HTTP","REGEX_DEFAULT_LINK","DEFAULT_AE_EMBED_URL_TPL","DEFAULT_AE_EMBED_WIDGET_TPL","DEFAULT_AE_EMBED_DEFAULT_LINK_TPL","AE_EMBED_URL_TPL","embedUrlTemplate","AE_EMBED_WIDGET_TPL","embedWidgetTpl","AE_EMBED_DEFAULT_LINK_TPL","embedLinkDefaultTpl","insertHtml","widgets","mask","widget","jsonp","encodeURIComponent","response","html","createATag","msg","aTagHtml","upcast","embedWidgetUpcastFn","attributes","dataValue","widgetElement","addElementCallback","FILTER_SKIP_TREE","alignmentsObj","center","cursor","both","scale","regexPercent","hidpi","icons","imageScaleResize","initOn","classRegex","alignClasses","image2_alignClasses","captionedClass","image2_captionedClass","helpers","image2","alt","hasCaption","caption","ready","checkHasNaturalRatio","wrapper","align","alignElement","setData","image2_disableResizer","inline","imageOrLink","oldResizeWrapper","resizeWrapper","nativeEvt","newWidth","newHeight","updateData","moveDiffX","moveDiffY","factor","startX","screenX","startY","screenY","startWidth","startHeight","clientHeight","listeners","cursorClass","attachToDocuments","collection","globalDoc","pop","setAttributes","selectElement","getStyleableElement","figcaption","figure","classes","img","contentTransformations","features","checkFeature","contenteditable","data-cke-saved-src","oldData","dimensions","downcast","attrsHolder","replaceWith","parseCssText","wrapWith","htmlParser","float","isEmpty","writeCssText","draggable","editables","selector","getClasses","RegExp","repository","parseElementClasses","getLabel","pathName","styleableElements","isCenterWrapper","validChildren","div","child","isLinkedOrStandaloneImage","ENTER_P","match","onLoad","addCss","natural","getNatural","naturalWidth","naturalHeigh","Image","heigh","IMAGE_HANDLES","POSITION_ELEMENT_FN","bl","handle","box","positionElement","bm","lm","tl","tm","rm","isFirefox","documentElement","enablePlugin","resizeTimeout","Resizer","snapToSize","mouseDownListener","isHandle","initDrag","getType","SELECTION_NONE","hide","resizeElement","getElementById","container","preview","appendChild","handles","handleName","createHandle","classList","otherImages","getElementsByTagName","splice","getBoundingBox","body","showHandles","elements","getElementsByClassName","hideHandles","removeChild","drag","DragEvent","onStart","showPreview","isDragging","onDrag","calculateSize","updatePreview","previewBox","updateHandles","onRelease","hidePreview","onComplete","resizeComplete","start","backgroundImage","delta","ratio","others","other","String","startPos","clientX","clientY","events","mousemove","keydown","mouseup","currentPos","shiftKey","ctrl","ctrlKey","which","release","ctx","getBoundingClientRect","pageXOffset","pageYOffset","DEFAULT_CONFIG","regex","_onKeyDown","_checkForBackspaceAndUndo","bullet","_getListConfig","configRegex","autolist","textContainer","substring","regexLen","autolistCfg","regexItem","_createList","listConfig","setText","userAgent","DELIMITERS","REGEX_LAST_WORD","REGEX_URL","_onKeyUp","_getLastWord","offset","previousText","_currentKeyCode","lastChild","previousNode","_startContainer","_offset","lastWord","_isValidURL","_ckLink","_replaceContentByLink","content","createRange","setStart","setEnd","ckLink","linkNode","_subscribeToKeyEvent","nextEditableNode","getNextEditableNode","nextNode","getNextNode","caretOffset","newRange","setEndAfter","isIE","_onDragEnter","_onDragOver","_onDragDrop","_handleFiles","_processFile","createSelectionFromPoint","dataTransfer","_preventEvent","bin","addimages","autolink","dragresize","dragresizeie","imagealignment","pasteimages","selectionkeystrokes","tableresize","tabletools","ariaState","ariaElement","_createAriaElement","uiTasksTimeout","uicore","timeout","handleUI","allowEsc","handleAria","handleMouseLeave","found","aeUINodes","focusHandler","statusElement","urlTemplate","urlParams","errorCallback","callbackKey","getNextNumber","jsonpCallbacks","cleanUp","scriptElement","simulate","eventInstance","createEvent","initEvent","dispatchEvent","IE_NON_DIRECTLY_EDITABLE_ELEMENT","col","colgroup","tfoot","thead","_editor","HEADING_BOTH","HEADING_COL","HEADING_NONE","HEADING_ROW","_createElement","setHeading","heading","moveToPosition","POSITION_AFTER_START","webkit","shrink","hasAttribute","rowHeadingSettings","tHead","colHeadingSettings","nodeName","headingSettings","POSITION_BEFORE_START","tableHead","tableBody","getElementsByTag","tableHeading","hadColHeading","needColHeading","needRowHeading","tableFirstRow","tableFirstRowChildCount","renameNode","createTHead","previousFirstRow","newFirstRow","newFirstRowChildCount","headingCommands","tableUtils","SelectionRegion","createSelectionFromRange","endX","endY","end","caretPositionFromPoint","offsetNode","caretRangeFromPoint","selectRanges","createTextRange","endRange","duplicate","setEndPoint","getCaretRegion","bookmarkNodeEl","scrollPos","getNative","getSelectionRegion","getClientRectsRegion","getSelectionDirection","nativeSelection","defaultRect","clientRects","getClientRects","rangeCount","getRangeAt","anchorNode","compareDocumentPosition","focusNode","anchorOffset","focusOffset","Node","DOCUMENT_POSITION_PRECEDING","load","override","pluginsLoad","names","scope","pluginName","require","methodName","originalPluginMethod","phase","REGEX_BOOKMARK_SCHEME","REGEX_EMAIL_SCHEME","REGEX_URI_SCHEME","moveToElementEditEnd","whitespace","URI","insertNode","_getCompleteURI","data-cke-saved-href","applyToRange","SHRINK_TEXT","alwaysRemoveElement","uri","removeAttrs","setAttrs","removeAttributes","debounceHandle","callFn","callContext","startIndex","callArgs","selectionRegion","Core","_oop2","_base2","initializer","removePlugins","extraPlugins","pasteFromWordRemoveStyles","pasteFromWordRemoveFontStyles","edge","_addReadOnlyLinkClickListener","loadLanguageResources","_renderUI","destructor","_destroyed","_editorUIElement","unmountComponentAtNode","_clearSelections","empty","getWindow","removeAllRanges","_defaultReadOnlyClickFn","mouseEvent","hasCtrlKey","metaKey","shouldOpen","_redirectLink","_getNativeEditor","open","editorUIElement","_mainUI","render","_main2","_toElement","_validateAllowedContent","_validateToolbars","enableContentEditable","srcNode","uiNode","implementOn","BRIDGE_BUTTONS","OOP","implementEventTarget","_core2","getBasePath","ALLOYEDITOR_BASEPATH","scripts","regexBasePath","getButtons","reduce","acc","val","getUrl","resource","basePath","timestamp","charAt","_langResourceRequested","languages","language","userLanguage","locale","scriptLoader","loaded","buttonName"],"mappings":"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","file":"alloy-editor-core-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 100);\n","(function() { module.exports = window[undefined]; }());","import Lang from '../../oop/lang';\n\n/**\n * ButtonStateClasses is a mixin that decorates the domElement of a component\n * with different CSS classes based on the current state of the element.\n *\n * To check for state, the component can expose the following methods:\n * - `Function` **isActive** to check the active state\n * - `Function` **isDisabled** to check the disabled state\n *\n * @class ButtonStateClasses\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Returns the list of state classes associated to the current element's state, according\n     * to the results of the isActive and isDisabled methods.\n     *\n     * @instance\n     * @memberof ButtonStateClasses\n     * @method getStateClasses\n     * @return {String} A string with the state CSS classes.\n     */\n    getStateClasses() {\n        var stateClasses = '';\n\n        // Check for active state\n        if (Lang.isFunction(this.isActive) && this.isActive()) {\n            stateClasses += 'ae-button-pressed';\n        }\n\n        // Check for disabled state\n        if (Lang.isFunction(this.isDisabled) && this.isDisabled()) {\n            stateClasses += ' ae-button-disabled';\n        }\n\n        return stateClasses;\n    }\n};","/**\n * ButtonCommand is a mixin that executes a command via CKEDITOR's API.\n *\n * @class ButtonCommand\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Executes a CKEditor command and fires `actionPerformed` event.\n     *\n     * @instance\n     * @memberof ButtonCommand\n     * @param {Object=} data Optional data to be passed to CKEDITOR's `execCommand` method.\n     * @method execCommand\n     */\n    execCommand(data) {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.execCommand(this.props.command, data);\n\n        if (this.props.modifiesSelection) {\n            editor.selectionChange(true);\n        }\n\n        editor.fire('actionPerformed', this);\n    }\n};","(function() { module.exports = window[undefined]; }());","/**\n * Provides core language utilities.\n *\n * @class Lang\n */\nconst Lang = {\n    /**\n     * Check if the passed value is an array.\n     *\n     * @memberof Lang\n     * @method isArray\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is an array, false otherwise.\n     * @static\n     */\n    isArray: function(value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n    },\n\n    /**\n     * Check if the passed value is boolean.\n     *\n     * @memberof Lang\n     * @method isBoolean\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is boolean, false otherwise.\n     * @static\n     */\n    isBoolean: function(value) {\n        return typeof value === 'boolean';\n    },\n\n    /**\n     * Check if the passed value is a function.\n     *\n     * @memberof Lang\n     * @method isFunction\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is a function, false otherwise.\n     * @static\n     */\n    isFunction: function(value) {\n        return typeof(value) === 'function';\n    },\n\n    /**\n     * Check if the passed value is NULL.\n     *\n     * @memberof Lang\n     * @method isNull\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is NULL, false otherwise.\n     * @static\n     */\n    isNull: function(value) {\n        return value === null;\n    },\n\n    /**\n     * Check if the passed value is number.\n     *\n     * @memberof Lang\n     * @method isNumber\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is number, false otherwise.\n     * @static\n     */\n    isNumber: function(value) {\n        return typeof value === 'number' && isFinite(value);\n    },\n\n    /**\n     * Check if the passed value is an object\n     *\n     * @memberof Lang\n     * @method isObject\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is an object, false otherwise.\n     * @static\n     */\n    isObject: function(value) {\n        var valueType = typeof value;\n\n        return (value && (valueType === 'object' || Lang.isFunction(value)));\n    },\n\n    /**\n     * Check if the passed value is a string.\n     *\n     * @memberof Lang\n     * @method isString\n     * @param {Any} value The value which have to be checked.\n     * @return {Boolean} True if the passed value is a string, false otherwise.\n     * @static\n     */\n    isString: function(value) {\n        return typeof value === 'string';\n    },\n\n    /**\n     * Adds all properties from the supplier to the receiver.\n     * The function will add all properties, not only these owned by the supplier.\n     *\n     * @memberof Lang\n     * @method mix\n     * @param {Object} receiver The object which will receive properties.\n     * @param {Object} supplier The object which provides properties.\n     * @return {Object} The modified receiver.\n     * @static\n     */\n    mix: function(receiver, supplier) {\n        var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n        for (var key in supplier) {\n            if (hasOwnProperty.call(supplier, key)) {\n                receiver[key] = supplier[key];\n            }\n        }\n    },\n\n    /**\n     * Converts value to Integer.\n     *\n     * @memberof Lang\n     * @method toInt\n     * @param {Any} value The value which have to be converted to Integer.\n     * @return {Integer} The converted value.\n     * @static\n     */\n    toInt: function(value) {\n        return parseInt(value, 10);\n    }\n};\n\nexport default Lang;","import Lang from '../../oop/lang.js'\n\n/**\n * ButtonStyle is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonStyle\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        if (Lang.isFunction(super.componentWillMount)) {\n            super.componentWillMount();\n        }\n\n        var style = this.props.style;\n\n        if (Lang.isString(style)) {\n            var parts = style.split('.');\n            var currentMember = this.props.editor.get('nativeEditor').config;\n            var property = parts.shift();\n\n            while (property && Lang.isObject(currentMember) && Lang.isObject(currentMember[property])) {\n                currentMember = currentMember[property];\n                property = parts.shift();\n            }\n\n            if (Lang.isObject(currentMember)) {\n                style = currentMember;\n            }\n        }\n\n        this._style = new CKEDITOR.style(style);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (Lang.isFunction(super.componentWillUnmount)) {\n            super.componentWillUnmount();\n        }\n\n        this._style = null;\n    }\n\n    /**\n     * Returns instance of CKEDITOR.style which represents the current button style.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method getStyle\n     * @return {CKEDITOR.style} The current style representation.\n     */\n    getStyle() {\n        return this._style;\n    }\n\n    /**\n     * Checks if style is active in the current selection.\n     *\n     * @instance\n     * @memberof ButtonStyle\n     * @method isActive\n     * @return {Boolean} True if style is active, false otherwise.\n     */\n    isActive() {\n        var result;\n\n        var editor = this.props.editor.get('nativeEditor');\n\n        var elementPath = editor.elementPath();\n\n        result = this.getStyle().checkActive(elementPath, editor);\n\n        return result;\n    }\n};","/**\n * ButtonCommandActive is a mixin that provides an `isActive` method to determine if\n * a context-aware command is currently in an active state.\n *\n * @class ButtonCommandActive\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Checks if the command is active in the current selection.\n     *\n     * @instance\n     * @memberof ButtonCommandActive\n     * @method isActive\n     * @return {Boolean} True if the command is active, false otherwise.\n     */\n    isActive() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var command = editor.getCommand(this.props.command);\n\n        return command ? command.state === CKEDITOR.TRISTATE_ON : false;\n    }\n};","import Lang from '../../oop/lang.js';\nimport ReactDOM from 'react-dom';\n\nvar DIRECTION_NONE = 0;\nvar DIRECTION_NEXT = 1;\nvar DIRECTION_PREV = -1;\n\nvar ACTION_NONE = 0;\nvar ACTION_MOVE_FOCUS = 1;\nvar ACTION_DISMISS_FOCUS = 2;\n\n/**\n * WidgetFocusManager is a mixin that provides keyboard navigation inside a widget. To do this,\n * it exposes the following props and methods:\n *\n * @class WidgetFocusManager\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (Lang.isFunction(super.componentDidMount)) {\n            super.componentDidMount();\n        }\n\n        this._refresh();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * Refreshes the descendants list.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method componentDidUpdate\n     */\n    componentDidUpdate() {\n        if (Lang.isFunction(super.componentDidUpdate)) {\n            super.componentDidUpdate();\n        }\n\n        this._refresh();\n    }\n\n    /**\n     * Focuses the current active descendant.\n     *\n     * Several Widgets can be nested in a component hierarchy by attaching this focus method to\n     * the widget DOM node, transferring the DOM focus control to the inner FocusManager.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method focus\n     */\n    focus(event) {\n        if (!event || this._isValidTarget(event.target)) {\n            if (this._descendants && this._descendants.length) {\n                var activeDescendantEl = this._descendants[this._activeDescendant];\n                // When user clicks with the mouse, the activeElement is already set and there\n                // is no need to focus it. Focusing of the active descendant (usually some button) is required\n                // in case of keyboard navigation, because the focused element might be not the first button,\n                // but the div element, which contains the button.\n                if (document.activeElement !== activeDescendantEl && !this.props.focusFirstChild) {\n                    if (this._descendants.indexOf(document.activeElement) === -1) {\n                        activeDescendantEl.focus();\n                    }\n                }\n\n                if (event) {\n                    event.stopPropagation();\n                    event.preventDefault();\n                }\n            }\n        }\n    }\n\n    /**\n     * Handles the key events on a DOM node to execute the appropriate navigation when needed.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @param {Object} event The Keyboard event that was detected on the widget DOM node.\n     * @method handleKey\n     */\n    handleKey(event) {\n        if (this._isValidTarget(event.target) && this._descendants) {\n            var action = this._getFocusAction(event);\n\n            if (action.type) {\n                event.stopPropagation();\n                event.preventDefault();\n\n                if (action.type === ACTION_MOVE_FOCUS) {\n                    this._moveFocus(action.direction);\n                }\n\n                if (action.type === ACTION_DISMISS_FOCUS) {\n                    this.props.onDismiss(action.direction);\n                }\n            }\n        }\n    }\n\n    /**\n     * Moves the focus among descendants in the especified direction.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method moveFocus\n     * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n     */\n    moveFocus(direction) {\n        direction = Lang.isNumber(direction) ? direction : 0;\n\n        this._moveFocus(direction);\n    }\n\n    /**\n     * Returns the action, if any, that a keyboard event in the current focus manager state\n     * should produce.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusAction\n     * @param {object} event The Keyboard event.\n     * @protected\n     * @return {Object} An action object with type and direction properties.\n     */\n    _getFocusAction(event) {\n        var action = {\n            type: ACTION_NONE\n        };\n\n        if (this.props.keys) {\n            var direction = this._getFocusMoveDirection(event);\n\n            if (direction) {\n                action.direction = direction;\n                action.type = ACTION_MOVE_FOCUS;\n            }\n\n            var dismissAction = this._getFocusDismissAction(event, direction);\n\n            if (dismissAction.dismiss) {\n                action.direction = dismissAction.direction;\n                action.type = ACTION_DISMISS_FOCUS;\n            }\n        }\n\n        return action;\n    }\n\n    /**\n     * Returns the dismiss action, if any, the focus manager should execute to yield the focus. This\n     * will happen in any of these scenarios if a dismiss callback has been specified:\n     * - A dismiss key has been pressed\n     * - In a non-circular focus manager, when:\n     *     - The active descendant is the first one and a prev key has been pressed.\n     *     - The active descendant is the last one and a next key has been pressed.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusDismissAction\n     * @param {Number} focusMoveDirection The focus movement direction (if any).\n     * @param {Object} event The Keyboard event.\n     * @protected\n     * @return {Object} A dismiss action with dismiss and direction properties.\n     */\n    _getFocusDismissAction(event, focusMoveDirection) {\n        var dismissAction = {\n            direction: focusMoveDirection,\n            dismiss: false\n        };\n\n        if (this.props.onDismiss) {\n            if (this._isValidKey(event.keyCode, this.props.keys.dismiss)) {\n                dismissAction.dismiss = true;\n            }\n            if (this._isValidKey(event.keyCode, this.props.keys.dismissNext)) {\n                dismissAction.dismiss = true;\n                dismissAction.direction = DIRECTION_NEXT;\n            }\n            if (this._isValidKey(event.keyCode, this.props.keys.dismissPrev)) {\n                dismissAction.dismiss = true;\n                dismissAction.direction = DIRECTION_PREV;\n            }\n\n            if (!dismissAction.dismiss && !this.props.circular && focusMoveDirection) {\n                dismissAction.dismiss = (\n                    focusMoveDirection === DIRECTION_PREV && this._activeDescendant === 0 ||\n                    focusMoveDirection === DIRECTION_NEXT && this._activeDescendant === this._descendants.length - 1\n                );\n            }\n        }\n\n        return dismissAction;\n    }\n\n    /**\n     * Returns the direction, if any, in which the focus should be moved. In presence of the\n     * shift key modifier, the direction of the movement is inverted.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _getFocusMoveDirection\n     * @param {Object} event The Keyboard event.\n     * @protected\n     * @return {Number} The computed direction of the expected focus movement.\n     */\n    _getFocusMoveDirection(event) {\n        var direction = DIRECTION_NONE;\n\n        if (this._isValidKey(event.keyCode, this.props.keys.next)) {\n            direction = DIRECTION_NEXT;\n        }\n        if (this._isValidKey(event.keyCode, this.props.keys.prev)) {\n            direction = DIRECTION_PREV;\n        }\n\n        if (event.shifKey) {\n            direction *= -1;\n        }\n\n        return direction;\n    }\n\n    /**\n     * Indicates if a given keyCode is valid for the given set of keys.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _isValidKey\n     * @param {Array|Number} keys A key set. Can be a number an array of numbers representing the allowed keyCodes.\n     * @param {Number} keyCode An event keyCode.\n     * @protected\n     * @return {Boolean} A boolean value indicating if the key is valid.\n     */\n    _isValidKey(keyCode, keys) {\n        return Lang.isArray(keys) ? (keys.indexOf(keyCode) !== -1) : (keyCode === keys);\n    }\n\n    /**\n     * Indicates if a given element is valid for focus management. User input elements such as\n     * input, select or textarea are excluded.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _isValidKey\n     * @param {DOMNode} element A DOM element.\n     * @protected\n     * @return {Boolean} A boolean value indicating if the element is valid.\n     */\n    _isValidTarget(element) {\n        var tagName = element.tagName.toLowerCase();\n\n        return (tagName !== 'input' && tagName !== 'select' && tagName !== 'textarea');\n    }\n\n    /**\n     * Moves the focus among descendants in the especified direction.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _moveFocus\n     * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n     * @protected\n     */\n    _moveFocus(direction) {\n        var numDescendants = this._descendants.length;\n\n        var descendant = this._descendants[this._activeDescendant];\n\n        descendant.setAttribute('tabIndex', -1);\n\n        this._activeDescendant += direction;\n\n        if (this.props.circular) {\n            // Calculate proper modulo result since remainder operator doesn't behave in the\n            // same way for negative numbers\n            this._activeDescendant = ((this._activeDescendant % numDescendants) + numDescendants) % numDescendants;\n        } else {\n            this._activeDescendant = Math.max(Math.min(this._activeDescendant, numDescendants - 1), 0);\n        }\n\n        descendant = this._descendants[this._activeDescendant];\n\n        descendant.setAttribute('tabIndex', 0);\n        descendant.focus();\n    }\n\n    /**\n     * Refreshes the descendants list by executing the CSS selector again and resets the descendants tabIndex.\n     *\n     * @instance\n     * @memberof WidgetFocusManager\n     * @method _refresh\n     * @protected\n     */\n    _refresh() {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (domNode) {\n            var descendants = domNode.querySelectorAll(this.props.descendants);\n\n            var priorityDescendants = [];\n\n            this._descendants = [];\n\n            Array.prototype.slice.call(descendants).forEach(function(item) {\n                var dataTabIndex = item.getAttribute('data-tabindex');\n\n                if (dataTabIndex) {\n                    priorityDescendants.push(item);\n                } else {\n                    this._descendants.push(item);\n                }\n            }.bind(this));\n\n            priorityDescendants = priorityDescendants.sort(function(a, b) {\n                return (Lang.toInt(a.getAttribute('data-tabindex')) > Lang.toInt(b.getAttribute('data-tabindex')));\n            });\n\n            this._descendants = priorityDescendants.concat(this._descendants);\n\n            this._activeDescendant = 0;\n\n            this._descendants.some(function(item, index) {\n                if (item.getAttribute('tabindex') === '0') {\n                    this._activeDescendant = index;\n                    this.focus();\n\n                    return true;\n                }\n            }.bind(this));\n        }\n    }\n};","import ButtonCommandListItem from './button-command-list-item.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonCommandsList class provides functionality for showing a list of commands that can be\n * executed to the current selection..\n *\n * @class ButtonCommandsList\n * @uses WidgetFocusManager\n */\nclass ButtonCommandsList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the list node to allow keyboard interaction.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <div className=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\" onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} tabIndex=\"0\">\n                <ul className=\"ae-listbox\" id={this.props.listId} role=\"listbox\">\n                    {this._renderActions(this.props.commands)}\n                </ul>\n            </div>\n        );\n    }\n\n    /**\n     * Renders instances of ButtonCommandListItem with the description of the row action that will be executed.\n     *\n     * @instance\n     * @memberof ButtonCommandsList\n     * @method _renderActions\n     * @protected\n     * @return {Array} Rendered instances of ButtonCommandListItem class\n     */\n    _renderActions(commands) {\n        var editor = this.props.editor;\n        var items;\n\n        if (commands && commands.length) {\n            items = commands.map(function(item) {\n                return (\n                    <li key={item.command} role=\"option\">\n                        <ButtonCommandListItem command={item.command} description={typeof item.label === 'string' ? item.label : item.label()} editor={editor} />\n                    </li>\n                );\n            });\n        }\n\n        return items;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonCommandsList\n * @memberof ButtonCommandsList\n * @property {String} key\n * @static\n */\nButtonCommandsList.key = 'buttonCommandsList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCommandsList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonCommandsList.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonCommandsList\n);","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonKeystroke is a mixin that provides a `keystroke` prop that allows configuring\n * a function of the instance to be invoked upon the keystroke activation.\n *\n * @class ButtonKeystroke\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonKeystroke\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        if (Lang.isFunction(super.componentWillMount)) {\n            super.componentWillMount();\n        }\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var keystroke = this.props.keystroke;\n\n        var commandName = keystroke.name || ((Math.random() * 1e9) >>> 0).toString();\n\n        var command = nativeEditor.getCommand(commandName);\n\n        if (!command) {\n            command = new CKEDITOR.command(nativeEditor, {\n                exec: function(editor) {\n                        var keystrokeFn = keystroke.fn;\n\n                        if (Lang.isString(keystrokeFn)) {\n                            this[keystrokeFn].call(this, editor);\n                        } else if (Lang.isFunction(keystrokeFn)) {\n                            keystrokeFn.call(this, editor);\n                        }\n                    }.bind(this)\n                }\n            );\n\n            nativeEditor.addCommand(commandName, command);\n        }\n\n        this._defaultKeystrokeCommand = nativeEditor.keystrokeHandler.keystrokes[keystroke.keys];\n\n        nativeEditor.setKeystroke(keystroke.keys, commandName);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonKeystroke\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (Lang.isFunction(super.componentWillUnmount)) {\n            super.componentWillUnmount();\n        }\n\n        this.props.editor.get('nativeEditor').setKeystroke(this.props.keystroke.keys, this._defaultKeystrokeCommand);\n    }\n};","import WidgetFocusManager from '../base/widget-focus-manager.js';\nimport React from 'react';\n\n/**\n * The ButtonDropdown class provides markup and keyboard navigation behaviour to a dropdown\n * opened from a button.\n *\n * @class ButtonDropdown\n */\nclass ButtonDropdown extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonDropdown\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <div className=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\" onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} tabIndex=\"0\">\n                <ul className=\"ae-listbox\" role=\"listbox\">\n                    {this.props.children}\n                </ul>\n            </div>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the dropdown in the configuration.\n *\n * @default dropdown\n * @memberof ButtonDropdown\n * @property {String} key\n * @static\n */\nButtonDropdown.key = 'dropdown';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonDropdown\n * @method getDefaultProps\n */\nButtonDropdown.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonDropdown\n);","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonActionStyle is a mixin that provides applying style implementation for a\n * button based on the `applyStyle` and `removeStyle` API of CKEDITOR.\n *\n * To execute properly, the component has to expose the following methods which can be obtained\n * out of the box using the {{#crossLink \"ButtonStyle\"}}{{/crossLink}} mixin:\n * - `Function` {{#crossLink \"ButtonStyle/isActive\"}}{{/crossLink}} to check the active state\n * - `Function` {{#crossLink \"ButtonStyle/getStyle\"}}{{/crossLink}} to return the style that should be applied\n *\n * @class ButtonActionStyle\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Removes or applies the component style to the current selection.\n     *\n     * @instance\n     * @memberof ButtonActionStyle\n     * @method applyStyle\n     */\n    applyStyle() {\n        if (Lang.isFunction(this.isActive) && Lang.isFunction(this.getStyle)) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            editor.getSelection().lock();\n\n            if (this.isActive()) {\n                editor.removeStyle(this.getStyle());\n            } else {\n                editor.applyStyle(this.getStyle());\n            }\n\n            editor.getSelection().unlock();\n\n            editor.fire('actionPerformed', this);\n        }\n    }\n};","import ReactDOM from 'react-dom';\nimport Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for managing different dropdowns inside a widget.\n *\n * @class WidgetDropdown\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            ...this.state,\n            dropdownTrigger: null,\n            itemDropdown: null\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps(nextProps) {\n        if (Lang.isFunction(super.componentWillReceiveProps)) {\n            super.componentWillReceiveProps();\n        }\n\n        this.setState({\n            dropdownTrigger: null,\n            itemDropdown: null\n        });\n    }\n\n    /**\n     * Merges the provided object with two more properties:\n     * - expanded - boolean flag which indicates if an widget should be rendered exclusively.\n     * - toggleDropdown - function, which can be used by an widget in order to obtain exclusive state.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method mergeDropdownProps\n     * @param {Object} obj The properties container which should be merged with the properties, related\n     *    to dropdown state.\n     * @param {Object} itemKey They key of an React Widget which contains the dropdown.\n     * @return {Object} The merged object.\n     */\n    mergeDropdownProps(obj, itemKey) {\n        return CKEDITOR.tools.merge(obj, {\n            expanded: this.state.itemDropdown === itemKey ? true : false,\n            tabIndex: this.state.dropdownTrigger === itemKey ? 0 : -1,\n            toggleDropdown: this.toggleDropdown.bind(this, itemKey)\n        });\n    }\n\n    /**\n     * Sets the active dropdown of the widget or discards the toggled item from the state.\n     *\n     * @instance\n     * @memberof WidgetDropdown\n     * @method toggleDropdown\n     * @param {Object} itemDropdown The widget which requests to toggle its dropdown.\n     * @param {Number} toggleDirection User movement direction when toggled via keyboard.\n     */\n    toggleDropdown(itemDropdown, toggleDirection) {\n        this.setState({\n            dropdownTrigger: itemDropdown,\n            itemDropdown: itemDropdown !== this.state.itemDropdown ? itemDropdown : null\n        }, function() {\n            if (!this.state.itemDropdown) {\n                if (this.moveFocus) {\n                    this.moveFocus(toggleDirection);\n                } else {\n                    ReactDOM.findDOMNode(this).focus();\n                }\n            }\n        });\n    }\n};","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for managing exclusive state of an widget.\n * The exclusive state means that a button may request to be the only rendered\n * widget in its parent container. WidgetExclusive will manage this state by\n * filtering and suppressing the other sibling widgets from displaying.\n *\n * @class WidgetExclusive\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Cancels the exclusive state of an widget.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method cancelExclusive\n     * @param {Object} itemExclusive The widget which exclusive state should be canceled.\n     */\n    cancelExclusive(itemExclusive) {\n        if (this.state.itemExclusive === itemExclusive) {\n            this.setState({\n                itemExclusive: null\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     * Calling this.setState() within this function will not trigger an additional render.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method componentWillReceiveProps\n     * @param {Object} nextProps Object containing the current set of properties.\n     */\n    componentWillReceiveProps(nextProps) {\n        if (Lang.isFunction(super.componentWillReceiveProps)) {\n            super.componentWillReceiveProps();\n        }\n\n        // Receiving properties means that the component is being re-rendered.\n        // Re-rendering is triggered by editorInteraction, so we have to\n        // reset the exclusive state and render the UI according to the new selection.\n        this.setState({\n            itemExclusive: null\n        });\n    }\n\n    /**\n     * Filters the items and returns only those with exclusive state.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method filterExclusive\n     * @param {Array} items The widgets to be filtered.\n     * @return {Array|Object} The item with executive state.\n     */\n    filterExclusive(items) {\n        return items.filter(function(item) {\n            if (this.state.itemExclusive) {\n                if (this.state.itemExclusive === item.key) {\n                    return item;\n                }\n            } else {\n                return item;\n            }\n        }.bind(this));\n    }\n\n    /**\n     * Merges the provided object with three more properties:\n     * - cancelExclusive - function, which can be used by a widget in order to cancel executive state.\n     * - renderExclusive - boolean flag which indicates if an widget should be rendered exclusively.\n     * - requestExclusive - function, which can be used by a widget in order to obtain exclusive state.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method mergeExclusiveProps\n     * @param {Object} obj The properties container which should be merged with the properties, related\n     *    to exclusive state.\n     * @param {Object} itemKey They key of an React Widget which should be rendered exclusively.\n     * @return {Object} The merged object.\n     */\n    mergeExclusiveProps(obj, itemKey) {\n        return CKEDITOR.tools.merge(obj, {\n            cancelExclusive: this.cancelExclusive.bind(this, itemKey),\n            renderExclusive: (this.state.itemExclusive === itemKey),\n            requestExclusive: this.requestExclusive.bind(this, itemKey)\n        });\n    }\n\n    /**\n     * Requests and sets exclusive state of an widget.\n     *\n     * @instance\n     * @memberof WidgetExclusive\n     * @method requestExclusive\n     * @param {Object} itemExclusive The widget which requests exclusive state.\n     */\n    requestExclusive(itemExclusive) {\n        this.setState({\n            itemExclusive: itemExclusive\n        });\n    }\n};","import Lang from './lang';\n\n/**\n * Sets the prototype, constructor and superclass properties to support an inheritance strategy\n * that can chain constructors and methods. Static members will not be inherited.\n *\n * @memberof OOP\n * @method extend\n * @param {Function} receiver The class which will extend another class.\n * @param {Function} supplier The class which will provide the properties the child class.\n * @param {Object} protoProps Prototype properties to add/override.\n * @param {Object} staticProps Static properties to add/overwrite.\n * @return {Function} The extended class.\n * @static\n */\nconst extend = function(receiver, supplier, protoProps, staticProps) {\n    if (!supplier || !receiver) {\n        throw 'extend failed, verify dependencies';\n    }\n\n    var supplierProto = supplier.prototype, receiverProto = Object.create(supplierProto);\n    receiver.prototype = receiverProto;\n\n    receiverProto.constructor = receiver;\n    receiver.superclass = supplierProto;\n\n    // assign constructor property\n    if (supplier !== Object && supplierProto.constructor === Object.prototype.constructor) {\n        supplierProto.constructor = supplier;\n    }\n\n    // add prototype overrides\n    if (protoProps) {\n        Lang.mix(receiverProto, protoProps);\n    }\n\n    // add object overrides\n    if (staticProps) {\n        Lang.mix(receiver, staticProps);\n    }\n\n    return receiver;\n};\n\nexport default extend;","var _isRangeAtElementEnd = function(range, element) {\n    // Finding if a range is at the end of an element is somewhat tricky due to how CKEditor handles\n    // ranges. It might depend on wether a source node inside the element is selected or not. For now,\n    // we need to cover the following cases:\n    //\n    // - The text length of the element is the same as the endOffset of the range\n    // - Both start and end containers match the element and the start and end offsets are 1\n\n    return element.getText().length === range.endOffset ||\n        (\n            element.equals(range.startContainer) &&\n            element.equals(range.endContainer) &&\n            range.startOffset === range.endOffset &&\n            range.endOffset === 1\n        );\n};\n\nvar embedSelectionTest = function(payload) {\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        selectionData.element &&\n        selectionData.element.getAttribute('data-widget') === 'ae_embed'\n    );\n};\n\nvar linkSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n    var range = nativeEditor.getSelection().getRanges()[0];\n\n    var element;\n\n    return !!(\n        nativeEditor.isSelectionEmpty() &&\n        (element = (new CKEDITOR.Link(nativeEditor)).getFromSelection()) &&\n        element.getText().length !== range.endOffset &&\n        !element.isReadOnly() &&\n        !_isRangeAtElementEnd(range, element)\n    );\n};\n\nvar imageSelectionTest = function(payload) {\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        selectionData.element &&\n        selectionData.element.getName() === 'img' &&\n        !selectionData.element.isReadOnly()\n    );\n};\n\nvar textSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var selectionEmpty = nativeEditor.isSelectionEmpty();\n\n    var selectionData = payload.data.selectionData;\n\n    return !!(\n        !selectionData.element &&\n        selectionData.region &&\n        !selectionEmpty &&\n        !nativeEditor.getSelection().getCommonAncestor().isReadOnly()\n    );\n};\n\nvar tableSelectionTest = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var table = new CKEDITOR.Table(nativeEditor);\n    var element = table.getFromSelection();\n\n    return !!(element && table.isEditable(element));\n};\n\nconst SelectionTest = {\n    embed: embedSelectionTest,\n    image: imageSelectionTest,\n    link: linkSelectionTest,\n    table: tableSelectionTest,\n    text: textSelectionTest\n};\n\nexport default SelectionTest;","import ReactDOM from 'react-dom';\n\n/**\n * Calculates the position where an Widget should be displayed based on the point\n * where user interacted with the editor.\n *\n * @class WidgetPosition\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Lifecycle. Returns the default values of the properties used in the widget.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method getDefaultProps\n     */\n    static defaultProps = {\n        ...WrappedComponent.defaultProps,\n        gutter: {\n            left: 0,\n            top: 10\n        },\n        constrainToViewport: true\n    }\n\n    /**\n     * Cancels an scheduled animation frame.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method cancelAnimation\n     */\n    cancelAnimation() {\n        if (window.cancelAnimationFrame) {\n            window.cancelAnimationFrame(this._animationFrameId);\n        }\n    }\n\n    /**\n     * Returns an object which contains the position of the element in page coordinates,\n     * restricted to fit to given viewport.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method getConstrainedPosition\n     * @param {Object} attrs The following properties, provided as numbers:\n     * - height\n     * - left\n     * - top\n     * - width\n     * @param {Object} viewPaneSize Optional. If not provided, the current viewport will be used. Should contain at least these properties:\n     * - width\n     * @return {Object} An object with `x` and `y` properties, which represent the constrained position of the\n     * element.\n     */\n    getConstrainedPosition(attrs, viewPaneSize) {\n        viewPaneSize = viewPaneSize || new CKEDITOR.dom.window(window).getViewPaneSize();\n\n        var x = attrs.left;\n        var y = attrs.top;\n\n        if (attrs.left + attrs.width > viewPaneSize.width) {\n            x -= (attrs.left + attrs.width - viewPaneSize.width);\n        }\n\n        if (y < 0) {\n            y = 0;\n        }\n\n        return {\n            x: x,\n            y: y\n        };\n    }\n\n    /**\n     * Returns the position, in page coordinates, according to which a widget should appear.\n     * Depending on the direction of the selection, the wdiget may appear above of or on bottom of the selection.\n     *\n     * It depends on the props editorEvent to analyze the following user-interaction parameters:\n     * - {Object} selectionData The data about the selection in the editor as returned from\n     * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n     * - {Number} pos Contains the coordinates of the position, considered as most appropriate.\n     * This may be the point where the user released the mouse, or just the beginning or the end of\n     * the selection.\n     *\n     * @instance\n     * @memberof WidgetInteractionPoint\n     * @method getInteractionPoint\n     * @return {Object} An Object which contains the following properties:\n     * direction, x, y, where x and y are in page coordinates and direction can be one of these:\n     * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n     */\n    getInteractionPoint() {\n        var eventPayload = this.props.editorEvent ? this.props.editorEvent.data : null;\n\n        if (!eventPayload) {\n            return;\n        }\n\n        var selectionData = eventPayload.selectionData;\n\n        var nativeEvent = eventPayload.nativeEvent;\n\n        var pos = {\n            x: eventPayload.nativeEvent.pageX,\n            y: selectionData.region.top\n        };\n\n        var direction = selectionData.region.direction;\n\n        var endRect = selectionData.region.endRect;\n\n        var startRect = selectionData.region.startRect;\n\n        if (endRect && startRect && startRect.top === endRect.top) {\n            direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n        }\n\n        var x;\n        var y;\n\n        // If we have the point where user released the mouse, show Toolbar at this point\n        // otherwise show it on the middle of the selection.\n\n        if (pos.x && pos.y) {\n            x = this._getXPoint(selectionData, pos.x);\n\n            if (direction === CKEDITOR.SELECTION_BOTTOM_TO_TOP) {\n                y = Math.min(pos.y, selectionData.region.top);\n            } else {\n                y = Math.max(pos.y, this._getYPoint(selectionData, nativeEvent));\n            }\n        } else {\n            x = selectionData.region.left + selectionData.region.width / 2;\n\n            if (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n\n                y = this._getYPoint(selectionData, nativeEvent);\n\n            } else {\n                y = selectionData.region.top;\n            }\n        }\n\n        return {\n            direction: direction,\n            x: x,\n            y: y\n        };\n    }\n\n    /**\n     * Returns the position of the Widget.\n     *\n     * @instance\n     * @memberof WidgetInteractionPoint\n     * @method _getXPoint\n     * @param {Object} eventX The X coordinate received from the native event (mouseup).\n     * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n     * @protected\n     * @return {Number} The calculated X point in page coordinates.\n     */\n    _getXPoint(selectionData, eventX) {\n        var region = selectionData.region;\n\n        var left = region.startRect ? region.startRect.left : region.left;\n        var right = region.endRect ? region.endRect.right : region.right;\n\n        var x;\n\n        if (left < eventX && right > eventX) {\n            x = eventX;\n        } else {\n            var leftDist = Math.abs(left - eventX);\n            var rightDist = Math.abs(right - eventX);\n\n            if (leftDist < rightDist) { // user raised the mouse on left on the selection\n                x = left;\n            } else {\n                x = right;\n            }\n        }\n\n        return x;\n    }\n\n    /**\n     * Returns the position of the Widget.\n     *\n     * @instance\n     * @memberof WidgetInteractionPoint\n     * @method _getYPoint\n     * @param {Object} nativeEvent The data about event is fired\n     * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n     * @protected\n     * @return {Number} The calculated Y point in page coordinates.\n     */\n    _getYPoint(selectionData, nativeEvent) {\n        var y = 0;\n\n        if (selectionData && nativeEvent) {\n            var elementTarget = new CKEDITOR.dom.element(nativeEvent.target);\n\n            if (elementTarget.$ && elementTarget.getStyle('overflow') === 'auto') {\n                y = nativeEvent.target.offsetTop + nativeEvent.target.offsetHeight;\n            } else {\n                y = selectionData.region.bottom;\n            }\n        }\n\n        return y;\n    }\n\n    /**\n     * Returns the position of the Widget taking in consideration the\n     * {{#crossLink \"WidgetPosition/gutter:attribute\"}}{{/crossLink}} attribute.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @protected\n     * @method  getWidgetXYPoint\n     * @param {Number} left The left offset in page coordinates where Toolbar should be shown.\n     * @param {Number} top The top offset in page coordinates where Toolbar should be shown.\n     * @param {Number} direction The direction of the selection. May be one of the following:\n     * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n     * @return {Array} An Array with left and top offsets in page coordinates.\n     */\n    getWidgetXYPoint(left, top, direction) {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        var gutter = this.props.gutter;\n\n        if (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM || direction === CKEDITOR.SELECTION_BOTTOM_TO_TOP) {\n            left = left - gutter.left - (domNode.offsetWidth / 2);\n\n            top = (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) ? (top + gutter.top) :\n                (top - domNode.offsetHeight - gutter.top);\n\n        } else if (direction === CKEDITOR.SELECTION_LEFT_TO_RIGHT ||\n            direction === CKEDITOR.SELECTION_RIGHT_TO_LEFT) {\n\n            left = (direction === CKEDITOR.SELECTION_LEFT_TO_RIGHT) ?\n                (left + gutter.left + domNode.offsetHeight / 2) :\n                (left - 3 * domNode.offsetHeight / 2 - gutter.left);\n\n            top = top - gutter.top - (domNode.offsetHeight / 2);\n        }\n\n        if (left < 0) {\n            left = 0;\n        }\n\n        if (top < 0) {\n            top = 0;\n        }\n\n        return [left, top];\n    }\n\n    /**\n     * Returns true if the widget is visible, false otherwise\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method isVisible\n     * @return {Boolean} True if the widget is visible, false otherwise\n     */\n    isVisible() {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (domNode) {\n            var domElement = new CKEDITOR.dom.element(domNode);\n\n            return domElement.hasClass('alloy-editor-visible');\n        }\n\n        return false;\n    }\n\n    /**\n     * Moves a widget from a starting point to a destination point.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method moveToPoint\n     * @param  {Object} startPoint The starting point for the movement.\n     * @param  {Object} endPoint The destination point for the movement.\n     */\n    moveToPoint(startPoint, endPoint) {\n        var domElement = new CKEDITOR.dom.element(ReactDOM.findDOMNode(this));\n\n        domElement.setStyles({\n            left: startPoint[0] + 'px',\n            top: startPoint[1] + 'px',\n            opacity: 0\n        });\n\n        domElement.removeClass('alloy-editor-invisible');\n\n        this._animate(function() {\n            domElement.addClass('ae-toolbar-transition');\n            domElement.addClass('alloy-editor-visible');\n            domElement.setStyles({\n                left: endPoint[0] + 'px',\n                top: endPoint[1] + 'px',\n                opacity: 1\n            });\n        });\n    }\n\n    /**\n     * Shows the widget with the default animation transition.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method show\n     */\n    show() {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (!this.isVisible() && domNode) {\n            var interactionPoint = this.getInteractionPoint();\n\n            if (interactionPoint) {\n                var domElement = new CKEDITOR.dom.element(domNode);\n\n                var finalX,\n                    finalY,\n                    initialX,\n                    initialY;\n\n                finalX = initialX = parseFloat(domElement.getStyle('left'));\n                finalY = initialY = parseFloat(domElement.getStyle('top'));\n\n                if (this.props.constrainToViewport) {\n                    var res = this.getConstrainedPosition({\n                        height: parseFloat(domNode.offsetHeight),\n                        left: finalX,\n                        top: finalY,\n                        width: parseFloat(domNode.offsetWidth)\n                    });\n\n                    finalX = res.x;\n                    finalY = res.y;\n                }\n\n                if (interactionPoint.direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n                    initialY = this.props.selectionData.region.bottom;\n                } else {\n                    initialY = this.props.selectionData.region.top;\n                }\n\n                this.moveToPoint([initialX, initialY], [finalX, finalY]);\n            }\n        }\n    }\n\n    /**\n     * Updates the widget position based on the current interaction point.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method updatePosition\n     */\n    updatePosition() {\n        var interactionPoint = this.getInteractionPoint();\n\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (interactionPoint && domNode) {\n            var xy = this.getWidgetXYPoint(interactionPoint.x, interactionPoint.y, interactionPoint.direction);\n\n            new CKEDITOR.dom.element(domNode).setStyles({\n                left: xy[0] + 'px',\n                top: xy[1] + 'px'\n            });\n        }\n    }\n\n    /**\n     * Requests an animation frame, if possible, to simulate an animation.\n     *\n     * @instance\n     * @memberof WidgetPosition\n     * @method _animate\n     * @param {Function} callback The function to be executed on the scheduled frame.\n     * @protected\n     */\n    _animate(callback) {\n        if (window.requestAnimationFrame) {\n            this._animationFrameId = window.requestAnimationFrame(callback);\n        } else {\n            callback();\n        }\n    }\n}\n","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for displaying Widget Arrow box on top or on bottom of the widget\n * depending on the point of user interaction with the editor.\n *\n * @class WidgetArrowBox\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Returns the list of arrow box classes associated to the current element's state. It relies\n     * on the getInteractionPoint method to calculate the selection direction.\n     *\n     * @instance\n     * @memberof WidgetArrowBox\n     * @method getArrowBoxClasses\n     * @return {String} A string with the arrow box CSS classes.\n     */\n    getArrowBoxClasses() {\n        var arrowBoxClasses = 'ae-arrow-box';\n\n        if (Lang.isFunction(this.getInteractionPoint) && this.getInteractionPoint()) {\n            if (this.getInteractionPoint().direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n                arrowBoxClasses += ' ae-arrow-box-top';\n            } else {\n                arrowBoxClasses += ' ae-arrow-box-bottom';\n            }\n        }\n\n        return arrowBoxClasses;\n    }\n};","import Lang from '../../oop/lang.js';\nimport React from 'react';\n\n/**\n * ToolbarButtons is a mixin which provides a list of buttons which have to be\n * displayed on the current toolbar depending on user preferences and given state.\n *\n * @class ToolbarButtons\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Analyzes the current selection and the buttons exclusive mode value to figure out which\n     * buttons should be present in a given state.\n     *\n     * @instance\n     * @memberof ToolbarButtons\n     * @method getToolbarButtons\n     * @param {Array} buttons The buttons could be shown, prior to the state filtering.\n     * @param {Object} additionalProps Additional props that should be passed down to the buttons.\n     * @return {Array} An Array which contains the buttons that should be rendered.\n     */\n    getToolbarButtons(buttons, additionalProps) {\n        var buttonProps = {};\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var buttonCfg = nativeEditor.config.buttonCfg || {};\n\n        if (Lang.isFunction(buttons)) {\n            buttons = buttons.call(this) || [];\n        }\n\n        var toolbarButtons = this.filterExclusive(\n                buttons.filter(function(button) {\n                    return button && (AlloyEditor.Buttons[button] || AlloyEditor.Buttons[button.name]);\n                })\n                .map(function(button) {\n                    if (Lang.isString(button)) {\n                        buttonProps[button] = buttonCfg[button];\n                        button = AlloyEditor.Buttons[button];\n                    } else if (Lang.isString(button.name)) {\n                        buttonProps[AlloyEditor.Buttons[button.name].key] = CKEDITOR.tools.merge(buttonCfg[button], button.cfg);\n                        button = AlloyEditor.Buttons[button.name];\n                    }\n\n                    return button;\n                })\n            )\n            .map(function(button) {\n                var props = this.mergeExclusiveProps({\n                    editor: this.props.editor,\n                    key: button.key,\n                    tabKey: button.key,\n                    tabIndex: (this.props.trigger && this.props.trigger.props.tabKey === button.key) ? 0 : -1,\n                    trigger: this.props.trigger\n                }, button.key);\n\n                props = this.mergeDropdownProps(props, button.key);\n\n                if (additionalProps) {\n                    props = CKEDITOR.tools.merge(props, additionalProps);\n                }\n\n                props = CKEDITOR.tools.merge(props, buttonProps[button.key]);\n\n                return React.createElement(button, props);\n            }, this);\n\n        return toolbarButtons;\n    }\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nvar KEY_ENTER = 13;\nvar KEY_ESC = 27;\n\n/**\n * The ButtonTableEdit class provides functionality for creating and editing a table in a document.\n * Provides UI for creating a table.\n *\n * @class ButtonTableEdit\n */\nclass ButtonTableEdit extends React.Component {\n    /**\n     * Lifecycle. Invoked once before the component is mounted.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method getInitialState\n     */\n    constructor(props) {\n        super(props);\n\n        this.rowsRef = React.createRef();\n        this.colsRef = React.createRef();\n        this.state = {\n            cols: 3,\n            rows: 3\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        this.rowsRef.current.focus();\n    }\n\n    /**\n     * Creates a table.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _createTable\n     * @protected\n     */\n    _createTable() {\n        var editor = this.props.editor.get('nativeEditor');\n        var tableUtils = new CKEDITOR.Table(editor);\n\n        tableUtils.create({\n            attrs: this.props.tableAttributes,\n            cols: this.state.cols,\n            rows: this.state.rows\n        });\n\n        this.props.cancelExclusive();\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Handles a change in input value. Sets the provided value from the user back to the input.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _handleChange\n     * @param {String} inputName The name of the input which value should be updated.\n     * @param {SyntheticEvent} event The provided event.\n     * @protected\n     */\n    _handleChange(inputName, event) {\n        var state = {};\n        state[inputName] = event.target.value;\n\n        this.setState(state);\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates the table.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === KEY_ENTER) {\n            this._createTable();\n        } else if (event.keyCode === KEY_ESC) {\n            this.props.cancelExclusive();\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var time = Date.now();\n        var rowsId = time + 'rows';\n        var colsId = time + 'cols';\n\n        return (\n            <div className=\"ae-container-edit-table\">\n                <label htmlFor={rowsId}>{AlloyEditor.Strings.rows}</label>\n                <div className=\"ae-container-input small\">\n                    <input className=\"ae-input\" id={rowsId} onChange={this._handleChange.bind(this, 'rows')} min=\"1\" onKeyDown={this._handleKeyDown.bind(this)} placeholder=\"Rows\" ref={this.rowsRef} type=\"number\" value={this.state.rows}></input>\n                </div>\n\n                <label htmlFor={colsId}>{AlloyEditor.Strings.columns}</label>\n                <div className=\"ae-container-input small\">\n                    <input className=\"ae-input\" id={colsId} onChange={this._handleChange.bind(this, 'cols')} min=\"1\" onKeyDown={this._handleKeyDown.bind(this)} placeholder=\"Colums\" ref={this.colsRef} type=\"number\" value={this.state.cols}></input>\n                </div>\n\n                <button aria-label=\"Confirm\" className=\"ae-button\" onClick={this._createTable.bind(this)}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableEdit\n * @memberof ButtonTableEdit\n * @property {String} key\n * @static\n */\nButtonTableEdit.key = 'tableEdit';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonTableEdit\n * @method getDefaultProps\n */\nButtonTableEdit.defaultProps = {\n    tableAttributes: {\n        border: 1,\n        cellPadding: 0,\n        cellSpacing: 0,\n        style: 'width: 100%'\n    }\n};\n\nexport default ButtonTableEdit;\n","import ButtonDropdown from './button-dropdown.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonsStylesListHeader from './button-styles-list-header.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonStylesList class provides functionality for showing a list of styles that can be\n * applied to the current selection..\n *\n * @class ButtonStylesList\n * @uses WidgetFocusManager\n */\nclass ButtonStylesList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the list node to allow keyboard interaction.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        var blockStyles = [];\n        var inlineStyles = [];\n        var objectStyles = [];\n\n        this.props.styles.forEach(function(item) {\n            var style = new CKEDITOR.style(item.style);\n\n            if (style.type === CKEDITOR.STYLE_BLOCK) {\n                blockStyles.push(item);\n            } else if (style.type === CKEDITOR.STYLE_INLINE) {\n                inlineStyles.push(item);\n            } else if (style.type === CKEDITOR.STYLE_OBJECT) {\n                objectStyles.push(item);\n            }\n        });\n\n        this._blockStyles = blockStyles;\n        this._inlineStyles = inlineStyles;\n        this._objectStyles = objectStyles;\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var removeStylesItem;\n\n        if (this.props.showRemoveStylesItem) {\n            removeStylesItem = <ButtonStylesListItemRemove editor={this.props.editor} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <ButtonDropdown {...this.props}>\n                {removeStylesItem}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.blockStyles} styles={this._blockStyles} />\n                {this._renderStylesItems(this._blockStyles)}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.inlineStyles} styles={this._inlineStyles} />\n                {this._renderStylesItems(this._inlineStyles)}\n\n                <ButtonsStylesListHeader name={AlloyEditor.Strings.objectStyles} styles={this._objectStyles} />\n                {this._renderStylesItems(this._objectStyles)}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Renders instances of ButtonStylesListItem with the preview of the correspondent block, inline or object styles.\n     *\n     * @instance\n     * @memberof ButtonStylesList\n     * @method _renderStylesItems\n     * @param {Array} styles List of styles for which preview should be rendered.\n     * @protected\n     * @return {Array} Rendered instances of ButtonStylesListItem class\n     */\n    _renderStylesItems(styles) {\n        var editor = this.props.editor;\n        var items;\n\n        if (styles && styles.length) {\n            items = styles.map(function(item) {\n                return (\n                    <li key={item.name} role=\"option\">\n                        <ButtonStylesListItem activeStyle={this.props.activeStyle} editor={editor} name={item.name} style={item.style} />\n                    </li>\n                );\n            }.bind(this));\n        }\n\n        return items;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @memberof ButtonStylesList\n * @static\n * @property {String} key\n * @default buttonStylesList\n */\nButtonStylesList.key = 'buttonStylesList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStylesList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStylesList.defaultProps = {\n    circular: false,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    },\n    showRemoveStylesItem: true\n};\n\nexport default WidgetFocusManager(\n    ButtonStylesList\n);","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStylesListItem class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItem\n * @uses ButtonActionStyle\n * @uses ButtonStyle\n */\nclass ButtonStylesListItem extends React.Component {\n    /**\n     * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method componentWillMount\n     */\n    componentWillMount() {\n        // Styles with wildcard element (*) generate an empty tag in their preview < class=\"custom-class\" />.\n        // We default to element span and remove the margins to obtain a more consistent set of previews.\n        var styleCfg = {\n            element: 'span',\n            styles: {\n                margin: 0\n            }\n        };\n\n        styleCfg = CKEDITOR.tools.merge(styleCfg, this.props.style);\n\n        this._preview = new CKEDITOR.style(styleCfg).buildPreview(this.props.name);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        // We need to use dangerouselySetInnterHTML since we're not in control of the style\n        // preview that is generated by CKEditor.\n        var className = this.props.name === this.props.activeStyle ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n        return (\n            <button className={className} dangerouslySetInnerHTML={{__html: this._preview}} onClick={this._onClick.bind(this)} tabIndex={this.props.tabIndex}></button>\n        );\n    }\n\n    /**\n     * Applies the item style to the editor selection.\n     *\n     * @instance\n     * @memberof ButtonStylesListItem\n     * @method _onClick\n     * @protected\n     */\n    _onClick() {\n        // Typically, we want the style to be the only one applied to the current selection, so\n        // we execute the 'removeFormat' command first. Note that block styles won't be cleaned.\n        // However, this is consistent with other editors implementations of this feature.\n        this.props.editor.get('nativeEditor').execCommand('removeFormat');\n\n        this.applyStyle();\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonStylesListItem\n * @memberof ButtonStylesListItem\n * @property {String} key\n * @static\n */\nButtonStylesListItem.key = 'buttonStylesListItem';\n\nexport default ButtonActionStyle(\n    ButtonStyle(\n        ButtonStylesListItem\n));","import React from 'react';\n\n/**\n * The ButtonStylesListItemRemove class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItemRemove\n */\nclass ButtonStylesListItemRemove extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStylesListItemRemove\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <li role=\"option\">\n                <button className=\"ae-toolbar-element\" onClick={this._removeStyles.bind(this)} tabIndex={this.props.tabIndex}>{AlloyEditor.Strings.normal}</button>\n            </li>\n        );\n    }\n\n    /**\n     * Removes all inline styles and configured block elements applied to the current selection.\n     *\n     * @instance\n     * @memberof ButtonStylesListItemRemove\n     * @method _removeStyles\n     * @protected\n     */\n    _removeStyles() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.execCommand('removeFormat');\n\n        this.props.removeBlocks.forEach(function(blockItem) {\n            var blockStyle = new CKEDITOR.style({element: blockItem});\n\n            editor.removeStyle(blockStyle);\n        });\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonStylesListItemRemove\n * @memberof ButtonStylesListItemRemove\n * @property {String} key\n * @static\n */\nButtonStylesListItemRemove.key = 'buttonStylesListItemRemove';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStylesListItemRemove\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStylesListItemRemove.defaultProps = {\n    removeBlocks: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'pre']\n};\n\nexport default ButtonStylesListItemRemove;\n","import React from 'react';\n\n/**\n * The ButtonsStylesListHeader class provides the header of an list of style items.\n *\n * @class ButtonsStylesListHeader\n */\nclass ButtonsStylesListHeader extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonsStylesListHeader\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.styles && this.props.styles.length) {\n            return (\n                <span className=\"ae-list-header\">{this.props.name}</span>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n\nexport default ButtonsStylesListHeader;","import ButtonDropdown from './button-dropdown.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonTargetList class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonTargetList\n * @uses WidgetFocusManager\n */\nclass ButtonTargetList extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this).focus();\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var listTargets = this._renderListTargets();\n\n        return (\n            <ButtonDropdown {...this.props}>\n                {listTargets}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Returns the the allowed link target items.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method _getAllowedTargetItems\n     * @protected\n     * @return {Array} The allowed target items.\n     */\n    _getAllowedTargetItems() {\n        return this.props.allowedLinkTargets || [{\n            label: AlloyEditor.Strings.linkTargetDefault,\n            value: ''\n        }, {\n            label: AlloyEditor.Strings.linkTargetSelf,\n            value: '_self'\n        }, {\n            label: AlloyEditor.Strings.linkTargetBlank,\n            value: '_blank'\n        }, {\n            label: AlloyEditor.Strings.linkTargetParent,\n            value: '_parent'\n        }, {\n            label: AlloyEditor.Strings.linkTargetTop,\n            value: '_top'\n        }];\n    }\n\n    /**\n     * Renders the allowed link target items.\n     *\n     * @instance\n     * @memberof ButtonTargetList\n     * @method _renderListTargets\n     * @protected\n     * @return {Object} Returns the rendered link items\n     */\n    _renderListTargets() {\n        var targets = this._getAllowedTargetItems();\n\n        var handleLinkTargetChange = this.props.handleLinkTargetChange;\n\n        targets = targets.map(function(target) {\n            var className = this.props.selectedTarget === target.value ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n            return (\n                <li key={target.value} role=\"option\">\n                    <button className={className} data-value={target.value} onClick={handleLinkTargetChange}>{target.label}</button>\n                </li>\n            );\n        }.bind(this));\n\n        return targets;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkTargetEdit\n * @memberof ButtonTargetList\n * @property {String} key\n * @static\n */\nButtonTargetList.key = 'targetList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonTargetList\n * @method getDefaultProps\n */\nButtonTargetList.defaultProps = {\n    circular: true,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonTargetList\n);","import ButtonTargetList from './button-target-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonLinkTargetEdit class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonLinkTargetEdit\n */\nclass ButtonLinkTargetEdit extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLinkTargetEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var handleLinkTargetChange = this.props.handleLinkTargetChange;\n        var allowedLinkTargets = this.props.allowedTargets;\n\n        return (\n            <div className=\"ae-container-edit-link-target ae-container-dropdown ae-container-dropdown-medium ae-has-dropdown\" tabIndex=\"0\">\n                <button aria-expanded={this.props.expanded} aria-label={this.props.selectedTarget} className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={this.props.selectedTarget}>\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{this.props.selectedTarget}</span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {this.props.expanded && (\n                    <ButtonTargetList editor={this.props.editor} onDismiss={this.props.toggleDropdown} allowedLinkTargets={allowedLinkTargets} handleLinkTargetChange={handleLinkTargetChange} selectedTarget={this.props.selectedTarget}/>\n                )}\n            </div>\n        );\n    }\n\n    /**\n     * Lifecycle. Invoked before rendering when new props or state are being received.\n     * This method is not called for the initial render or when forceUpdate is used.\n     *\n     * @instance\n     * @memberof ButtonLinkTargetEdit\n     * @method  shouldComponentUpdate\n     * @return {Boolean} Returns false when the transition to the new props and state will not\n     * require a component update.\n     */\n    shouldComponentUpdate(nextProps) {\n        return nextProps.expanded !== this.props.expanded || nextProps.selectedTarget !== this.props.selectedTarget;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkTargetEdit\n * @memberof ButtonLinkTargetEdit\n * @property {String} key\n * @static\n */\nButtonLinkTargetEdit.key = 'linkTargetEdit';\n\nexport default ButtonLinkTargetEdit;\n","/**\n * ButtonCfgProps is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonCfgProps\n */\nexport default WrappedComponent => class extends WrappedComponent {\n    /**\n     * Merges the properties, passed to the current component with user's configuration\n     * via `buttonCfg` property.\n     *\n     * @instance\n     * @memberof ButtonCfgProps\n     * @method mergeButtonCfgProps\n     * @param {Object} props The properties to be merged with the provided configuration for this\n     * button. If not passed, the user configuration will be merged with `this.props`\n     * @return {Object} The merged properties\n     */\n    mergeButtonCfgProps(props) {\n        props = props || this.props;\n\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var buttonCfg = nativeEditor.config.buttonCfg || {};\n        var result = CKEDITOR.tools.merge(props, buttonCfg['linkEdit']);\n\n        return result;\n    }\n};","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport Lang from '../../oop/lang.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonLinkEdit class provides functionality for creating and editing a link in a document.\n * Provides UI for creating, editing and removing a link.\n *\n * @class ButtonLinkEdit\n * @uses ButtonCfgProps\n * @uses WidgetDropdown\n * @uses WidgetFocusManager\n */\nclass ButtonLinkEdit extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.linkInput = React.createRef();\n        this.state = this._getInitialState();\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing. This should only happen if the component\n     * is rendered in exclusive mode to prevent aggressive focus stealing.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (this.props.renderExclusive || this.props.manualSelection) {\n            // We need to wait for the next rendering cycle before focusing to avoid undesired\n            // scrolls on the page\n            this._focusLinkInput();\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps() {\n        this.setState(this._getInitialState());\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var targetSelector = {\n            allowedTargets: this.props.allowedTargets,\n            editor: this.props.editor,\n            handleLinkTargetChange: this._handleLinkTargetChange.bind(this),\n            selectedTarget: this.state.linkTarget || AlloyEditor.Strings.linkTargetDefault\n        };\n\n        targetSelector = this.mergeDropdownProps(targetSelector, ButtonLinkTargetEdit.key);\n\n        var autocompleteDropdown;\n\n        if (this.props.data) {\n            var dataFn = this.props.data;\n\n            if (!Lang.isFunction(dataFn)) {\n                var items = this.props.data;\n\n                dataFn = () => items;\n            }\n\n            var autocompleteDropdownProps = {\n                autocompleteSelected: this.state.autocompleteSelected,\n                data: dataFn,\n                editor: this.props.editor,\n                handleLinkAutocompleteClick: this._handleLinkAutocompleteClick,\n                onDismiss: this.props.toggleDropdown,\n                setAutocompleteState: this._setAutocompleteState,\n                term: this.state.linkHref\n            };\n\n            autocompleteDropdownProps = this.mergeDropdownProps(autocompleteDropdownProps, ButtonLinkAutocompleteList.key);\n\n            autocompleteDropdown = <ButtonLinkAutocompleteList {...autocompleteDropdownProps} />;\n        }\n\n        var buttonClearLink;\n\n        if (this.state.linkHref) {\n            buttonClearLink = <button aria-label={AlloyEditor.Strings.clearInput} className=\"ae-button ae-icon-remove\" onClick={this._clearLink.bind(this)} title={AlloyEditor.Strings.clear}></button>;\n        }\n\n        var placeholderProp = {};\n\n        if (!CKEDITOR.env.ie && AlloyEditor.Strings) {\n            placeholderProp.placeholder = AlloyEditor.Strings.editLink;\n        }\n\n        return (\n            <div className=\"ae-container-edit-link\">\n                <button aria-label={AlloyEditor.Strings.removeLink} className=\"ae-button\" disabled={!this.state.element} onClick={this._removeLink.bind(this)} title={AlloyEditor.Strings.remove}>\n                    <span className=\"ae-icon-unlink\"></span>\n                </button>\n                <div className=\"ae-container-input xxl\">\n                    {this.props.showTargetSelector && <ButtonLinkTargetEdit {...targetSelector} />}\n                    <div className=\"ae-container-input\">\n                        <input className=\"ae-input\" onChange={this._handleLinkHrefChange.bind(this)} onKeyDown={this._handleKeyDown.bind(this)} { ...placeholderProp } ref={this.linkInput} type=\"text\" value={this.state.linkHref}></input>\n                        {autocompleteDropdown}\n                    </div>\n                    {buttonClearLink}\n                </div>\n                <button aria-label={AlloyEditor.Strings.confirm} className=\"ae-button\" disabled={!this._isValidState()} onClick={this._updateLink.bind(this)} title={AlloyEditor.Strings.confirm}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n\n    /**\n     * The return value will be used as the initial value of this.state.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _getInitialState\n     * @protected\n     * @return {Object}\n     */\n    _getInitialState() {\n        const {editor, defaultLinkTarget} = this.props;\n\n        const link = new CKEDITOR.Link(editor.get('nativeEditor')).getFromSelection();\n        const href = link ? link.getAttribute('href') : '';\n        const target = link ? link.getAttribute('target') : defaultLinkTarget;\n\n        return {\n            autocompleteSelected: false,\n            element: link,\n            initialLink: {\n                href: href,\n                target: target\n            },\n            linkHref: href,\n            linkTarget: target\n        };\n    }\n\n    /**\n     * Clears the link input. This only changes the component internal state, but does not\n     * affect the link element of the editor. Only the _removeLink and _updateLink methods\n     * are translated to the editor element.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _clearLink\n     * @protected\n     */\n    _clearLink() {\n        this.setState({\n            linkHref: ''\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Focuses the user cursor on the widget's input.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _focusLinkInput\n     * @protected\n     */\n    _focusLinkInput() {\n        var instance = this;\n\n        var focusLinkEl = function() {\n            instance.linkInput.current.focus();\n        };\n\n        if (window.requestAnimationFrame) {\n            window.requestAnimationFrame(focusLinkEl);\n        } else {\n            setTimeout(focusLinkEl, 0);\n        }\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates/updates the link.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === 13 || event.keyCode === 27) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === 13) {\n            this._updateLink();\n        } else if (event.keyCode === 40) {\n            this.setState({\n                autocompleteSelected: true\n            });\n        } else if (event.keyCode === 27) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            new CKEDITOR.Link(editor).advanceSelection();\n\n            this.props.editor.get('nativeEditor').fire('actionPerformed', this);\n        }\n    }\n\n    /**\n     * Updates the component state when the link input changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkHrefChange\n     * @param {SyntheticEvent} event The change event.\n     * @protected\n     */\n    _handleLinkHrefChange(event) {\n        this.setState({\n            linkHref: event.target.value\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Updates the component state when the link target changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkTargetChange\n     * @param {SyntheticEvent} event The click event.\n     * @protected\n     */\n    _handleLinkTargetChange(event) {\n        this.setState({\n            itemDropdown: null,\n            linkTarget: event.target.getAttribute('data-value')\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Updates the component state when an autocomplete link result is selected by user interaction.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _handleLinkAutocompleteClick\n     * @param {SyntheticEvent} event The click event.\n     * @protected\n     */\n    _handleLinkAutocompleteClick(event) {\n        this.setState({\n            itemDropdown: null,\n            linkHref: event.target.getAttribute('data-value')\n        });\n\n        this._focusLinkInput();\n    }\n\n    /**\n     * Verifies that the current link state is valid so the user can save the link. A valid state\n     * means that we have a non-empty href and that either that or the link target are different\n     * from the original link.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _isValidState\n     * @protected\n     * @return {Boolean} [description]\n     */\n    _isValidState() {\n        var validState =\n            this.state.linkHref && (\n                this.state.linkHref !== this.state.initialLink.href ||\n                this.state.linkTarget !== this.state.initialLink.target\n            );\n\n        return validState;\n    }\n\n    /**\n     * Removes the link in the editor element.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _removeLink\n     * @protected\n     */\n    _removeLink() {\n        var editor = this.props.editor.get('nativeEditor');\n        var linkUtils = new CKEDITOR.Link(editor);\n        var selection = editor.getSelection();\n        var bookmarks = selection.createBookmarks();\n\n        linkUtils.remove(this.state.element, { advance: true });\n\n        selection.selectBookmarks(bookmarks);\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Update autocompleteSelected state to focus and select autocomplete´s dropdown\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _setAutocompleteState\n     * @protected\n     */\n    _setAutocompleteState(state) {\n        this.setState({\n            autocompleteSelected: state.selected\n        });\n    }\n\n    /**\n     * Updates the link in the editor element. If the element didn't exist previously, it will\n     * create a new <a> element with the href specified in the link input.\n     *\n     * @instance\n     * @memberof ButtonLinkEdit\n     * @method _updateLink\n     * @protected\n     */\n    _updateLink() {\n        var editor = this.props.editor.get('nativeEditor');\n        var linkUtils = new CKEDITOR.Link(editor, {appendProtocol: this.props.appendProtocol});\n        var linkAttrs = {\n            target: this.state.linkTarget\n        };\n        var modifySelection = { advance: true };\n\n        if (this.state.linkHref) {\n            if (this.state.element) {\n                linkAttrs.href = this.state.linkHref;\n\n                linkUtils.update(linkAttrs, this.state.element, modifySelection);\n            } else {\n                linkUtils.create(this.state.linkHref, linkAttrs, modifySelection);\n            }\n\n            editor.fire('actionPerformed', this);\n        }\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default linkEdit\n * @memberof ButtonLinkEdit\n * @property {String} key\n * @static\n */\nButtonLinkEdit.key = 'linkEdit';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLinkEdit\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLinkEdit.defaultProps = {\n    appendProtocol: true,\n    autocompleteUrl: '',\n    circular: true,\n    customIndexStart: true,\n    defaultLinkTarget: '',\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    },\n    showTargetSelector: true\n};\n\nexport default ButtonCfgProps(\n    WidgetDropdown(\n    WidgetFocusManager(\n        ButtonLinkEdit\n)));\n","import ButtonDropdown from './button-dropdown.jsx';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport React from 'react';\n\n/**\n * The ButtonLinkAutocompleteList class provides functionality for showing a list of\n * items that can be selected for the link.\n *\n * @class ButtonLinkAutocompleteList\n * @uses WidgetFocusManager\n */\nclass ButtonLinkAutocompleteList extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            items: []\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps(nextProps) {\n        if (!nextProps.term || nextProps.term !== this.props.term) {\n            clearTimeout(this._timeout);\n\n            if (nextProps.term) {\n                this._timeout = setTimeout(this._updateItems, this.props.delay);\n            } else {\n                this.setState({\n                    items: []\n                });\n            }\n        }\n\n        if (nextProps.autocompleteSelected) {\n            setTimeout(this.focus, 0);\n            this.props.setAutocompleteState({\n                selected: false\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        clearTimeout(this._timeout);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the list.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (!this.props.expanded || !this.state.items.length) {\n            return null;\n        }\n\n        return (\n            <ButtonDropdown>\n                {this._renderAutocompleteItems(this.state.items)}\n            </ButtonDropdown>\n        );\n    }\n\n    /**\n     * Lifecycle. Invoked before rendering when new props or state are being received.\n     * This method is not called for the initial render or when forceUpdate is used.\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method  shouldComponentUpdate\n     * @return {Boolean} Returns false when the transition to the new props and state will not\n     * require a component update.\n     */\n    shouldComponentUpdate(nextProps, nextState) {\n        return nextProps.expanded !== this.props.expanded || nextProps.term !== this.props.term || nextState.items !== this.state.items;\n    }\n\n    /**\n     * Renders a set of list items for the provided items\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method _renderAutocompleteItems\n     * @param {Array} items List of autocomplete items to render\n     * @protected\n     * @return {Array} Rendered list item instances\n     */\n    _renderAutocompleteItems(items) {\n        items = items || [];\n\n        var handleLinkAutocompleteClick = this.props.handleLinkAutocompleteClick;\n\n        return items.map(function(item) {\n            var className = this.props.term === item.url ? 'ae-toolbar-element active' : 'ae-toolbar-element';\n\n            return (\n                <li key={item.url} role=\"option\">\n                    <button className={className} onClick={handleLinkAutocompleteClick} data-value={item.url}>{item.title}</button>\n                </li>\n            );\n        }.bind(this));\n    }\n\n    /**\n     * Retrieves the data according to {this.props.term} and calls setState() with the returned data\n     *\n     * @instance\n     * @memberof ButtonLinkAutocompleteList\n     * @method _updateItems\n     * @protected\n     */\n    _updateItems() {\n        var instance = this;\n\n        if (!this.props.term) {\n            return;\n        }\n\n        var promise = Promise.resolve(this.props.data(this.props.term));\n\n        promise.then(function(items) {\n            if (items.length) {\n                !instance.props.expanded && instance.props.toggleDropdown();\n            }\n\n            instance.setState({\n                items: items\n            });\n        });\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonLinkAutocompleteList\n * @memberof ButtonLinkAutocompleteList\n * @property {String} key\n * @static\n */\nButtonLinkAutocompleteList.key = 'buttonLinkAutocompleteList';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLinkAutocompleteList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLinkAutocompleteList.defaultProps = {\n    circular: false,\n    data: [],\n    delay: 100,\n    descendants: '.ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        dismissNext: [39],\n        dismissPrev: [37],\n        next: [40],\n        prev: [38]\n    }\n};\n\nexport default WidgetFocusManager(\n    ButtonLinkAutocompleteList\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nvar KEY_ENTER = 13;\nvar KEY_ESC = 27;\n\n/**\n * The ButtonEmbedEdit class provides functionality for creating and editing an embed link in a document.\n * Provides UI for creating and editing an embed link.\n *\n * @class ButtonEmbedEdit\n */\nclass ButtonEmbedEdit extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.linkInput = React.createRef();\n        this.state = this.getInitialState();\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses on the link input to immediately allow editing. This should only happen if the component\n     * is rendered in exclusive mode to prevent aggressive focus stealing.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        if (this.props.renderExclusive || this.props.manualSelection) {\n            // We need to wait for the next rendering cycle before focusing to avoid undesired\n            // scrolls on the page\n            if (window.requestAnimationFrame) {\n                window.requestAnimationFrame(this._focusLinkInput.bind(this));\n            } else {\n                setTimeout(this._focusLinkInput.bind(this), 0);\n            }\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked when a component is receiving new props.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method componentWillReceiveProps\n     */\n    componentWillReceiveProps() {\n        this.setState(this.getInitialState());\n    }\n\n    /**\n     * Lifecycle. Invoked once before the component is mounted.\n     * The return value will be used as the initial value of this.state.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method getInitialState\n     */\n    getInitialState() {\n        var editor = this.props.editor.get('nativeEditor');\n        var embed;\n\n        var selection = editor.getSelection();\n\n        if (selection) {\n            var selectedElement = selection.getSelectedElement();\n\n            if (selectedElement) {\n                embed = selectedElement.findOne('[data-widget=\"ae_embed\"]');\n            }\n        }\n\n        var href = embed ? embed.getAttribute('data-ae-embed-url') : '';\n\n        return {\n            element: embed,\n            initialLink: {\n                href: href\n            },\n            linkHref: href\n        };\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var clearLinkStyle = {\n            opacity: this.state.linkHref ? 1 : 0\n        };\n\n        return (\n            <div className=\"ae-container-edit-link\">\n                <button aria-label={AlloyEditor.Strings.deleteEmbed} className=\"ae-button\" data-type=\"button-embed-remove\" disabled={!this.state.element} onClick={this._removeEmbed.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.deleteEmbed}>\n                    <span className=\"ae-icon-bin\"></span>\n                </button>\n                <div className=\"ae-container-input xxl\">\n                    <input className=\"ae-input\" onChange={this._handleLinkHrefChange.bind(this)} onKeyDown={this._handleKeyDown.bind(this)} placeholder={AlloyEditor.Strings.editLink} ref={this.linkInput} type=\"text\" value={this.state.linkHref}></input>\n                    <button aria-label={AlloyEditor.Strings.clearInput} className=\"ae-button ae-icon-remove\" onClick={this._clearLink.bind(this)} style={clearLinkStyle} title={AlloyEditor.Strings.clear}></button>\n                </div>\n                <button aria-label={AlloyEditor.Strings.confirm} className=\"ae-button\" disabled={!this._isValidState()} onClick={this._embedLink.bind(this)} title={AlloyEditor.Strings.confirm}>\n                    <span className=\"ae-icon-ok\"></span>\n                </button>\n            </div>\n        );\n    }\n\n    /**\n     * Clears the link input. This only changes the component internal state, but does not\n     * affect the link element of the editor. Only the _removeLink and _updateLink methods\n     * are translated to the editor element.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _clearLink\n     * @protected\n     */\n    _clearLink() {\n        this.setState({\n            linkHref: ''\n        });\n    }\n\n    /**\n     * Triggers the embedUrl command to transform the link into an embed media object\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _embedLink\n     * @protected\n     */\n    _embedLink() {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n\n        nativeEditor.execCommand('embedUrl', {\n            url: this.state.linkHref\n        });\n\n        // We need to cancelExclusive with the bound parameters in case the button is used\n        // inside another in exclusive mode (such is the case of the link button)\n        this.props.cancelExclusive();\n    }\n\n    /**\n     * Focuses the user cursor on the widget's input.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _focusLinkInput\n     * @protected\n     */\n    _focusLinkInput() {\n        this.linkInput.current.focus();\n    }\n\n    /**\n     * Monitors key interaction inside the input element to respond to the keys:\n     * - Enter: Creates/updates the link.\n     * - Escape: Discards the changes.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _handleKeyDown\n     * @param {SyntheticEvent} event The keyboard event.\n     * @protected\n     */\n    _handleKeyDown(event) {\n        if (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n            event.preventDefault();\n        }\n\n        if (event.keyCode === KEY_ENTER) {\n            this._embedLink();\n        } else if (event.keyCode === KEY_ESC) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            // We need to cancelExclusive with the bound parameters in case the button is used\n            // inside another in exclusive mode (such is the case of the link button)\n            this.props.cancelExclusive();\n\n            editor.fire('actionPerformed', this);\n        }\n    }\n\n    /**\n     * Updates the component state when the link input changes on user interaction.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _handleLinkHrefChange\n     * @param {SyntheticEvent} event The change event.\n     * @protected\n     */\n    _handleLinkHrefChange(event) {\n        this.setState({\n            linkHref: event.target.value\n        });\n    }\n\n    /**\n     * Verifies that the current link state is valid so the user can save the link. A valid state\n     * means that we have a non-empty href that's different from the original one.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _isValidState\n     * @protected\n     * @return {Boolean} True if the state is valid, false otherwise\n     */\n    _isValidState() {\n        var validState =\n            this.state.linkHref && (\n                this.state.linkHref !== this.state.initialLink.href\n            );\n\n        return validState;\n    }\n\n    /**\n     * Removes the embed in the editor element.\n     *\n     * @instance\n     * @memberof ButtonEmbedEdit\n     * @method _removeEmbed\n     * @protected\n     */\n    _removeEmbed() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var embedWrapper = this.state.element.getAscendant(function(element) {\n            return element.hasClass('cke_widget_wrapper');\n        });\n\n        embedWrapper.remove();\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default embedEdit\n * @memberof ButtonEmbedEdit\n * @property {String} key\n * @static\n */\nButtonEmbedEdit.key = 'embedEdit';\n\nexport default ButtonEmbedEdit;\n","import ButtonCommand from '../base/button-command.js';\nimport React from 'react';\n\n/**\n * The ButtonCommandListItem class is a UI class that renders a ButtonCommand that can be used inside\n * a list as an item, with a string representation of its behaviour.\n *\n * @class ButtonCommandListItem\n * @uses ButtonCommand\n */\nclass ButtonCommandListItem extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCommandListItem\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={this.props.description} className={this._getClassName()} onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex}>{this.props.description}</button>\n        );\n    }\n\n    /**\n     * Returns the class name of Widget.\n     *\n     * @instance\n     * @memberof ButtonCommandListItem\n     * @method _getClassName\n     * @protected\n     * @return {String} The class name of the Widget.\n     */\n    _getClassName() {\n        var className = 'ae-toolbar-element';\n\n        if (this.props.icon) {\n            className += ' ae-icon-' + this.props.icon;\n        }\n\n        return className;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default buttonCommandListItem\n * @memberof ButtonCommandListItem\n * @property {String} key\n * @static\n */\nButtonCommandListItem.key = 'buttonCommandListItem';\n\nexport default ButtonCommand(\n    ButtonCommandListItem\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * The ButtonCameraImage class takes photo from camera and inserts it to the content.\n *\n * @class ButtonCameraImage\n */\nclass ButtonCameraImage extends React.Component {\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * Focuses the take photo button.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        ReactDOM.findDOMNode(this.refs.buttonTakePhoto).focus();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (this._stream) {\n            if (this._stream.stop) {\n                this._stream.stop();\n            } else if (this._stream.getVideoTracks) {\n                this._stream.getVideoTracks().forEach(function(track) {\n                    track.stop();\n                });\n            }\n            this._stream = null;\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var getUserMedia = navigator.getUserMedia ||\n            navigator.webkitGetUserMedia ||\n            navigator.mozGetUserMedia ||\n            navigator.msGetUserMedia;\n\n        getUserMedia.call(navigator, {\n            video: true,\n            audio: false\n        }, this._handleStreamSuccess.bind(this), this._handleStreamError.bind(this));\n\n        return (\n            <div className=\"ae-camera\">\n                <video ref=\"videoContainer\">Video stream not available.</video>\n                <button className=\"ae-camera-shoot\" onClick={this.takePhoto.bind(this)} ref=\"buttonTakePhoto\">Take photo</button>\n                <canvas className=\"ae-camera-canvas\" ref=\"canvasContainer\"></canvas>\n            </div>\n        );\n    }\n\n    /**\n     * Takes photo from the video stream and inserts in into editor's content.\n     *\n     * @fires ButtonCameraImage#imageCameraAdd\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method takePhoto\n     */\n    takePhoto() {\n        var videoEl = ReactDOM.findDOMNode(this.refs.videoContainer);\n        var canvasEl = ReactDOM.findDOMNode(this.refs.canvasContainer);\n\n        var context = canvasEl.getContext('2d');\n\n        var height = this._videoHeight;\n        var width = this.props.videoWidth;\n\n        if (width && height) {\n            canvasEl.width = width;\n            canvasEl.height = height;\n\n            context.drawImage(videoEl, 0, 0, width, height);\n\n            var imgURL = canvasEl.toDataURL('image/png');\n\n            var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + imgURL + '\">');\n\n            var editor = this.props.editor.get('nativeEditor');\n\n            editor.insertElement(el);\n\n            this.props.cancelExclusive();\n\n            editor.fire('actionPerformed', this);\n\n            editor.fire('imageCameraAdd', el);\n        }\n    }\n\n    /**\n     * Displays error message in case of video stream capturing failure.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method _handleStreamError\n     * @param {Event} error The fired event in case of error.\n     * @protected\n     */\n    _handleStreamError(error) {\n        window.alert('An error occurred! ' + error);\n    }\n\n    /**\n     * Starts streaming video in the video element and sets width/height to the video\n     * and canvas elements.\n     *\n     * @instance\n     * @memberof ButtonCameraImage\n     * @method _handleStreamSuccess\n     * @param {Object} stream The video stream\n     * @protected\n     */\n    _handleStreamSuccess(stream) {\n        var videoEl = ReactDOM.findDOMNode(this.refs.videoContainer);\n        var canvasEl = ReactDOM.findDOMNode(this.refs.canvasContainer);\n\n        videoEl.addEventListener('canplay', function(event) {\n            var height = videoEl.videoHeight / (videoEl.videoWidth/this.props.videoWidth);\n\n            if (isNaN(height)) {\n                height = this.props.videoWidth / (4/3);\n            }\n\n            videoEl.setAttribute('width', this.props.videoWidth);\n            videoEl.setAttribute('height', height);\n            canvasEl.setAttribute('width', this.props.videoWidth);\n            canvasEl.setAttribute('height', height);\n\n            this._videoHeight = height;\n        }.bind(this), false);\n\n        this._stream = stream;\n\n        if (navigator.mozGetUserMedia) {\n            videoEl.mozSrcObject = stream;\n        } else {\n            videoEl.src = (window.URL || window.webkitURL).createObjectURL(stream);\n        }\n\n        videoEl.play();\n\n        ReactDOM.findDOMNode(this.refs.buttonTakePhoto).disabled = false;\n    }\n\n    /**\n     * Fired when an image is being taken from the camera and added as an element to the editor.\n     *\n     * @event ButtonCameraImage#imageCameraAdd\n     * @memberof ButtonCameraImage\n     * @param {CKEDITOR.dom.element} el The created img element in editor.\n     */\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default cameraImage\n * @memberof ButtonCameraImage\n * @property {String} key\n * @static\n */\nButtonCameraImage.key = 'cameraImage';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCameraImage\n * @method getDefaultProps\n */\nButtonCameraImage.defaultProps = {\n    videoWidth: 320\n};\n\nexport default ButtonCameraImage;\n","import ReactDOM from 'react-dom';\n\n// Default gutter value for toolbar positioning\nvar DEFAULT_GUTTER = {\n    left: 0,\n    top: 0\n};\n\n/**\n * Centers a Toolbar according to given rectangle\n *\n * @method centerToolbar\n * @param {Object} toolbar The toolbar to be centered\n * @param {Object} rect The rectangle according to which the Toolbar will be centered\n */\nvar centerToolbar = function(toolbar, rect) {\n    var toolbarNode = ReactDOM.findDOMNode(toolbar);\n\n    var halfNodeWidth = toolbarNode.offsetWidth / 2;\n    var scrollPosition = new CKEDITOR.dom.window(window).getScrollPosition();\n\n    var gutter = toolbar.props.gutter || DEFAULT_GUTTER;\n\n    var widgetXY = toolbar.getWidgetXYPoint(rect.left + rect.width / 2 - scrollPosition.x, rect.top + scrollPosition.y, CKEDITOR.SELECTION_BOTTOM_TO_TOP);\n\n    toolbar.moveToPoint([\n        widgetXY[0],\n        widgetXY[1]\n    ], [\n        rect.left + rect.width / 2 - halfNodeWidth - scrollPosition.x,\n        rect.top - toolbarNode.offsetHeight + scrollPosition.y - gutter.top\n    ]);\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method imageSelectionSetPosition\n * @param {Object} payload Payload, should contain the selection data for retrieving the\n * client rectangle of the selected image\n * @return {Boolean} True, in all cases\n */\nvar imageSelectionSetPosition = function(payload) {\n    centerToolbar(this, payload.selectionData.element.getClientRect());\n\n    return true;\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method tableSelectionSetPosition\n * @param {Object} payload Object, which contains the selection data for retrieving the\n * client rectangle of the selected table\n * @return {Boolean} True, in all cases\n */\nvar tableSelectionSetPosition = function(payload) {\n    var nativeEditor = payload.editor.get('nativeEditor');\n\n    var table = new CKEDITOR.Table(nativeEditor).getFromSelection();\n\n    centerToolbar(this, table.getClientRect());\n\n    return true;\n};\n\nconst SelectionSetPosition = {\n    image: imageSelectionSetPosition,\n    table: tableSelectionSetPosition\n};\n\nexport default SelectionSetPosition;","var tableSelectionGetArrowBoxClasses = function() {\n    return 'ae-arrow-box ae-arrow-box-bottom';\n};\n\nconst SelectionGetArrowBoxClasses = {\n    table: tableSelectionGetArrowBoxClasses\n};\n\nexport default SelectionGetArrowBoxClasses;","import SelectionGetArrowBoxClasses from './selection-arrowbox.js';\nimport SelectionSetPosition from './selection-position.js';\nimport SelectionTest from './selection-test.js';\n\nconst Selections = [{\n    name: 'embed',\n    buttons: ['embedRemove', 'embedEdit'],\n    test: SelectionTest.embed\n}, {\n    name: 'link',\n    buttons: ['linkEdit'],\n    test: SelectionTest.link\n}, {\n    name: 'image',\n    buttons: ['imageLeft', 'imageCenter', 'imageRight'],\n    setPosition: SelectionSetPosition.image,\n    test: SelectionTest.image\n}, {\n    name: 'text',\n    buttons: ['styles', 'bold', 'italic', 'underline', 'link', 'twitter'],\n    test: SelectionTest.text\n}, {\n    name: 'table',\n    buttons: ['tableHeading', 'tableRow', 'tableColumn', 'tableCell', 'tableRemove'],\n    getArrowBoxClasses: SelectionGetArrowBoxClasses.table,\n    setPosition: SelectionSetPosition.table,\n    test: SelectionTest.table\n}];\n\nexport default Selections;","import Lang from './lang.js';\n\n/**\n * Attribute implementation.\n *\n * @class Attribute\n * @constructor\n*/\nfunction Attribute(config) {\n    this.__config__ = config || {};\n    this.__ATTRS__ = {};\n}\n\nAttribute.prototype = {\n    constructor: Attribute,\n\n    /**\n     * Retrieves the value of an attribute.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method get\n     * @param {String} attr The attribute which value should be retrieved.\n     * @return {Any} The value of the attribute.\n     */\n    get: function(attr) {\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        if (!currentAttr) {\n            return;\n        }\n\n        if (!this._isInitialized(attr)) {\n            this._init(attr);\n        }\n\n        var curValue = this.__ATTRS__[attr];\n\n        if (currentAttr.getter) {\n            curValue = this._callStringOrFunction(currentAttr.getter, curValue);\n        }\n\n        return curValue;\n    },\n\n    /**\n     * Sets the value of an attribute.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method set\n     * @param {String} attr The attribute which value should be set.\n     * @param {Any} value The value which should be set to the attribute.\n     */\n    set: function(attr, value) {\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        if (!currentAttr) {\n            return;\n        }\n\n        if (!this._isInitialized(attr)) {\n            this._init(attr);\n        }\n\n        if (currentAttr.readOnly) {\n            return;\n        }\n\n        if (currentAttr.writeOnce && this._isInitialized(attr)) {\n            return;\n        }\n\n        if (currentAttr.validator && !this._callStringOrFunction(currentAttr.validator, value)) {\n            return;\n        }\n\n        if (currentAttr.setter) {\n            value = this._callStringOrFunction(currentAttr.setter, value);\n        }\n\n        this.__ATTRS__[attr] = value;\n    },\n\n    /**\n     * Calls the provided param as function with the supplied arguments.\n     * If param provided as string, a corresponding function in this object will\n     * be called. If provided param is a function, it will be directly called.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _callStringOrFunction\n     * @param  {Any|Array} args The arguments which will be provided to the called function\n     * @param  {String|Function} stringOrFunction The function which should be called\n     * @protected\n     * @return {Any} The returned value from the called function\n     */\n    _callStringOrFunction: function(stringOrFunction, args) {\n        var result = null;\n\n        if (!Lang.isArray(args)) {\n            args = [args];\n        }\n\n        if (Lang.isString(stringOrFunction) && Lang.isFunction(this[stringOrFunction])) {\n            result = this[stringOrFunction].apply(this, args);\n        } else if (Lang.isFunction(stringOrFunction)) {\n            result = stringOrFunction.apply(this, args);\n        }\n\n        return result;\n    },\n\n    /**\n     * Initializes an attribute. Sets its default value depending on the flags of the\n     * attribute and the passed configuration object to the constructor.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _init\n     * @param {String} attr The name of the attribute which have to be initialized.\n     * @protected\n     */\n    _init: function(attr) {\n        var value;\n\n        var currentAttr = this.constructor.ATTRS[attr];\n\n        // Check if there is default value or passed one via configuration object\n        var hasDefaultValue = Object.prototype.hasOwnProperty.call(currentAttr, 'value');\n        var hasPassedValueViaConfig = Object.prototype.hasOwnProperty.call(this.__config__, attr);\n\n        // If there is valueFn, set the value to be the result of invocation of this function\n        if (currentAttr.valueFn) {\n            value = this._callStringOrFunction(currentAttr.valueFn, value);\n\n            this.__ATTRS__[attr] = value;\n        }\n        // else if the attribute has readOnly flag, set the default value from the attribute,\n        // regardless if there is value or not\n        else if (currentAttr.readOnly) {\n            value = currentAttr.value;\n        }\n        // else if the attribute has writeOnce value, set it from the passed configuration or from the\n        // default value, in this order. Otherwise, return miserable.\n        else if (currentAttr.writeOnce) {\n            if (hasPassedValueViaConfig) {\n                value = this.__config__[attr];\n            } else if (hasDefaultValue) {\n                value = currentAttr.value;\n            } else {\n                return;\n            }\n        }\n        // These two cases below are easy - set the value to be from the passed config or\n        // from the default value, in this order.\n        else if (hasPassedValueViaConfig) {\n            value = this.__config__[attr];\n        } else if (hasDefaultValue) {\n            value = currentAttr.value;\n        }\n\n        // If there is validator, and user passed config object - check the returned value.\n        // If it is false, then set as initial value the default one.\n        // However, if there is no default value, just return.\n        if (currentAttr.validator && hasPassedValueViaConfig && !this._callStringOrFunction(currentAttr.validator, value)) {\n            if (hasDefaultValue) {\n                value = currentAttr.value;\n            } else {\n                return;\n            }\n        }\n\n        // If there is setter and user passed config object - pass the value thought the setter.\n        // The value might be one from defaultFn, default value or provided from the config.\n        if (currentAttr.setter && hasPassedValueViaConfig) {\n            value = this._callStringOrFunction(currentAttr.setter, value);\n        }\n\n        // Finally, set the value as initial value to the storage with values.\n        this.__ATTRS__[attr] = value;\n    },\n\n    /**\n     * Checks if an attribute is initialized. An attribute is considered as initialized\n     * when there is an own property with this name in the local collection of attribute values\n     * for the current instance.\n     *\n     * @instance\n     * @memberof Attribute\n     * @method _isInitialized\n     * @param {String} attr The attribute which should be checked if it is initialized.\n     * @protected\n     * @return {Boolean} Returns true if the attribute has been initialized, false otherwise.\n     */\n    _isInitialized: function(attr) {\n        return Object.prototype.hasOwnProperty.call(this.__ATTRS__, attr);\n    }\n};\n\nexport default Attribute;","import Lang from '../../oop/lang.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\n\n/**\n * The ToolbarStyles class hosts the buttons for styling a text selection.\n *\n * @class ToolbarStyles\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarStyles extends React.Component{\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method componentDidUpdate\n     * @param {Object} prevProps The previous state of the component's properties.\n     * @param {Object} prevState Component's previous state.\n     */\n    componentDidUpdate(prevProps, prevState) {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Renders the buttons for adding content or hides the toolbar\n     * if user interacted with a non-editable element.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method render\n     * @return {Object|null} The content which should be rendered.\n     */\n    render() {\n        var currentSelection = this._getCurrentSelection();\n\n        if (currentSelection) {\n            var getArrowBoxClassesFn = this._getSelectionFunction(currentSelection.getArrowBoxClasses);\n            var arrowBoxClasses;\n\n            if (getArrowBoxClassesFn) {\n                arrowBoxClasses = getArrowBoxClassesFn();\n            } else {\n                arrowBoxClasses = this.getArrowBoxClasses();\n            }\n\n            var cssClasses = 'ae-toolbar-styles ' + arrowBoxClasses;\n\n            var buttons = this.getToolbarButtons(\n                currentSelection.buttons,\n                {\n                    manualSelection: this.props.editorEvent ? this.props.editorEvent.data.manualSelection : null,\n                    selectionType: currentSelection.name\n                }\n            );\n\n            return (\n                <div aria-label={AlloyEditor.Strings.styles} className={cssClasses} data-tabindex={this.props.config.tabIndex || 0} onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} role=\"toolbar\" tabIndex=\"-1\">\n                    <div className=\"ae-container\">\n                        {buttons}\n                    </div>\n                </div>\n            );\n        }\n\n        return null;\n    }\n\n    /**\n     * Retrieve a function from String. It converts a fully qualified string into the mapped function.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _getSelectionFunction\n     * @param {Function|String} selectionFn A function, or a fully qualified string pointing to the desired one (e.g. 'AlloyEditor.SelectionTest.image').\n     * @protected\n     * @return {Function} The mapped function.\n     */\n    _getSelectionFunction(selectionFn) {\n        var selectionFunction;\n\n        if (Lang.isFunction(selectionFn)) {\n            selectionFunction = selectionFn;\n\n        } else if (Lang.isString(selectionFn)) {\n            var parts = selectionFn.split('.');\n            var currentMember = window;\n            var property = parts.shift();\n\n            while (property && Lang.isObject(currentMember) && Lang.isObject(currentMember[property])) {\n                currentMember = currentMember[property];\n                property = parts.shift();\n            }\n\n            if (Lang.isFunction(currentMember)) {\n                selectionFunction = currentMember;\n            }\n        }\n\n        return selectionFunction;\n    }\n\n    /**\n     * Analyzes the current editor selection and returns the selection configuration that matches.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _getCurrentSelection\n     * @protected\n     * @return {Object} The matched selection configuration.\n     */\n    _getCurrentSelection() {\n        var eventPayload = this.props.editorEvent ? this.props.editorEvent.data : null;\n        var selection;\n\n        if (eventPayload) {\n            this.props.config.selections.some(function(item) {\n                var testFn = this._getSelectionFunction(item.test);\n                var result;\n\n                if (testFn) {\n                    result = eventPayload.manualSelection === item.name || testFn({\n                        data: eventPayload,\n                        editor: this.props.editor\n                    });\n                }\n\n                if (result) {\n                    selection = item;\n                }\n\n                return result;\n            }, this);\n        }\n\n        return selection;\n    }\n\n    /**\n     * Calculates and sets the position of the toolbar.\n     *\n     * @instance\n     * @memberof ToolbarStyles\n     * @method _updatePosition\n     * @protected\n     */\n    _updatePosition() {\n        // If component is not mounted, there is nothing to do\n        if (!ReactDOM.findDOMNode(this)) {\n            return;\n        }\n\n        var currentSelection = this._getCurrentSelection();\n        var result;\n\n        // If current selection has a function called `setPosition`, call it\n        // and check the returned value. If false, fallback to the default positioning logic.\n        if (currentSelection) {\n            var setPositionFn = this._getSelectionFunction(currentSelection.setPosition);\n\n            if (setPositionFn) {\n                result = setPositionFn.call(this, {\n                    editor: this.props.editor,\n                    editorEvent: this.props.editorEvent,\n                    selectionData: this.props.selectionData\n                });\n            }\n        }\n\n        if (!result) {\n            this.updatePosition();\n            this.show();\n        }\n    }\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarStyles\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarStyles.defaultProps = {\n    circular: true,\n    descendants: '.ae-input, .ae-button:not([disabled]), .ae-toolbar-element',\n    keys: {\n        dismiss: [27],\n        next: [39, 40],\n        prev: [37, 38]\n    }\n};\n\n/**\n* The name which will be used as an alias of the button in the configuration.\n*\n* @default styles\n* @memberof ToolbarStyles\n* @property {String} key\n* @static\n*/\nToolbarStyles.key = 'styles';\n\nexport default WidgetArrowBox(\n    WidgetDropdown(\n    WidgetExclusive(\n    WidgetFocusManager(\n    WidgetPosition(\n    ToolbarButtons(\n        ToolbarStyles\n))))));","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\n\nvar POSITION_LEFT = 1;\nvar POSITION_RIGHT = 2;\n\n/**\n * The ToolbarAdd class provides functionality for adding content to the editor.\n *\n * @class ToolbarAdd\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarAdd extends React.Component{\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client (not on the server),\n     * immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        this._updatePosition();\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * This method is not called for the initial render.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method componentDidUpdate\n     * @param {Object} prevProps The previous state of the component's properties.\n     * @param {Object} prevState Component's previous state.\n     */\n    componentDidUpdate(prevProps, prevState) {\n        this._updatePosition();\n\n        // In case of exclusive rendering, focus the first descendant (button)\n        // so the user will be able to start interacting with the buttons immediately.\n        if (this.props.renderExclusive) {\n            this.focus();\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the buttons for adding content or hides the toolbar\n     * if user interacted with a non-editable element.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method render\n     * @return {Object|null} The content which should be rendered.\n     */\n    render() {\n        // Some operations such as `requestExclusive` may force editor to blur which will\n        // invalidate the `props.editorEvent` stored value, without causing a `props` change.\n        // For example, if the editor is empty, `ae_placeholder` plugin will remove\n        // the target from the DOM and will prevent `add` toolbar from rendering.\n        //\n        // It should be safe to assume that if you have been able to render the toolbar\n        // and request the exclusive mode, then rendering might be kept until the exclusive mode is left.\n        if (!this.state.itemExclusive &&\n                this.props.editorEvent &&\n                this.props.editorEvent.data.nativeEvent.target &&\n                !this.props.editorEvent.data.nativeEvent.target.isContentEditable) {\n            return null;\n        }\n\n        var buttons = this._getButtons();\n        var className = this._getToolbarClassName();\n\n        return (\n            <div aria-label={AlloyEditor.Strings.add} className={className} data-tabindex={this.props.config.tabIndex || 0} onFocus={this.focus.bind(this)} onKeyDown={this.handleKey.bind(this)} role=\"toolbar\" tabIndex=\"-1\">\n                <div className=\"ae-container\">\n                    {buttons}\n                </div>\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of buttons that will eventually render to HTML.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _getButtons\n     * @protected\n     * @return {Object} The buttons which have to be rendered.\n     */\n    _getButtons() {\n        var buttons;\n\n        if (this.props.renderExclusive) {\n            buttons = this.getToolbarButtons(this.props.config.buttons);\n        } else {\n            if (this.props.selectionData && this.props.selectionData.region) {\n                buttons = (\n                    <button aria-label={AlloyEditor.Strings.add} className=\"ae-button ae-button-add\" onClick={this.props.requestExclusive.bind(this, ToolbarAdd.key)} title={AlloyEditor.Strings.add}>\n                        <span className=\"ae-icon-add\"></span>\n                    </button>\n                );\n            }\n        }\n\n        return buttons;\n    }\n\n    /**\n     * Returns the class name of the toolbar in case of both exclusive and normal mode.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _getToolbarClassName\n     * @protected\n     * @return {String} The class name which have to be applied to the DOM element.\n     */\n    _getToolbarClassName() {\n        var cssClass = 'ae-toolbar-add';\n\n        if (this.props.renderExclusive) {\n            cssClass = 'ae-toolbar ' + this.getArrowBoxClasses();\n        }\n\n        return cssClass;\n    }\n\n    /**\n     * Calculates and sets the position of the toolbar in exclusive or normal mode.\n     *\n     * @instance\n     * @memberof ToolbarAdd\n     * @method _updatePosition\n     * @protected\n     */\n    _updatePosition() {\n        var region;\n\n        // If component is not mounted, there is nothing to do\n        if (!ReactDOM.findDOMNode(this)) {\n            return;\n        }\n\n        if (this.props.renderExclusive) {\n            this.updatePosition();\n            this.show();\n        } else {\n            if (this.props.selectionData) {\n                region = this.props.selectionData.region;\n            }\n\n            if (region) {\n                var domNode = ReactDOM.findDOMNode(this);\n\n                var domElement = new CKEDITOR.dom.element(domNode);\n\n                var startRect = region.startRect || region;\n\n                var nativeEditor = this.props.editor.get('nativeEditor');\n\n                var clientRect = nativeEditor.editable().getClientRect();\n\n                var offsetLeft;\n\n                var position = this.props.config.position || this.props.position;\n\n                if (position === POSITION_LEFT) {\n                    offsetLeft = clientRect.left - domNode.offsetWidth - this.props.gutterExclusive.left + 'px';\n                } else {\n                    offsetLeft = clientRect.right + this.props.gutterExclusive.left + 'px';\n                }\n\n                domNode.style.left = offsetLeft;\n\n                domNode.style.top = Math.floor((region.bottom + region.top) / 2) + 'px';\n\n                if (nativeEditor.element.getStyle('overflow') !== 'auto') {\n                    domNode.style.top = Math.floor(region.top - domNode.offsetHeight/2 + startRect.height/2) + 'px';\n                } else {\n                    domNode.style.top = Math.floor( nativeEditor.element.$.offsetTop + (startRect.height / 2) - (domNode.offsetHeight / 2) ) + 'px';\n                }\n\n                domNode.style.opacity = 1;\n\n                domElement.removeClass('ae-arrow-box');\n\n                this.cancelAnimation();\n            }\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default add\n * @memberof ToolbarAdd\n * @property {String} key\n * @static\n */\nToolbarAdd.key = 'add';\n\n/**\n * Defines the constant for positioning the Toolbar on left of the editable area.\n *\n * @default 1\n * @memberof ToolbarAdd\n * @property {String} left\n * @static\n */\nToolbarAdd.left = POSITION_LEFT;\n\n/**\n * Defines the constant for positioning the Toolbar on right of the editable area.\n *\n * @default 2\n * @memberof ToolbarAdd\n * @property {String} right\n * @static\n */\nToolbarAdd.right = POSITION_RIGHT;\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarAdd\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarAdd.defaultProps = {\n    circular: true,\n    descendants: '.ae-button',\n    gutterExclusive: {\n        left: 10,\n        top: 0\n    },\n    keys: {\n        dismiss: [27],\n        next: [39, 40],\n        prev: [37, 38]\n    },\n    position: POSITION_LEFT\n};\n\nexport default WidgetArrowBox(\n    WidgetDropdown(\n    WidgetExclusive(\n    WidgetFocusManager(\n    WidgetPosition(\n    ToolbarButtons(\n        ToolbarAdd\n))))));","import ToolbarAdd from './toolbar-add.jsx';\nimport ToolbarStyles from './toolbar-styles.jsx';\n\nexport default {\n    [ToolbarAdd.key]: ToolbarAdd,\n    [ToolbarStyles.key]: ToolbarStyles\n};","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnderline class provides functionality for underlying a text selection.\n *\n * @class ButtonUnderline\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnderline extends React.Component{\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonUnderline\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.underline} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-underline\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.underline}>\n                <span className=\"ae-icon-underline\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default underline\n * @memberof ButtonUnderline\n * @property {String} key\n * @static\n */\nButtonUnderline.key = 'underline';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonUnderline\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonUnderline.defaultProps = {\n    command: 'underline',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 85 /*U*/\n    },\n    style: 'coreStyles_underline'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonUnderline\n))));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnorderedlist class provides functionality for creating unordered lists in an editor.\n *\n * @class ButtonUnorderedlist\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnorderedlist extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonUnorderedlist\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.bulletedlist} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-ul\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.bulletedlist}>\n                <span className=\"ae-icon-bulleted-list\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default ul\n * @memberof ButtonUnorderedlist\n * @property {String} key\n * @static\n */\nButtonUnorderedlist.key = 'ul';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonUnorderedlist\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonUnorderedlist.defaultProps = {\n    command: 'bulletedlist',\n    style: {\n        element: 'ul'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonUnorderedlist\n)));","import ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonTwitter class provides functionality for creating a link which\n * allows people to tweet part of the content in the editor.\n *\n * @class ButtonTwitter\n * @uses ButtonStateClasses\n */\nclass ButtonTwitter extends React.Component {\n    /**\n     * Creates or removes the twitter link on the selection.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method handleClick\n     */\n    handleClick() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        var linkUtils = new CKEDITOR.Link(editor);\n\n        if (this.isActive()) {\n            linkUtils.remove(linkUtils.getFromSelection());\n        } else {\n            linkUtils.create(\n                this._getHref(),\n                {\n                    'class': 'ae-twitter-link',\n                    'target': '_blank'\n                }\n            );\n        }\n\n        editor.fire('actionPerformed', this);\n    }\n\n    /**\n     * Checks if the current selection is contained within a link that points to twitter.com/intent/tweet.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method isActive\n     * @return {Boolean} True if the selection is inside a twitter link, false otherwise.\n     */\n    isActive() {\n        var link = new CKEDITOR.Link(this.props.editor.get('nativeEditor')).getFromSelection();\n\n        return (link && (link.getAttribute('href').indexOf('twitter.com/intent/tweet') !== -1));\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.twitter} className={cssClass} data-type=\"button-twitter\" onClick={this.handleClick.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.twitter}>\n                <span className=\"ae-icon-twitter\"></span>\n            </button>\n        );\n    }\n\n    /**\n     * Generates the appropriate twitter url based on the selected text and the configuration\n     * options received via props.\n     *\n     * @instance\n     * @memberof ButtonTwitter\n     * @method _getHref\n     * @protected\n     * @return {String} A valid twitter url with the selected text and given configuration.\n     */\n    _getHref() {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n        var selectedText = nativeEditor.getSelection().getSelectedText();\n        var url = this.props.url;\n        var via = this.props.via;\n        var twitterHref = 'https://twitter.com/intent/tweet?text=' + selectedText;\n\n        if (url) {\n            twitterHref += '&url=' + url;\n        }\n\n        if (via) {\n            twitterHref += '&via=' + via;\n        }\n\n        return twitterHref;\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default twitter\n * @memberof ButtonTwitter\n * @property {String} key\n * @static\n */\nButtonTwitter.key = 'twitter';\n\nexport default ButtonStateClasses(\n    ButtonTwitter\n);","import ButtonTableEdit from './button-table-edit.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTable class provides functionality for creating and editing a table in a document. ButtonTable\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonTableEdit UI with all the table edition controls.\n *\n * @class ButtonTable\n */\nclass ButtonTable extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTable\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonTableEdit {...this.props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.table} className=\"ae-button\" data-type=\"button-table\" onClick={this.props.requestExclusive} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.table}>\n                    <span className=\"ae-icon-table\"></span>\n                </button>\n            );\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default table\n * @memberof ButtonTable\n * @property {String} key\n * @static\n */\nButtonTable.key = 'table';\n\nexport default ButtonTable;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableRow class provides functionality to work with table rows.\n *\n * @class ButtonTableRow\n */\nclass ButtonTableRow extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableRow\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableRow.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.row} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.row}>\n                    <span className=\"ae-icon-row\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableRow\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'rowInsertBefore',\n                label: AlloyEditor.Strings.rowInsertBefore\n            },\n            {\n                command: 'rowInsertAfter',\n                label: AlloyEditor.Strings.rowInsertAfter\n            },\n            {\n                command: 'rowDelete',\n                label: AlloyEditor.Strings.rowDelete\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRow\n * @memberof ButtonTableRow\n * @property {String} key\n * @static\n */\nButtonTableRow.key = 'tableRow';\n\nexport default ButtonTableRow;","import React from 'react';\n\n/**\n * The ButtonTableRemove class provides functionality for removing a table\n *\n * @class ButtonTableRemove\n */\nclass ButtonTableRemove extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableRemove\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.deleteTable} className=\"ae-button\" data-type=\"button-table-remove\" onClick={this._removeTable.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.deleteTable}>\n                <span className=\"ae-icon-bin\"></span>\n            </button>\n        );\n    }\n\n    /**\n     * Removes the table in the editor element.\n     *\n     * @instance\n     * @memberof ButtonTableRemove\n     * @method _removeTable\n     * @protected\n     */\n    _removeTable() {\n        var editor = this.props.editor.get('nativeEditor');\n        var tableUtils = new CKEDITOR.Table(editor);\n\n        tableUtils.remove();\n\n        editor.fire('actionPerformed', this);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRemove\n * @memberof ButtonTableRemove\n * @property {String} key\n * @static\n */\nButtonTableRemove.key = 'tableRemove';\n\nexport default ButtonTableRemove;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableHeading class provides functionality to work with table heading.\n *\n * @class ButtonTableHeading\n */\nclass ButtonTableHeading extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableHeading\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableHeading.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        var activeHeading = new CKEDITOR.Table(this.props.editor.get('nativeEditor')).getHeading();\n        var activeHeadingIntro = AlloyEditor.Strings.headers + ':';\n        var activeHeadingLabel = AlloyEditor.Strings['headers' + activeHeading];\n\n        return (\n            <div className=\"ae-container-dropdown-xl ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label=\"\" className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title=\"\">\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{activeHeadingIntro} <strong>{activeHeadingLabel}</strong></span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableHeading\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'tableHeadingNone',\n                label: AlloyEditor.Strings.headersNone\n            },\n            {\n                command: 'tableHeadingRow',\n                label: AlloyEditor.Strings.headersRow\n            },\n            {\n                command: 'tableHeadingColumn',\n                label: AlloyEditor.Strings.headersColumn\n            },\n            {\n                command: 'tableHeadingBoth',\n                label: AlloyEditor.Strings.headersBoth\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableRow\n * @memberof ButtonTableHeading\n * @property {String} key\n * @static\n */\nButtonTableHeading.key = 'tableHeading';\n\nexport default ButtonTableHeading;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableColumn class provides functionality to work with table columns.\n *\n * @class ButtonTableColumn\n */\nclass ButtonTableColumn extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableColumn\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList,\n            buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableColumn.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.column} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} role=\"listbox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.column}>\n                    <span className=\"ae-icon-column\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableColumn\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'columnInsertBefore',\n                label: AlloyEditor.Strings.columnInsertBefore\n            },\n            {\n                command: 'columnInsertAfter',\n                label: AlloyEditor.Strings.columnInsertAfter\n            },\n            {\n                command: 'columnDelete',\n                label: AlloyEditor.Strings.columnDelete\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableColumn\n * @memberof ButtonTableColumn\n * @property {String} key\n * @static\n */\nButtonTableColumn.key = 'tableColumn';\n\nexport default ButtonTableColumn;","import ButtonCommandsList from './button-commands-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableCell class provides functionality to work with table cells.\n *\n * @class ButtonTableCell\n */\nclass ButtonTableCell extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonTableCell\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var buttonCommandsList;\n        var buttonCommandsListId;\n\n        if (this.props.expanded) {\n            buttonCommandsListId = ButtonTableCell.key + 'List';\n            buttonCommandsList = <ButtonCommandsList commands={this._getCommands()} editor={this.props.editor} listId={buttonCommandsListId} onDismiss={this.props.toggleDropdown} />;\n        }\n\n        return (\n            <div className=\"ae-container ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.cell} aria-owns={buttonCommandsListId} className=\"ae-button\" onClick={this.props.toggleDropdown.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.cell}>\n                    <span className=\"ae-icon-cell\"></span>\n                </button>\n                {buttonCommandsList}\n            </div>\n        );\n    }\n\n    /**\n     * Returns a list of commands. If a list of commands was passed\n     * as property `commands`, it will take a precedence over the default ones.\n     *\n     * @instance\n     * @memberof ButtonTableCell\n     * @method _getCommands\n     * @protected\n     * @return {Array} The list of available commands.\n     */\n    _getCommands() {\n        return this.props.commands || [\n            {\n                command: 'cellInsertBefore',\n                label: AlloyEditor.Strings.cellInsertBefore\n            },\n            {\n                command: 'cellInsertAfter',\n                label: AlloyEditor.Strings.cellInsertAfter\n            },\n            {\n                command: 'cellDelete',\n                label: AlloyEditor.Strings.cellDelete\n            },\n            {\n                command: 'cellMerge',\n                label: AlloyEditor.Strings.cellMerge\n            },\n            {\n                command: 'cellMergeDown',\n                label: AlloyEditor.Strings.cellMergeDown\n            },\n            {\n                command: 'cellMergeRight',\n                label: AlloyEditor.Strings.cellMergeRight\n            },\n            {\n                command: 'cellHorizontalSplit',\n                label: AlloyEditor.Strings.cellSplitHorizontal\n            },\n            {\n                command: 'cellVerticalSplit',\n                label: AlloyEditor.Strings.cellSplitVertical\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default tableCell\n * @memberof ButtonTableCell\n * @property {String} key\n * @static\n */\nButtonTableCell.key = 'tableCell';\n\nexport default ButtonTableCell;","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSuperscript class provides functionality for applying superscript style to a text selection.\n *\n * @class ButtonSuperscript\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSuperscript extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonSuperscript\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.superscript} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-superscript\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.superscript}>\n                <span className=\"ae-icon-superscript\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default superscript\n * @memberof ButtonSuperscript\n * @property {String} key\n * @static\n */\nButtonSuperscript.key = 'superscript';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonSuperscript\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonSuperscript.defaultProps = {\n    command: 'superscript',\n    style: 'coreStyles_superscript'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonSuperscript\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSubscript class provides functionality for applying subscript style to a text selection.\n *\n * @class ButtonSubscript\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSubscript extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonSubscript\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.subscript} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-subscript\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.subscript}>\n                <span className=\"ae-icon-subscript\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default subscript\n * @memberof ButtonSubscript\n * @property {String} key\n * @static\n */\nButtonSubscript.key = 'subscript';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonSubscript\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonSubscript.defaultProps = {\n    command: 'subscript',\n    style: 'coreStyles_subscript'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonSubscript\n)));","import ButtonStylesList from './button-styles-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonStyles class provides functionality for styling a selection with a list of\n * configurable and customizable styles. The allowed styles follow CKEDITOR.Style configuration\n * (http://docs.ckeditor.com/#!/api/CKEDITOR.style)\n *\n * @class ButtonStyles\n */\nclass ButtonStyles extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var activeStyle = AlloyEditor.Strings.normal;\n\n        var styles = this._getStyles();\n\n        styles.forEach(function(item) {\n            if (this._checkActive(item.style)) {\n                activeStyle = item.name;\n            }\n        }.bind(this));\n\n        var buttonStylesList;\n\n        if (this.props.expanded) {\n            buttonStylesList = <ButtonStylesList activeStyle={activeStyle} editor={this.props.editor} onDismiss={this.props.toggleDropdown} showRemoveStylesItem={this.props.showRemoveStylesItem} styles={styles} />;\n        }\n\n        return (\n            <div className=\"ae-container-dropdown ae-has-dropdown\">\n                <button aria-expanded={this.props.expanded} aria-label={AlloyEditor.Strings.styles + ' ' + activeStyle} className=\"ae-toolbar-element\" onClick={this.props.toggleDropdown.bind(this)} role=\"combobox\" tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.styles + ' ' + activeStyle}>\n                    <div className=\"ae-container\">\n                        <span className=\"ae-container-dropdown-selected-item\">{activeStyle}</span>\n                        <span className=\"ae-icon-arrow\"></span>\n                    </div>\n                </button>\n                {buttonStylesList}\n            </div>\n        );\n    }\n\n    /**\n     * Checks if the given style definition is applied to the current selection in the editor.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method _checkActive\n     * @param {Object} styleConfig Style definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n     * @protected\n     * @return {Boolean} Returns true if the style is applied to the selection, false otherwise.\n     */\n    _checkActive(styleConfig) {\n        var nativeEditor = this.props.editor.get('nativeEditor');\n\n        // Styles with wildcard element (*) won't be considered active by CKEditor. Defaulting\n        // to a 'span' element works for most of those cases with no defined element.\n        styleConfig = CKEDITOR.tools.merge({element: 'span'}, styleConfig);\n\n        var style = new CKEDITOR.style(styleConfig);\n\n        return style.checkActive(nativeEditor.elementPath(), nativeEditor);\n    }\n\n    /**\n     * Returns an array of styles. Each style consists from two properties:\n     * - name - the style name, for example \"h1\"\n     * - style - an object with one property, called `element` which value\n     * represents the style which have to be applied to the element.\n     *\n     * @instance\n     * @memberof ButtonStyles\n     * @method _getStyles\n     * @protected\n     * @return {Array<object>} An array of objects containing the styles.\n     */\n    _getStyles() {\n        return this.props.styles || [\n            {\n                name: AlloyEditor.Strings.h1,\n                style: {\n                    element: 'h1'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.h2,\n                style: {\n                    element: 'h2'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.formatted,\n                style: {\n                    element: 'pre'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.cite,\n                style: {\n                    element: 'cite'\n                }\n            },\n            {\n                name: AlloyEditor.Strings.code,\n                style: {\n                    element: 'code'\n                }\n            }\n        ];\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default styles\n * @memberof ButtonStyles\n * @property {String} key\n * @static\n */\nButtonStyles.key = 'styles';\n\nexport default ButtonStyles;","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStrike class styles a selection with strike style.\n *\n * @class ButtonStrike\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonStrike extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     * @instance\n     * @memberof ButtonStrike\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.strike} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-strike\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.strike}>\n                <span className=\"ae-icon-strike\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default strike\n * @memberof ButtonStrike\n * @property {String} key\n * @static\n */\nButtonStrike.key = 'strike';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonStrike\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonStrike.defaultProps = {\n    command: 'strike',\n    style: 'coreStyles_strike'\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonStrike\n)));","import ButtonCommand from '../base/button-command.js';\nimport React from 'react';\n\n/**\n * The ButtonRemoveFormat class removes style formatting.\n *\n * @class ButtonRemoveFormat\n * @uses ButtonCommand\n */\nclass ButtonRemoveFormat extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonRemoveFormat\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.removeformat} className='ae-button' data-type=\"button-removeformat\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.removeformat}>\n                <span className=\"ae-icon-removeformat\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default removeFormat\n * @memberof ButtonRemoveFormat\n * @property {String} key\n * @static\n */\nButtonRemoveFormat.key = 'removeFormat';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonRemoveFormat\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonRemoveFormat.defaultProps = {\n    command: 'removeFormat'\n};\n\nexport default ButtonCommand(\n    ButtonRemoveFormat\n);","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonQuote class wraps a selection in `blockquote` element.\n *\n * @class ButtonQuote\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonQuote extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonQuote\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.quote} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-quote\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.quote}>\n                <span className=\"ae-icon-quote\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default quote\n * @memberof ButtonQuote\n * @property {String} key\n * @static\n */\nButtonQuote.key = 'quote';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonQuote\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonQuote.defaultProps = {\n    command: 'blockquote',\n    style: {\n        element: 'blockquote'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonQuote\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphJustify class provides functionality for justfying a paragraph.\n *\n * @class ButtonParagraphJustify\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphJustify extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphJustify\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignJustify} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-justify\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignJustify}>\n                <span className=\"ae-icon-align-justified\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphJustify\n * @memberof ButtonParagraphJustify\n * @property {String} key\n * @static\n */\nButtonParagraphJustify.key = 'paragraphJustify';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphJustify\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphJustify.defaultProps = {\n    command: 'justifyblock'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphJustify\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphCenter class provides functionality for centering a paragraph.\n *\n * @class ButtonParagraphCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphCenter extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphCenter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignCenter} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-center\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignCenter}>\n                <span className=\"ae-icon-align-center\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphCenter\n * @memberof ButtonParagraphCenter\n * @property {String} key\n * @static\n */\nButtonParagraphCenter.key = 'paragraphCenter';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphCenter\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphCenter.defaultProps = {\n    command: 'justifycenter'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphCenter\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n/**\n * The ButtonParagraphAlignRight class provides functionality for aligning a paragraph on right.\n *\n * @class ButtonParagraphAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignRight extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphAlignRight\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignRight} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-align-right\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignRight}>\n                <span className=\"ae-icon-align-right\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphRight\n * @memberof ButtonParagraphAlignRight\n * @property {String} key\n * @static\n */\nButtonParagraphAlignRight.key = 'paragraphRight';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphAlignRight\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphAlignRight.defaultProps = {\n    command: 'justifyright'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphAlignRight\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n/**\n * The ButtonParagraphAlignLeft class provides functionality for aligning a paragraph on left.\n *\n * @class ButtonParagraphAlignLeft\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignLeft extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonParagraphAlignLeft\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignLeft} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-paragraph-align-left\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignLeft}>\n                <span className=\"ae-icon-align-left\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default paragraphLeft\n * @memberof ButtonParagraphAlignLeft\n * @property {String} key\n * @static\n */\nButtonParagraphAlignLeft.key = 'paragraphLeft';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonParagraphAlignLeft\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonParagraphAlignLeft.defaultProps = {\n    command: 'justifyleft'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonParagraphAlignLeft\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonOutdentBlock class provides functionality for outdenting blocks.\n *\n * @class ButtonOutdentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonOutdentBlock extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonOutdentBlock\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.outdent} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-outdent-block\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.outdent}>\n                <span className=\"ae-icon-outdent-block\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default indentBlock\n * @memberof ButtonOutdentBlock\n * @property {String} key\n * @static\n */\nButtonOutdentBlock.key = 'outdentBlock';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonOutdentBlock\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonOutdentBlock.defaultProps = {\n    command: 'outdent'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonOutdentBlock\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonOrderedList class provides functionality for creating ordered lists in an editor.\n *\n * @class ButtonOrderedList\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonOrderedList extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonOrderedList\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.numberedlist} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-ol\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.numberedlist}>\n                <span className=\"ae-icon-numbered-list\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default ol\n * @memberof ButtonOrderedList\n * @property {String} key\n * @static\n */\nButtonOrderedList.key = 'ol';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonOrderedList\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonOrderedList.defaultProps = {\n    command: 'numberedlist',\n    style: {\n        element: 'ol'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonOrderedList\n)));","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonLink class provides functionality for creating and editing a link in a document. ButtonLink\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonLinkEdit UI with all the link edition controls.\n *\n * @class ButtonLink\n * @uses ButtonCfgProps\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n */\nclass ButtonLink extends React.Component {\n    /**\n     * Checks if the current selection is contained within a link.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method isActive\n     * @return {Boolean} True if the selection is inside a link, false otherwise.\n     */\n    isActive() {\n        return (new CKEDITOR.Link(this.props.editor.get('nativeEditor')).getFromSelection() !== null);\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        if (this.props.renderExclusive) {\n            var props = this.mergeButtonCfgProps();\n\n            return (\n                <ButtonLinkEdit {...props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.link} className={cssClass} data-type=\"button-link\" onClick={this._requestExclusive.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.link}>\n                    <span className=\"ae-icon-link\"></span>\n                </button>\n            );\n        }\n    }\n\n    /**\n     * Requests the link button to be rendered in exclusive mode to allow the creation of a link.\n     *\n     * @instance\n     * @memberof ButtonLink\n     * @method _requestExclusive\n     * @protected\n     */\n    _requestExclusive() {\n        this.props.requestExclusive(ButtonLink.key);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default link\n * @memberof ButtonLink\n * @property {String} key\n * @static\n */\nButtonLink.key = 'link';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonLink\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonLink.defaultProps = {\n    keystroke: {\n        fn: '_requestExclusive',\n        keys: CKEDITOR.CTRL + 76 /*L*/\n    }\n};\n\nexport default ButtonCfgProps(\n    ButtonKeystroke(\n    ButtonStateClasses(\n        ButtonLink\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonItalic class provides functionality for styling an selection with italic (em) style.\n *\n * @class ButtonItalic\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonItalic extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonItalic\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.italic} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-italic\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.italic}>\n                <span className=\"ae-icon-italic\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default italic\n * @memberof ButtonItalic\n * @property {String} key\n * @static\n */\nButtonItalic.key = 'italic';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonItalic\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonItalic.defaultProps = {\n    command: 'italic',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 73 /*I*/\n    },\n    style: 'coreStyles_italic'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonItalic\n))));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonIndentBlock class provides functionality for indenting the selected blocks.\n *\n * @class ButtonIndentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonIndentBlock extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonIndentBlock\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.indent} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-indent-block\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.indent}>\n                <span className=\"ae-icon-indent-block\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default indentBlock\n * @memberof ButtonIndentBlock\n * @property {String} key\n * @static\n */\nButtonIndentBlock.key = 'indentBlock';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonIndentBlock\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonIndentBlock.defaultProps = {\n    command: 'indent'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonIndentBlock\n)));","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * The ButtonImage class inserts an image to the content.\n *\n * @class ButtonImage\n */\nclass ButtonImage extends React.Component {\n    constructor(props) {\n        super(props);\n        this.fileInput = React.createRef();\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImage\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var inputSyle = {display: 'none'};\n\n        return (\n            <div>\n                <button aria-label={AlloyEditor.Strings.image} className=\"ae-button\" data-type=\"button-image\" onClick={this.handleClick.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.image}>\n                    <span className=\"ae-icon-image\"></span>\n                </button>\n\n                <input accept=\"image/*\" onChange={this._onInputChange.bind(this)} ref={this.fileInput} style={inputSyle} type=\"file\"/>\n            </div>\n        );\n    }\n\n    /**\n     * Simulates click on the input element. This will open browser's native file open dialog.\n     *\n     * @instance\n     * @memberof ButtonImage\n     * @method handleClick\n     * @param {SyntheticEvent} event The received click event on the button.\n     */\n    handleClick() {\n        this.fileInput.current.click();\n    }\n\n    /**\n     * On input change, reads the chosen file and fires an event `beforeImageAdd` with the image which will be added\n     * to the content. The image file will be passed in the `imageFiles` property.\n     * If any of the listeners returns `false` or cancels the event, the image won't be added to the content.\n     * Otherwise, an event `imageAdd` will be fired with the inserted element into the editable area.\n     * The passed params will be:\n     * - `el` - the created img element\n     * - `file` - the original image file from the input element\n     *\n     * @fires ButtonImage#beforeImageAdd\n     * @fires ButtonImage#imageAdd\n     * @instance\n     * @memberof ButtonImage\n     * @method _onInputChange\n     * @protected\n     */\n    _onInputChange() {\n        var inputEl = this.fileInput.current;\n\n        // On IE11 the function might be called with an empty array of\n        // files. In such a case, no actions will be taken.\n        if (!inputEl.files.length) {\n            return;\n        }\n\n        var reader = new FileReader();\n        var file = inputEl.files[0];\n\n        reader.onload = function(event) {\n            var editor = this.props.editor.get('nativeEditor');\n\n            var result = editor.fire('beforeImageAdd', {\n                imageFiles: file\n            });\n\n            if (!!result) {\n                var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + event.target.result + '\">');\n\n                editor.insertElement(el);\n\n                editor.fire('actionPerformed', this);\n\n                var imageData = {\n                    el: el,\n                    file: file\n                };\n\n\n                editor.fire('imageAdd', imageData);\n            }\n        }.bind(this);\n\n        reader.readAsDataURL(file);\n\n        inputEl.value = '';\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default image\n * @memberof ButtonImage\n * @property {String} key\n * @static\n */\nButtonImage.key = 'image';\n\nexport default ButtonImage;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignRight class provides functionality for aligning an image on right.\n *\n * @class ButtonImageAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignRight extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignRight\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignRight} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-right\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignRight}>\n                <span className=\"ae-icon-align-right\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageRight\n * @memberof ButtonImageAlignRight\n * @property {String} key\n * @static\n */\nButtonImageAlignRight.key = 'imageRight';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignRight\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignRight.defaultProps = {\n    command: 'justifyright'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignRight\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignLeft class provides functionality for aligning an image on left.\n *\n * @class ButtonImageAlignLeft\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignLeft extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignLeft\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignLeft} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-left\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignLeft}>\n                <span className=\"ae-icon-align-left\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageLeft\n * @memberof ButtonImageAlignLeft\n * @property {String} key\n * @static\n */\nButtonImageAlignLeft.key = 'imageLeft';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignLeft\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignLeft.defaultProps = {\n    command: 'justifyleft'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignLeft\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignCenter class provides functionality for aligning an image in the center.\n *\n * @class ButtonImageAlignCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignCenter extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonImageAlignCenter\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.alignCenter} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-image-align-center\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.alignCenter}>\n                <span className=\"ae-icon-align-center\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default imageCenter\n * @memberof ButtonImageAlignCenter\n * @property {String} key\n * @static\n */\nButtonImageAlignCenter.key = 'imageCenter';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonImageAlignCenter\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonImageAlignCenter.defaultProps = {\n    command: 'justifycenter'\n};\n\nexport default ButtonCommand(\n    ButtonCommandActive(\n    ButtonStateClasses(\n        ButtonImageAlignCenter\n)));","import ButtonCommand from '../base/button-command.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonHline class provides inserts horizontal line.\n *\n * @class ButtonHline\n * @uses ButtonCommand\n * @uses ButtonStyle\n */\nclass ButtonHline extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonHline\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        return (\n            <button aria-label={AlloyEditor.Strings.horizontalrule} className=\"ae-button\" data-type=\"button-hline\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.horizontalrule}>\n                <span className=\"ae-icon-separator\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default hline\n * @memberof ButtonHline\n * @property {String} key\n * @static\n */\nButtonHline.key = 'hline';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonHline\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonHline.defaultProps = {\n    command: 'horizontalrule',\n    style: {\n        element: 'hr'\n    }\n};\n\nexport default ButtonCommand(\n    ButtonStyle(\n        ButtonHline\n));","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonH2 class provides wraps a selection in `h2` element.\n *\n * @class ButtonH2\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH2 extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonH2\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.h2} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-h2\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.h2}>\n                <span className=\"ae-icon-h2\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default h2\n * @memberof ButtonH2\n * @property {String} key\n * @static\n */\nButtonH2.key = 'h2';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonH2\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonH2.defaultProps = {\n    style: {\n        element: 'h2'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonH2\n)));","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonH1 class provides wraps a selection in `h1` element.\n *\n * @class ButtonH1\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH1 extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonH1\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.h1} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-h1\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.h1}>\n                <span className=\"ae-icon-h1\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default h1\n * @memberof ButtonH1\n * @property {String} key\n * @static\n */\nButtonH1.key = 'h1';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonH1\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonH1.defaultProps = {\n    style: {\n        element: 'h1'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonH1\n)));","import ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport React from 'react';\n\n/**\n * The ButtonEmbed class provides functionality for creating and editing an embed link in a document.\n * ButtonEmbed renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonEmbedEdit UI with all the link edition controls.\n *\n * @class ButtonEmbed\n * @uses ButtonKeystroke\n */\nclass ButtonEmbed extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonEmbed\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonEmbedEdit {...this.props} />\n            );\n        } else {\n            return (\n                <button aria-label={AlloyEditor.Strings.link} className=\"ae-button\" data-type=\"button-embed\" onClick={this._requestExclusive.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.link}>\n                    <span className=\"ae-icon-add\"></span>\n                </button>\n            );\n        }\n    }\n\n    /**\n     * Requests the link button to be rendered in exclusive mode to allow the embedding of a link.\n     *\n     * @instance\n     * @memberof ButtonEmbed\n     * @method _requestExclusive\n     * @protected\n     */\n    _requestExclusive() {\n        this.props.requestExclusive(ButtonEmbed.key);\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default embed\n * @memberof ButtonEmbed\n * @property {String} key\n * @static\n */\nButtonEmbed .key = 'embed';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonEmbed\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonEmbed.defaultProps = {\n    keystroke: {\n        fn: '_requestExclusive',\n        keys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /*L*/\n    }\n};\n\nexport default ButtonKeystroke(\n    ButtonEmbed\n);","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonCode class provides wraps a selection in `pre` element.\n *\n * @class ButtonCode\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonCode extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCode\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.code} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-code\" onClick={this.applyStyle.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.code}>\n                <span className=\"ae-icon-code\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default code\n * @memberof ButtonCode\n * @property {String} key\n * @static\n */\nButtonCode.key = 'code';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonCode\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonCode.defaultProps = {\n    style: {\n        element: 'pre'\n    }\n};\n\nexport default ButtonActionStyle(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonCode\n)));","import ButtonCameraImage from './button-camera-image.jsx';\nimport React from 'react';\n\n/**\n * The ButtonCamera class renders in two different ways:\n *\n * - Normal: Just a button that allows to switch to the edition mode.\n * - Exclusive: Renders ButtonCameraImage in order to take photo from the camera.\n *\n * @class ButtonCamera\n */\nclass ButtonCamera extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonCamera\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.props.renderExclusive) {\n            return (\n                <ButtonCameraImage {...this.props} />\n            );\n        } else {\n            var disabled = !(navigator.getUserMedia ||\n                (navigator.webkitGetUserMedia && location.protocol === 'https') ||\n                navigator.mozGetUserMedia ||\n                navigator.msGetUserMedia);\n\n            var label = disabled ? AlloyEditor.Strings.cameraDisabled : AlloyEditor.Strings.camera;\n\n            return (\n                <button aria-label={label} className=\"ae-button\" data-type=\"button-image-camera\" disabled={disabled} onClick={this.props.requestExclusive.bind(ButtonCamera.key)} tabIndex={this.props.tabIndex} title={label}>\n                    <span className=\"ae-icon-camera\"></span>\n                </button>\n            );\n        }\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default camera\n * @memberof ButtonCamera\n * @property {String} key\n * @static\n */\nButtonCamera.key = 'camera';\n\nexport default ButtonCamera;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonBold class provides functionality for styling an selection with strong (bold) style.\n *\n * @class ButtonBold\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonBold extends React.Component {\n    /**\n     * Lifecycle. Renders the UI of the button.\n     *\n     * @instance\n     * @memberof ButtonBold\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        var cssClass = 'ae-button ' + this.getStateClasses();\n\n        return (\n            <button aria-label={AlloyEditor.Strings.bold} aria-pressed={cssClass.indexOf('pressed') !== -1} className={cssClass} data-type=\"button-bold\" onClick={this.execCommand.bind(this)} tabIndex={this.props.tabIndex} title={AlloyEditor.Strings.bold}>\n                <span className=\"ae-icon-bold\"></span>\n            </button>\n        );\n    }\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default bold\n * @memberof ButtonBold\n * @property {String} key\n * @static\n */\nButtonBold.key = 'bold';\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ButtonBold\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nButtonBold.defaultProps = {\n    command: 'bold',\n    keystroke: {\n        fn: 'execCommand',\n        keys: CKEDITOR.CTRL + 66 /*B*/\n    },\n    style: 'coreStyles_bold'\n};\n\nexport default ButtonCommand(\n    ButtonKeystroke(\n    ButtonStateClasses(\n    ButtonStyle(\n        ButtonBold\n))));\n","import ButtonBold from './button-bold.jsx';\nimport ButtonCameraImage from './button-camera-image.jsx';\nimport ButtonCamera from './button-camera.jsx';\nimport ButtonCode from './button-code.jsx';\nimport ButtonCommandListItem from './button-command-list-item.jsx';\nimport ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonDropdown from './button-dropdown.jsx';\nimport ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonEmbed from './button-embed.jsx';\nimport ButtonH1 from './button-h1.jsx';\nimport ButtonH2 from './button-h2.jsx';\nimport ButtonHline from './button-hline.jsx';\nimport ButtonImageAlignCenter from './button-image-align-center.jsx';\nimport ButtonImageAlignLeft from './button-image-align-left.jsx';\nimport ButtonImageAlignRight from './button-image-align-right.jsx';\nimport ButtonImage from './button-image.jsx';\nimport ButtonIndentBlock from './button-indent-block.jsx';\nimport ButtonItalic from './button-italic.jsx';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport ButtonLink from './button-link.jsx';\nimport ButtonOl from './button-ol.jsx';\nimport ButtonOutdentBlock from './button-outdent-block.jsx';\nimport ButtonParagraphAlignLeft from './button-paragraph-align-left.jsx';\nimport ButtonParagraphAlignRight from './button-paragraph-align-right.jsx';\nimport ButtonParagraphCenter from './button-paragraph-center.jsx';\nimport ButtonParagraphJustify from './button-paragraph-justify.jsx';\nimport ButtonQuote from './button-quote.jsx';\nimport ButtonRemoveFormat from './button-remove-format.jsx';\nimport ButtonStrike from './button-strike.jsx';\nimport ButtonStylesListHeader from './button-styles-list-header.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport ButtonStyles from './button-styles.jsx';\nimport ButtonSubscript from './button-subscript.jsx';\nimport ButtonSuperscript from './button-superscript.jsx';\nimport ButtonTableCell from './button-table-cell.jsx';\nimport ButtonTableColumn from './button-table-column.jsx';\nimport ButtonTableEdit from './button-table-edit.jsx';\nimport ButtonTableHeading from './button-table-heading.jsx';\nimport ButtonTableRemove from './button-table-remove.jsx';\nimport ButtonTableRow from './button-table-row.jsx';\nimport ButtonTable from './button-table.jsx';\nimport ButtonTargetList from './button-target-list.jsx';\nimport ButtonTwitter from './button-twitter.jsx';\nimport ButtonUl from './button-ul.jsx';\nimport ButtonUnderline from './button-underline.jsx';\n\nexport default {\n    [ButtonBold.key]: ButtonBold,\n    [ButtonCameraImage.key]: ButtonCameraImage,\n    [ButtonCamera.key]: ButtonCamera,\n    [ButtonCode.key]: ButtonCode,\n    [ButtonCommandListItem.key]: ButtonCommandListItem,\n    [ButtonCommandsList.key]: ButtonCommandsList,\n    [ButtonDropdown.key]: ButtonDropdown,\n    [ButtonEmbedEdit.key]: ButtonEmbedEdit,\n    [ButtonEmbed.key]: ButtonEmbed,\n    [ButtonH1.key]: ButtonH1,\n    [ButtonH2.key]: ButtonH2,\n    [ButtonHline.key]: ButtonHline,\n    [ButtonImageAlignCenter.key]: ButtonImageAlignCenter,\n    [ButtonImageAlignLeft.key]: ButtonImageAlignLeft,\n    [ButtonImageAlignRight.key]: ButtonImageAlignRight,\n    [ButtonImage.key]: ButtonImage,\n    [ButtonIndentBlock.key]: ButtonIndentBlock,\n    [ButtonItalic.key]: ButtonItalic,\n    [ButtonLinkAutocompleteList.key]: ButtonLinkAutocompleteList,\n    [ButtonLinkEdit.key]: ButtonLinkEdit,\n    [ButtonLinkTargetEdit.key]: ButtonLinkTargetEdit,\n    [ButtonLink.key]: ButtonLink,\n    [ButtonOl.key]: ButtonOl,\n    [ButtonOutdentBlock.key]: ButtonOutdentBlock,\n    [ButtonParagraphAlignLeft.key]: ButtonParagraphAlignLeft,\n    [ButtonParagraphAlignRight.key]: ButtonParagraphAlignRight,\n    [ButtonParagraphCenter.key]: ButtonParagraphCenter,\n    [ButtonParagraphJustify.key]: ButtonParagraphJustify,\n    [ButtonQuote.key]: ButtonQuote,\n    [ButtonRemoveFormat.key]: ButtonRemoveFormat,\n    [ButtonStrike.key]: ButtonStrike,\n    [ButtonStylesListHeader.key]: ButtonStylesListHeader,\n    [ButtonStylesListItemRemove.key]: ButtonStylesListItemRemove,\n    [ButtonStylesListItem.key]: ButtonStylesListItem,\n    [ButtonStylesList.key]: ButtonStylesList,\n    [ButtonStyles.key]: ButtonStyles,\n    [ButtonSubscript.key]: ButtonSubscript,\n    [ButtonSuperscript.key]: ButtonSuperscript,\n    [ButtonTableCell.key]: ButtonTableCell,\n    [ButtonTableColumn.key]: ButtonTableColumn,\n    [ButtonTableEdit.key]: ButtonTableEdit,\n    [ButtonTableHeading.key]: ButtonTableHeading,\n    [ButtonTableRemove.key]: ButtonTableRemove,\n    [ButtonTableRow.key]: ButtonTableRow,\n    [ButtonTable.key]: ButtonTable,\n    [ButtonTargetList.key]: ButtonTargetList,\n    [ButtonTwitter.key]: ButtonTwitter,\n    [ButtonUl.key]: ButtonUl,\n    [ButtonUnderline.key]: ButtonUnderline\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetExclusive from './base/widget-exclusive.js';\nimport WidgetFocusManager from './base/widget-focus-manager.js';\n\n/**\n * The main editor UI class manages a hierarchy of widgets (toolbars and buttons).\n *\n * @class UI\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n */\nclass UI extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            hidden: false\n        };\n    }\n\n    /**\n     * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentDidMount\n     */\n    componentDidMount() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.on('editorInteraction', this._onEditorInteraction, this);\n        editor.on('actionPerformed', this._onActionPerformed, this);\n        editor.on('key', this._onEditorKey, this);\n\n        // Set up events for hiding the UI when user stops interacting with the editor.\n        // This may happen when he just clicks outside of the editor. However,\n        // this does not include a situation when he clicks on some button, part of\n        // editor's UI.\n\n        // It is not easy to debounce _setUIHidden on mousedown, because if we\n        // debounce it, when the handler is being invoked, the target might be no more part\n        // of the editor's UI - onActionPerformed causes re-render.\n        this._mousedownListener = function (event) {\n            this._setUIHidden(event.target);\n        }.bind(this);\n\n        this._keyDownListener = CKEDITOR.tools.debounce(function(event) {\n            this._setUIHidden(document.activeElement);\n        }, this.props.eventsDelay, this);\n\n        document.addEventListener('mousedown', this._mousedownListener);\n        document.addEventListener('keydown', this._keyDownListener);\n    }\n\n    /**\n     * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n     * Fires `ariaUpdate` event passing ARIA related messages.\n     * Fires `editorUpdate` event passing the previous and current properties and state.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentDidUpdate\n     */\n    componentDidUpdate (prevProps, prevState) {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        var editor = this.props.editor.get('nativeEditor');\n\n        if (domNode) {\n            editor.fire('ariaUpdate', {\n                message: this._getAvailableToolbarsMessage(domNode)\n            });\n        }\n\n        editor.fire('editorUpdate', {\n            prevProps: prevProps,\n            prevState: prevState,\n            props: this.props,\n            state: this.state\n        });\n    }\n\n    _getAriaUpdateTemplate(ariaUpdate) {\n        if (!this._ariaUpdateTemplates) {\n            this._ariaUpdateTemplates = {};\n        }\n\n        if (!this._ariaUpdateTemplates[ariaUpdate]) {\n            this._ariaUpdateTemplates[ariaUpdate] = new CKEDITOR.template(this._getAriaUpdates()[ariaUpdate]);\n        }\n\n        return this._ariaUpdateTemplates[ariaUpdate];\n    }\n\n    /**\n     * Returns the templates for ARIA messages.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _getAriaUpdates\n     * @return {Object} ARIA relates messages. Default:\n     * {\n     *      noToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n     *      oneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n     *      manyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars\n     *  }\n     */\n    _getAriaUpdates() {\n        return this.props.ariaUpdates || {\n            noToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n            oneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n            manyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars\n        };\n    }\n\n    /**\n     * Returns an ARIA message which represents the number of currently available toolbars.\n     *\n     * @instance\n     * @memberof UI\n     * @method _getAvailableToolbarsMessage\n     * @protected\n     * @param {CKEDITOR.dom.element} domNode The DOM node from which the available toolbars will be retrieved.\n     * @return {String} The ARIA message for the number of available toolbars\n     */\n    _getAvailableToolbarsMessage(domNode) {\n        var toolbarsNodeList = domNode.querySelectorAll('[role=\"toolbar\"]');\n\n        if (!toolbarsNodeList.length) {\n            return this._getAriaUpdates().noToolbar;\n        } else {\n            var toolbarNames = Array.prototype.slice.call(toolbarsNodeList).map(function(toolbar) {\n                return toolbar.getAttribute('aria-label');\n            });\n\n            var ariaUpdate = toolbarNames.length === 1 ? 'oneToolbar' : 'manyToolbars';\n\n            return this._getAriaUpdateTemplate(ariaUpdate).output({\n                toolbars: toolbarNames.join(',').replace(/,([^,]*)$/, ' and ' + '$1')\n            });\n        }\n    }\n\n    /**\n     * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n     *\n     * @instance\n     * @memberof UI\n     * @method componentWillUnmount\n     */\n    componentWillUnmount() {\n        if (this._mousedownListener) {\n            document.removeEventListener('mousedown', this._mousedownListener);\n        }\n\n        if (this._keyDownListener) {\n            this._keyDownListener.detach();\n            document.removeEventListener('keydown', this._keyDownListener);\n        }\n    }\n\n    /**\n     * Lifecycle. Renders the UI of the editor. This may include several toolbars and buttons.\n     * The editor's UI also takes care of rendering the items in exclusive mode.\n     *\n     * @instance\n     * @memberof UI\n     * @method render\n     * @return {Object} The content which should be rendered.\n     */\n    render() {\n        if (this.state.hidden) {\n            return null;\n        }\n\n        var toolbars = Object.keys(this.props.toolbars).map(function(toolbar) {\n            return AlloyEditor.Toolbars[toolbar] || window[toolbar];\n        });\n\n        toolbars = this.filterExclusive(toolbars).map(function(toolbar) {\n            var props = this.mergeExclusiveProps({\n                config: this.props.toolbars[toolbar.key],\n                editor: this.props.editor,\n                editorEvent: this.state.editorEvent,\n                key: toolbar.key,\n                onDismiss: this._onDismissToolbarFocus,\n                selectionData: this.state.selectionData\n            }, toolbar.key);\n\n            return React.createElement(toolbar, props);\n        }.bind(this));\n\n        return (\n            <div className=\"ae-toolbars\" onKeyDown={this.handleKey.bind(this)}>\n                {toolbars}\n            </div>\n        );\n    }\n\n    /**\n     * Listener to the editor's `actionPerformed` event. Sets state and redraws the UI of the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onActionPerformed\n     * @param {SynteticEvent} event The provided event\n     */\n    _onActionPerformed(event) {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.focus();\n\n        this.setState({\n            itemExclusive: null,\n            selectionData: editor.getSelectionData()\n        });\n    }\n\n    /**\n     * Executed when a dismiss key is pressed over a toolbar to return the focus to the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onDismissToolbarFocus\n     */\n    _onDismissToolbarFocus() {\n        var editor = this.props.editor.get('nativeEditor');\n\n        editor.focus();\n    }\n\n    /**\n     * Listener to the editor's `userInteraction` event. Retrieves the data about the user selection and\n     * provides it via component's state property.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onEditorInteraction\n     * @param {SynteticEvent} event The provided event\n     */\n    _onEditorInteraction(event) {\n        this.setState({\n            editorEvent: event,\n            hidden: false,\n            itemExclusive: null,\n            selectionData: event.data.selectionData\n        });\n    }\n\n    /**\n     * Focuses on the active toolbar when the combination ALT+F10 is pressed inside the editor.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _onEditorKey\n     */\n    _onEditorKey(event) {\n        var nativeEvent = event.data.domEvent.$;\n\n        if (nativeEvent.altKey && nativeEvent.keyCode === 121) {\n            this.focus();\n        }\n    }\n\n    /**\n     * Checks if the target with which the user interacted is part of editor's UI or it is\n     * the editable area. If none of these, sets the state of editor's UI to be hidden.\n     *\n     * @instance\n     * @memberof UI\n     * @protected\n     * @method _setUIHidden\n     * @param {DOMElement} target The DOM element with which user interacted lastly.\n     */\n    _setUIHidden(target) {\n        var domNode = ReactDOM.findDOMNode(this);\n\n        if (domNode) {\n            var editable = this.props.editor.get('nativeEditor').editable();\n            var targetNode = new CKEDITOR.dom.node(target);\n\n            if (!editable) {\n                this.setState({\n                    hidden: true\n                });\n            } else {\n                var res = (editable.$ === target) || editable.contains(targetNode) ||\n                    (new CKEDITOR.dom.element(domNode)).contains(targetNode);\n\n                if (!res) {\n                    this.setState({\n                        hidden: true\n                    });\n                }\n            }\n        }\n    }\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof UI\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nUI.defaultProps = {\n    circular: true,\n    descendants: '[class^=ae-toolbar-]',\n    eventsDelay: 0,\n    keys: {\n        next: 9\n    }\n};\n\n/**\n * Fired when component updates and when it is rendered in the DOM.\n * The payload consists from a `message` property containing the ARIA message.\n *\n * @event ariaUpdate\n */\n\n/**\n * Fired when component updates. The payload consists from an object with the following\n * properties:\n * - prevProps - The previous properties of the component\n * - prevState - The previous state of the component\n * - props - The current properties of the component\n * - state - The current state of the component\n *\n * @event ariaUpdate\n */\n\nexport default WidgetExclusive(\n    WidgetFocusManager(\n        UI\n));","import Attribute from './attribute.js';\nimport Lang from './lang.js';\nimport extend from './oop.js';\n\n/**\n * Quick and dirty impl of Base class.\n *\n * @class Base\n * @constructor\n */\nfunction Base(config) {\n    Base.superclass.constructor.call(this, config);\n\n    this.init(config);\n}\n\nextend(Base, Attribute, {\n    /**\n     * Calls the `initializer` method of each class which extends Base starting from the parent to the child.\n     * Will pass the configuration object to each initializer method.\n     *\n     * @instance\n     * @memberof Base\n     * @method init\n     * @param {Object} config Configuration object\n     */\n    init: function(config) {\n        this._callChain('initializer', config);\n    },\n\n    /**\n     * Calls the `destructor` method of each class which extends Base starting from the parent to the child.\n     *\n     * @instance\n     * @memberof Base\n     * @method destroy\n     */\n    destroy: function() {\n        this._callChain('destructor');\n    },\n\n    /**\n     * Calls a method of each class, which is being present in the hierarchy starting from parent to the child.\n     *\n     * @instance\n     * @memberof Base\n     * @method _callChain\n     * @param {Object|Array} args The arguments with which the method should be invoked\n     * @param {String} wat  The method, which should be invoked\n     * @protected\n     */\n    _callChain: function(wat, args) {\n        var arr = [];\n\n        var ctor = this.constructor;\n\n        while (ctor) {\n            if (Lang.isFunction(ctor.prototype[wat])) {\n                arr.push(ctor.prototype[wat]);\n            }\n\n            ctor = ctor.superclass ? ctor.superclass.constructor : null;\n        }\n\n        arr = arr.reverse();\n\n        args = Lang.isArray(args) ? args : [args];\n\n        for (var i = 0; i < arr.length; i++) {\n            var item = arr[i];\n\n            item.apply(this, args);\n        }\n    }\n});\n\nexport default Base;","(function() {\n    'use strict';\n\n    /* istanbul ignore if */\n    if (CKEDITOR.plugins.get('ae_uibridge')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin that extends CKEDITOR.ui.add function so an add handler can be specified\n     * on top of the original ones. It bridges the calls to add components via:\n     * - editor.ui.add(name, type, definition)\n     *\n     * @class CKEDITOR.plugins.ae_uibridge\n     * @constructor\n     */\n    CKEDITOR.plugins.add('ae_uibridge', {\n        /**\n         * Initialization of the plugin, part of CKEditor plugin lifecycle.\n         *\n         * @method beforeInit\n         * @param {Object} editor The current editor instance\n         */\n        beforeInit: function(editor) {\n            var originalUIAddFn = editor.ui.add;\n\n            editor.ui.add = function(name, type, definition) {\n                originalUIAddFn.apply(this, arguments);\n\n                var typeHandler = this._.handlers[type];\n\n                if (typeHandler && typeHandler.add) {\n                    typeHandler.add(name, definition, editor);\n                    AlloyEditor.registerBridgeButton(name, editor.__processingPlugin__.plugin.name);\n                }\n            };\n        }\n    });\n}());","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n( function() {\n\t'use strict';\n\n    if (CKEDITOR.plugins.get('ae_tabletools')){\n\t\treturn;\n    }\n\n\tvar cellNodeRegex = /^(?:td|th)$/;\n\n\tfunction getSelectedCells( selection ) {\n\t\tvar ranges = selection.getRanges();\n\t\tvar retval = [];\n\t\tvar database = {};\n\n\t\tfunction moveOutOfCellGuard( node ) {\n\t\t\t// Apply to the first cell only.\n\t\t\tif ( retval.length > 0 )\n\t\t\t\treturn;\n\n\t\t\t// If we are exiting from the first </td>, then the td should definitely be\n\t\t\t// included.\n\t\t\tif ( node.type == CKEDITOR.NODE_ELEMENT && cellNodeRegex.test( node.getName() ) && !node.getCustomData( 'selected_cell' ) ) {\n\t\t\t\tCKEDITOR.dom.element.setMarker( database, node, 'selected_cell', true );\n\t\t\t\tretval.push( node );\n\t\t\t}\n\t\t}\n\n\t\tfor ( var i = 0; i < ranges.length; i++ ) {\n\t\t\tvar range = ranges[ i ];\n\n\t\t\tif ( range.collapsed ) {\n\t\t\t\t// Walker does not handle collapsed ranges yet - fall back to old API.\n\t\t\t\tvar startNode = range.getCommonAncestor();\n\t\t\t\tvar nearestCell = startNode.getAscendant( 'td', true ) || startNode.getAscendant( 'th', true );\n\t\t\t\tif ( nearestCell )\n\t\t\t\t\tretval.push( nearestCell );\n\t\t\t} else {\n\t\t\t\tvar walker = new CKEDITOR.dom.walker( range );\n\t\t\t\tvar node;\n\t\t\t\twalker.guard = moveOutOfCellGuard;\n\n\t\t\t\twhile ( ( node = walker.next() ) ) {\n\t\t\t\t\t// If may be possible for us to have a range like this:\n\t\t\t\t\t// <td>^1</td><td>^2</td>\n\t\t\t\t\t// The 2nd td shouldn't be included.\n\t\t\t\t\t//\n\t\t\t\t\t// So we have to take care to include a td we've entered only when we've\n\t\t\t\t\t// walked into its children.\n\n\t\t\t\t\tif ( node.type != CKEDITOR.NODE_ELEMENT || !node.is( CKEDITOR.dtd.table ) ) {\n\t\t\t\t\t\tvar parent = node.getAscendant( 'td', true ) || node.getAscendant( 'th', true );\n\t\t\t\t\t\tif ( parent && !parent.getCustomData( 'selected_cell' ) ) {\n\t\t\t\t\t\t\tCKEDITOR.dom.element.setMarker( database, parent, 'selected_cell', true );\n\t\t\t\t\t\t\tretval.push( parent );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\n\t\treturn retval;\n\t}\n\n\tfunction getFocusElementAfterDelCells( cellsToDelete ) {\n\t\tvar i = 0,\n\t\t\tlast = cellsToDelete.length - 1,\n\t\t\tdatabase = {},\n\t\t\tcell, focusedCell, tr;\n\n\t\twhile ( ( cell = cellsToDelete[ i++ ] ) )\n\t\t\tCKEDITOR.dom.element.setMarker( database, cell, 'delete_cell', true );\n\n\t\t// 1.first we check left or right side focusable cell row by row;\n\t\ti = 0;\n\t\twhile ( ( cell = cellsToDelete[ i++ ] ) ) {\n\t\t\tif ( ( focusedCell = cell.getPrevious() ) && !focusedCell.getCustomData( 'delete_cell' ) || ( focusedCell = cell.getNext() ) && !focusedCell.getCustomData( 'delete_cell' ) ) {\n\t\t\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\t\t\t\treturn focusedCell;\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers( database );\n\n\t\t// 2. then we check the toppest row (outside the selection area square) focusable cell\n\t\ttr = cellsToDelete[ 0 ].getParent();\n\t\tif ( ( tr = tr.getPrevious() ) )\n\t\t\treturn tr.getLast();\n\n\t\t// 3. last we check the lowerest  row focusable cell\n\t\ttr = cellsToDelete[ last ].getParent();\n\t\tif ( ( tr = tr.getNext() ) )\n\t\t\treturn tr.getChild( 0 );\n\n\t\treturn null;\n\t}\n\n\tfunction insertRow( selection, insertBefore ) {\n\t\tvar cells = getSelectedCells( selection ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tdoc = firstCell.getDocument(),\n\t\t\tstartRow = cells[ 0 ].getParent(),\n\t\t\tstartRowIndex = startRow.$.rowIndex,\n\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\tendRowIndex = lastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1,\n\t\t\tendRow = new CKEDITOR.dom.element( table.$.rows[ endRowIndex ] ),\n\t\t\trowIndex = insertBefore ? startRowIndex : endRowIndex,\n\t\t\trow = insertBefore ? startRow : endRow;\n\n\t\tvar map = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tcloneRow = map[ rowIndex ],\n\t\t\tnextRow = insertBefore ? map[ rowIndex - 1 ] : map[ rowIndex + 1 ],\n\t\t\twidth = map[ 0 ].length;\n\n\t\tvar newRow = doc.createElement( 'tr' );\n\t\tfor ( var i = 0; cloneRow[ i ] && i < width; i++ ) {\n\t\t\tvar cell;\n\t\t\t// Check whether there's a spanning row here, do not break it.\n\t\t\tif ( cloneRow[ i ].rowSpan > 1 && nextRow && cloneRow[ i ] == nextRow[ i ] ) {\n\t\t\t\tcell = cloneRow[ i ];\n\t\t\t\tcell.rowSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element( cloneRow[ i ] ).clone();\n\t\t\t\tcell.removeAttribute( 'rowSpan' );\n\t\t\t\tcell.appendBogus();\n\t\t\t\tnewRow.append( cell );\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.colSpan - 1;\n\t\t}\n\n\t\tinsertBefore ? newRow.insertBefore( row ) : newRow.insertAfter( row );\n\t}\n\n\tfunction deleteRows( selectionOrRow ) {\n\t\tif ( selectionOrRow instanceof CKEDITOR.dom.selection ) {\n\t\t\tvar cells = getSelectedCells( selectionOrRow ),\n\t\t\t\tfirstCell = cells[ 0 ],\n\t\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\t\tstartRow = cells[ 0 ].getParent(),\n\t\t\t\tstartRowIndex = startRow.$.rowIndex,\n\t\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\t\tendRowIndex = lastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1,\n\t\t\t\trowsToDelete = [];\n\n\t\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\t\tfor ( var i = startRowIndex; i <= endRowIndex; i++ ) {\n\t\t\t\tvar mapRow = map[ i ],\n\t\t\t\t\trow = new CKEDITOR.dom.element( table.$.rows[ i ] );\n\n\t\t\t\tfor ( var j = 0; j < mapRow.length; j++ ) {\n\t\t\t\t\tvar cell = new CKEDITOR.dom.element( mapRow[ j ] ),\n\t\t\t\t\t\tcellRowIndex = cell.getParent().$.rowIndex;\n\n\t\t\t\t\tif ( cell.$.rowSpan == 1 )\n\t\t\t\t\t\tcell.remove();\n\t\t\t\t\t// Row spanned cell.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Span row of the cell, reduce spanning.\n\t\t\t\t\t\tcell.$.rowSpan -= 1;\n\t\t\t\t\t\t// Root row of the cell, root cell to next row.\n\t\t\t\t\t\tif ( cellRowIndex == i ) {\n\t\t\t\t\t\t\tvar nextMapRow = map[ i + 1 ];\n\t\t\t\t\t\t\tnextMapRow[ j - 1 ] ? cell.insertAfter( new CKEDITOR.dom.element( nextMapRow[ j - 1 ] ) ) : new CKEDITOR.dom.element( table.$.rows[ i + 1 ] ).append( cell, 1 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tj += cell.$.colSpan - 1;\n\t\t\t\t}\n\n\t\t\t\trowsToDelete.push( row );\n\t\t\t}\n\n\t\t\tvar rows = table.$.rows;\n\n\t\t\t// Where to put the cursor after rows been deleted?\n\t\t\t// 1. Into next sibling row if any;\n\t\t\t// 2. Into previous sibling row if any;\n\t\t\t// 3. Into table's parent element if it's the very last row.\n\t\t\tvar cursorPosition = new CKEDITOR.dom.element( rows[ endRowIndex + 1 ] || ( startRowIndex > 0 ? rows[ startRowIndex - 1 ] : null ) || table.$.parentNode );\n\n\t\t\tfor ( i = rowsToDelete.length; i >= 0; i-- )\n\t\t\t\tdeleteRows( rowsToDelete[ i ] );\n\n\t\t\treturn cursorPosition;\n\t\t} else if ( selectionOrRow instanceof CKEDITOR.dom.element ) {\n\t\t\ttable = selectionOrRow.getAscendant( 'table' );\n\n\t\t\tif ( table.$.rows.length == 1 )\n\t\t\t\ttable.remove();\n\t\t\telse\n\t\t\t\tselectionOrRow.remove();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction getCellColIndex( cell, isStart ) {\n\t\tvar row = cell.getParent(),\n\t\t\trowCells = row.$.cells;\n\n\t\tvar colIndex = 0;\n\t\tfor ( var i = 0; i < rowCells.length; i++ ) {\n\t\t\tvar mapCell = rowCells[ i ];\n\t\t\tcolIndex += isStart ? 1 : mapCell.colSpan;\n\t\t\tif ( mapCell == cell.$ )\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn colIndex - 1;\n\t}\n\n\tfunction getColumnsIndices( cells, isStart ) {\n\t\tvar retval = isStart ? Infinity : 0;\n\t\tfor ( var i = 0; i < cells.length; i++ ) {\n\t\t\tvar colIndex = getCellColIndex( cells[ i ], isStart );\n\t\t\tif ( isStart ? colIndex < retval : colIndex > retval )\n\t\t\t\tretval = colIndex;\n\t\t}\n\t\treturn retval;\n\t}\n\n\tfunction insertColumn( selection, insertBefore ) {\n\t\tvar cells = getSelectedCells( selection ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tstartCol = getColumnsIndices( cells, 1 ),\n\t\t\tlastCol = getColumnsIndices( cells ),\n\t\t\tcolIndex = insertBefore ? startCol : lastCol;\n\n\t\tvar map = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tcloneCol = [],\n\t\t\tnextCol = [],\n\t\t\theight = map.length;\n\n\t\tfor ( var i = 0; i < height; i++ ) {\n\t\t\tcloneCol.push( map[ i ][ colIndex ] );\n\t\t\tvar nextCell = insertBefore ? map[ i ][ colIndex - 1 ] : map[ i ][ colIndex + 1 ];\n\t\t\tnextCol.push( nextCell );\n\t\t}\n\n\t\tfor ( i = 0; i < height; i++ ) {\n\t\t\tvar cell;\n\n\t\t\tif ( !cloneCol[ i ] )\n\t\t\t\tcontinue;\n\n\t\t\t// Check whether there's a spanning column here, do not break it.\n\t\t\tif ( cloneCol[ i ].colSpan > 1 && nextCol[ i ] == cloneCol[ i ] ) {\n\t\t\t\tcell = cloneCol[ i ];\n\t\t\t\tcell.colSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element( cloneCol[ i ] ).clone();\n\t\t\t\tcell.removeAttribute( 'colSpan' );\n\t\t\t\tcell.appendBogus();\n\t\t\t\tcell[ insertBefore ? 'insertBefore' : 'insertAfter' ].call( cell, new CKEDITOR.dom.element( cloneCol[ i ] ) );\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.rowSpan - 1;\n\t\t}\n\t}\n\n\tfunction deleteColumns( selectionOrCell ) {\n\t\tvar cells = getSelectedCells( selectionOrCell ),\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\tlastCell = cells[ cells.length - 1 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tstartColIndex, endColIndex,\n\t\t\trowsToDelete = [];\n\n\t\t// Figure out selected cells' column indices.\n\t\tfor ( var i = 0, rows = map.length; i < rows; i++ ) {\n\t\t\tfor ( var j = 0, cols = map[ i ].length; j < cols; j++ ) {\n\t\t\t\tif ( map[ i ][ j ] == firstCell.$ )\n\t\t\t\t\tstartColIndex = j;\n\t\t\t\tif ( map[ i ][ j ] == lastCell.$ )\n\t\t\t\t\tendColIndex = j;\n\t\t\t}\n\t\t}\n\n\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\tfor ( i = startColIndex; i <= endColIndex; i++ ) {\n\t\t\tfor ( j = 0; j < map.length; j++ ) {\n\t\t\t\tvar mapRow = map[ j ],\n\t\t\t\t\trow = new CKEDITOR.dom.element( table.$.rows[ j ] ),\n\t\t\t\t\tcell = new CKEDITOR.dom.element( mapRow[ i ] );\n\n\t\t\t\tif ( cell.$ ) {\n\t\t\t\t\tif ( cell.$.colSpan == 1 )\n\t\t\t\t\t\tcell.remove();\n\t\t\t\t\t// Reduce the col spans.\n\t\t\t\t\telse\n\t\t\t\t\t\tcell.$.colSpan -= 1;\n\n\t\t\t\t\tj += cell.$.rowSpan - 1;\n\n\t\t\t\t\tif ( !row.$.cells.length )\n\t\t\t\t\t\trowsToDelete.push( row );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar firstRowCells = table.$.rows[ 0 ] && table.$.rows[ 0 ].cells;\n\n\t\t// Where to put the cursor after columns been deleted?\n\t\t// 1. Into next cell of the first row if any;\n\t\t// 2. Into previous cell of the first row if any;\n\t\t// 3. Into table's parent element;\n\t\tvar cursorPosition = new CKEDITOR.dom.element( firstRowCells[ startColIndex ] || ( startColIndex ? firstRowCells[ startColIndex - 1 ] : table.$.parentNode ) );\n\n\t\t// Delete table rows only if all columns are gone (do not remove empty row).\n\t\tif ( rowsToDelete.length == rows )\n\t\t\ttable.remove();\n\n\t\treturn cursorPosition;\n\t}\n\n\tfunction insertCell( selection, insertBefore ) {\n\t\tvar startElement = selection.getStartElement();\n\t\tvar cell = startElement.getAscendant( 'td', 1 ) || startElement.getAscendant( 'th', 1 );\n\n\t\tif ( !cell )\n\t\t\treturn;\n\n\t\t// Create the new cell element to be added.\n\t\tvar newCell = cell.clone();\n\t\tnewCell.appendBogus();\n\n\t\tif ( insertBefore )\n\t\t\tnewCell.insertBefore( cell );\n\t\telse\n\t\t\tnewCell.insertAfter( cell );\n\t}\n\n\tfunction deleteCells( selectionOrCell ) {\n\t\tif ( selectionOrCell instanceof CKEDITOR.dom.selection ) {\n\t\t\tvar cellsToDelete = getSelectedCells( selectionOrCell );\n\t\t\tvar table = cellsToDelete[ 0 ] && cellsToDelete[ 0 ].getAscendant( 'table' );\n\t\t\tvar cellToFocus = getFocusElementAfterDelCells( cellsToDelete );\n\n\t\t\tfor ( var i = cellsToDelete.length - 1; i >= 0; i-- )\n\t\t\t\tdeleteCells( cellsToDelete[ i ] );\n\n\t\t\tif ( cellToFocus )\n\t\t\t\tplaceCursorInCell( cellToFocus, true );\n\t\t\telse if ( table )\n\t\t\t\ttable.remove();\n\t\t} else if ( selectionOrCell instanceof CKEDITOR.dom.element ) {\n\t\t\tvar tr = selectionOrCell.getParent();\n\t\t\tif ( tr.getChildCount() == 1 )\n\t\t\t\ttr.remove();\n\t\t\telse\n\t\t\t\tselectionOrCell.remove();\n\t\t}\n\t}\n\n\t// Remove filler at end and empty spaces around the cell content.\n\tfunction trimCell( cell ) {\n\t\tvar bogus = cell.getBogus();\n\t\tbogus && bogus.remove();\n\t\tcell.trim();\n\t}\n\n\tfunction placeCursorInCell( cell, placeAtEnd ) {\n\t\tvar docInner = cell.getDocument(),\n\t\t\tdocOuter = CKEDITOR.document;\n\n\t\t// Fixing \"Unspecified error\" thrown in IE10 by resetting\n\t\t// selection the dirty and shameful way (#10308).\n\t\t// We can not apply this hack to IE8 because\n\t\t// it causes error (#11058).\n\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version == 10 ) {\n\t\t\tdocOuter.focus();\n\t\t\tdocInner.focus();\n\t\t}\n\n\t\tvar range = new CKEDITOR.dom.range( docInner );\n\t\tif ( !range[ 'moveToElementEdit' + ( placeAtEnd ? 'End' : 'Start' ) ]( cell ) ) {\n\t\t\trange.selectNodeContents( cell );\n\t\t\trange.collapse( placeAtEnd ? false : true );\n\t\t}\n\t\trange.select( true );\n\t}\n\n\tfunction cellInRow( tableMap, rowIndex, cell ) {\n\t\tvar oRow = tableMap[ rowIndex ];\n\t\tif ( typeof cell == 'undefined' )\n\t\t\treturn oRow;\n\n\t\tfor ( var c = 0; oRow && c < oRow.length; c++ ) {\n\t\t\tif ( cell.is && oRow[ c ] == cell.$ )\n\t\t\t\treturn c;\n\t\t\telse if ( c == cell )\n\t\t\t\treturn new CKEDITOR.dom.element( oRow[ c ] );\n\t\t}\n\t\treturn cell.is ? -1 : null;\n\t}\n\n\tfunction cellInCol( tableMap, colIndex ) {\n\t\tvar oCol = [];\n\t\tfor ( var r = 0; r < tableMap.length; r++ ) {\n\t\t\tvar row = tableMap[ r ];\n\t\t\toCol.push( row[ colIndex ] );\n\n\t\t\t// Avoid adding duplicate cells.\n\t\t\tif ( row[ colIndex ].rowSpan > 1 )\n\t\t\t\tr += row[ colIndex ].rowSpan - 1;\n\t\t}\n\t\treturn oCol;\n\t}\n\n\tfunction mergeCells( selection, mergeDirection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\n\t\t// Invalid merge request if:\n\t\t// 1. In batch mode despite that less than two selected.\n\t\t// 2. In solo mode while not exactly only one selected.\n\t\t// 3. Cells distributed in different table groups (e.g. from both thead and tbody).\n\t\tvar commonAncestor;\n\t\tif ( ( mergeDirection ? cells.length != 1 : cells.length < 2 ) || ( commonAncestor = selection.getCommonAncestor() ) && commonAncestor.type == CKEDITOR.NODE_ELEMENT && commonAncestor.is( 'table' ) )\n\t\t\treturn false;\n\n\t\tvar cell,\n\t\t\tfirstCell = cells[ 0 ],\n\t\t\ttable = firstCell.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\tmapHeight = map.length,\n\t\t\tmapWidth = map[ 0 ].length,\n\t\t\tstartRow = firstCell.getParent().$.rowIndex,\n\t\t\tstartColumn = cellInRow( map, startRow, firstCell );\n\n\t\tif ( mergeDirection ) {\n\t\t\tvar targetCell;\n\t\t\ttry {\n\t\t\t\tvar rowspan = parseInt( firstCell.getAttribute( 'rowspan' ), 10 ) || 1;\n\t\t\t\tvar colspan = parseInt( firstCell.getAttribute( 'colspan' ), 10 ) || 1;\n\n\t\t\t\ttargetCell = map[ mergeDirection == 'up' ? ( startRow - rowspan ) : mergeDirection == 'down' ? ( startRow + rowspan ) : startRow ][\n\t\t\t\t\tmergeDirection == 'left' ?\n\t\t\t\t\t\t( startColumn - colspan ) :\n\t\t\t\t\tmergeDirection == 'right' ? ( startColumn + colspan ) : startColumn ];\n\n\t\t\t} catch ( er ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// 1. No cell could be merged.\n\t\t\t// 2. Same cell actually.\n\t\t\tif ( !targetCell || firstCell.$ == targetCell )\n\t\t\t\treturn false;\n\n\t\t\t// Sort in map order regardless of the DOM sequence.\n\t\t\tcells[ ( mergeDirection == 'up' || mergeDirection == 'left' ) ? 'unshift' : 'push' ]( new CKEDITOR.dom.element( targetCell ) );\n\t\t}\n\n\t\t// Start from here are merging way ignorance (merge up/right, batch merge).\n\t\tvar doc = firstCell.getDocument(),\n\t\t\tlastRowIndex = startRow,\n\t\t\ttotalRowSpan = 0,\n\t\t\ttotalColSpan = 0,\n\t\t\t// Use a documentFragment as buffer when appending cell contents.\n\t\t\tfrag = !isDetect && new CKEDITOR.dom.documentFragment( doc ),\n\t\t\tdimension = 0;\n\n\t\tfor ( var i = 0; i < cells.length; i++ ) {\n\t\t\tcell = cells[ i ];\n\n\t\t\tvar tr = cell.getParent(),\n\t\t\t\tcellFirstChild = cell.getFirst(),\n\t\t\t\tcolSpan = cell.$.colSpan,\n\t\t\t\trowSpan = cell.$.rowSpan,\n\t\t\t\trowIndex = tr.$.rowIndex,\n\t\t\t\tcolIndex = cellInRow( map, rowIndex, cell );\n\n\t\t\t// Accumulated the actual places taken by all selected cells.\n\t\t\tdimension += colSpan * rowSpan;\n\t\t\t// Accumulated the maximum virtual spans from column and row.\n\t\t\ttotalColSpan = Math.max( totalColSpan, colIndex - startColumn + colSpan );\n\t\t\ttotalRowSpan = Math.max( totalRowSpan, rowIndex - startRow + rowSpan );\n\n\t\t\tif ( !isDetect ) {\n\t\t\t\t// Trim all cell fillers and check to remove empty cells.\n\t\t\t\tif ( trimCell( cell ), cell.getChildren().count() ) {\n\t\t\t\t\t// Merge vertically cells as two separated paragraphs.\n\t\t\t\t\tif ( rowIndex != lastRowIndex && cellFirstChild && !( cellFirstChild.isBlockBoundary && cellFirstChild.isBlockBoundary( { br: 1 } ) ) ) {\n\t\t\t\t\t\tvar last = frag.getLast( CKEDITOR.dom.walker.whitespaces( true ) );\n\t\t\t\t\t\tif ( last && !( last.is && last.is( 'br' ) ) )\n\t\t\t\t\t\t\tfrag.append( 'br' );\n\t\t\t\t\t}\n\n\t\t\t\t\tcell.moveChildren( frag );\n\t\t\t\t}\n\t\t\t\ti ? cell.remove() : cell.setHtml( '' );\n\t\t\t}\n\t\t\tlastRowIndex = rowIndex;\n\t\t}\n\n\t\tif ( !isDetect ) {\n\t\t\tfrag.moveChildren( firstCell );\n\n\t\t\tfirstCell.appendBogus();\n\n\t\t\tif ( totalColSpan >= mapWidth )\n\t\t\t\tfirstCell.removeAttribute( 'rowSpan' );\n\t\t\telse\n\t\t\t\tfirstCell.$.rowSpan = totalRowSpan;\n\n\t\t\tif ( totalRowSpan >= mapHeight )\n\t\t\t\tfirstCell.removeAttribute( 'colSpan' );\n\t\t\telse\n\t\t\t\tfirstCell.$.colSpan = totalColSpan;\n\n\t\t\t// Swip empty <tr> left at the end of table due to the merging.\n\t\t\tvar trs = new CKEDITOR.dom.nodeList( table.$.rows ),\n\t\t\t\tcount = trs.count();\n\n\t\t\tfor ( i = count - 1; i >= 0; i-- ) {\n\t\t\t\tvar tailTr = trs.getItem( i );\n\t\t\t\tif ( !tailTr.$.cells.length ) {\n\t\t\t\t\ttailTr.remove();\n\t\t\t\t\tcount++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn firstCell;\n\t\t}\n\t\t// Be able to merge cells only if actual dimension of selected\n\t\t// cells equals to the caculated rectangle.\n\t\telse {\n\t\t\treturn ( totalRowSpan * totalColSpan ) == dimension;\n\t\t}\n\t}\n\n\tfunction verticalSplitCell( selection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\t\tif ( cells.length > 1 )\n\t\t\treturn false;\n\t\telse if ( isDetect )\n\t\t\treturn true;\n\n\t\tvar cell = cells[ 0 ],\n\t\t\ttr = cell.getParent(),\n\t\t\ttable = tr.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\trowIndex = tr.$.rowIndex,\n\t\t\tcolIndex = cellInRow( map, rowIndex, cell ),\n\t\t\trowSpan = cell.$.rowSpan,\n\t\t\tnewCell, newRowSpan, newCellRowSpan, newRowIndex;\n\n\t\tif ( rowSpan > 1 ) {\n\t\t\tnewRowSpan = Math.ceil( rowSpan / 2 );\n\t\t\tnewCellRowSpan = Math.floor( rowSpan / 2 );\n\t\t\tnewRowIndex = rowIndex + newRowSpan;\n\t\t\tvar newCellTr = new CKEDITOR.dom.element( table.$.rows[ newRowIndex ] ),\n\t\t\t\tnewCellRow = cellInRow( map, newRowIndex ),\n\t\t\t\tcandidateCell;\n\n\t\t\tnewCell = cell.clone();\n\n\t\t\t// Figure out where to insert the new cell by checking the vitual row.\n\t\t\tfor ( var c = 0; c < newCellRow.length; c++ ) {\n\t\t\t\tcandidateCell = newCellRow[ c ];\n\t\t\t\t// Catch first cell actually following the column.\n\t\t\t\tif ( candidateCell.parentNode == newCellTr.$ && c > colIndex ) {\n\t\t\t\t\tnewCell.insertBefore( new CKEDITOR.dom.element( candidateCell ) );\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tcandidateCell = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The destination row is empty, append at will.\n\t\t\tif ( !candidateCell )\n\t\t\t\tnewCellTr.append( newCell );\n\t\t} else {\n\t\t\tnewCellRowSpan = newRowSpan = 1;\n\n\t\t\tnewCellTr = tr.clone();\n\t\t\tnewCellTr.insertAfter( tr );\n\t\t\tnewCellTr.append( newCell = cell.clone() );\n\n\t\t\tvar cellsInSameRow = cellInRow( map, rowIndex );\n\t\t\tfor ( var i = 0; i < cellsInSameRow.length; i++ )\n\t\t\t\tcellsInSameRow[ i ].rowSpan++;\n\t\t}\n\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.rowSpan = newRowSpan;\n\t\tnewCell.$.rowSpan = newCellRowSpan;\n\t\tif ( newRowSpan == 1 )\n\t\t\tcell.removeAttribute( 'rowSpan' );\n\t\tif ( newCellRowSpan == 1 )\n\t\t\tnewCell.removeAttribute( 'rowSpan' );\n\n\t\treturn newCell;\n\t}\n\n\tfunction horizontalSplitCell( selection, isDetect ) {\n\t\tvar cells = getSelectedCells( selection );\n\t\tif ( cells.length > 1 )\n\t\t\treturn false;\n\t\telse if ( isDetect )\n\t\t\treturn true;\n\n\t\tvar cell = cells[ 0 ],\n\t\t\ttr = cell.getParent(),\n\t\t\ttable = tr.getAscendant( 'table' ),\n\t\t\tmap = CKEDITOR.tools.buildTableMap( table ),\n\t\t\trowIndex = tr.$.rowIndex,\n\t\t\tcolIndex = cellInRow( map, rowIndex, cell ),\n\t\t\tcolSpan = cell.$.colSpan,\n\t\t\tnewCell, newColSpan, newCellColSpan;\n\n\t\tif ( colSpan > 1 ) {\n\t\t\tnewColSpan = Math.ceil( colSpan / 2 );\n\t\t\tnewCellColSpan = Math.floor( colSpan / 2 );\n\t\t} else {\n\t\t\tnewCellColSpan = newColSpan = 1;\n\t\t\tvar cellsInSameCol = cellInCol( map, colIndex );\n\t\t\tfor ( var i = 0; i < cellsInSameCol.length; i++ )\n\t\t\t\tcellsInSameCol[ i ].colSpan++;\n\t\t}\n\t\tnewCell = cell.clone();\n\t\tnewCell.insertAfter( cell );\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.colSpan = newColSpan;\n\t\tnewCell.$.colSpan = newCellColSpan;\n\t\tif ( newColSpan == 1 )\n\t\t\tcell.removeAttribute( 'colSpan' );\n\t\tif ( newCellColSpan == 1 )\n\t\t\tnewCell.removeAttribute( 'colSpan' );\n\n\t\treturn newCell;\n\t}\n\n\tCKEDITOR.plugins.add('ae_tabletools', {\n\t\tinit: function( editor ) {\n\t\t\tvar lang = editor.lang.table;\n\n\t\t\tfunction createDef( def ) {\n\t\t\t\treturn CKEDITOR.tools.extend( def || {}, {\n\t\t\t\t\tcontextSensitive: 1,\n\t\t\t\t\trefresh: function( editor, path ) {\n\t\t\t\t\t\tthis.setState( path.contains( { td: 1, th: 1 }, 1 ) ? CKEDITOR.TRISTATE_OFF : CKEDITOR.TRISTATE_DISABLED );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tfunction addCmd( name, def ) {\n\t\t\t\tvar cmd = editor.getCommand(name);\n\n\t\t\t\tif (cmd) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcmd = editor.addCommand(name, def);\n\t\t\t\teditor.addFeature(cmd);\n\t\t\t}\n\n\t\t\taddCmd( 'rowDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tplaceCursorInCell( deleteRows( selection ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'rowInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertRow( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'rowInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertRow( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tvar element = deleteColumns( selection );\n\t\t\t\t\telement && placeCursorInCell( element, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertColumn( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'columnInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertColumn( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellDelete', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tdeleteCells( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMerge', createDef( {\n\t\t\t\tallowedContent: 'td[colspan,rowspan]',\n\t\t\t\trequiredContent: 'td[colspan,rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection() ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMergeRight', createDef( {\n\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection(), 'right' ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellMergeDown', createDef( {\n\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( mergeCells( editor.getSelection(), 'down' ), true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellVerticalSplit', createDef( {\n\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( verticalSplitCell( editor.getSelection() ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellHorizontalSplit', createDef( {\n\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tplaceCursorInCell( horizontalSplitCell( editor.getSelection() ) );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellInsertBefore', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertCell( selection, true );\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\taddCmd( 'cellInsertAfter', createDef( {\n\t\t\t\trequiredContent: 'table',\n\t\t\t\texec: function( editor ) {\n\t\t\t\t\tvar selection = editor.getSelection();\n\t\t\t\t\tinsertCell( selection );\n\t\t\t\t}\n\t\t\t} ) );\n\t\t},\n\n\t\tgetSelectedCells: getSelectedCells\n\n\t});\n} )();\n\n/**\n * Create a two-dimension array that reflects the actual layout of table cells,\n * with cell spans, with mappings to the original td elements.\n *\n * @param {CKEDITOR.dom.element} table\n * @member CKEDITOR.tools\n */\nCKEDITOR.tools.buildTableMap = function( table ) {\n\tvar aRows = table.$.rows;\n\n\t// Row and Column counters.\n\tvar r = -1;\n\n\tvar aMap = [];\n\n\tfor ( var i = 0; i < aRows.length; i++ ) {\n\t\tr++;\n\t\t!aMap[ r ] && ( aMap[ r ] = [] );\n\n\t\tvar c = -1;\n\n\t\tfor ( var j = 0; j < aRows[ i ].cells.length; j++ ) {\n\t\t\tvar oCell = aRows[ i ].cells[ j ];\n\n\t\t\tc++;\n\t\t\twhile ( aMap[ r ][ c ] )\n\t\t\t\tc++;\n\n\t\t\tvar iColSpan = isNaN( oCell.colSpan ) ? 1 : oCell.colSpan;\n\t\t\tvar iRowSpan = isNaN( oCell.rowSpan ) ? 1 : oCell.rowSpan;\n\n\t\t\tfor ( var rs = 0; rs < iRowSpan; rs++ ) {\n\t\t\t\tif ( !aMap[ r + rs ] )\n\t\t\t\t\taMap[ r + rs ] = [];\n\n\t\t\t\tfor ( var cs = 0; cs < iColSpan; cs++ ) {\n\t\t\t\t\taMap[ r + rs ][ c + cs ] = aRows[ i ].cells[ j ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc += iColSpan - 1;\n\t\t}\n\t}\n\treturn aMap;\n};\n","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_tableresize')) {\n        return;\n    }\n\n    var pxUnit = CKEDITOR.tools.cssLength;\n\n    function getWidth(el) {\n        return CKEDITOR.env.ie ? el.$.clientWidth : parseInt(el.getComputedStyle('width'), 10);\n    }\n\n    function getBorderWidth(element, side) {\n        var computed = element.getComputedStyle('border-' + side + '-width'),\n            borderMap = {\n                thin: '0px',\n                medium: '1px',\n                thick: '2px'\n            };\n\n        if (computed.indexOf('px') < 0) {\n            // look up keywords\n            if (computed in borderMap && element.getComputedStyle('border-style') != 'none') {\n                computed = borderMap[computed];\n            } else {\n                computed = 0;\n            }\n        }\n\n        return parseInt(computed, 10);\n    }\n\n    // Gets the table row that contains the most columns.\n    function getMasterPillarRow(table) {\n        var $rows = table.$.rows,\n            maxCells = 0,\n            cellsCount, $elected, $tr;\n\n        for (var i = 0, len = $rows.length; i < len; i++) {\n            $tr = $rows[i];\n            cellsCount = $tr.cells.length;\n\n            if (cellsCount > maxCells) {\n                maxCells = cellsCount;\n                $elected = $tr;\n            }\n        }\n\n        return $elected;\n    }\n\n    function buildTableColumnPillars(table) {\n        var pillars = [],\n            pillarIndex = -1,\n            rtl = (table.getComputedStyle('direction') === 'rtl');\n\n        // Get the raw row element that cointains the most columns.\n        var $tr = getMasterPillarRow(table);\n\n        // Get the tbody element and position, which will be used to set the\n        // top and bottom boundaries.\n        var tbody = new CKEDITOR.dom.element(table.$.tBodies[0]),\n            tbodyPosition = tbody.getDocumentPosition();\n\n        // Loop thorugh all cells, building pillars after each one of them.\n        for (var i = 0, len = $tr.cells.length; i < len; i++) {\n            // Both the current cell and the successive one will be used in the\n            // pillar size calculation.\n            var td = new CKEDITOR.dom.element($tr.cells[i]),\n                nextTd = $tr.cells[i + 1] && new CKEDITOR.dom.element($tr.cells[i + 1]);\n\n            pillarIndex += td.$.colSpan || 1;\n\n            // Calculate the pillar boundary positions.\n            var pillarLeft, pillarRight, pillarWidth;\n\n            var x = td.getDocumentPosition().x;\n\n            // Calculate positions based on the current cell.\n            rtl ? pillarRight = x + getBorderWidth(td, 'left') : pillarLeft = x + td.$.offsetWidth - getBorderWidth(td, 'right');\n\n            // Calculate positions based on the next cell, if available.\n            if (nextTd) {\n                x = nextTd.getDocumentPosition().x;\n\n                rtl ? pillarLeft = x + nextTd.$.offsetWidth - getBorderWidth(nextTd, 'right') : pillarRight = x + getBorderWidth(nextTd, 'left');\n            }\n            // Otherwise calculate positions based on the table (for last cell).\n            else {\n                x = table.getDocumentPosition().x;\n\n                rtl ? pillarLeft = x : pillarRight = x + table.$.offsetWidth;\n            }\n\n            pillarWidth = Math.max(pillarRight - pillarLeft, 4);\n\n            // The pillar should reflects exactly the shape of the hovered\n            // column border line.\n            pillars.push({\n                table: table,\n                index: pillarIndex,\n                x: pillarLeft,\n                y: tbodyPosition.y,\n                width: pillarWidth,\n                height: tbody.$.offsetHeight,\n                rtl: rtl\n            });\n        }\n\n        return pillars;\n    }\n\n    function getPillarAtPosition(pillars, positionX) {\n        for (var i = 0, len = pillars.length; i < len; i++) {\n            var pillar = pillars[i];\n\n            if (positionX >= pillar.x && positionX <= (pillar.x + pillar.width)) {\n                return pillar;\n            }\n        }\n\n        return null;\n    }\n\n    function cancel(evt) {\n        (evt.data || evt).preventDefault();\n    }\n\n    function columnResizer(editor) {\n        var pillar, document, resizer, isResizing, startOffset, currentShift;\n\n        var leftSideCells, rightSideCells, leftShiftBoundary, rightShiftBoundary;\n\n        function detach() {\n            pillar = null;\n            currentShift = 0;\n            isResizing = 0;\n\n            document.removeListener('mouseup', onMouseUp);\n            resizer.removeListener('mousedown', onMouseDown);\n            resizer.removeListener('mousemove', onMouseMove);\n\n            document.getBody().setStyle('cursor', 'auto');\n        }\n\n        function resizeStart() {\n            // Before starting to resize, figure out which cells to change\n            // and the boundaries of this resizing shift.\n\n            var columnIndex = pillar.index,\n                map = CKEDITOR.tools.buildTableMap(pillar.table),\n                leftColumnCells = [],\n                rightColumnCells = [],\n                leftMinSize = Number.MAX_VALUE,\n                rightMinSize = leftMinSize,\n                rtl = pillar.rtl;\n\n            for (var i = 0, len = map.length; i < len; i++) {\n                var row = map[i],\n                    leftCell = row[columnIndex + (rtl ? 1 : 0)],\n                    rightCell = row[columnIndex + (rtl ? 0 : 1)];\n\n                leftCell = leftCell && new CKEDITOR.dom.element(leftCell);\n                rightCell = rightCell && new CKEDITOR.dom.element(rightCell);\n\n                if (!leftCell || !rightCell || !leftCell.equals(rightCell)) {\n                    leftCell && (leftMinSize = Math.min(leftMinSize, getWidth(leftCell)));\n                    rightCell && (rightMinSize = Math.min(rightMinSize, getWidth(rightCell)));\n\n                    leftColumnCells.push(leftCell);\n                    rightColumnCells.push(rightCell);\n                }\n            }\n\n            // Cache the list of cells to be resized.\n            leftSideCells = leftColumnCells;\n            rightSideCells = rightColumnCells;\n\n            // Cache the resize limit boundaries.\n            leftShiftBoundary = pillar.x - leftMinSize;\n            rightShiftBoundary = pillar.x + rightMinSize;\n\n            resizer.setOpacity(0.5);\n            startOffset = parseInt(resizer.getStyle('left'), 10);\n            currentShift = 0;\n            isResizing = 1;\n\n            resizer.on('mousemove', onMouseMove);\n\n            // Prevent the native drag behavior otherwise 'mousemove' won't fire.\n            document.on('dragstart', cancel);\n        }\n\n        function resizeEnd() {\n            isResizing = 0;\n\n            resizer.setOpacity(0);\n\n            currentShift && resizeColumn();\n\n            var table = pillar.table;\n            setTimeout(function() {\n                table.removeCustomData('_cke_table_pillars');\n            }, 0);\n\n            document.removeListener('dragstart', cancel);\n        }\n\n        function resizeColumn() {\n            var rtl = pillar.rtl,\n                cellsCount = rtl ? rightSideCells.length : leftSideCells.length;\n\n            // Perform the actual resize to table cells, only for those by side of the pillar.\n            for (var i = 0; i < cellsCount; i++) {\n                var leftCell = leftSideCells[i],\n                    rightCell = rightSideCells[i],\n                    table = pillar.table;\n\n                // Defer the resizing to avoid any interference among cells.\n                CKEDITOR.tools.setTimeout(function(leftCell, leftOldWidth, rightCell, rightOldWidth, tableWidth, sizeShift) {\n                    // 1px is the minimum valid width (#11626).\n                    leftCell && leftCell.setStyle('width', pxUnit(Math.max(leftOldWidth + sizeShift, 1)));\n                    rightCell && rightCell.setStyle('width', pxUnit(Math.max(rightOldWidth - sizeShift, 1)));\n\n                    // If we're in the last cell, we need to resize the table as well\n                    if (tableWidth) {\n                        table.setStyle('width', pxUnit(tableWidth + sizeShift * (rtl ? -1 : 1)));\n                    }\n                }, 0, this, [\n                    leftCell, leftCell && getWidth(leftCell),\n                    rightCell, rightCell && getWidth(rightCell), (!leftCell || !rightCell) && (getWidth(table) + getBorderWidth(table, 'left') + getBorderWidth(table, 'right')),\n                    currentShift\n                ]);\n            }\n        }\n\n        function onMouseDown(evt) {\n            cancel(evt);\n\n            resizeStart();\n\n            document.on('mouseup', onMouseUp, this);\n        }\n\n        function onMouseUp(evt) {\n            evt.removeListener();\n\n            resizeEnd();\n        }\n\n        function onMouseMove(evt) {\n            move(evt.data.getPageOffset().x);\n        }\n\n        document = editor.document;\n\n        resizer = CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on ' +\n            'style=\"position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;' +\n            'padding:0;background-color:#004;background-image:none;border:0px none;z-index:10\"></div>', document);\n\n        // Clean DOM when editor is destroyed.\n        editor.on('destroy', function() {\n            resizer.remove();\n        });\n\n        // Place the resizer after body to prevent it\n        // from being editable.\n        document.getDocumentElement().append(resizer);\n\n        this.attachTo = function(targetPillar) {\n            // Accept only one pillar at a time.\n            if (isResizing) {\n                return;\n            }\n\n            pillar = targetPillar;\n\n            resizer.setStyles({\n                width: pxUnit(targetPillar.width),\n                height: pxUnit(targetPillar.height),\n                left: pxUnit(targetPillar.x),\n                top: pxUnit(targetPillar.y)\n            });\n\n            resizer.on('mousedown', onMouseDown, this);\n\n            document.getBody().setStyle('cursor', 'col-resize');\n\n            // Display the resizer to receive events but don't show it,\n            // only change the cursor to resizable shape.\n            resizer.show();\n        };\n\n        var move = this.move = function(posX) {\n            if (!pillar){\n                return 0;\n            }\n\n            if (!isResizing && (posX < pillar.x || posX > (pillar.x + pillar.width))) {\n                detach();\n                return 0;\n            }\n\n            var resizerNewPosition = posX - Math.round(resizer.$.offsetWidth / 2);\n\n            if (isResizing) {\n                if (resizerNewPosition === leftShiftBoundary || resizerNewPosition === rightShiftBoundary) {\n                    return 1;\n                }\n\n                resizerNewPosition = Math.max(resizerNewPosition, leftShiftBoundary);\n                resizerNewPosition = Math.min(resizerNewPosition, rightShiftBoundary);\n\n                currentShift = resizerNewPosition - startOffset;\n            }\n\n            resizer.setStyle('left', pxUnit(resizerNewPosition));\n\n            return 1;\n        };\n    }\n\n    function clearPillarsCache(evt) {\n        var target = evt.data.getTarget();\n\n        if (evt.name === 'mouseout') {\n            // Bypass interal mouse move.\n            if (!target.is('table')) {\n                return;\n            }\n\n            var dest = new CKEDITOR.dom.element(evt.data.$.relatedTarget || evt.data.$.toElement);\n            while (dest && dest.$ && !dest.equals(target) && !dest.is('body')) {\n                dest = dest.getParent();\n            }\n            if (!dest || dest.equals(target)) {\n                return;\n            }\n        }\n\n        target.getAscendant('table', 1).removeCustomData('_cke_table_pillars');\n        evt.removeListener();\n    }\n\n    CKEDITOR.plugins.add('ae_tableresize', {\n        requires: 'ae_tabletools',\n\n        init: function(editor) {\n            editor.on('contentDom', function() {\n                var resizer,\n                    editable = editor.editable();\n\n                // In Classic editor it is better to use document\n                // instead of editable so event will work below body.\n                editable.attachListener(editable.isInline() ? editable : editor.document, 'mousemove', function(evt) {\n                    evt = evt.data;\n\n                    var target = evt.getTarget();\n\n                    // FF may return document and IE8 some UFO (object with no nodeType property...)\n                    // instead of an element (#11823).\n                    if (target.type !== CKEDITOR.NODE_ELEMENT) {\n                        return;\n                    }\n\n                    var pageX = evt.getPageOffset().x;\n\n                    // If we're already attached to a pillar, simply move the\n                    // resizer.\n                    if (resizer && resizer.move(pageX)) {\n                        cancel(evt);\n                        return;\n                    }\n\n                    // Considering table, tr, td, tbody but nothing else.\n                    var table, pillars;\n\n                    if (!target.is('table') && !target.getAscendant('tbody', 1)) {\n                        return;\n                    }\n\n                    table = target.getAscendant('table', 1);\n\n                    // Make sure the table we found is inside the container\n                    // (eg. we should not use tables the editor is embedded within)\n                    if (!editor.editable().contains(table)) {\n                        return;\n                    }\n\n                    if (!(pillars = table.getCustomData('_cke_table_pillars'))) {\n                        // Cache table pillars calculation result.\n                        table.setCustomData('_cke_table_pillars', (pillars = buildTableColumnPillars(table)));\n                        table.on('mouseout', clearPillarsCache);\n                        table.on('mousedown', clearPillarsCache);\n                    }\n\n                    var pillar = getPillarAtPosition(pillars, pageX);\n                    if (pillar) {\n                        !resizer && (resizer = new columnResizer(editor));\n                        resizer.attachTo(pillar);\n                    }\n                });\n            });\n        }\n    });\n\n}());\n","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_selectionkeystrokes')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin that simulates editor interaction events based on manual keystrokes. This\n     * can be used to trigger different reactions in the editor.\n     *\n     * @class CKEDITOR.plugins.ae_selectionkeystrokes\n     */\n    CKEDITOR.plugins.add(\n        'ae_selectionkeystrokes', {\n            requires: 'ae_selectionregion',\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function adds a command to the editor for every defined selectionKeystroke\n             * in the configuration and maps it to the specified keystroke.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                if (editor.config.selectionKeystrokes) {\n                    editor.config.selectionKeystrokes.forEach(function(selectionKeystroke) {\n                        var command = new CKEDITOR.command(editor, {\n                            exec: function(editor) {\n                                editor.fire('editorInteraction', {\n                                    manualSelection: selectionKeystroke.selection,\n                                    nativeEvent: {},\n                                    selectionData: editor.getSelectionData()\n                                });\n                            }\n                        });\n\n                        var commandName = 'selectionKeystroke' + selectionKeystroke.selection;\n\n                        editor.addCommand(commandName, command);\n                        editor.setKeystroke(selectionKeystroke.keys, commandName);\n                    });\n                }\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_placeholder')) {\n        return;\n    }\n\n    /**\n     * CKEDITOR enterMode config set the behavior of paragraphs\n     * When the content is empty CKEDITOR keeps the enterMode string\n     * into the content\n     * @property\n     * @type {string}\n     */\n    var brFiller = CKEDITOR.env.needsBrFiller ? '<br>' : '';\n\n    var enterModeEmptyValue = {\n        1: ['<p>' + brFiller + '</p>'],\n        2: ['', ' ', brFiller],\n        3: ['<div>' + brFiller + '</div>']\n    };\n\n    /**\n     * CKEditor plugin which allows adding a placeholder to the editor. In this case, if there\n     * is no content to the editor, there will be hint to the user.\n     *\n     * @class CKEDITOR.plugins.ae_placeholder\n     */\n\n    /**\n     * Specifies the placeholder class which have to be aded to editor when editor is not focused.\n     *\n     * @attribute placeholderClass\n     * @default ae_placeholder\n     * @type String\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_placeholder', {\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'blur' and 'contentDom' event listeners.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.on('blur', this._checkEmptyData, this);\n                editor.on('change', this._checkEmptyData, this);\n                editor.on('focus', this._removePlaceholderClass, this);\n                editor.once('contentDom', this._checkEmptyData, this);\n            },\n\n            /**\n             * Removes any data from the content and adds a class,\n             * specified by the \"placeholderClass\" config attribute.\n             *\n             * @protected\n             * @method _checkEmptyData\n             * @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n             */\n            _checkEmptyData: function(event) {\n                var editor = event.editor;\n\n                var editableNode = editor.editable();\n\n                var innerHtml = editableNode.$.innerHTML.trim();\n\n                var isEmpty = enterModeEmptyValue[editor.config.enterMode].some(function(element) {\n                    return innerHtml === element;\n                });\n\n                if (isEmpty) {\n                    editableNode.addClass(editor.config.placeholderClass);\n                } else {\n                    editableNode.removeClass(editor.config.placeholderClass);\n                }\n            },\n\n            /**\n             * Remove placeholder class when input is focused\n             *\n             * @protected\n             * @method _removePlaceholderClass\n             + @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n             */\n            _removePlaceholderClass: function(event) {\n                var editor = event.editor;\n\n                var editorNode = new CKEDITOR.dom.element(editor.element.$);\n\n                editorNode.removeClass(editor.config.placeholderClass);\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_pasteimages')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin which allows pasting images directly into the editable area. The image will be encoded\n     * as Data URI. An event `beforeImageAdd` will be fired with the list of pasted images. If any of the listeners\n     * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n     * an event `imageAdd` will be fired with the inserted element into the editable area.\n     *\n     * @class CKEDITOR.plugins.ae_pasteimages\n     */\n\n    /**\n     * Fired before adding images to the editor.\n     * @event beforeImageAdd\n     * @param {Array} imageFiles Array of image files\n     */\n\n    /**\n     * Fired when an image is being added to the editor successfully.\n     *\n     * @event imageAdd\n     * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n     * @param {File} file The image file\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_pasteimages', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'paste' event on the editing area.\n             *\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'paste', this._onPaste, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * The function creates an img element with src the image data as Data URI.\n             * Then, it fires an 'imageAdd' event via CKEditor's event system. The passed\n             * params will be:\n             * - `el` - the created img element\n             * - `file` - the original pasted data\n             *\n             * @method _onPaste\n             * @protected\n             * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n             */\n            _onPaste: function(event) {\n                if (event.data.$.clipboardData) {\n                    var pastedData = event.data.$.clipboardData.items[0];\n                    var editor = event.listenerData.editor;\n\n                    if (pastedData.type.indexOf('image') === 0) {\n                        var reader = new FileReader();\n                        var imageFile = pastedData.getAsFile();\n\n                        reader.onload = function(event) {\n                            var result = editor.fire('beforeImageAdd', {\n                                imageFiles: imageFile\n                            });\n\n                            if (!!result) {\n                                var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + event.target.result + '\">');\n\n                                editor.insertElement(el);\n\n                                var imageData = {\n                                    el: el,\n                                    file: imageFile\n                                };\n\n                                editor.fire('imageAdd', imageData);\n                            }\n                        }.bind(this);\n\n                        reader.readAsDataURL(imageFile);\n                    }\n                }\n            }\n        }\n    );\n}());","import SelectionTest from '../selections/selection-test.js';\n\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_imagealignment')) {\n        return;\n    }\n\n    /**\n     * Enum for supported image alignments\n     * @type {Object}\n     */\n    var IMAGE_ALIGNMENT = {\n        CENTER: 'center',\n        LEFT: 'left',\n        RIGHT: 'right'\n    };\n\n    /**\n     * Enum values for supported image alignments\n     * @type {Array}\n     */\n    var ALIGN_VALUES = [\n        IMAGE_ALIGNMENT.LEFT,\n        IMAGE_ALIGNMENT.RIGHT,\n        IMAGE_ALIGNMENT.CENTER\n    ];\n\n    /**\n     * Necessary styles for the center alignment\n     * @type {Array.<Object>}\n     */\n    var CENTERED_IMAGE_STYLE = [{\n        name: 'display',\n        value: 'block'\n    }, {\n        name: 'margin-left',\n        value: 'auto'\n    }, {\n        name: 'margin-right',\n        value: 'auto'\n    }];\n\n    /**\n     * Retrieves the alignment value of an image.\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @return {String} The alignment value\n     */\n    var getImageAlignment = function(image) {\n        var imageAlignment = image.getStyle('float');\n\n        if (!imageAlignment || imageAlignment === 'inherit' || imageAlignment === 'none') {\n            imageAlignment = image.getAttribute('align');\n        }\n\n        if (!imageAlignment) {\n            var centeredImage = CENTERED_IMAGE_STYLE.every(function(style) {\n                var styleCheck = image.getStyle(style.name) === style.value;\n\n                if (!styleCheck && style.vendorPrefixes) {\n                    styleCheck = style.vendorPrefixes.some(function(vendorPrefix) {\n                        return image.getStyle(vendorPrefix + style.name) === style.value;\n                    });\n                }\n\n                return styleCheck;\n            });\n\n            imageAlignment = centeredImage ? IMAGE_ALIGNMENT.CENTER : null;\n        }\n\n        return imageAlignment;\n    };\n\n    /**\n     * Removes the alignment value of an image\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @param {String} imageAlignment The image alignment value to be removed\n     */\n    var removeImageAlignment = function(image, imageAlignment) {\n        if (imageAlignment === IMAGE_ALIGNMENT.LEFT || imageAlignment === IMAGE_ALIGNMENT.RIGHT) {\n            image.removeStyle('float');\n\n            if (imageAlignment === getImageAlignment(image)) {\n                image.removeAttribute('align');\n            }\n        } else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n            CENTERED_IMAGE_STYLE.forEach(function(style) {\n                image.removeStyle(style.name);\n\n                if (style.vendorPrefixes) {\n                    style.vendorPrefixes.forEach(function(vendorPrefix) {\n                        image.removeStyle(vendorPrefix + style.name);\n                    });\n                }\n            });\n        }\n    };\n\n    /**\n     * Sets the alignment value of an image\n     *\n     * @param {CKEDITOR.dom.element} image The image element\n     * @param {String} imageAlignment The image alignment value to be set\n     */\n    var setImageAlignment = function(image, imageAlignment) {\n        removeImageAlignment(image, getImageAlignment(image));\n\n        if (imageAlignment === IMAGE_ALIGNMENT.LEFT || imageAlignment === IMAGE_ALIGNMENT.RIGHT) {\n            image.setStyle('float', imageAlignment);\n        } else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n            CENTERED_IMAGE_STYLE.forEach(function(style) {\n                image.setStyle(style.name, style.value);\n\n                if (style.vendorPrefixes) {\n                    style.vendorPrefixes.forEach(function(vendorPrefix) {\n                        image.setStyle(vendorPrefix + style.name, style.value);\n                    });\n                }\n            });\n        }\n    };\n\n    /**\n     * CKEditor plugin which modifies the justify commands to properly align images. This\n     * plugin is an excerpt of CKEditor's original image one that can be found at\n     * https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/image/plugin.js\n     *\n     * @class CKEDITOR.plugins.ae_imagealignment\n     */\n    CKEDITOR.plugins.add(\n        'ae_imagealignment', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'paste' event on the editing area.\n             *\n             * @method afterInit\n             * @param {Object} editor The current editor instance\n             */\n            afterInit: function(editor) {\n                var self = this;\n\n                ALIGN_VALUES.forEach(function(value) {\n                    var command = editor.getCommand('justify' + value);\n\n                    if (command) {\n                        command.on('exec', function(event) {\n                            var selectionData = editor.getSelectionData();\n\n                            if (selectionData && SelectionTest.image({data: {selectionData: selectionData}})) {\n                                var image = selectionData.element;\n\n                                var imageAlignment = getImageAlignment(image);\n\n                                if (imageAlignment === value) {\n                                    removeImageAlignment(image, value);\n                                } else {\n                                    setImageAlignment(image, value);\n                                }\n\n                                event.cancel();\n\n                                self.refreshCommands(editor, new CKEDITOR.dom.elementPath(image));\n                            }\n                        });\n\n                        command.on('refresh', function(event) {\n                            var selectionData = {\n                                element: event.data.path.lastElement\n                            };\n\n                            if (SelectionTest.image({data: {selectionData: selectionData}})) {\n                                var imageAlignment = getImageAlignment(selectionData.element);\n\n                                this.setState(imageAlignment === value ? CKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF);\n\n                                event.cancel();\n                            }\n                        });\n                    }\n                });\n            },\n\n            /**\n             * Forces a refresh of the modified justify commands. This is needed because the applied changes\n             * do not modify the selection, so the refresh is never triggered and the UI does not update\n             * properly until the next selectionChange event.\n             *\n             * @param {CKEDITOR.editor} editor The editor instance\n             * @param {CKEDITOR.dom.elementPath} elementPath The path of the selected image\n             */\n            refreshCommands: function(editor, elementPath) {\n                ALIGN_VALUES.forEach(function(value) {\n                    var command = editor.getCommand('justify' + value);\n\n                    if (command) {\n                        command.refresh(editor, elementPath);\n                    }\n                });\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    /* istanbul ignore if */\n    if (CKEDITOR.plugins.get('ae_embed')) {\n        return;\n    }\n\n    var REGEX_HTTP = /^https?/;\n\n    var REGEX_DEFAULT_LINK = /<a href=/;\n\n    var PROVIDERS = ['youtube', 'twitter'];\n\n    CKEDITOR.DEFAULT_AE_EMBED_URL_TPL = 'http://alloy.iframe.ly/api/oembed?url={url}&callback={callback}';\n    CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL = '<div data-ae-embed-url=\"{url}\"></div>';\n    CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL = '<a href=\"{url}\">{url}</a>';\n    /**\n     * CKEditor plugin which adds the infrastructure to embed urls as media objects using an oembed\n     * service. By default, and for demoing purposes only, the oembed service is hosted in iframe.ly\n     * at //alloy.iframe.ly/api/oembed?url={url}&callback={callback}. Note this should be changed to\n     * a self-hosted or paid service in production environments. Access to the alloy.iframe.ly endpoint\n     * may be restricted per domain due to significant traffic.\n     *\n     * This plugin adds an `embedUrl` command that can be used to easily embed a URL and transform it\n     * to an embedded content.\n     *\n     * @class CKEDITOR.plugins.ae_embed\n     */\n    CKEDITOR.plugins.add(\n        'ae_embed', {\n            requires: 'widget',\n            init: function(editor) {\n                var AE_EMBED_URL_TPL = new CKEDITOR.template(editor.config.embedUrlTemplate || CKEDITOR.DEFAULT_AE_EMBED_URL_TPL);\n                var AE_EMBED_WIDGET_TPL = new CKEDITOR.template(editor.config.embedWidgetTpl || CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL);\n                var AE_EMBED_DEFAULT_LINK_TPL = new CKEDITOR.template(editor.config.embedLinkDefaultTpl || CKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL);\n\n                // Default function to upcast DOM elements to embed widgets.\n                // It matches CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL\n                var defaultEmbedWidgetUpcastFn = function(element, data) {\n                    if (element.name === 'div' && element.attributes['data-ae-embed-url']) {\n                        data.url = element.attributes['data-ae-embed-url'];\n\n                        return true;\n                    }\n                };\n\n                // Create a embedUrl command that can be invoked to easily embed media URLs\n                editor.addCommand('embedUrl', {\n                    exec: function(editor, data) {\n                        editor.insertHtml(\n                            AE_EMBED_WIDGET_TPL.output({\n                                url: data.url\n                            })\n                        );\n                    }\n                });\n\n                // Create a widget to properly handle embed operations\n                editor.widgets.add('ae_embed', {\n\n\n                    mask: true,\n                    requiredContent: 'div[data-ae-embed-url]',\n\n                    /**\n                     * Listener to be executed every time the widget's data changes. It takes care of\n                     * requesting the embed object to the configured oembed service and render it in\n                     * the editor\n                     *\n                     * @method data\n                     * @param {event} event Data change event\n                     */\n                    data: function(event) {\n                        var widget = this;\n\n                        var url = event.data.url;\n\n                        if (url) {\n                            CKEDITOR.tools.jsonp(AE_EMBED_URL_TPL, {\n                                url: encodeURIComponent(url)\n                            }, function(response) {\n                                if (response.html) {\n                                    if (REGEX_DEFAULT_LINK.test(response.html)) {\n                                        widget.createATag(url);\n                                    } else {\n                                        widget.element.setHtml(response.html);\n                                    }\n                                } else {\n                                    widget.createATag(url);\n                                }\n                            }, function(msg) {\n                                widget.createATag(url);\n                            });\n                        }\n                    },\n\n                    createATag: function(url) {\n                        this.editor.execCommand('undo');\n\n                        var currentSelection = this.editor.getSelection().getSelectedElement();\n\n                        var aTagHtml = AE_EMBED_DEFAULT_LINK_TPL.output({\n                            url: url\n                        });\n\n                        this.editor.insertHtml(aTagHtml);\n                        this.editor.fire('actionPerformed', this);\n                    },\n\n                    /**\n                     * Function used to upcast an element to ae_embed widgets.\n                     *\n                     * @method upcast\n                     * @param {CKEDITOR.htmlParser.element} element The element to be checked\n                     * @param {Object} data The object that will be passed to the widget\n                     */\n                    upcast: function(element, data) {\n                        var embedWidgetUpcastFn = editor.config.embedWidgetUpcastFn || defaultEmbedWidgetUpcastFn;\n\n                        return embedWidgetUpcastFn(element, data);\n                    }\n                });\n\n                // Add a listener to handle paste events and turn links into embed objects\n                editor.once('contentDom', function() {\n                    editor.on('paste', function(event) {\n                        var link = event.data.dataValue;\n\n                        if (REGEX_HTTP.test(link)) {\n                            event.stop();\n\n                            editor.execCommand('embedUrl', {\n                                url: event.data.dataValue\n                            });\n                        }\n                    });\n                });\n\n                // Add a listener to handle selection change events and properly detect editor\n                // interactions on the widgets without messing with widget native selection\n                editor.on('selectionChange', function(event) {\n                    var selection = editor.getSelection();\n\n                    if (selection){\n                        var element = selection.getSelectedElement();\n\n                        if (element) {\n                            var widgetElement = element.findOne('[data-widget=\"ae_embed\"]');\n\n                            if (widgetElement) {\n                                var region = element.getClientRect();\n\n                                var scrollPosition = new CKEDITOR.dom.window(window).getScrollPosition();\n                                region.left -= scrollPosition.x;\n                                region.top += scrollPosition.y;\n\n                                region.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\n                                editor.fire('editorInteraction', {\n                                    nativeEvent: {},\n                                    selectionData: {\n                                        element: widgetElement,\n                                        region: region\n                                    }\n                                });\n                            }\n                        }\n                    }\n                });\n\n                // Add a filter to skip filtering widget elements\n                editor.filter.addElementCallback(function(element) {\n                    if ('data-ae-embed-url' in element.attributes) {\n                        return CKEDITOR.FILTER_SKIP_TREE;\n                    }\n                });\n            }\n        }\n    );\n}());","/**\n * CKEditor plugin: Image2\n * - Show gripper to resize images on IE\n */\n(function () {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_dragresize_ie')) {\n        return;\n    }\n\n    var alignmentsObj = {\n        center: 1,\n        left: 0,\n        right: 2\n    };\n\n    /*\n     * Set cursor css depend on imageScaleResize config\n     **/\n\n    var cursor = {\n        both: 'nwse-resize',\n        height: 'ns-resize',\n        scale: 'nwse-resize',\n        width: 'ew-resize',\n    };\n\n    var regexPercent = /^\\s*(\\d+\\%)\\s*$/i;\n\n    var template = '<img alt=\"\" src=\"\" />';\n\n    CKEDITOR.plugins.add('ae_dragresize_ie', {\n        hidpi: true,\n\n        icons: 'image',\n\n        init: function (editor) {\n            var image = widgetDef(editor);\n\n            // Register the widget.\n            editor.widgets.add('image', image);\n        },\n\n        onLoad: function () {\n            CKEDITOR.addCss(\n                '.cke_image_resizer_nwse-resize{' +\n                'cursor: nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_ns-resize{' +\n                'cursor: ns-resize;' +\n                '}' +\n                '.cke_image_resizer_nwse-resize{' +\n                'cursor: nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_ew-resize{' +\n                'cursor: ew-resize;' +\n                '}' +\n                '.cke_image_nocaption{' +\n                // This is to remove unwanted space so resize\n                // wrapper is displayed property.\n                'line-height:0' +\n                '}' +\n                '.cke_image_resizer{' +\n                'display:none;' +\n                'position:absolute;' +\n                'width:10px;' +\n                'height:10px;' +\n                'bottom:-5px;' +\n                'right:-5px;' +\n                'background:#000;' +\n                'outline:1px solid #fff;' +\n                // Prevent drag handler from being misplaced (#11207).\n                'line-height:0;' +\n                'cursor:nwse-resize;' +\n                '}' +\n                '.cke_image_resizer_wrapper{' +\n                'position:relative;' +\n                'display:inline-block;' +\n                'line-height:0;' +\n                '}' +\n                '.cke_widget_wrapper:hover .cke_image_resizer,' +\n                '.cke_image_resizer.cke_image_resizing{' +\n                'display:block' +\n                '}'\n            );\n        },\n\n        requires: 'widget'\n    });\n\n    // Wiget states (forms) depending on alignment and configuration.\n    //\n    // Non-captioned widget (inline styles)\n    // \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n    // \t\t│Align │Internal form                  │Data                         │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│none  │<wrapper>                      │<img />                      │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│left  │<wrapper style=”float:left”>   │<img style=”float:left” />   │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│center│<wrapper>                      │<p style=”text-align:center”>│\n    // \t\t│      │ <p style=”text-align:center”> │  <img />                    │\n    // \t\t│      │   <img />                     │</p>                         │\n    // \t\t│      │ </p>                          │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│right │<wrapper style=”float:right”>  │<img style=”float:right” />  │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n    //\n    // Non-captioned widget (config.image2_alignClasses defined)\n    // \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n    // \t\t│Align │Internal form                  │Data                         │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│none  │<wrapper>                      │<img />                      │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│left  │<wrapper class=”left”>         │<img class=”left” />         │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│center│<wrapper>                      │<p class=”center”>           │\n    // \t\t│      │ <p class=”center”>            │ <img />                     │\n    // \t\t│      │   <img />                     │</p>                         │\n    // \t\t│      │ </p>                          │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n    // \t\t│right │<wrapper class=”right”>        │<img class=”right” />        │\n    // \t\t│      │ <img />                       │                             │\n    // \t\t│      │</wrapper>                     │                             │\n    // \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n    //\n    // Captioned widget (inline styles)\n    // \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n    // \t\t│Align │Internal form                           │Data                                    │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│none  │<wrapper>                               │<figure />                              │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│left  │<wrapper style=”float:left”>            │<figure style=”float:left” />           │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│center│<wrapper style=”text-align:center”>     │<div style=”text-align:center”>         │\n    // \t\t│      │ <figure style=”display:inline-block” />│ <figure style=”display:inline-block” />│\n    // \t\t│      │</wrapper>                              │</p>                                    │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│right │<wrapper style=”float:right”>           │<figure style=”float:right” />          │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n    //\n    // Captioned widget (config.image2_alignClasses defined)\n    // \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n    // \t\t│Align │Internal form                           │Data                                    │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│none  │<wrapper>                               │<figure />                              │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│left  │<wrapper class=”left”>                  │<figure class=”left” />                 │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│center│<wrapper class=”center”>                │<div class=”center”>                    │\n    // \t\t│      │ <figure />                             │ <figure />                             │\n    // \t\t│      │</wrapper>                              │</p>                                    │\n    // \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n    // \t\t│right │<wrapper class=”right”>                 │<figure class=”right” />                │\n    // \t\t│      │ <figure />                             │                                        │\n    // \t\t│      │</wrapper>                              │                                        │\n    // \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function widgetDef(editor) {\n        editor.config.imageScaleResize = editor.config.imageScaleResize || 'both';\n\n        editor.on('imageAdd', function (imageData) {\n            editor.widgets.initOn(imageData.data.el, 'image');\n        });\n\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var captionedClass = editor.config.image2_captionedClass;\n\n        return {\n            init: function () {\n                var helpers = CKEDITOR.plugins.image2;\n\n                var image = this.parts.image;\n\n                var data = {\n                    alt: image.getAttribute('alt') || '',\n                    hasCaption: !!this.parts.caption,\n                    height: image.getAttribute('height') || '',\n                    // Lock ratio is on by default (#10833).\n                    lock: this.ready ? helpers.checkHasNaturalRatio(image) : true,\n                    src: image.getAttribute('src'),\n                    width: image.getAttribute('width') || ''\n                };\n\n                // If we used 'a' in widget#parts definition, it could happen that\n                // selected element is a child of widget.parts#caption. Since there's no clever\n                // way to solve it with CSS selectors, it's done like that. (#11783).\n                var link = image.getAscendant('a');\n\n                if (link && this.wrapper.contains(link)) {\n                    this.parts.link = link;\n                }\n\n                // Depending on configuration, read style/class from element and\n                // then remove it. Removed style/class will be set on wrapper in #data listener.\n                // Note: Center alignment is detected during upcast, so only left/right cases\n                // are checked below.\n                if (!data.align) {\n                    var alignElement = data.hasCaption ? this.element : image;\n\n                    // Read the initial left/right alignment from the class set on element.\n                    if (alignClasses) {\n                        if (alignElement.hasClass(alignClasses[0])) {\n                            data.align = 'left';\n                        } else if (alignElement.hasClass(alignClasses[2])) {\n                            data.align = 'right';\n                        }\n\n                        if (data.align) {\n                            alignElement.removeClass(alignClasses[alignmentsObj[data.align]]);\n                        } else {\n                            data.align = 'none';\n                        }\n                    }\n                    // Read initial float style from figure/image and then remove it.\n                    else {\n                        data.align = alignElement.getStyle('float') || 'none';\n                        alignElement.removeStyle('float');\n                    }\n                }\n\n                // Get rid of extra vertical space when there's no caption.\n                // It will improve the look of the resizer.\n                this.wrapper[(data.hasCaption ? 'remove' : 'add') + 'Class']('cke_image_nocaption');\n\n                this.setData(data);\n\n                if (editor.config.image2_disableResizer !== true) {\n                    setupResizer(this);\n                }\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#addClass\n            addClass: function (className) {\n                getStyleableElement(this).addClass(className);\n            },\n\n            allowedContent: getWidgetAllowedContent(editor),\n\n            // This widget converts style-driven dimensions to attributes.\n            contentTransformations: [\n                ['img[width]: sizeToAttribute']\n            ],\n\n            data: function () {\n                var features = this.features;\n\n                // Image can't be captioned when figcaption is disallowed (#11004).\n                if (this.data.hasCaption && !editor.filter.checkFeature(features.caption)) {\n                    this.data.hasCaption = false;\n                }\n\n                // Image can't be aligned when floating is disallowed (#11004).\n                if (this.data.align != 'none' && !editor.filter.checkFeature(features.align)) {\n                    this.data.align = 'none';\n                }\n\n                // Update widget.parts.link since it will not auto-update unless widget\n                // is destroyed and re-inited.\n                if (!this.data.link) {\n                    if (this.parts.link) {\n                        delete this.parts.link;\n                    }\n                } else {\n                    if (!this.parts.link) {\n                        this.parts.link = this.parts.image.getParent();\n                    }\n                }\n\n                this.parts.image.setAttributes({\n                    alt: this.data.alt,\n\n                    contenteditable: this.parts.image.getAttribute('contenteditable') ? this.parts.image.getAttribute('contenteditable') : true,\n\n                    // This internal is required by the editor.\n                    'data-cke-saved-src': this.data.src,\n\n                    src: this.data.src\n                });\n\n                // If shifting non-captioned -> captioned, remove classes\n                // related to styles from <img/>.\n                if (this.oldData && !this.oldData.hasCaption && this.data.hasCaption) {\n                    for (var c in this.data.classes) {\n                        this.parts.image.removeClass(c);\n                    }\n                }\n\n                // Set dimensions of the image according to gathered data.\n                // Do it only when the attributes are allowed (#11004).\n                if (editor.filter.checkFeature(features.dimension)) {\n                    setDimensions(this);\n                }\n\n                // Cache current data.\n                this.oldData = CKEDITOR.tools.extend({}, this.data);\n            },\n\n            downcast: downcastWidgetElement(editor),\n\n            draggable: false,\n\n            // This widget has an editable caption.\n            editables: {\n                caption: {\n                    selector: 'figcaption',\n                    allowedContent: 'br em strong sub sup u s; a[!href,target]'\n                }\n            },\n\n            features: getWidgetFeatures(editor),\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#getClasses\n            getClasses: (function () {\n                var classRegex = new RegExp('^(' + [].concat(captionedClass, alignClasses).join('|') + ')$');\n\n                return function () {\n                    var classes = this.repository.parseElementClasses(getStyleableElement(this).getAttribute('class'));\n\n                    // Neither config.image2_captionedClass nor config.image2_alignClasses\n                    // do not belong to style classes.\n                    for (var c in classes) {\n                        if (classRegex.test(c)) {\n                            delete classes[c];\n                        }\n                    }\n\n                    return classes;\n                };\n            })(),\n\n            getLabel: function () {\n                var label = (this.data.alt || '') + ' ' + this.pathName;\n\n                return label;\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#hasClass\n            hasClass: function (className) {\n                return getStyleableElement(this).hasClass(className);\n            },\n\n            parts: {\n                caption: 'figcaption',\n                image: 'img'\n            },\n\n            // Overrides default method to handle internal mutability of Image2.\n            // @see CKEDITOR.plugins.widget#removeClass\n            removeClass: function (className) {\n                getStyleableElement(this).removeClass(className);\n            },\n\n            requiredContent: 'img[src,alt]',\n\n            styleableElements: 'img figure',\n\n            // Template of the widget: plain image.\n            template: template,\n\n            upcast: upcastWidgetElement(editor)\n        };\n    }\n\n    /**\n     * A set of Enhanced Image (image2) plugin helpers.\n     *\n     * @class\n     * @singleton\n     */\n    CKEDITOR.plugins.image2 = {\n        /**\n         * Checks whether the current image ratio matches the natural one\n         * by comparing dimensions.\n         *\n         * @param {CKEDITOR.dom.element} image\n         * @returns {Boolean}\n         */\n        checkHasNaturalRatio: function (image) {\n            var $ = image.$,\n                natural = this.getNatural(image);\n\n            // The reason for two alternative comparisons is that the rounding can come from\n            // both dimensions, e.g. there are two cases:\n            // \t1. height is computed as a rounded relation of the real height and the value of width,\n            //\t2. width is computed as a rounded relation of the real width and the value of heigh.\n            return Math.round($.clientWidth / natural.width * natural.height) == $.clientHeight ||\n                Math.round($.clientHeight / natural.height * natural.width) == $.clientWidth;\n        },\n\n        /**\n         * Returns natural dimensions of the image. For modern browsers\n         * it uses natural(Width|Height). For old ones (IE8) it creates\n         * a new image and reads the dimensions.\n         *\n         * @param {CKEDITOR.dom.element} image\n         * @returns {Object}\n         */\n        getNatural: function (image) {\n            var dimensions;\n\n            if (image.$.naturalWidth) {\n                dimensions = {\n                    height: image.$.naturalHeigh,\n                    width: image.$.naturalWidth\n                };\n            } else {\n                var img = new Image();\n\n                img.src = image.getAttribute('src');\n\n                dimensions = {\n                    height: img.heigh,\n                    width: img.width\n                };\n            }\n\n            return dimensions;\n        },\n    };\n\n    // Returns a function that creates widgets from all <img> and\n    // <figure class=\"{config.image2_captionedClass}\"> elements.\n    //\n    // @param {CKEDITOR.editor} editor\n    // @returns {Function}\n    function upcastWidgetElement(editor) {\n        var isCenterWrapper = centerWrapperChecker(editor);\n\n        var captionedClass = editor.config.image2_captionedClass;\n\n        // @param {CKEDITOR.htmlParser.element} el\n        // @param {Object} data\n        return function (el, data) {\n            var dimensions = {\n                height: 1,\n                width: 1\n            };\n\n            var name = el.name;\n\n            var image;\n\n            // #11110 Don't initialize on pasted fake objects.\n            if (el.attributes['data-cke-realelement']) {\n                return;\n            }\n\n            // If a center wrapper is found, there are 3 possible cases:\n            //\n            // 1. <div style=\"text-align:center\"><figure>...</figure></div>.\n            //    In this case centering is done with a class set on widget.wrapper.\n            //    Simply replace centering wrapper with figure (it's no longer necessary).\n            //\n            // 2. <p style=\"text-align:center\"><img/></p>.\n            //    Nothing to do here: <p> remains for styling purposes.\n            //\n            // 3. <div style=\"text-align:center\"><img/></div>.\n            //    Nothing to do here (2.) but that case is only possible in enterMode different\n            //    than ENTER_P.\n            if (isCenterWrapper(el)) {\n                if (name == 'div') {\n                    var figure = el.getFirst('figure');\n\n                    // Case #1.\n                    if (figure) {\n                        el.replaceWith(figure);\n                        el = figure;\n                    }\n                }\n                // Cases #2 and #3 (handled transparently)\n\n                // If there's a centering wrapper, save it in data.\n                data.align = 'center';\n\n                // Image can be wrapped in link <a><img/></a>.\n                image = el.getFirst('img') || el.getFirst('a').getFirst('img');\n            }\n\n            // No center wrapper has been found.\n            else if (name == 'figure' && el.hasClass(captionedClass)) {\n                image = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\n                // Upcast linked image like <a><img/></a>.\n            } else if (isLinkedOrStandaloneImage(el)) {\n                image = el.name == 'a' ? el.children[0] : el;\n            }\n\n            if (!image) {\n                return;\n            }\n\n            // If there's an image, then cool, we got a widget.\n            // Now just remove dimension attributes expressed with %.\n            for (var d in dimensions) {\n                var dimension = image.attributes[d];\n\n                if (dimension && dimension.match(regexPercent)) {\n                    delete image.attributes[d];\n                }\n            }\n\n            return el;\n        };\n    }\n\n    // Returns a function which transforms the widget to the external format\n    // according to the current configuration.\n    //\n    // @param {CKEDITOR.editor}\n    function downcastWidgetElement(editor) {\n        var alignClasses = editor.config.image2_alignClasses;\n\n        // @param {CKEDITOR.htmlParser.element} el\n        return function (el) {\n            // In case of <a><img/></a>, <img/> is the element to hold\n            // inline styles or classes (image2_alignClasses).\n            var attrsHolder = el.name == 'a' ? el.getFirst() : el;\n\n            var attrs = attrsHolder.attributes;\n\n            var align = this.data.align;\n\n            // De-wrap the image from resize handle wrapper.\n            // Only block widgets have one.\n            if (!this.inline) {\n                var resizeWrapper = el.getFirst('span');\n\n                if (resizeWrapper) {\n                    resizeWrapper.replaceWith(resizeWrapper.getFirst({\n                        a: 1,\n                        img: 1\n                    }));\n                }\n            }\n\n            if (align && align != 'none') {\n                var styles = CKEDITOR.tools.parseCssText(attrs.style || '');\n\n                // When the widget is captioned (<figure>) and internally centering is done\n                // with widget's wrapper style/class, in the external data representation,\n                // <figure> must be wrapped with an element holding an style/class:\n                //\n                // \t<div style=\"text-align:center\">\n                // \t\t<figure class=\"image\" style=\"display:inline-block\">...</figure>\n                // \t</div>\n                // or\n                // \t<div class=\"some-center-class\">\n                // \t\t<figure class=\"image\">...</figure>\n                // \t</div>\n                //\n                if (align == 'center' && el.name == 'figure') {\n                    el = el.wrapWith(new CKEDITOR.htmlParser.element('div',\n                        alignClasses ? {\n                            'class': alignClasses[1]\n                        } : {\n                            style: 'text-align:center'\n                        }));\n                }\n\n                // If left/right, add float style to the downcasted element.\n                else if (align in {\n                        left: 1,\n                        right: 1\n                    }) {\n                    if (alignClasses) {\n                        attrsHolder.addClass(alignClasses[alignmentsObj[align]]);\n                    } else {\n                        styles['float'] = align;\n                    }\n                }\n\n                // Update element styles.\n                if (!alignClasses && !CKEDITOR.tools.isEmpty(styles)) {\n                    attrs.style = CKEDITOR.tools.writeCssText(styles);\n                }\n            }\n\n            return el;\n        };\n    }\n\n    // Returns a function that checks if an element is a centering wrapper.\n    //\n    // @param {CKEDITOR.editor} editor\n    // @returns {Function}\n    function centerWrapperChecker(editor) {\n        var captionedClass = editor.config.image2_captionedClass;\n\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var validChildren = {\n            a: 1,\n            figure: 1,\n            img: 1\n        };\n\n        return function (el) {\n            // Wrapper must be either <div> or <p>.\n            if (!(el.name in {\n                    div: 1,\n                    p: 1\n                })) {\n                return false;\n            }\n\n            var children = el.children;\n\n            // Centering wrapper can have only one child.\n            if (children.length !== 1) {\n                return false;\n            }\n\n            var child = children[0];\n\n            // Only <figure> or <img /> can be first (only) child of centering wrapper,\n            // regardless of its type.\n            if (!(child.name in validChildren)) {\n                return false;\n            }\n\n            // If centering wrapper is <p>, only <img /> can be the child.\n            //   <p style=\"text-align:center\"><img /></p>\n            if (el.name == 'p') {\n                if (!isLinkedOrStandaloneImage(child)) {\n                    return false;\n                }\n            }\n            // Centering <div> can hold <img/> or <figure>, depending on enterMode.\n            else {\n                // If a <figure> is the first (only) child, it must have a class.\n                //   <div style=\"text-align:center\"><figure>...</figure><div>\n                if (child.name == 'figure') {\n                    if (!child.hasClass(captionedClass)) {\n                        return false;\n                    }\n                } else {\n                    // Centering <div> can hold <img/> or <a><img/></a> only when enterMode\n                    // is ENTER_(BR|DIV).\n                    //   <div style=\"text-align:center\"><img /></div>\n                    //   <div style=\"text-align:center\"><a><img /></a></div>\n                    if (editor.enterMode == CKEDITOR.ENTER_P) {\n                        return false;\n                    }\n\n                    // Regardless of enterMode, a child which is not <figure> must be\n                    // either <img/> or <a><img/></a>.\n                    if (!isLinkedOrStandaloneImage(child)) {\n                        return false;\n                    }\n                }\n            }\n\n            // Centering wrapper got to be... centering. If image2_alignClasses are defined,\n            // check for centering class. Otherwise, check the style.\n            if (alignClasses ? el.hasClass(alignClasses[1]) :\n                CKEDITOR.tools.parseCssText(el.attributes.style || '', true)['text-align'] == 'center') {\n                return true;\n            }\n\n            return false;\n        };\n    }\n\n    // Checks whether element is <img/> or <a><img/></a>.\n    //\n    // @param {CKEDITOR.htmlParser.element}\n    function isLinkedOrStandaloneImage(el) {\n        if (el.name == 'img') {\n            return true;\n        } else if (el.name == 'a') {\n            return el.children.length == 1 && el.getFirst('img');\n        }\n\n        return false;\n    }\n\n    // Sets width and height of the widget image according to current widget data.\n    //\n    // @param {CKEDITOR.plugins.widget} widget\n    function setDimensions(widget) {\n        var data = widget.data;\n\n        var dimensions = {\n            height: data.height,\n            width: data.width\n        };\n\n        var image = widget.parts.image;\n\n        for (var d in dimensions) {\n            if (dimensions[d]) {\n                image.setAttribute(d, dimensions[d]);\n            } else {\n                image.removeAttribute(d);\n            }\n        }\n    }\n\n    // Defines all features related to drag-driven image resizing.\n    //\n    // @param {CKEDITOR.plugins.widget} widget\n    function setupResizer(widget) {\n        var editor = widget.editor;\n\n        var editable = editor.editable();\n\n        var doc = editor.document;\n\n        // Store the resizer in a widget for testing (#11004).\n        var resizer = widget.resizer = doc.createElement('span');\n\n        resizer.addClass('cke_image_resizer');\n        resizer.addClass('cke_image_resizer_' + cursor[editor.config.imageScaleResize]);\n        resizer.append(new CKEDITOR.dom.text('\\u200b', doc));\n\n        // Inline widgets don't need a resizer wrapper as an image spans the entire widget.\n        if (!widget.inline) {\n            var imageOrLink = widget.parts.link || widget.parts.image;\n\n            var oldResizeWrapper = imageOrLink.getParent();\n\n            var resizeWrapper = doc.createElement('span');\n\n            resizeWrapper.addClass('cke_image_resizer_wrapper');\n            resizeWrapper.append(imageOrLink);\n            resizeWrapper.append(resizer);\n            widget.element.append(resizeWrapper, true);\n\n            // Remove the old wrapper which could came from e.g. pasted HTML\n            // and which could be corrupted (e.g. resizer span has been lost).\n            if (oldResizeWrapper.is('span')) {\n                oldResizeWrapper.remove();\n            }\n        } else {\n            widget.wrapper.append(resizer);\n        }\n\n        // Calculate values of size variables and mouse offsets.\n        resizer.on('mousedown', function (evt) {\n            var image = widget.parts.image;\n\n            // \"factor\" can be either 1 or -1. I.e.: For right-aligned images, we need to\n            // subtract the difference to get proper width, etc. Without \"factor\",\n            // resizer starts working the opposite way.\n            var factor = widget.data.align == 'right' ? -1 : 1;\n\n            // The x-coordinate of the mouse relative to the screen\n            // when button gets pressed.\n            var startX = evt.data.$.screenX;\n\n            var startY = evt.data.$.screenY;\n\n            // The initial dimensions and aspect ratio of the image.\n            var startWidth = image.$.clientWidth;\n\n            var startHeight = image.$.clientHeight;\n\n            var listeners = [];\n\n            // A class applied to editable during resizing.\n            var cursorClass = 'cke_image_s' + (!~factor ? 'w' : 'e');\n\n            var nativeEvt, newWidth, newHeight, updateData;\n\n            var moveDiffX, moveDiffY, moveRatio;\n\n            // Save the undo snapshot first: before resizing.\n            editor.fire('saveSnapshot');\n\n            // Mousemove listeners are removed on mouseup.\n            attachToDocuments('mousemove', onMouseMove, listeners);\n\n            // Clean up the mousemove listener. Update widget data if valid.\n            attachToDocuments('mouseup', onMouseUp, listeners);\n\n            // The entire editable will have the special cursor while resizing goes on.\n            editable.addClass(cursorClass);\n\n            // This is to always keep the resizer element visible while resizing.\n            resizer.addClass('cke_image_resizing');\n\n            // Attaches an event to a global document if inline editor.\n            // Additionally, if classic (`iframe`-based) editor, also attaches the same event to `iframe`'s document.\n            function attachToDocuments(name, callback, collection) {\n                var globalDoc = CKEDITOR.document;\n\n                var listeners = [];\n\n                if (!doc.equals(globalDoc)) {\n                    listeners.push(globalDoc.on(name, callback));\n                }\n\n                listeners.push(doc.on(name, callback));\n\n                if (collection) {\n                    for (var i = listeners.length; i--;) {\n                        collection.push(listeners.pop());\n                    }\n                }\n            }\n\n            // This is how variables refer to the geometry.\n            // Note: x corresponds to moveOffset, this is the position of mouse\n            // Note: o corresponds to [startX, startY].\n            //\n            // \t+--------------+--------------+\n            // \t|              |              |\n            // \t|      I       |      II      |\n            // \t|              |              |\n            // \t+------------- o -------------+ _ _ _\n            // \t|              |              |      ^\n\n            // \t|      VI      |     III      |      | moveDiffY\n            // \t|              |         x _ _ _ _ _ v\n            // \t+--------------+---------|----+\n            // \t               |         |\n            // \t                <------->\n            // \t                moveDiffX\n            function onMouseMove(evt) {\n                var imageScaleResize = editor.config.imageScaleResize;\n\n                nativeEvt = evt.data.$;\n\n                // This is how far the mouse is from the point the button was pressed.\n                moveDiffX = nativeEvt.screenX - startX;\n                moveDiffY = startY - nativeEvt.screenY;\n\n                // This is the aspect ratio of the move difference.\n                moveRatio = Math.abs(moveDiffX / moveDiffY);\n\n                if (imageScaleResize === 'width' || imageScaleResize === 'both' || imageScaleResize === 'scale') {\n                    newWidth = startWidth + factor * moveDiffX;\n                }\n\n                if (imageScaleResize === 'height' || imageScaleResize === 'both') {\n                    newHeight = startHeight - moveDiffY;\n                }\n\n                if (imageScaleResize === 'scale') {\n                    newHeight = 'auto';\n                }\n\n                newWidth = newWidth || startWidth;\n                newHeight = newHeight || startHeight;\n\n                // Don't update attributes if less than 10.\n                // This is to prevent images to visually disappear.\n                if (newWidth >= 15 && (newHeight >= 15 || newHeight === 'auto')) {\n                    image.setAttributes({\n                        width: newWidth,\n                        height: newHeight\n                    });\n                    updateData = true;\n                } else {\n                    updateData = false;\n                }\n            }\n\n            function onMouseUp() {\n                var l;\n\n                while ((l = listeners.pop())) {\n                    l.removeListener();\n                }\n\n                // Restore default cursor by removing special class.\n                editable.removeClass(cursorClass);\n\n                // This is to bring back the regular behaviour of the resizer.\n                resizer.removeClass('cke_image_resizing');\n\n                if (updateData) {\n                    widget.setData({\n                        height: newHeight,\n                        width: newWidth\n                    });\n\n                    // Save another undo snapshot: after resizing.\n                    editor.fire('saveSnapshot');\n                }\n\n                // Don't update data twice or more.\n                updateData = false;\n            }\n        });\n\n        // Change the position of the widget resizer when data changes.\n        widget.on('data', function () {\n            resizer[widget.data.align == 'right' ? 'addClass' : 'removeClass']('cke_image_resizer_left');\n        });\n\n        widget.parts.image.on('click', function () {\n\n            editor._.editable.editor.getSelection().selectElement(this);\n\n            var selectionData = editor._.editable.editor.getSelectionData();\n            if (selectionData) {\n                editor.fire('editorInteraction', {\n                    nativeEvent: event,\n                    selectionData: selectionData\n                });\n            }\n        });\n\n    }\n\n    // Returns a set of widget allowedContent rules, depending\n    // on configurations like config#image2_alignClasses or\n    // config#image2_captionedClass.\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function getWidgetAllowedContent(editor) {\n        var rules = {\n            figcaption: true,\n            figure: {\n                classes: '!' + editor.config.image2_captionedClass\n            },\n            img: {\n                attributes: '!src,alt,width,height'\n            }\n        };\n\n        return rules;\n    }\n\n    // Returns a set of widget feature rules, depending\n    // on editor configuration. Note that the following may not cover\n    // all the possible cases since requiredContent supports a single\n    // tag only.\n    //\n    // @param {CKEDITOR.editor}\n    // @returns {Object}\n    function getWidgetFeatures(editor) {\n        var alignClasses = editor.config.image2_alignClasses;\n\n        var features = {\n            align: {\n                requiredContent: 'img' +\n                    (alignClasses ? '(' + alignClasses[0] + ')' : '{float}')\n            },\n            caption: {\n                requiredContent: 'figcaption'\n            },\n            dimension: {\n                requiredContent: 'img[width,height]'\n            }\n        };\n\n        return features;\n    }\n\n    // Returns element which is styled, considering current\n    // state of the widget.\n    //\n    // @see CKEDITOR.plugins.widget#applyStyle\n    // @param {CKEDITOR.plugins.widget} widget\n    // @returns {CKEDITOR.dom.element}\n    function getStyleableElement(widget) {\n        return widget.data.hasCaption ? widget.element : widget.parts.image;\n    }\n})();\n\nCKEDITOR.config.image2_captionedClass = 'image';","/**\n * CKEditor plugin: Dragable image resizing\n * https://github.com/sstur/ck-dragresize\n * - Shows semi-transparent overlay while resizing\n * - Enforces Aspect Ratio (unless holding shift)\n * - Snap to size of other images in editor\n * - Escape while dragging cancels resize\n */\n(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_dragresize')) {\n        return;\n    }\n\n    var IMAGE_HANDLES = {\n        both: ['tl', 'tm', 'tr', 'lm', 'rm', 'bl', 'bm', 'br'],\n        height: ['tl', 'tm', 'tr', 'bl', 'bm', 'br'],\n        scale: ['tl', 'tr', 'bl', 'br'],\n        width: ['tl', 'tr', 'lm', 'rm', 'bl', 'br'],\n    };\n\n    var POSITION_ELEMENT_FN = {\n        bl: function(handle, left, top, box) {\n            positionElement(handle, -3 + left, box.height - 4 + top);\n        },\n        bm: function(handle, left, top, box) {\n            positionElement(handle, Math.round(box.width / 2) - 3 + left, box.height - 4 + top);\n        },\n        br: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, box.height - 4 + top);\n        },\n        lm: function(handle, left, top, box) {\n            positionElement(handle, -3 + left, Math.round(box.height / 2) - 3 + top);\n        },\n        tl: function(handle, left, top, box) {\n            positionElement(handle, left - 3, top - 3);\n        },\n        tm: function(handle, left, top, box) {\n            positionElement(handle, Math.round(box.width / 2) - 3 + left, -3 + top);\n        },\n        tr: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, -3 + top);\n        },\n        rm: function(handle, left, top, box) {\n            positionElement(handle, box.width - 4 + left, Math.round(box.height / 2) - 3 + top);\n        }\n    };\n\n    var IMAGE_SNAP_TO_SIZE = 7;\n\n    var isFirefox = ('MozAppearance' in document.documentElement.style);\n\n    var isWebKit = ('WebkitAppearance' in document.documentElement.style);\n\n    var enablePlugin = isWebKit || isFirefox;\n\n    if (enablePlugin) {\n        // CSS is added in a compressed form\n        CKEDITOR.addCss('img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}');\n    }\n\n    /**\n     * Initializes the plugin\n     */\n    CKEDITOR.plugins.add('ae_dragresize', {\n        onLoad: function() {\n            if (!enablePlugin) {\n                return;\n            }\n        },\n        init: function(editor) {\n            if (!enablePlugin) {\n                return;\n            }\n\n            editor.once('contentDom', function(evt) {\n                init(editor);\n            });\n        }\n    });\n\n    function init(editor) {\n        var window = editor.window.$,\n            document = editor.document.$;\n\n        if (isFirefox) {\n            // Disable the native image resizing\n            document.execCommand('enableObjectResizing', false, false);\n        }\n\n        var snapToSize = (typeof IMAGE_SNAP_TO_SIZE === 'undefined') ? null : IMAGE_SNAP_TO_SIZE;\n\n        editor.config.imageScaleResize = editor.config.imageScaleResize || 'both';\n\n        var resizer = new Resizer(editor, {\n            imageScaleResize: editor.config.imageScaleResize,\n            snapToSize: snapToSize\n        });\n\n        var mouseDownListener = function(e) {\n            if (resizer.isHandle(e.target)) {\n                resizer.initDrag(e);\n            }\n        };\n\n        document.addEventListener('mousedown', mouseDownListener, false);\n\n        function selectionChange() {\n            var selection = editor.getSelection();\n\n            if (!selection) return;\n            // If an element is selected and that element is an IMG\n            if (selection.getType() !== CKEDITOR.SELECTION_NONE && selection.getStartElement().is('img')) {\n                // And we're not right or middle clicking on the image\n                if (!window.event || !window.event.button || window.event.button === 0) {\n                    resizer.show(selection.getStartElement().$);\n                }\n            } else {\n                resizer.hide();\n            }\n        }\n\n        editor.on('selectionChange', selectionChange);\n\n        editor.on('getData', function(e) {\n            var html = e.data.dataValue || '';\n            html = html.replace(/<div id=\"ckimgrsz\"([\\s\\S]*?)<\\/div>/i, '');\n            html = html.replace(/\\b(ckimgrsz)\\b/g, '');\n            e.data.dataValue = html;\n        });\n\n        editor.on('beforeUndoImage', function() {\n            // Remove the handles before undo images are saved\n            resizer.hide();\n        });\n\n        editor.on('afterUndoImage', function() {\n            // Restore the handles after undo images are saved\n            selectionChange();\n        });\n\n        editor.on('blur', function() {\n            // Remove the handles when editor loses focus\n            resizer.hide();\n        });\n\n        editor.on('beforeModeUnload', function self() {\n            editor.removeListener('beforeModeUnload', self);\n            resizer.hide();\n        });\n\n        editor.on('destroy', function() {\n            var resizeElement = document.getElementById('ckimgrsz');\n\n            if (resizeElement) {\n                resizeElement.remove();\n            }\n\n            if (isFirefox) {\n                document.execCommand('enableObjectResizing', false, true);\n            }\n\n            document.removeEventListener('mousedown', mouseDownListener);\n        });\n\n        // Update the selection when the browser window is resized\n        var resizeTimeout;\n        editor.window.on('resize', function() {\n            // Cancel any resize waiting to happen\n            clearTimeout(resizeTimeout);\n            // Delay resize to \"debounce\"\n            resizeTimeout = setTimeout(selectionChange, 50);\n        });\n    }\n\n    function Resizer(editor, cfg) {\n        this.editor = editor;\n        this.window = editor.window.$;\n        this.document = editor.document.$;\n        this.cfg = cfg || {};\n        this.init();\n    }\n\n    Resizer.prototype = {\n        init: function() {\n            var instance = this;\n\n            var container = this.container = this.document.createElement('div');\n\n            container.id = 'ckimgrsz';\n            this.preview = this.document.createElement('span');\n            container.appendChild(this.preview);\n\n            var handles = this.handles = {};\n\n            IMAGE_HANDLES[this.cfg.imageScaleResize].forEach(function (handleName, index) {\n                handles[handleName] = instance.handles[handleName] = instance.createHandle(handleName);\n            });\n\n            for (var n in handles) {\n                container.appendChild(handles[n]);\n            }\n        },\n        createHandle: function(name) {\n            var el = this.document.createElement('i');\n            el.classList.add(name);\n            return el;\n        },\n        isHandle: function(el) {\n            var handles = this.handles;\n            for (var n in handles) {\n                if (handles[n] === el) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        show: function(el) {\n            this.el = el;\n            if (this.cfg.snapToSize) {\n                this.otherImages = toArray(this.document.getElementsByTagName('img'));\n                this.otherImages.splice(this.otherImages.indexOf(el), 1);\n            }\n            var box = this.box = getBoundingBox(this.window, el);\n            positionElement(this.container, box.left, box.top);\n            this.document.body.appendChild(this.container);\n            this.el.classList.add('ckimgrsz');\n            this.showHandles();\n        },\n        hide: function() {\n            // Remove class from all img.ckimgrsz\n            var elements = this.document.getElementsByClassName('ckimgrsz');\n            for (var i = 0; i < elements.length; ++i) {\n                elements[i].classList.remove('ckimgrsz');\n            }\n            this.hideHandles();\n            if (this.container.parentNode) {\n                this.container.parentNode.removeChild(this.container);\n            }\n        },\n        initDrag: function(e) {\n            if (e.button !== 0) {\n                //right-click or middle-click\n                return;\n            }\n            var resizer = this;\n            var drag = new DragEvent(this.window, this.document);\n            drag.onStart = function() {\n                resizer.showPreview();\n                resizer.isDragging = true;\n                resizer.editor.getSelection().lock();\n            };\n            drag.onDrag = function() {\n                resizer.calculateSize(this);\n                resizer.updatePreview();\n                var box = resizer.previewBox;\n                resizer.updateHandles(box, box.left, box.top);\n            };\n            drag.onRelease = function() {\n                resizer.isDragging = false;\n                resizer.hidePreview();\n                resizer.hide();\n                resizer.editor.getSelection().unlock();\n                // Save an undo snapshot before the image is permanently changed\n                resizer.editor.fire('saveSnapshot');\n            };\n            drag.onComplete = function() {\n                resizer.resizeComplete();\n                // Save another snapshot after the image is changed\n                resizer.editor.fire('saveSnapshot');\n            };\n            drag.start(e);\n        },\n        updateHandles: function(box, left, top) {\n            left = left || 0;\n            top = top || 0;\n            var handles = this.handles;\n\n            for (var handle in handles) {\n                POSITION_ELEMENT_FN[handle](handles[handle], left, top, box);\n            }\n        },\n        showHandles: function() {\n            var handles = this.handles;\n            this.updateHandles(this.box);\n            for (var n in handles) {\n                handles[n].style.display = 'block';\n            }\n        },\n        hideHandles: function() {\n            var handles = this.handles;\n            for (var n in handles) {\n                handles[n].style.display = 'none';\n            }\n        },\n        showPreview: function() {\n            this.preview.style.backgroundImage = 'url(\"' + this.el.src + '\")';\n            this.calculateSize();\n            this.updatePreview();\n            this.preview.style.display = 'block';\n        },\n        updatePreview: function() {\n            var box = this.previewBox;\n            positionElement(this.preview, box.left, box.top);\n            this.preview.style.width = this.previewBox.width + 'px';\n            this.preview.style.height = this.previewBox.height + 'px';\n        },\n        hidePreview: function() {\n            var box = getBoundingBox(this.window, this.preview);\n            this.result = {\n                width: box.width,\n                height: box.height\n            };\n            this.preview.style.display = 'none';\n        },\n        calculateSize: function(data) {\n            var box = this.previewBox = {\n                top: 0,\n                left: 0,\n                width: this.box.width,\n                height: this.box.height\n            };\n\n            if (!data) return;\n\n            var attr = data.target.className;\n\n            if (~attr.indexOf('r')) {\n                box.width = Math.max(32, this.box.width + data.delta.x);\n            }\n            if (~attr.indexOf('b')) {\n                box.height = Math.max(32, this.box.height + data.delta.y);\n            }\n            if (~attr.indexOf('l')) {\n                box.width = Math.max(32, this.box.width - data.delta.x);\n            }\n            if (~attr.indexOf('t')) {\n                box.height = Math.max(32, this.box.height - data.delta.y);\n            }\n            //if dragging corner, enforce aspect ratio (unless shift key is being held)\n            if (attr.indexOf('m') < 0 && !data.keys.shift) {\n                var ratio = this.box.width / this.box.height;\n                if (box.width / box.height > ratio) {\n                    box.height = Math.round(box.width / ratio);\n                } else {\n                    box.width = Math.round(box.height * ratio);\n                }\n            }\n\n            var snapToSize = this.cfg.snapToSize;\n\n            if (snapToSize) {\n                var others = this.otherImages;\n                for (var i = 0; i < others.length; i++) {\n                    var other = getBoundingBox(this.window, others[i]);\n                    if (Math.abs(box.width - other.width) <= snapToSize && Math.abs(box.height - other.height) <= snapToSize) {\n                        box.width = other.width;\n                        box.height = other.height;\n                        break;\n                    }\n                }\n            }\n\n            //recalculate left or top position\n            if (~attr.indexOf('l')) {\n                box.left = this.box.width - box.width;\n            }\n            if (~attr.indexOf('t')) {\n                box.top = this.box.height - box.height;\n            }\n        },\n        resizeComplete: function() {\n            resizeElement.call(this, this.el, this.result.width, this.result.height);\n        }\n    };\n\n    function DragEvent(window, document) {\n        this.window = window;\n        this.document = document;\n        this.events = {\n            mousemove: bind(this.mousemove, this),\n            keydown: bind(this.keydown, this),\n            mouseup: bind(this.mouseup, this)\n        };\n    }\n\n    DragEvent.prototype = {\n        start: function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.target = e.target;\n            this.attr = e.target.className;\n            this.startPos = {\n                x: e.clientX,\n                y: e.clientY\n            };\n            this.update(e);\n            var events = this.events;\n            this.document.addEventListener('mousemove', events.mousemove, false);\n            this.document.addEventListener('keydown', events.keydown, false);\n            this.document.addEventListener('mouseup', events.mouseup, false);\n            this.document.body.classList.add('dragging-' + this.attr);\n            this.onStart && this.onStart();\n        },\n        update: function(e) {\n            this.currentPos = {\n                x: e.clientX,\n                y: e.clientY\n            };\n            this.delta = {\n                x: e.clientX - this.startPos.x,\n                y: e.clientY - this.startPos.y\n            };\n            this.keys = {\n                shift: e.shiftKey,\n                ctrl: e.ctrlKey,\n                alt: e.altKey\n            };\n        },\n        mousemove: function(e) {\n            this.update(e);\n            this.onDrag && this.onDrag();\n            if (e.which === 0) {\n                //mouse button released outside window; mouseup wasn't fired (Chrome)\n                this.mouseup(e);\n            }\n        },\n        keydown: function(e) {\n            //escape key cancels dragging\n            if (e.keyCode === 27) {\n                this.release();\n            }\n        },\n        mouseup: function(e) {\n            this.update(e);\n            this.release();\n            this.onComplete && this.onComplete();\n        },\n        release: function() {\n            this.document.body.classList.remove('dragging-' + this.attr);\n            var events = this.events;\n            this.document.removeEventListener('mousemove', events.mousemove, false);\n            this.document.removeEventListener('keydown', events.keydown, false);\n            this.document.removeEventListener('mouseup', events.mouseup, false);\n            this.onRelease && this.onRelease();\n        }\n    };\n\n    //helper functions\n    function toArray(obj) {\n        var len = obj.length,\n            arr = new Array(len);\n        for (var i = 0; i < len; i++) {\n            arr[i] = obj[i];\n        }\n        return arr;\n    }\n\n    function bind(fn, ctx) {\n        if (fn.bind) {\n            return fn.bind(ctx);\n        }\n        return function() {\n            fn.apply(ctx, arguments);\n        };\n    }\n\n    function positionElement(el, left, top) {\n        el.style.left = String(left) + 'px';\n        el.style.top = String(top) + 'px';\n    }\n\n    function resizeElement(el, width, height) {\n        var imageScaleResize = this.editor.config.imageScaleResize;\n        if (imageScaleResize === 'both') {\n            el.style.width = String(width) + 'px';\n            el.style.height = String(height) + 'px';\n        }\n        else if (imageScaleResize === 'width' || imageScaleResize === 'scale') {\n            el.style.height = 'auto';\n            el.style.width = String(width) + 'px';\n        }\n        else if (imageScaleResize === 'height') {\n            el.style.height = String(height) + 'px';\n            el.style.width = 'auto';\n        }\n    }\n\n    function getBoundingBox(window, el) {\n        var rect = el.getBoundingClientRect();\n        return {\n            left: rect.left + window.pageXOffset,\n            top: rect.top + window.pageYOffset,\n            width: rect.width,\n            height: rect.height\n        };\n    }\n}());\n","(function() {\n\t'use strict';\n\n    if (CKEDITOR.plugins.get('ae_autolist')) {\n        return;\n    }\n\n    var KEY_BACK = 8;\n\n    var KEY_SPACE = 32;\n\n    var DEFAULT_CONFIG = [\n        {\n            regex: /^\\*$/,\n            type: 'bulletedlist'\n        },\n        {\n            regex: /^1\\.$/,\n            type: 'numberedlist'\n        }\n    ];\n\n\t/**\n     * CKEditor plugin which automatically generates ordered/unordered list when user types text which looks like a list.\n     *\n     * @class CKEDITOR.plugins.ae_autolist\n     * @constructor\n     */\n    CKEDITOR.plugins.add(\n        'ae_autolist', {\n\n            /**\n             * Initialization of the plugin, part of CKeditor plugin lifecycle.\n             * The function registers the `keydown` event on the content editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'keydown', this._onKeyDown, this, {\n                        editor: editor\n                    });\n\n                }.bind(this));\n            },\n\n            /**\n             * Checks for pressing the `Backspace` key in order to undo the list creation.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _checkForBackspaceAndUndo\n             * @param {Event} event Event object\n             * @protected\n             */\n            _checkForBackspaceAndUndo: function(event) {\n                var editor = event.listenerData.editor;\n\n                var nativeEvent = event.data.$;\n\n                var editable = editor.editable();\n\n                editable.removeListener('keydown', this._checkForBackspaceAndUndo);\n\n                if (nativeEvent.keyCode === KEY_BACK) {\n                    editor.execCommand('undo');\n                    editor.insertHtml(event.listenerData.bullet + '&nbsp;');\n                    event.data.preventDefault();\n                }\n            },\n\n            /**\n             * Checks current line to find match with MATCHES object to create OL or UL.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _checkLine\n             * @param {editor} Editor object\n             * @protected\n             * @return {Object|null} Returns an object which contains the detected list config if any\n             */\n            _getListConfig: function(editor) {\n                var configRegex = editor.config.autolist || DEFAULT_CONFIG;\n\n                var range = editor.getSelection().getRanges()[0];\n\n                var textContainer = range.endContainer.getText();\n\n                var bullet = textContainer.substring(0, range.startOffset);\n\n                var text = textContainer.substring(range.startOffset, textContainer.length);\n\n                var index = 0;\n\n                var regexLen = configRegex.length;\n\n                var autolistCfg = null;\n\n                while (!autolistCfg && regexLen > index) {\n                    var regexItem = configRegex[index];\n\n                    if (regexItem.regex.test(bullet)) {\n                        autolistCfg = {\n                            bullet: bullet,\n                            editor: editor,\n                            text: text,\n                            type: regexItem.type\n                        };\n\n                        break;\n                    }\n\n                    index++;\n                }\n\n                return autolistCfg;\n            },\n\n\t\t\t/**\n             * Create list with different types: Bulleted or Numbered list\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _createList\n             * @param {Object} listConfig Object that contains bullet, text and type for creating the list\n             * @protected\n\t\t\t */\n            _createList: function(listConfig) {\n                var editor = listConfig.editor;\n\n                var range = editor.getSelection().getRanges()[0];\n\n                range.endContainer.setText(listConfig.text);\n                editor.execCommand(listConfig.type);\n\n                var editable = editor.editable();\n\n                // Subscribe to keydown in order to check if the next key press is `Backspace`.\n                // If so, the creation of the list will be discarded.\n                editable.attachListener(editable, 'keydown', this._checkForBackspaceAndUndo, this, {\n                    editor: editor,\n                    bullet: listConfig.bullet\n                }, 1);\n            },\n\n\t\t\t/**\n             * Listens to the `Space` key events to check if the last word\n             * introduced by the user should be replaced by a list (OL or UL)\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolist\n             * @method _onKeyDown\n             * @param {Event} event Event object\n             * @protected\n             */\n            _onKeyDown: function(event) {\n                var nativeEvent = event.data.$;\n\n                if (nativeEvent.keyCode === KEY_SPACE) {\n                    var listConfig = this._getListConfig(event.listenerData.editor);\n\n                    if (listConfig) {\n                        event.data.preventDefault();\n                        this._createList(listConfig);\n                    }\n                }\n            }\n        }\n\t);\n}());","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_autolink')) {\n        return;\n    }\n\n    // Disables the auto URL detection feature in IE, their lacks functionality:\n    // They convert the links only on space. We do on space, comma, semicolon and Enter.\n    if (/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)) {\n        document.execCommand('AutoUrlDetect', false, false);\n    }\n\n    var KEY_BACK = 8;\n\n    var KEY_COMMA = 188;\n\n    var KEY_ENTER = 13;\n\n    var KEY_SEMICOLON = 186;\n\n    var KEY_SPACE = 32;\n\n    var DELIMITERS = [KEY_COMMA, KEY_ENTER, KEY_SEMICOLON, KEY_SPACE];\n\n    var REGEX_LAST_WORD = /[^\\s]+/mg;\n\n    var REGEX_URL = /(https?\\:\\/\\/|www\\.)(-\\.)?([^(\\s/?\\.#-)]+\\.?)+(\\b\\/[^\\s]*)?$/i;\n\n    /**\n     * CKEditor plugin which automatically generates links when user types text which looks like URL.\n     *\n     * @class CKEDITOR.plugins.ae_autolink\n     * @constructor\n     */\n    CKEDITOR.plugins.add(\n        'ae_autolink', {\n\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers the `keyup` event on the editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'keyup', this._onKeyUp, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * Retrieves the last word introduced by the user. Reads from the current\n             * caret position backwards until it finds the first white space.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _getLastWord\n             * @protected\n             * @return {String} The last word introduced by user\n             */\n            _getLastWord: function(editor) {\n                var range = editor.getSelection().getRanges()[0];\n\n                var offset = range.startOffset;\n\n                var previousText = '';\n\n                // The user pressed Enter, so we have to look on the previous node\n                if (this._currentKeyCode === KEY_ENTER) {\n                    var previousNode = range.startContainer.getPrevious();\n\n                    var lastChild;\n\n                    if (previousNode) {\n                        // If previous node is a SPACE, (it does not have 'getLast' method),\n                        // ignore it and find the previous text node\n                        while (!previousNode.getLast) {\n                            previousNode = previousNode.getPrevious();\n                        }\n\n                        lastChild = previousNode.getLast();\n\n                        // Depending on the browser, the last child node may be a <BR>\n                        // (which does not have 'getText' method),\n                        // so ignore it and find the previous text node\n                        while (lastChild && !lastChild.getText()) {\n                            lastChild = lastChild.getPrevious();\n                        }\n                    }\n\n                    // Check if the lastChild is already a link\n                    if (!(lastChild && lastChild.$.href)) {\n                        this._startContainer = lastChild;\n                        previousText = lastChild ? lastChild.getText() : '';\n                        this._offset = previousText.length;\n                    }\n                } else {\n                    this._startContainer = range.startContainer;\n\n                    // Last character is the delimiter, ignore it\n                    previousText = this._startContainer.getText().substring(0, offset - 1);\n\n                    this._offset = offset - 1;\n                }\n\n                var lastWord = '';\n\n                var match = previousText.match(REGEX_LAST_WORD);\n\n                if (match) {\n                    lastWord = match.pop();\n                }\n\n                return lastWord;\n            },\n\n            /**\n             * Checks if the given link is a valid URL.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method isValidURL\n             * @param {String} link The link we want to know if it is a valid URL\n             * @protected\n             * @return {Boolean} Returns true if the link is a valid URL, false otherwise\n             */\n            _isValidURL: function(link) {\n                return REGEX_URL.test(link);\n            },\n\n            /**\n             * Listens to the `keydown` event and if the keycode is `Backspace`, removes the previously\n             * created link.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _onKeyDown\n             * @param {EventFacade} event EventFacade object\n             * @protected\n             */\n            _onKeyDown: function(event) {\n                var nativeEvent = event.data.$;\n\n                var editor = event.listenerData.editor;\n\n                var editable = editor.editable();\n\n                editable.removeListener('keydown', this._onKeyDown);\n\n                if (nativeEvent.keyCode === KEY_BACK) {\n                    event.cancel();\n                    event.data.preventDefault();\n\n                    this._removeLink(editor);\n                }\n\n                this._ckLink = null;\n            },\n\n            /**\n             * Listens to the `Enter` and `Space` key events in order to check if the last word\n             * introduced by the user should be replaced by a link element.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _onKeyUp\n             * @param {EventFacade} event EventFacade object\n             * @protected\n             */\n            _onKeyUp: function(event) {\n                var nativeEvent = event.data.$;\n\n                this._currentKeyCode = nativeEvent.keyCode;\n\n                if (DELIMITERS.indexOf(this._currentKeyCode) !== -1) {\n                    var editor = event.listenerData.editor;\n\n                    var lastWord = this._getLastWord(editor);\n\n                    if (this._isValidURL(lastWord)) {\n                        this._replaceContentByLink(editor, lastWord);\n                    }\n                }\n            },\n\n            /**\n             * Replaces content by a link element.\n             *\n             * @fires CKEDITOR.plugins.ae_autolink#autolinkAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _replaceContentByLink\n             * @param {String} content The text that has to be replaced by an link element\n             * @protected\n             */\n            _replaceContentByLink: function(editor, content) {\n                var range = editor.createRange();\n                var node = CKEDITOR.dom.element.get(this._startContainer);\n                var offset = this._offset;\n\n                // Select the content, so CKEDITOR.Link can properly replace it\n                range.setStart(node, offset - content.length);\n                range.setEnd(node, offset);\n                range.select();\n\n                var ckLink = new CKEDITOR.Link(editor);\n                ckLink.create(content);\n                this._ckLink = ckLink;\n\n                var linkNode = ckLink.getFromSelection();\n                editor.fire('autolinkAdd', linkNode);\n\n                this._subscribeToKeyEvent(editor);\n\n                // Now range is on the link and it is selected. We have to\n                // return focus to the caret position.\n                range = editor.getSelection().getRanges()[0];\n\n                // If user pressed `Enter`, get the next editable node at position 0,\n                // otherwise set the cursor at the next character of the link (the white space)\n                if (this._currentKeyCode === KEY_ENTER) {\n                    var nextEditableNode = range.getNextEditableNode();\n\n                    range.setStart(nextEditableNode, 0);\n                    range.setEnd(nextEditableNode, 0);\n                } else {\n                    var nextNode = range.getNextNode();\n\n                    range.setStart(nextNode, 1);\n                    range.setEnd(nextNode, 1);\n                }\n\n                range.select();\n            },\n\n            /**\n             * Fired when a URL is detected in text and converted to a link.\n             *\n             * @event CKEDITOR.plugins.ae_autolink#autolinkAdd\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @param {CKEDITOR.dom.element} el Node of the created link.\n             */\n\n            /**\n             * Removes the created link element, and replaces it by its text.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _removeLink\n             * @protected\n             */\n            _removeLink: function(editor) {\n                var range = editor.getSelection().getRanges()[0];\n                var caretOffset = range.startOffset;\n\n                // Select the link, so CKEDITOR.Link can properly remove it\n                var linkNode = this._startContainer.getNext() || this._startContainer;\n\n                var newRange = editor.createRange();\n                newRange.setStart(linkNode, 0);\n                newRange.setEndAfter(linkNode);\n                newRange.select();\n\n                this._ckLink.remove();\n\n                // Return focus to the caret position\n                range.setEnd(range.startContainer, caretOffset);\n                range.setStart(range.startContainer, caretOffset);\n\n                range.select();\n            },\n\n            /**\n             * Subscribe to a key event of the editable aria.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_autolink\n             * @method _subscribeToKeyEvent\n             * @protected\n             */\n            _subscribeToKeyEvent: function(editor) {\n                var editable = editor.editable();\n\n                // Change the priority of keydown listener - 1 means the highest priority.\n                // In Chrome on pressing `Enter` the listener is not being invoked.\n                // See http://dev.ckeditor.com/ticket/11861 for more information.\n                editable.attachListener(editable, 'keydown', this._onKeyDown, this, {\n                    editor: editor\n                }, 1);\n            }\n        }\n    );\n}());\n","(function() {\n    'use strict';\n\n    var isIE = CKEDITOR.env.ie;\n\n    if (CKEDITOR.plugins.get('ae_addimages')) {\n        return;\n    }\n\n    /**\n     * CKEditor plugin which allows Drag&Drop of images directly into the editable area. The image will be encoded\n     * as Data URI. An event `beforeImageAdd` will be fired with the list of dropped images. If any of the listeners\n     * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n     * an event `imageAdd` will be fired with the inserted element into the editable area.\n     *\n     * @class CKEDITOR.plugins.ae_addimages\n     */\n\n    /**\n     * Fired before adding images to the editor.\n     *\n     * @event CKEDITOR.plugins.ae_addimages#beforeImageAdd\n     * @instance\n     * @memberof CKEDITOR.plugins.ae_addimages\n     * @param {Array} imageFiles Array of image files\n     */\n\n    /**\n     * Fired when an image is being added to the editor successfully.\n     *\n     * @event CKEDITOR.plugins.ae_addimages#imageAdd\n     * @instance\n     * @memberof CKEDITOR.plugins.ae_addimages\n     * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n     * @param {File} file The image file\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_addimages', {\n            /**\n             * Initialization of the plugin, part of CKEditor plugin lifecycle.\n             * The function registers a 'dragenter', 'dragover', 'drop' and `paste` events on the editing area.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method init\n             * @param {Object} editor The current editor instance\n             */\n            init: function(editor) {\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    editable.attachListener(editable, 'dragenter', this._onDragEnter, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'dragover', this._onDragOver, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'drop', this._onDragDrop, this, {\n                        editor: editor\n                    });\n\n                    editable.attachListener(editable, 'paste', this._onPaste, this, {\n                        editor: editor\n                    });\n                }.bind(this));\n            },\n\n            /**\n             * Accepts an array of dropped files to the editor. Then, it filters the images and sends them for further\n             * processing to {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}}\n             *\n             * @fires CKEDITOR.plugins.ae_addimages#beforeImageAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _handleFiles\n             * @param {Array} files Array of dropped files. Only the images from this list will be processed.\n             * @param {Object} editor The current editor instance\n             * @protected\n             */\n            _handleFiles: function(files, editor) {\n                var file;\n                var i;\n\n                var imageFiles = [];\n\n                for (i = 0; i < files.length; i++) {\n                    file = files[i];\n\n                    if (file.type.indexOf('image') === 0) {\n                        imageFiles.push(file);\n                    }\n                }\n\n                var result = editor.fire('beforeImageAdd', {\n                    imageFiles: imageFiles\n                });\n\n                if (!!result) {\n                    for (i = 0; i < imageFiles.length; i++) {\n                        file = imageFiles[i];\n\n                        this._processFile(file, editor);\n                    }\n                }\n\n                return false;\n            },\n\n            /**\n             * Handles drag drop event. The function will create a selection from the current\n             * point and will send a list of files to be processed to\n             * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_handleFiles:method\"}}{{/crossLink}} method.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragDrop\n             * @param {CKEDITOR.dom.event} event dragdrop event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragDrop: function(event) {\n                var nativeEvent = event.data.$;\n\n                new CKEDITOR.dom.event(nativeEvent).preventDefault();\n\n                var editor = event.listenerData.editor;\n\n                event.listenerData.editor.createSelectionFromPoint(nativeEvent.clientX, nativeEvent.clientY);\n\n                this._handleFiles(nativeEvent.dataTransfer.files, editor);\n            },\n\n            /**\n             * Handles drag enter event. In case of IE, this function will prevent the event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragEnter\n             * @param {DOM event} event dragenter event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragEnter: function(event) {\n                if (isIE) {\n                    this._preventEvent(event);\n                }\n            },\n\n            /**\n             * Handles drag over event. In case of IE, this function will prevent the event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onDragOver\n             * @param {DOM event} event dragover event, as received natively from CKEditor\n             * @protected\n             */\n            _onDragOver: function(event) {\n                if (isIE) {\n                    this._preventEvent(event);\n                }\n            },\n\n            /**\n             * Checks if the pasted data is image and passes it to\n             * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}} for processing.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _onPaste\n             * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n             * @protected\n             */\n            _onPaste: function(event) {\n                if (event.data && event.data.$ && event.data.$.clipboardData && event.data.$.clipboardData.items && event.data.$.clipboardData.items.length > 0) {\n                    var pastedData = event.data.$.clipboardData.items[0];\n\n                    if (pastedData.type.indexOf('image') === 0) {\n                        var imageFile = pastedData.getAsFile();\n\n                        this._processFile(imageFile, event.listenerData.editor);\n                    }\n                }\n            },\n\n            /**\n             * Prevents a native event.\n             *\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _preventEvent\n             * @param {DOM event} event The event to be prevented.\n             * @protected\n             */\n            _preventEvent: function(event) {\n                event = new CKEDITOR.dom.event(event.data.$);\n\n                event.preventDefault();\n                event.stopPropagation();\n            },\n\n            /**\n             * Processes an image file. The function creates an img element and sets as source\n             * a Data URI, then fires an 'imageAdd' event via CKEditor's event system.\n             *\n             * @fires CKEDITOR.plugins.ae_addimages#imageAdd\n             * @instance\n             * @memberof CKEDITOR.plugins.ae_addimages\n             * @method _preventEvent\n             * @param {DOM event} event The event to be prevented.\n             * @protected\n             */\n            _processFile: function(file, editor) {\n                var reader = new FileReader();\n\n                reader.addEventListener('loadend', function() {\n                    var bin = reader.result;\n\n                    var el = CKEDITOR.dom.element.createFromHtml('<img src=\"' + bin + '\">');\n\n                    editor.insertElement(el);\n\n                    var imageData = {\n                        el: el,\n                        file: file\n                    };\n\n                    editor.fire('imageAdd', imageData);\n                });\n\n                reader.readAsDataURL(file);\n            }\n        }\n    );\n}());","import addimages from './addimages';\nimport autolink from './autolink';\nimport autolist from './autolist';\nimport dragresize from './dragresize';\nimport dragresizeie from './dragresize_ie';\nimport embed from './embed';\nimport imagealignment from './imagealignment';\nimport pasteimages from './pasteimages';\nimport placeholder from './placeholder';\nimport selectionkeystrokes from './selectionkeystrokes';\nimport tableresize from './tableresize';\nimport tabletools from './tabletools';\n\nexport {\n    addimages,\n    autolink,\n    autolist,\n    dragresize,\n    dragresizeie,\n    embed,\n    imagealignment,\n    pasteimages,\n    placeholder,\n    selectionkeystrokes,\n    tableresize,\n    tabletools\n};","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_uicore')) {\n        return;\n    }\n\n    /**\n     * UICore class which will handle user interactions with the editor. These interactions\n     * might be triggered via mouse, keyboard or touch devices. The class fill fire an event via\n     * CKEditor's event system - \"editorInteraction\". The UI may listen to this event and\n     * execute some actions - for example to show/hide toolbars.\n     *\n     * By default if user presses the Esc key, 'editorInteraction' event won't be fired. However, this behaviour can be changed\n     * by setting {{#crossLink \"CKEDITOR.plugins.ae_uicore/allowEsc:attribute\"}}{{/crossLink}} config property in editor's configuration to true.\n     *\n     * @class ae_uicore\n     */\n\n    /**\n     * Fired when user interacts somehow with the browser. This may be clicking with the mouse, pressing keyboard button,\n     * or touching screen. This even will be not fired after each interaction. It will be debounced. By default the timeout\n     * is 50ms. This value can be overwritten via {{#crossLink \"CKEDITOR.plugins.ae_uicore/timeout:attribute\"}}{{/crossLink}}\n     * property of editor's configuration, like: editor.config.uicore.timeout = 100\n     *\n     * @memberof ae_uicore\n     * @event ae_uicore#editorInteraction\n     * @param {Object} data An object which contains the following properties:\n     * - nativeEvent - The event as received from CKEditor.\n     * - selectionData - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n     */\n\n    /**\n     * Fired by UI elements like Toolbars or Buttons when their state changes. The listener updates the live region with the provided data.\n     *\n     * @memberof ae_uicore\n     * @event ae_uicore#ariaUpdate\n     * @param {Object} data An object which contains the following properties:\n     * - message - The provided message from the UI element.\n     */\n\n    /**\n     * If set to true, the editor will still fire {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event,\n     * if user presses Esc key.\n     *\n     * @memberof ae_uicore\n     * @attribute allowEsc\n     * @default false\n     * @type Boolean\n     */\n\n    /**\n     * Specifies the default timeout after which the {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event\n     * will be fired.\n     *\n     * @memberof ae_uicore\n     * @attribute timeout\n     * @default 50 (ms)\n     * @type Number\n     */\n\n    CKEDITOR.plugins.add(\n        'ae_uicore', {\n            /**\n             * Initializer lifecycle implementation for the UICore plugin.\n             *\n             * @memberof ae_uicore\n             * @method init\n             * @param {Object} editor The current CKEditor instance.\n             * @protected\n             */\n            init: function(editor) {\n                var ariaState = [];\n\n                var ariaElement = this._createAriaElement(editor.id);\n\n                var uiTasksTimeout = editor.config.uicore ? editor.config.uicore.timeout : 50;\n\n                var handleUI = CKEDITOR.tools.debounce(\n                    function(event) {\n                        ariaState = [];\n\n                        if (event.name !== 'keyup' || event.data.$.keyCode !== 27 || editor.config.allowEsc) {\n                            var selectionData = editor.getSelectionData();\n\n                            if (selectionData) {\n                                editor.fire('editorInteraction', {\n                                    nativeEvent: event.data.$,\n                                    selectionData: selectionData\n                                });\n                            }\n                        }\n                    },\n                    uiTasksTimeout\n                );\n\n                var handleAria = CKEDITOR.tools.debounce(\n                    function(event) {\n                        ariaElement.innerHTML = ariaState.join('. ');\n                    },\n                    uiTasksTimeout\n                );\n\n                var handleMouseLeave = CKEDITOR.tools.debounce(\n                    function(event) {\n                        var aeUINodes = document.querySelectorAll('.ae-ui');\n\n                        var found;\n\n                        for (var i = 0; i < aeUINodes.length; i++) {\n                            if (aeUINodes[i].contains(event.data.$.relatedTarget)) {\n                                found = true;\n                                break;\n                            }\n                        }\n\n                        if (!found) {\n                            handleUI(event);\n                        }\n                    },\n                    uiTasksTimeout\n                );\n\n                editor.on('ariaUpdate', function(event) {\n                    // handleAria is debounced function, so if it is being called multiple times, it will\n                    // be canceled until some time passes.\n                    // For that reason here we explicitly append the current message to the list of messages\n                    // and call handleAria. Since it is debounced, when some timeout passes,\n                    // all the messages will be applied to the live region and not only the last one.\n\n                    ariaState.push(event.data.message);\n\n                    handleAria();\n                });\n\n                editor.once('contentDom', function() {\n                    var editable = editor.editable();\n\n                    var focusHandler = editable.attachListener(editable, 'focus', function (event) {\n                        focusHandler.removeListener();\n\n                        editable.attachListener(editable, 'keyup', handleUI);\n                        editable.attachListener(editable, 'mouseup', handleUI);\n                        editable.attachListener(editable, 'mouseleave', handleMouseLeave);\n\n                        handleUI(event);\n                    });\n                });\n\n                editor.on('destroy', function(event) {\n                    ariaElement.parentNode.removeChild(ariaElement);\n\n                    handleUI.detach();\n                });\n            },\n\n            /**\n             * Creates and applies an HTML element to the body of the document which will contain ARIA messages.\n             *\n             * @memberof ae_uicore\n             * @method _createAriaElement\n             * @param {String} id The provided id of the element. It will be used as prefix for the final element Id.\n             * @protected\n             * @return {HTMLElement} The created and applied to DOM element.\n             */\n            _createAriaElement: function(id) {\n                var statusElement = document.createElement('div');\n\n                statusElement.className = 'ae-sr-only';\n\n                statusElement.setAttribute('aria-live', 'polite');\n                statusElement.setAttribute('role', 'status');\n                statusElement.setAttribute('id', id + 'LiveRegion');\n\n                document.body.appendChild(statusElement);\n\n                return statusElement;\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    /**\n     * CKEDITOR.tools class utility which adds additional methods to those of CKEditor.\n     *\n     * @class CKEDITOR.tools\n     */\n\n    /**\n     * Sends a request using the JSONP technique.\n     *\n     * @memberof CKEDITOR.tools\n     * @method jsonp\n     * @param {CKEDITOR.template} urlTemplate The template of the URL to be requested. All properties passed in `urlParams` can be used, plus a `{callback}`, which represent a JSONP callback, must be defined.\n     * @param {Function} callback A function to be called in case of success.\n     * @param {Function} errorCallback A function to be called in case of failure.\n     * @param {Object} urlParams Parameters to be passed to the `urlTemplate`.\n     * @return {Object} An object with the following properties:\n     *  - id: the transaction ID\n     *  - a `cancel()` method\n     * @static\n     */\n    CKEDITOR.tools.jsonp = function(urlTemplate, urlParams, callback, errorCallback) {\n        var callbackKey = CKEDITOR.tools.getNextNumber();\n\n        urlParams = urlParams || {};\n        urlParams.callback = 'CKEDITOR._.jsonpCallbacks[' + callbackKey + ']';\n\n        if (!CKEDITOR._.jsonpCallbacks) {\n            CKEDITOR._.jsonpCallbacks = {};\n        }\n\n        CKEDITOR._.jsonpCallbacks[callbackKey] = function(response) {\n            setTimeout(function() {\n                cleanUp();\n\n                callback(response);\n            });\n        };\n\n        var scriptElement = new CKEDITOR.dom.element('script');\n        scriptElement.setAttribute('src', urlTemplate.output(urlParams));\n        scriptElement.on('error', function() {\n            cleanUp();\n\n            if (errorCallback) {\n                errorCallback();\n            }\n        });\n\n        function cleanUp() {\n            if (scriptElement) {\n                scriptElement.remove();\n                delete CKEDITOR._.jsonpCallbacks[callbackKey];\n                scriptElement = null;\n            }\n        }\n\n        CKEDITOR.document.getBody().append(scriptElement);\n\n        return {\n            cancel: cleanUp,\n            id: callbackKey\n        };\n    };\n\n    /**\n     * Returns a new object containing all of the properties of all the supplied\n     * objects. The properties from later objects will overwrite those in earlier\n     * objects.\n     *\n     * Passing in a single object will create a shallow copy of it.\n     *\n     * @memberof CKEDITOR.tools\n     * @method merge\n     * @param {Object} objects* One or more objects to merge.\n     * @return {Object} A new merged object.\n     * @static\n     */\n    CKEDITOR.tools.merge = CKEDITOR.tools.merge || function() {\n        var result = {};\n\n        for (var i = 0; i < arguments.length; ++i) {\n            var obj = arguments[i];\n\n            for (var key in obj) {\n                if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                    result[key] = obj[key];\n                }\n            }\n        }\n\n        return result;\n    };\n\n    /**\n     * Simulates event on a DOM element.\n     *\n     * @memberof CKEDITOR.tools\n     * @method simulate\n     * @param {DOMElement} element The element on which the event shoud be simualted.\n     * @param {String} event The name of the event which have to be simulated.\n     * @static\n     */\n    CKEDITOR.tools.simulate = function(element, event) {\n        var eventInstance = document.createEvent('Events');\n        eventInstance.initEvent(event, true, false);\n        element.dispatchEvent(eventInstance);\n    };\n}());","(function() {\n    'use strict';\n\n    var IE_NON_DIRECTLY_EDITABLE_ELEMENT = {\n        'table': 1,\n        'col': 1,\n        'colgroup': 1,\n        'tbody': 1,\n        'td': 1,\n        'tfoot': 1,\n        'th': 1,\n        'thead': 1,\n        'tr': 1\n    };\n\n    /**\n     * Table class utility. Provides methods for create, delete and update tables.\n     *\n     * @class CKEDITOR.Table\n     * @constructor\n     * @param {Object} editor The CKEditor instance.\n     */\n\n    function Table(editor) {\n        this._editor = editor;\n    }\n\n    Table.HEADING_BOTH = 'Both';\n    Table.HEADING_COL = 'Column';\n    Table.HEADING_NONE = 'None';\n    Table.HEADING_ROW = 'Row';\n\n    Table.prototype = {\n        constructor: Table,\n\n        /**\n         * Creates a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method create\n         * @param {Object} config Table configuration object\n         * @return {Object} The created table\n         */\n        create: function(config) {\n            var editor = this._editor;\n            var table = this._createElement('table');\n\n            config = config || {};\n\n            // Generate the rows and cols.\n            var tbody = table.append(this._createElement('tbody'));\n            var rows = config.rows || 1;\n            var cols = config.cols || 1;\n\n            for (var i = 0; i < rows; i++) {\n                var row = tbody.append(this._createElement('tr'));\n                for (var j = 0; j < cols; j++) {\n                    var cell = row.append(this._createElement('td'));\n\n                    cell.appendBogus();\n                }\n            }\n\n            this.setAttributes(table, config.attrs);\n            this.setHeading(table, config.heading);\n\n            // Insert the table element if we're creating one.\n            editor.insertElement(table);\n\n            var firstCell = new CKEDITOR.dom.element(table.$.rows[0].cells[0]);\n            var range = editor.createRange();\n            range.moveToPosition(firstCell, CKEDITOR.POSITION_AFTER_START);\n            range.select();\n\n            return table;\n        },\n\n        /**\n         * Retrieves a table from the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method getFromSelection\n         * @return {CKEDITOR.dom.element} The retrieved table or null if not found.\n         */\n        getFromSelection: function() {\n            var table;\n            var selection = this._editor.getSelection();\n            var selected = selection.getSelectedElement();\n\n            if (selected && selected.is('table')) {\n                table = selected;\n            } else {\n                var ranges = selection.getRanges();\n\n                if (ranges.length > 0) {\n                    // Webkit could report the following range on cell selection (#4948):\n                    // <table><tr><td>[&nbsp;</td></tr></table>]\n\n                    /* istanbul ignore else */\n                    if (CKEDITOR.env.webkit) {\n                        ranges[0].shrink(CKEDITOR.NODE_ELEMENT);\n                    }\n\n                    table = this._editor.elementPath(ranges[0].getCommonAncestor(true)).contains('table', 1);\n                }\n            }\n\n            return table;\n        },\n\n        /**\n         * Checks if a given table can be considered as editable. This method\n         * workarounds a limitation of IE where for some elements (like table),\n         * `isContentEditable` returns always false. This is because IE does not support\n         * `contenteditable` on such elements. However, despite such elements\n         * cannot be set as content editable directly, a content editable SPAN,\n         * or DIV element can be placed inside the individual table cells.\n         * See https://msdn.microsoft.com/en-us/library/ms537837%28v=VS.85%29.aspx\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method isEditable\n         * @param {CKEDITOR.dom.element} el The table element to test if editable\n         * @return {Boolean}\n         */\n        isEditable: function (el) {\n            if (!CKEDITOR.env.ie || !el.is(IE_NON_DIRECTLY_EDITABLE_ELEMENT)) {\n                return !el.isReadOnly();\n            }\n\n            if (el.hasAttribute('contenteditable')) {\n                return (el.getAttribute('contenteditable') !== 'false');\n            }\n\n            return this.isEditable(el.getParent());\n        },\n\n        /**\n         * Returns which heading style is set for the given table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method getHeading\n         * @param {CKEDITOR.dom.element} table The table to gather the heading from. If null, it will be retrieved from the current selection.\n         * @return {String} The heading of the table. Expected values are `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n         */\n        getHeading: function(table) {\n            table = table || this.getFromSelection();\n\n            if (!table) {\n                return null;\n            }\n\n            var rowHeadingSettings = table.$.tHead !== null;\n\n            var colHeadingSettings = true;\n\n            // Check if all of the first cells in every row are TH\n            for (var row = 0; row < table.$.rows.length; row++) {\n                // If just one cell isn't a TH then it isn't a header column\n                var cell = table.$.rows[row].cells[0];\n\n                if (cell && cell.nodeName.toLowerCase() !== 'th') {\n                    colHeadingSettings = false;\n                    break;\n                }\n            }\n\n            var headingSettings = Table.HEADING_NONE;\n\n            if (rowHeadingSettings) {\n                headingSettings = Table.HEADING_ROW;\n            }\n\n            if (colHeadingSettings) {\n                headingSettings = (headingSettings === Table.HEADING_ROW ? Table.HEADING_BOTH : Table.HEADING_COL);\n            }\n\n            return headingSettings;\n        },\n\n        /**\n         * Removes a table from the editor.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method remove\n         * @param {CKEDITOR.dom.element} table The table element which table style should be removed.\n         */\n        remove: function(table) {\n            var editor = this._editor;\n\n            if (table) {\n                table.remove();\n            } else {\n                table = editor.elementPath().contains('table', 1);\n\n                if (table) {\n                    // If the table's parent has only one child remove it as well (unless it's a table cell, or the editable element) (#5416, #6289, #12110)\n                    var parent = table.getParent();\n                    var editable = editor.editable();\n\n                    if (parent.getChildCount() === 1 && !parent.is('td', 'th') && !parent.equals(editable)) {\n                        table = parent;\n                    }\n\n                    var range = editor.createRange();\n                    range.moveToPosition(table, CKEDITOR.POSITION_BEFORE_START);\n                    table.remove();\n                    range.select();\n                }\n            }\n        },\n\n        /**\n         * Assigns provided attributes to a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method setAttributes\n         * @param {Object} table The table to which the attributes should be assigned\n         * @param {Object} attrs The attributes which have to be assigned to the table\n         */\n        setAttributes: function(table, attrs) {\n            if (attrs) {\n                Object.keys(attrs).forEach(function(attr) {\n                    table.setAttribute(attr, attrs[attr]);\n                });\n            }\n        },\n\n        /**\n         * Sets the appropriate table heading style to a table.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @method setHeading\n         * @param {CKEDITOR.dom.element} table The table element to which the heading should be set. If null, it will be retrieved from the current selection.\n         * @param {String} heading The table heading to be set. Accepted values are: `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n         */\n        setHeading: function(table, heading) {\n            table = table || this.getFromSelection();\n\n            var i, newCell;\n            var tableHead;\n            var tableBody = table.getElementsByTag('tbody').getItem(0);\n\n            var tableHeading = this.getHeading(table);\n            var hadColHeading = (tableHeading === Table.HEADING_COL || tableHeading === Table.HEADING_BOTH);\n\n            var needColHeading = heading === Table.HEADING_COL || heading === Table.HEADING_BOTH;\n            var needRowHeading = heading === Table.HEADING_ROW || heading === Table.HEADING_BOTH;\n\n            // If we need row heading and don't have a <thead> element yet, move the\n            // first row of the table to the head and convert the nodes to <th> ones.\n            if (!table.$.tHead && needRowHeading) {\n                var tableFirstRow = tableBody.getElementsByTag('tr').getItem(0);\n                var tableFirstRowChildCount = tableFirstRow.getChildCount();\n\n                // Change TD to TH:\n                for (i = 0; i < tableFirstRowChildCount; i++) {\n                    var cell = tableFirstRow.getChild(i);\n\n                    // Skip bookmark nodes. (#6155)\n                    if (cell.type === CKEDITOR.NODE_ELEMENT && !cell.data('cke-bookmark')) {\n                        cell.renameNode('th');\n                        cell.setAttribute('scope', 'col');\n                    }\n                }\n\n                tableHead = this._createElement(table.$.createTHead());\n                tableHead.append(tableFirstRow.remove());\n            }\n\n            // If we don't need row heading and we have a <thead> element, move the\n            // row out of there and into the <tbody> element.\n            if (table.$.tHead !== null && !needRowHeading) {\n                // Move the row out of the THead and put it in the TBody:\n                tableHead = this._createElement(table.$.tHead);\n\n                var previousFirstRow = tableBody.getFirst();\n\n                while (tableHead.getChildCount() > 0) {\n                    var newFirstRow = tableHead.getFirst();\n                    var newFirstRowChildCount = newFirstRow.getChildCount();\n\n                    for (i = 0; i < newFirstRowChildCount; i++) {\n                        newCell = newFirstRow.getChild(i);\n\n                        if (newCell.type === CKEDITOR.NODE_ELEMENT) {\n                            newCell.renameNode('td');\n                            newCell.removeAttribute('scope');\n                        }\n                    }\n\n                    newFirstRow.insertBefore(previousFirstRow);\n                }\n\n                tableHead.remove();\n            }\n\n            tableHeading = this.getHeading(table);\n            var hasColHeading = (tableHeading === Table.HEADING_COL || tableHeading === Table.HEADING_BOTH);\n\n            // If we need column heading and the table doesn't have it, convert every first cell in\n            // every row into a `<th scope=\"row\">` element.\n            if (!hasColHeading && needColHeading) {\n                for (i = 0; i < table.$.rows.length; i++) {\n                    if (table.$.rows[i].cells[0].nodeName.toLowerCase() !== 'th') {\n                        newCell = new CKEDITOR.dom.element(table.$.rows[i].cells[0]);\n                        newCell.renameNode('th');\n                        newCell.setAttribute('scope', 'row');\n                    }\n                }\n            }\n\n            // If we don't need column heading but the table has it, convert every first cell in every\n            // row back into a `<td>` element.\n            if (hadColHeading && !needColHeading) {\n                for (i = 0; i < table.$.rows.length; i++) {\n                    var row = new CKEDITOR.dom.element(table.$.rows[i]);\n\n                    if (row.getParent().getName() === 'tbody') {\n                        newCell = new CKEDITOR.dom.element(row.$.cells[0]);\n                        newCell.renameNode('td');\n                        newCell.removeAttribute('scope');\n                    }\n                }\n            }\n        },\n\n        /**\n         * Creates a new CKEDITOR.dom.element using the passed tag name.\n         *\n         * @instance\n         * @memberof CKEDITOR.Table\n         * @protected\n         * @method _createElement\n         * @param {String} name The tag name from which an element should be created\n         * @return {CKEDITOR.dom.element} Instance of CKEDITOR DOM element class\n         */\n        _createElement: function(name) {\n            return new CKEDITOR.dom.element(name, this._editor.document);\n        }\n    };\n\n    CKEDITOR.on('instanceReady', function(event) {\n        var headingCommands = [Table.HEADING_NONE, Table.HEADING_ROW, Table.HEADING_COL, Table.HEADING_BOTH];\n\n        var tableUtils = new Table(event.editor);\n\n        headingCommands.forEach(function(heading) {\n            event.editor.addCommand('tableHeading' + heading, {\n                exec: function(editor) {\n                    tableUtils.setHeading(null, heading);\n                }\n            });\n        });\n    });\n\n    CKEDITOR.Table = CKEDITOR.Table || Table;\n}());\n","(function() {\n    'use strict';\n\n    if (CKEDITOR.plugins.get('ae_selectionregion')) {\n        return;\n    }\n\n    CKEDITOR.SELECTION_TOP_TO_BOTTOM = 0;\n    CKEDITOR.SELECTION_BOTTOM_TO_TOP = 1;\n    CKEDITOR.SELECTION_LEFT_TO_RIGHT = 2;\n    CKEDITOR.SELECTION_RIGHT_TO_LEFT = 3;\n\n    /**\n     * SelectionRegion utility class which provides metadata about the selection. The metadata may be the start and end\n     * rectangles, caret region, etc. **This class is not intended to be used standalone. Its functions will\n     * be merged into each editor instance, so the developer may use them directly via the editor, without making\n     * an instance of this class**.\n     *\n     * @class SelectionRegion\n     * @constructor\n     */\n    function SelectionRegion() {}\n\n    SelectionRegion.prototype = {\n        constructor: SelectionRegion,\n\n        /**\n         * Creates selection from two points in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method createSelectionFromPoint\n         * @param {Number} x X point in page coordinates.\n         * @param {Number} y Y point in page coordinates.\n         */\n        createSelectionFromPoint: function(x, y) {\n            this.createSelectionFromRange(x, y, x, y);\n        },\n\n        /**\n         * Creates selection from range. A range consists from two points in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method createSelectionFromRange\n         * @param {Number} startX X coordinate of the first point.\n         * @param {Number} startY Y coordinate of the first point.\n         * @param {Number} endX X coordinate of the second point.\n         * @param {Number} endY Y coordinate of the second point.\n         */\n        createSelectionFromRange: function(startX, startY, endX, endY) {\n            var end;\n            var endContainer;\n            var endOffset;\n            var range;\n            var start;\n            var startContainer;\n            var startOffset;\n\n            if (typeof document.caretPositionFromPoint === 'function') {\n                start = document.caretPositionFromPoint(startX, startY);\n                end = document.caretPositionFromPoint(endX, endY);\n\n                startContainer = start.offsetNode;\n                endContainer = end.offsetNode;\n\n                startOffset = start.offset;\n                endOffset = end.offset;\n\n                range = this.createRange();\n            } else if (typeof document.caretRangeFromPoint === 'function') {\n                start = document.caretRangeFromPoint(startX, startY);\n                end = document.caretRangeFromPoint(endX, endY);\n\n                startContainer = start.startContainer;\n                endContainer = end.startContainer;\n\n                startOffset = start.startOffset;\n                endOffset = end.startOffset;\n\n                range = this.createRange();\n            }\n\n            if (range && document.getSelection) {\n                range.setStart(new CKEDITOR.dom.node(startContainer), startOffset);\n                range.setEnd(new CKEDITOR.dom.node(endContainer), endOffset);\n\n                this.getSelection().selectRanges([range]);\n            } else if (typeof document.body.createTextRange === 'function') {\n                var selection = this.getSelection();\n\n                selection.unlock();\n\n                range = document.body.createTextRange();\n                range.moveToPoint(startX, startY);\n\n                var endRange = range.duplicate();\n                endRange.moveToPoint(endX, endY);\n\n                range.setEndPoint('EndToEnd', endRange);\n                range.select();\n\n                this.getSelection().lock();\n            }\n        },\n\n        /**\n         * Returns the region of the current position of the caret. The points are in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getCaretRegion\n         * @return {Object} Returns object with the following properties:\n         * - bottom\n         * - left\n         * - right\n         * - top\n         */\n        getCaretRegion: function() {\n            var selection = this.getSelection();\n\n            var region = {\n                bottom: 0,\n                left: 0,\n                right: 0,\n                top: 0\n            };\n\n            var bookmarks = selection.createBookmarks();\n\n            if (!bookmarks.length) {\n                return region;\n            }\n\n            var bookmarkNodeEl = bookmarks[0].startNode.$;\n\n            bookmarkNodeEl.style.display = 'inline-block';\n\n            region = new CKEDITOR.dom.element(bookmarkNodeEl).getClientRect();\n\n            bookmarkNodeEl.parentNode.removeChild(bookmarkNodeEl);\n\n            var scrollPos = new CKEDITOR.dom.window(window).getScrollPosition();\n\n            region.bottom = scrollPos.y + region.bottom;\n            region.left = scrollPos.x + region.left;\n            region.right = scrollPos.x + region.right;\n            region.top = scrollPos.y + region.top;\n\n            return region;\n        },\n\n        /**\n         * Returns data for the current selection.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionData\n         * @return {Object|null} Returns an object with the following data:\n         * - element - The currently selected element, if any\n         * - text - The selected text\n         * - region - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionRegion:method\"}}{{/crossLink}}\n         */\n        getSelectionData: function() {\n            var selection = this.getSelection();\n\n            if (!selection.getNative()) {\n                return null;\n            }\n\n            var result = {\n                element: selection.getSelectedElement(),\n                text: selection.getSelectedText()\n            };\n\n            result.region = this.getSelectionRegion(selection);\n\n            return result;\n        },\n\n        /**\n         * Returns the region of the current selection.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionRegion\n         * @return {Object} Returns object which is being returned from\n         * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getClientRectsRegion:method\"}}{{/crossLink}} with three more properties:\n         * - direction - the direction of the selection. Can be one of these:\n         *   1. CKEDITOR.SELECTION_TOP_TO_BOTTOM\n         *   2. CKEDITOR.SELECTION_BOTTOM_TO_TOP\n         * - height - The height of the selection region\n         * - width - The width of the selection region\n         */\n        getSelectionRegion: function() {\n            var region = this.getClientRectsRegion();\n\n            region.direction = this.getSelectionDirection();\n\n            region.height = region.bottom - region.top;\n            region.width = region.right - region.left;\n\n            return region;\n        },\n\n        /**\n         * Returns true if the current selection is empty, false otherwise.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method isSelectionEmpty\n         * @return {Boolean} Returns true if the current selection is empty, false otherwise.\n         */\n        isSelectionEmpty: function() {\n            var ranges;\n\n            var selection = this.getSelection();\n\n            return (selection.getType() === CKEDITOR.SELECTION_NONE) ||\n                ((ranges = selection.getRanges()) && ranges.length === 1 && ranges[0].collapsed);\n        },\n\n        /**\n         * Returns object with data about the [client rectangles](https://developer.mozilla.org/en-US/docs/Web/API/Element.getClientRects) of the selection,\n         * normalized across browses. All offsets below are in page coordinates.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getClientRectsRegion\n         * @return {Object} Returns object with the following data:\n         * - bottom - bottom offset of all client rectangles\n         * - left - left offset of all client rectangles\n         * - right - right offset of all client rectangles\n         * - top - top offset of all client rectangles\n         * - startRect - An Object, which contains the following information:\n         *     + bottom - bottom offset\n         *     + height - the height of the rectangle\n         *     + left - left offset of the selection\n         *     + right - right offset of the selection\n         *     + top - top offset of the selection\n         *     + width - the width of the rectangle\n         * - endRect - An Object, which contains the following information:\n         *     + bottom - bottom offset\n         *     + height - the height of the rectangle\n         *     + left - left offset of the selection\n         *     + right - right offset of the selection\n         *     + top - top offset of the selection\n         *     + width - the width of the rectangle\n         *\n         * If there is no native selection, the objects will be filled with 0.\n         */\n        getClientRectsRegion: function() {\n            var selection = this.getSelection();\n            var nativeSelection = selection.getNative();\n\n            var defaultRect = {\n                bottom: 0,\n                height: 0,\n                left: 0,\n                right: 0,\n                top: 0,\n                width: 0\n            };\n\n            var region = {\n                bottom: 0,\n                endRect: defaultRect,\n                left: 0,\n                right: 0,\n                top: 0,\n                startRect: defaultRect\n            };\n\n            if (!nativeSelection) {\n                return region;\n            }\n\n            var bottom = 0;\n            var clientRects;\n            var left = Infinity;\n            var rangeCount;\n            var right = -Infinity;\n            var top = Infinity;\n\n            if (nativeSelection.createRange) {\n                clientRects = nativeSelection.createRange().getClientRects();\n            } else {\n                rangeCount = nativeSelection.rangeCount;\n                clientRects = (nativeSelection.rangeCount > 0) ? nativeSelection.getRangeAt(0).getClientRects() : [];\n            }\n\n            if (clientRects.length === 0) {\n                region = this.getCaretRegion();\n            } else {\n                for (var i = 0, length = clientRects.length; i < length; i++) {\n                    var item = clientRects[i];\n\n                    if (item.left < left) {\n                        left = item.left;\n                    }\n\n                    if (item.right > right) {\n                        right = item.right;\n                    }\n\n                    if (item.top < top) {\n                        top = item.top;\n                    }\n\n                    if (item.bottom > bottom) {\n                        bottom = item.bottom;\n                    }\n                }\n\n                var scrollPos = new CKEDITOR.dom.window(window).getScrollPosition();\n\n                region.bottom = scrollPos.y + bottom;\n                region.left = scrollPos.x + left;\n                region.right = scrollPos.x + right;\n                region.top = scrollPos.y + top;\n\n                if (clientRects.length) {\n                    var endRect = clientRects[clientRects.length - 1];\n                    var startRect = clientRects[0];\n\n                    region.endRect = {\n                        bottom: scrollPos.y + endRect.bottom,\n                        height: endRect.height,\n                        left: scrollPos.x + endRect.left,\n                        right: scrollPos.x + endRect.right,\n                        top: scrollPos.y + endRect.top,\n                        width: endRect.width\n                    };\n\n                    region.startRect = {\n                        bottom: scrollPos.y + startRect.bottom,\n                        height: startRect.height,\n                        left: scrollPos.x + startRect.left,\n                        right: scrollPos.x + startRect.right,\n                        top: scrollPos.y + startRect.top,\n                        width: startRect.width\n                    };\n                }\n            }\n\n            return region;\n        },\n\n        /**\n         * Retrieves the direction of the selection. The direction is from top to bottom or from bottom to top.\n         * For IE < 9 it is not possible, so the direction for these browsers will be always CKEDITOR.SELECTION_TOP_TO_BOTTOM.\n         *\n         * @instance\n         * @memberof SelectionRegion\n         * @method getSelectionDirection\n         * @return {Number} Returns a number which represents selection direction. It might be one of these:\n         * - CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n         * - CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n         */\n        getSelectionDirection: function() {\n            var direction = CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n            var selection = this.getSelection();\n            var nativeSelection = selection.getNative();\n\n            if (!nativeSelection) {\n                return direction;\n            }\n\n            var anchorNode;\n\n            if ((anchorNode = nativeSelection.anchorNode) && anchorNode.compareDocumentPosition) {\n                var position = anchorNode.compareDocumentPosition(nativeSelection.focusNode);\n\n                if (!position && nativeSelection.anchorOffset > nativeSelection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n                    direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n                }\n            }\n\n            return direction;\n        }\n    };\n\n    CKEDITOR.plugins.add(\n        'ae_selectionregion', {\n            init: function(editor) {\n                var attr,\n                    hasOwnProperty;\n\n                hasOwnProperty = Object.prototype.hasOwnProperty;\n\n                for (attr in SelectionRegion.prototype) {\n                    if (hasOwnProperty.call(SelectionRegion.prototype, attr) && typeof editor[attr] === 'undefined') {\n                        editor[attr] = SelectionRegion.prototype[attr];\n                    }\n                }\n            }\n        }\n    );\n}());","(function() {\n    'use strict';\n\n    // Wraps each of the plugin lifecycle methods in a closure that will\n    // set up the editor.__processingPlugin__ variable so it can be globally\n    // accessed exposing the plugin being processed and the lifecycle phase\n    // in which it is happening\n    //\n    // @param {Object} plugin The plugin to wrap lifecycle methods\n    var wrapPluginLifecycle = function(plugin) {\n        var methods = ['beforeInit', 'init', 'afterInit'];\n\n        methods.forEach(function(methodName) {\n            if (plugin[methodName]) {\n                plugin[methodName] = CKEDITOR.tools.override(plugin[methodName], function(originalPluginMethod) {\n                    var payload = {\n                        phase: methodName,\n                        plugin: plugin\n                    };\n\n                    return function(editor) {\n                        editor.__processingPlugin__ = payload;\n\n                        originalPluginMethod.call(this, editor);\n\n                        editor.__processingPlugin__ = null;\n                    };\n                });\n            }\n        });\n    };\n\n    // Filters the requires object to remove unwanted dependencies. At this point\n    // only 'toolbar' has been identified, but more can appear. An unwanted plugin\n    // dependency is one that prevents a necessary plugin from being removed\n    //\n    // @param {string|Array<string>} requires The requires object\n    // @return {string} The filtered requires object\n    var filterUnwantedDependencies = function(requires) {\n        if (typeof requires === 'string') {\n            requires = requires.split(',');\n        }\n\n        return requires.filter(function(require) {\n            return require !== 'toolbar';\n        });\n    };\n\n    /**\n     * CKEDITOR.plugins class utility which adds additional methods to those of CKEditor.\n     *\n     * @class CKEDITOR.plugins\n     */\n\n    /**\n     * Overrides CKEDITOR.plugins.load method so we can extend the lifecycle methods of\n     * the loaded plugins to add some metainformation about the plugin being processed\n     *\n\t * @param {String/Array} names The name of the resource to load. It may be a\n\t * string with a single resource name, or an array with several names.\n\t * @param {Function} callback A function to be called when all resources\n\t * are loaded. The callback will receive an array containing all loaded names.\n\t * @param {Object} [scope] The scope object to be used for the callback call.\n     * @memberof CKEDITOR.plugins\n     * @method load\n     * @static\n     */\n    CKEDITOR.plugins.load = CKEDITOR.tools.override(CKEDITOR.plugins.load, function(pluginsLoad){\n        // Wrap original load function so we can transform the plugin input parameter\n        // before passing it down to the original callback\n        return function(names, callback, scope) {\n            pluginsLoad.call(this, names, function(plugins) {\n                if (callback) {\n                    Object.keys(plugins).forEach(function(pluginName) {\n                        var plugin = plugins[pluginName];\n\n                        if (plugin.requires) {\n                            plugin.requires = filterUnwantedDependencies(plugin.requires);\n                        }\n\n                        wrapPluginLifecycle(plugin);\n                    });\n\n                    callback.call(scope, plugins);\n                }\n            });\n        };\n    });\n}());","(function() {\n    'use strict';\n\n    var REGEX_BOOKMARK_SCHEME = /^#.*/i;\n    var REGEX_EMAIL_SCHEME = /^[a-z0-9\\u0430-\\u044F\\._-]+@/i;\n    var REGEX_URI_SCHEME = /^(?:[a-z][a-z0-9+\\-.]*)\\:|^\\//i;\n\n    /**\n     * Link class utility. Provides methods for create, delete and update links.\n     *\n     * @class CKEDITOR.Link\n     * @constructor\n     * @param {Object} editor The CKEditor instance.\n     */\n    function Link(editor, config) {\n        this._editor = editor;\n        this.appendProtocol = config && config.appendProtocol === false ? false : true;\n    }\n\n    Link.prototype = {\n        constructor: Link,\n\n        /**\n         * Advances the editor selection to the next available position after a\n         * given link or the one in the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method advanceSelection\n         * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n         */\n        advanceSelection: function(link) {\n            link = link || this.getFromSelection();\n\n            var range = this._editor.getSelection().getRanges()[0];\n\n            if (link) {\n                range.moveToElementEditEnd(link);\n\n                var nextNode = range.getNextEditableNode();\n\n                if (nextNode && !this._editor.element.equals(nextNode.getCommonAncestor(link))) {\n                    var whitespace = /\\s/.exec(nextNode.getText());\n\n                    var offset = whitespace ? whitespace.index + 1 : 0;\n\n                    range.setStart(nextNode, offset);\n                    range.setEnd(nextNode, offset);\n                }\n            }\n\n            this._editor.getSelection().selectRanges([range]);\n        },\n\n        /**\n         * Create a link with given URI as href.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method create\n         * @param {Object} attrs A config object with link attributes. These might be arbitrary DOM attributes.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         * @param {String} URI The URI of the link.\n         */\n        create: function(URI, attrs, modifySelection) {\n            var selection = this._editor.getSelection();\n\n            var range = selection.getRanges()[0];\n\n            if (range.collapsed) {\n                var text = new CKEDITOR.dom.text(URI, this._editor.document);\n                range.insertNode(text);\n                range.selectNodeContents(text);\n            }\n\n            URI = this._getCompleteURI(URI);\n\n            var linkAttrs = CKEDITOR.tools.merge({\n                'data-cke-saved-href': URI,\n                href: URI\n            }, attrs);\n\n            var style = new CKEDITOR.style({\n                attributes: linkAttrs,\n                element: 'a'\n            });\n\n            style.type = CKEDITOR.STYLE_INLINE;\n            style.applyToRange(range, this._editor);\n\n            if (modifySelection && modifySelection.advance) {\n                this.advanceSelection();\n            } else {\n                range.select();\n            }\n        },\n\n        /**\n         * Retrieves a link from the current selection.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method getFromSelection\n         * @return {CKEDITOR.dom.element} The retrieved link or null if not found.\n         */\n        getFromSelection: function() {\n            var selection = this._editor.getSelection();\n\n            var selectedElement = selection.getSelectedElement();\n\n            if (selectedElement && selectedElement.is('a')) {\n                return selectedElement;\n            }\n\n            var range = selection.getRanges()[0];\n\n            if (range) {\n                range.shrink(CKEDITOR.SHRINK_TEXT);\n\n                return this._editor.elementPath(range.getCommonAncestor()).contains('a', 1);\n            }\n\n            return null;\n        },\n\n        /**\n         * Removes a link from the editor.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method remove\n         * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         */\n        remove: function(link, modifySelection) {\n            var editor = this._editor;\n\n            if (link) {\n                if (modifySelection && modifySelection.advance) {\n                    this.advanceSelection();\n                }\n\n                link.remove(editor);\n            } else {\n                var style = new CKEDITOR.style({\n                    alwaysRemoveElement: 1,\n                    element: 'a',\n                    type: CKEDITOR.STYLE_INLINE\n                });\n\n                // 'removeStyle()' removes the style from the editor's current selection.\n                //  We need to force the selection to be the whole link element\n                //  to remove it properly.\n\n                var selection = editor.getSelection();\n                selection.selectElement(selection.getStartElement());\n\n                editor.removeStyle(style);\n            }\n        },\n\n        /**\n         * Updates the href of an already existing link.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method update\n         * @param {CKEDITOR.dom.element} link The link element which href should be removed.\n         * @param {Object|String} attrs The attributes to update or remove. Attributes with null values will be removed.\n         * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n         */\n        update: function(attrs, link, modifySelection) {\n            var instance =  this;\n\n            link = link || this.getFromSelection();\n\n            if (typeof attrs === 'string') {\n                var uri = instance._getCompleteURI(attrs);\n\n                link.setAttributes({\n                    'data-cke-saved-href': uri,\n                    href: uri\n                });\n            } else if (typeof attrs === 'object') {\n                var removeAttrs = [];\n\n                var setAttrs = {};\n\n                Object.keys(attrs).forEach(function(key) {\n                    if (attrs[key] === null) {\n                        if (key === 'href') {\n                            removeAttrs.push('data-cke-saved-href');\n                        }\n\n                        removeAttrs.push(key);\n                    } else {\n                        if (key === 'href') {\n                            var uri = instance._getCompleteURI(attrs[key]);\n\n                            setAttrs['data-cke-saved-href'] = uri;\n                            setAttrs[key] = uri;\n                        } else {\n                            setAttrs[key] = attrs[key];\n                        }\n                    }\n                });\n\n                link.removeAttributes(removeAttrs);\n                link.setAttributes(setAttrs);\n            }\n\n            if (modifySelection && modifySelection.advance) {\n                this.advanceSelection(link);\n            }\n        },\n\n        /**\n         * Checks if the URI begins with a '#' symbol to determine if it's an on page bookmark.\n         * If it doesn't, it then checks if the URI has an '@' symbol. If it does and the URI\n         * looks like an email and doesn't have 'mailto:', 'mailto:' is added to the URI.\n         * If it doesn't and the URI doesn't have a scheme, the default 'http' scheme with\n         * hierarchical path '//' is added to the URI.\n         *\n         * @instance\n         * @memberof CKEDITOR.Link\n         * @method _getCompleteURI\n         * @param {String} URI The URI of the link.\n         * @protected\n         * @return {String} The URI updated with the protocol.\n         */\n        _getCompleteURI: function(URI) {\n            if (REGEX_BOOKMARK_SCHEME.test(URI)) {\n                return URI;\n            } else if (REGEX_EMAIL_SCHEME.test(URI)) {\n                URI = 'mailto:' + URI;\n            } else if (!REGEX_URI_SCHEME.test(URI)) {\n                URI = this.appendProtocol ? 'http://' + URI : URI;\n            }\n\n            return URI;\n        }\n    };\n\n    CKEDITOR.Link = CKEDITOR.Link || Link;\n}());","(function() {\n    'use strict';\n\n    /**\n     * Debounce util function. If a function execution is expensive, it might be debounced. This means\n     * that it will be executed after some amount of time after its last call. For example, if we attach a\n     * a function on scroll event, it might be called hundreds times per second. In this case it may be\n     * debounced with, let's say 100ms. The real execution of this function will happen 100ms after last\n     * scroll event.\n     *\n     * @memberof CKEDITOR.tools\n     * @method debounce\n     * @param {Array} args An array of arguments which the callback will receive.\n     * @param {Function} callback The callback which has to be called after given timeout.\n     * @param {Number} timeout Timeout in milliseconds after which the callback will be called.\n     * @param {Object} context The context in which the callback will be called. This argument is optional.\n     * @static\n     */\n    CKEDITOR.tools.debounce = CKEDITOR.tools.debounce || function(callback, timeout, context, args) {\n        var debounceHandle;\n\n        var callFn = function() {\n            var callContext = context || this;\n\n            clearTimeout(debounceHandle);\n\n            var result = [];\n\n            for (var len = arguments.length, startIndex = 0; startIndex < len; ++startIndex) {\n                result.push(arguments[startIndex]);\n            }\n\n            var callArgs = result.concat(args || []);\n\n            debounceHandle = setTimeout(function() {\n                callback.apply(callContext, callArgs);\n            }, timeout);\n        };\n\n        callFn.detach = function() {\n            clearTimeout(debounceHandle);\n        };\n\n        return callFn;\n    };\n}());","import debounce from './debounce';\nimport link from './link';\nimport plugins from './plugins';\nimport selectionRegion from './selection-region';\nimport table from './table';\nimport tools from './tools';\nimport uicore from './uicore';\n\nexport {\n    debounce,\n    link,\n    plugins,\n    selectionRegion,\n    table,\n    tools,\n    uicore\n};","import '../core';\nimport '../plugins';\n\nimport '../components/uibridge/uibridge.js';\n\nimport extend from '../oop/oop';\nimport Lang from '../oop/lang';\nimport Base from '../oop/base';\nimport Selections from '../selections/selections';\nimport UI from '../components/main.jsx';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * AlloyEditor main class. Creates instance of the editor and provides the user configuration\n * to the UI.\n *\n * @class Core\n * @constructor\n */\nfunction Core(config) {\n    Core.superclass.constructor.call(this, config);\n}\n\nextend(Core, Base, {\n    /**\n     * Initializer lifecycle implementation for the AlloyEditor class. Creates a CKEditor\n     * instance, passing it the provided configuration attributes.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method initializer\n     * @param config {Object} Configuration object literal for the editor.\n     */\n    initializer: function(config) {\n        var node = this.get('srcNode');\n\n        if (this.get('enableContentEditable')) {\n            node.setAttribute('contenteditable', 'true');\n        }\n\n        var editor = CKEDITOR.inline(node);\n\n        editor.config.allowedContent = this.get('allowedContent');\n\n        editor.config.toolbars = this.get('toolbars');\n\n        editor.config.removePlugins = this.get('removePlugins');\n        editor.config.extraPlugins = this.get('extraPlugins');\n        editor.config.placeholderClass = this.get('placeholderClass');\n\n        editor.config.pasteFromWordRemoveStyles = false;\n        editor.config.pasteFromWordRemoveFontStyles = false;\n\n        editor.config.selectionKeystrokes = this.get('selectionKeystrokes');\n\n        Lang.mix(editor.config, config);\n\n        if (CKEDITOR.env.ie && !CKEDITOR.env.edge) {\n            editor.config.extraPlugins = editor.config.extraPlugins.replace('ae_dragresize', 'ae_dragresize_ie');\n            editor.config.removePlugins = editor.config.removePlugins.replace('ae_dragresize', 'ae_dragresize_ie');\n        }\n\n        editor.once('contentDom', function() {\n\n            this._addReadOnlyLinkClickListener(editor);\n\n            var editable = editor.editable();\n\n            editable.addClass('ae-editable');\n\n        }.bind(this));\n\n        this._editor = editor;\n\n        AlloyEditor.loadLanguageResources(this._renderUI.bind(this));\n    },\n\n    /**\n     * Destructor lifecycle implementation for the AlloyEdtor class. Destroys the CKEditor\n     * instance and destroys all created toolbars.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method destructor\n     */\n    destructor: function() {\n        this._destroyed = true;\n\n        if (this._editorUIElement) {\n            ReactDOM.unmountComponentAtNode(this._editorUIElement);\n            this._editorUIElement.parentNode.removeChild(this._editorUIElement);\n        }\n\n        var nativeEditor = this.get('nativeEditor');\n\n        if (nativeEditor) {\n            var editable = nativeEditor.editable();\n\n            if (editable) {\n                editable.removeClass('ae-editable');\n\n                if (this.get('enableContentEditable')) {\n                    this.get('srcNode').setAttribute('contenteditable', 'false');\n                }\n            }\n\n            this._clearSelections();\n\n            nativeEditor.destroy();\n        }\n    },\n\n\n    /**\n     * Clear selections from window object\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _clearSelections\n     */\n    _clearSelections: function() {\n        var nativeEditor = this.get('nativeEditor');\n        var isMSSelection = typeof window.getSelection != 'function';\n\n        if (isMSSelection) {\n            nativeEditor.document.$.selection.empty();\n        } else {\n            nativeEditor.document.getWindow().$.getSelection().removeAllRanges();\n        }\n    },\n\n    /**\n     * Method to set default link behavior\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _addReadOnlyLinkClickListener\n     * @param {Object} editor\n     */\n    _addReadOnlyLinkClickListener: function(editor) {\n        editor.editable().on('click', this._defaultReadOnlyClickFn, this, {\n            editor: editor\n        });\n    },\n\n    /**\n     * Called on `click` event when the editor is in read only mode. Navigates to link's URL or opens\n     * the link in a new window.\n     *\n     * @memberof Core\n     * @instance\n     * @event readOnlyClick\n     * @protected\n     * @method _defaultReadOnlyClickFn\n     * @param {Object} event The fired `click` event payload\n     */\n    _defaultReadOnlyClickFn: function(event) {\n        var mouseEvent = event.data.$;\n        var hasCtrlKey = mouseEvent.ctrlKey || mouseEvent.metaKey;\n        var shouldOpen = this._editor.config.readOnly || hasCtrlKey;\n\n        mouseEvent.preventDefault();\n\n        if (!shouldOpen) {\n            return;\n        }\n\n        if (event.listenerData.editor.editable().editor.fire('readOnlyClick', event.data) !== false) {\n            var ckElement = new CKEDITOR.dom.elementPath(event.data.getTarget(), this);\n            var link = ckElement.lastElement;\n\n            if (link) {\n                var href = link.$.attributes.href ? link.$.attributes.href.value : null;\n                var target = hasCtrlKey ? '_blank' : link.$.attributes.target ? link.$.attributes.target.value : null;\n                this._redirectLink(href, target);\n            }\n        }\n    },\n\n    /**\n     * Retrieves the native CKEditor instance. Having this, the developer may use the API of CKEditor OOTB.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _getNativeEditor\n     * @return {Object} The current instance of CKEditor.\n     */\n    _getNativeEditor: function() {\n        return this._editor;\n    },\n\n    /**\n     * Redirects the browser to a given link\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _redirectLink\n     * @param {string} href The href to take the browser to\n     * @param {string=} target Specifies where to display the link\n     */\n    _redirectLink: function(href, target) {\n        if (target && href) {\n            window.open(href, target);\n        }\n        else if (href) {\n            window.location.href = href;\n        }\n    },\n\n    /**\n     * Renders the specified from the user toolbars.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _renderUI\n     */\n    _renderUI: function() {\n        if (!this._destroyed) {\n            var editorUIElement = document.createElement('div');\n            editorUIElement.className = 'ae-ui';\n\n            var uiNode = this.get('uiNode') || document.body;\n\n            uiNode.appendChild(editorUIElement);\n\n            this._mainUI = ReactDOM.render(<UI\n                editor={this}\n                eventsDelay={this.get('eventsDelay')}\n                toolbars={this.get('toolbars')} />, editorUIElement);\n\n            this._editorUIElement = editorUIElement;\n\n            this.get('nativeEditor').fire('uiReady');\n        }\n    },\n\n    /**\n     * The function returns an HTML element from the passed value. If the passed value is a string, it should be\n     * the Id of the element which have to be retrieved from the DOM.\n     * If an HTML Element is passed, the element itself will be returned.\n     *\n     * @memberof Core\n     * @instance\n     * @method _toElement\n     * @protected\n     * @param {!(String|HTMLElement)} value String, which have to correspond to an HTML element from the DOM,\n     * or the HTML element itself. If Id is passed, the HTML element will be retrieved from the DOM.\n     * @return {HTMLElement} An HTML element.\n     */\n    _toElement: function(value) {\n        if (Lang.isString(value)) {\n            value = document.getElementById(value);\n        }\n\n        return value;\n    },\n\n    /**\n     * Validates the allowed content attribute. Look\n     * [here](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent) for more information about the\n     * supported values.\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _validateAllowedContent\n     * @param {Any} The value to be checked\n     * @return {Boolean} True if the current value is valid configuration, false otherwise\n     */\n    _validateAllowedContent: function(value) {\n        return Lang.isString(value) || Lang.isObject(value) || Lang.isBoolean(value);\n    },\n\n    /**\n     * Validates the value of toolbars attribute\n     *\n     * @memberof Core\n     * @instance\n     * @protected\n     * @method _validateToolbars\n     * @param {Any} The value to be checked\n     * @return {Boolean} True if the current value is valid toolbars configuration, false otherwise\n     */\n    _validateToolbars: function(value) {\n        return Lang.isObject(value) || Lang.isNull(value);\n    }\n}, {\n    ATTRS: {\n        /**\n         * Configures the allowed content for the current instance of AlloyEditor.\n         * Look on the [official CKEditor API](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent)\n         * for more information about the valid values.\n         *\n         * @memberof Core\n         * @instance\n         * @property allowedContent\n         * @default true\n         * @writeOnce\n         * @type {Boolean, String, Object}\n         */\n        allowedContent: {\n            validator: '_validateAllowedContent',\n            value: true,\n            writeOnce: true\n        },\n\n        /**\n         * Specifies whether AlloyEditor set the contenteditable attribute\n         * to \"true\" on its srcNode.\n         *\n         * @memberof Core\n         * @instance\n         * @property enableContentEditable\n         * @type Boolean\n         * @default true\n         * @writeOnce\n         */\n        enableContentEditable: {\n            validator: Lang.isBoolean,\n            value: true,\n            writeOnce: true\n        },\n\n        /**\n         * The delay (timeout), in ms, after which events such like key or mouse events will be processed.\n         *\n         * @memberof Core\n         * @instance\n         * @property eventsDelay\n         * @type {Number}\n         */\n        eventsDelay: {\n            validator: Lang.isNumber,\n            value: 100\n        },\n\n        /**\n         * Specifies the extra plugins which have to be loaded to the current CKEditor instance in order to\n         * make AlloyEditor to work properly.\n         *\n         * @memberof Core\n         * @instance\n         * @property extraPlugins\n         * @default 'uicore,selectionregion,dragresize,addimages,placeholder,tabletools,tableresize,autolink'\n         * @writeOnce\n         * @type {String}\n         */\n        extraPlugins: {\n            validator: Lang.isString,\n            value: 'ae_uicore,ae_selectionregion,ae_selectionkeystrokes,ae_imagealignment,ae_addimages,ae_placeholder,' +\n                'ae_tabletools,ae_tableresize,ae_autolink,ae_embed,ae_autolist,ae_dragresize,' +\n                'ae_uibridge',\n                //'ae_uibridge,ae_richcombobridge,ae_panelmenubuttonbridge,ae_menubridge,ae_menubuttonbridge,ae_buttonbridge',\n            writeOnce: true\n        },\n\n        /**\n         * Retrieves the native CKEditor instance. Having this, the developer may use the full API of CKEditor.\n         *\n         * @memberof Core\n         * @instance\n         * @property nativeEditor\n         * @readOnly\n         * @type {Object}\n         */\n        nativeEditor: {\n            getter: '_getNativeEditor',\n            readOnly: true\n        },\n\n        /**\n         * Specifies the class, which should be added by Placeholder plugin\n         * {{#crossLink \"CKEDITOR.plugins.ae_placeholder}}{{/crossLink}}\n         * when editor is not focused.\n         *\n         * @memberof Core\n         * @instance\n         * @property placeholderClass\n         * @default 'ae-placeholder'\n         * @writeOnce\n         * @type {String}\n         */\n        placeholderClass: {\n            validator: Lang.isString,\n            value: 'ae-placeholder',\n            writeOnce: true\n        },\n\n        /**\n         * Specifies the plugins, which come by default with CKEditor, but which are not needed by AlloyEditor.\n         * These plugins add the default UI for CKeditor, which is no more needed. Please note that AlloyEdtor\n         * comes with its own highly optimized copy of CKEditor (just customized via their official download page).\n         * This version does not come with the unneeded plugins, so the value of this property won't be needed.\n         * However, if you decide to go with the OOTB version of CKEditor, you will have to remove some of the\n         * plugins if you decide to use AlloyEditor. Keep in mind that removing these plugins doesn't remove them\n         * entirely from CKEditor. It just removes them from its current instance, in which you will use different\n         * UI - those of AlloyEditor. You will be fully able to use both OOTB CKEditor and AlloyEditor on the same\n         * page!\n         *\n         * @memberof Core\n         * @instance\n         * @property removePlugins\n         * @default 'contextmenu,toolbar,elementspath,resize,liststyle,link'\n         * @writeOnce\n         * @type {String}\n         */\n        removePlugins: {\n            validator: Lang.isString,\n            value: 'contextmenu,toolbar,elementspath,resize,liststyle,link',\n            writeOnce: true\n        },\n\n        /**\n         * Array of manual selection triggers. They can be configured to manually show a specific selection toolbar\n         * by forcing the selection type. A selectionKeystroke item consists of a keys property with a [CKEditor keystroke\n         * definition](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-keystrokes) and a selection property with\n         * the selection name to trigger.\n         *\n         * @memberof Core\n         * @instance\n         * @property selectionKeystrokes\n         * @type {Array}\n         */\n        selectionKeystrokes: {\n            validator: Lang.isArray,\n            value: [{\n                keys: CKEDITOR.CTRL + 76 /*L*/,\n                selection: 'link'\n            }, {\n                keys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /*L*/,\n                selection: 'embed'\n            }]\n        },\n\n        /**\n         * The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n         *\n         * @memberof Core\n         * @instance\n         * @property srcNode\n         * @type String | Node\n         * @writeOnce\n         */\n        srcNode: {\n            setter: '_toElement',\n            writeOnce: true\n        },\n\n        /**\n         * The toolbars configuration for this editor instance\n         *\n         * @memberof Core\n         * @instance\n         * @property {Object} toolbars\n         */\n        toolbars: {\n            validator: '_validateToolbars',\n            value: {\n                add: {\n                    buttons: ['image', 'embed', 'camera', 'hline', 'table'],\n                    tabIndex: 2\n                },\n                styles: {\n                    selections: Selections,\n                    tabIndex: 1\n                }\n            }\n        },\n\n        /**\n         * The Node ID or HTMl node, where AlloyEditor's UI should be rendered.\n         *\n         * @memberof Core\n         * @instance\n         * @property uiNode\n         * @type String | Node\n         * @writeOnce\n         */\n        uiNode: {\n            setter: '_toElement',\n            writeOnce: true\n        }\n    }\n});\n\nCKEDITOR.event.implementOn(Core);\n\nexport default Core;\n","import Core from './core.js';\nimport Lang from '../oop/lang.js';\n\nimport Buttons from '../components/buttons';\nimport Toolbars from '../components/toolbars';\n\nimport SelectionGetArrowBoxClasses from '../selections/selection-arrowbox';\nimport Selections from '../selections/selections';\nimport SelectionSetPosition from '../selections/selection-position';\nimport SelectionTest from '../selections/selection-test';\n\nimport Attribute from '../oop/attribute';\nimport extend from '../oop/oop';\n\n// An object containing all currently registered plugins in AlloyEditor.\nvar BRIDGE_BUTTONS = {};\n\n/**\n * Creates an instance of AlloyEditor.\n *\n * @memberof AlloyEditor\n * @method editable\n * @static\n * @param {String|Node} node The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n * @param {Object} config Configuration attributes for the current instance of AlloyEditor.\n * @return {Object} An instance of {{#crossLink \"Core\"}}{{/crossLink}}\n */\nconst editable = function(node, config) {\n    config = config || {};\n    config.srcNode = node;\n\n    AlloyEditor.implementEventTarget();\n\n    return new Core(config);\n};\n\n/**\n * The full URL for the AlloyEditor installation directory.\n * It is possible to manually provide the base path by setting a\n * global variable named `ALLOYEDITOR_BASEPATH`. This global variable\n * must be set **before** the editor script loading.\n *\n * @memberof AlloyEditor\n * @method getBasePath\n * @static\n * @return {String} The found base path\n */\nconst getBasePath = function() {\n    // Find out the editor directory path, based on its <script> tag.\n    var path = window.ALLOYEDITOR_BASEPATH || '';\n\n    if (!path) {\n        var scripts = document.getElementsByTagName('script');\n\n        for (var i = 0; i < scripts.length; i++) {\n            var match = scripts[ i ].src.match(AlloyEditor.regexBasePath);\n\n\n            if (match) {\n                path = match[1];\n                break;\n            }\n        }\n    }\n\n    // In IE (only) the script.src string is the raw value entered in the\n    // HTML source. Other browsers return the full resolved URL instead.\n    if (path.indexOf(':/') === -1 && path.slice(0, 2) !== '//' ) {\n        // Absolute path.\n        if (path.indexOf('/') === 0) {\n            path = location.href.match(/^.*?:\\/\\/[^\\/]*/)[0] + path;\n        }\n        // Relative path.\n        else {\n            path = location.href.match(/^[^\\?]*\\/(?:)/)[0] + path;\n        }\n    }\n\n    if (!path){\n        throw 'The AlloyEditor installation path could not be automatically detected. Please set the global variable \"ALLOYEDITOR_BASEPATH\" before creating editor instances.';\n    }\n\n    return path;\n};\n\n/**\n * Detects and load the corresponding language file if AlloyEditor language strings are not already present.\n * The function fires a {{#crossLink \"AlloyEditor/languageResourcesLoaded:event\"}}{{/crossLink}} event\n *\n * @memberof AlloyEditor\n * @method loadLanguageResources\n * @static\n * @param {Function} callback Optional callback to be called when AlloyEditor loads the language resource.\n */\nconst loadLanguageResources = function(callback) {\n    AlloyEditor.implementEventTarget();\n\n    if (Lang.isFunction(callback)) {\n        if (AlloyEditor.Strings) {\n            setTimeout(callback, 0);\n        } else {\n            AlloyEditor.once('languageResourcesLoaded', function() {\n                setTimeout(callback, 0);\n            });\n        }\n    }\n\n    if (!AlloyEditor._langResourceRequested) {\n        AlloyEditor._langResourceRequested = true;\n\n        var languages = ['af', 'ar', 'bg', 'bn', 'bs', 'ca', 'cs', 'cy', 'da', 'de', 'el', 'en-au', 'en-ca', 'en-gb', 'en', 'eo', 'es', 'et', 'eu', 'fa', 'fi', 'fo', 'fr-ca', 'fr', 'gl', 'gu', 'he', 'hi', 'hr', 'hu', 'id', 'is', 'it', 'ja', 'ka', 'km', 'ko', 'ku', 'lt', 'lv', 'mk', 'mn', 'ms', 'nb', 'nl', 'no', 'pl', 'pt-br', 'pt', 'ro', 'ru', 'si', 'sk', 'sl', 'sq', 'sr-latn', 'sr', 'sv', 'th', 'tr', 'tt', 'ug', 'uk', 'vi', 'zh-cn', 'zh'];\n\n        var userLanguage = navigator.language || navigator.userLanguage || 'en';\n\n        var parts = userLanguage.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/);\n        var lang = parts[1];\n        var locale = parts[2];\n\n        if (languages.indexOf(lang + '-' + locale) >= 0) {\n            lang = lang + '-' + locale;\n        } else if (languages.indexOf(lang) === -1) {\n            lang = 'en';\n        }\n\n        CKEDITOR.scriptLoader.load(AlloyEditor.getUrl('lang/alloy-editor/' + lang + '.js'), function(loaded) {\n            if (loaded) {\n                AlloyEditor.fire('languageResourcesLoaded');\n            }\n        }, this);\n    }\n};\n\n/**\n * Gets the full URL for AlloyEditor resources. By default, URLs\n * returned by this function contain a querystring parameter (\"t\")\n * set to the {@link CKEDITOR#timestamp} value.\n *\n * @memberof AlloyEditor\n * @method getUrl\n * @static\n * @param {String} resource The resource whose full URL we want to get.\n * It may be a full, absolute, or relative URL.\n * @return {String} The full URL.\n */\nconst getUrl = function(resource) {\n    var basePath = AlloyEditor.getBasePath();\n\n    // If this is not a full or absolute path.\n    if (resource.indexOf(':/') === -1 && resource.indexOf('/') !== 0) {\n        resource = basePath + resource;\n    }\n\n    // Add the timestamp, except for directories.\n    if (CKEDITOR.timestamp && resource.charAt( resource.length - 1 ) !== '/' && !(/[&?]t=/).test(resource)) {\n        resource += (resource.indexOf('?') >= 0 ? '&' : '?') + 't=' + CKEDITOR.timestamp;\n    }\n\n    return resource;\n};\n\n/**\n * Implements event firing and subscribing via CKEDITOR.event.\n *\n * @memberof AlloyEditor\n * @method implementEventTarget\n * @static\n */\nconst implementEventTarget = function() {\n    if (!AlloyEditor.fire && !AlloyEditor.on) {\n        CKEDITOR.event.implementOn(AlloyEditor);\n    }\n};\n\n/**\n * Regular expression which should match the script which have been used to load AlloyEditor.\n *\n * @memberof AlloyEditor\n * @property regexBasePath\n * @type {RegExp}\n * @static\n */\nconst regexBasePath = /(^|.*[\\\\\\/])(?:alloy-editor[^/]+|alloy-editor)\\.js(?:\\?.*|;.*)?$/i;\n\n/**\n * Fired when AlloyEditor detects the browser language and loads the corresponding language file. Once this event\n * is fired, AlloyEditor.Strings will be populated with data.\n *\n * @event languageResourcesLoaded\n */\n\n/**\n * Returns the required plugin names needed for a given plugin\n * if it is already registered or an empty array.\n *\n * @memberof AlloyEditor\n * @method getButtons\n * @param {Array} buttons An array of buttons or plugin names.\n * @return {Function} A function that can be invoked to resolve the requested button names.\n * @static\n */\nconst getButtons = function(buttons) {\n    return function() {\n        return buttons.reduce(function(acc, val) {\n            val = BRIDGE_BUTTONS[val] || [val];\n            return acc.concat(val);\n        }, []);\n    };\n};\n\n/**\n * Register a button and try to get its required plugins.\n *\n * @memberof AlloyEditor\n * @method registerBridgeButton\n * @param {String} buttonName The name of the button.\n * @param {String} pluginName The name of the plugin that registers the button.\n * @static\n */\nconst registerBridgeButton = function(buttonName, pluginName) {\n    if (!BRIDGE_BUTTONS[pluginName]) {\n        BRIDGE_BUTTONS[pluginName] = [];\n    }\n\n    BRIDGE_BUTTONS[pluginName].push(buttonName);\n};\n\n/**\n * @method OOP\n * @memberof AlloyEditor\n */\nconst OOP = {\n    extend\n};\n\nexport {\n    Attribute,\n    Buttons,\n    Core,\n    editable,\n    getBasePath,\n    getButtons,\n    getUrl,\n    implementEventTarget,\n    Lang,\n    loadLanguageResources,\n    OOP,\n    registerBridgeButton,\n    SelectionGetArrowBoxClasses,\n    Selections,\n    SelectionSetPosition,\n    SelectionTest,\n    Toolbars\n};\n"],"sourceRoot":""}