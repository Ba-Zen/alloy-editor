{"version":3,"sources":["webpack://AlloyEditor/webpack/bootstrap","webpack://AlloyEditor/external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\",\"umd\":\"react\"}","webpack://AlloyEditor/./src/components/buttons/button-icon.jsx","webpack://AlloyEditor/./src/components/base/button-state-classes.js","webpack://AlloyEditor/./src/components/base/button-command.js","webpack://AlloyEditor/./src/oop/lang.js","webpack://AlloyEditor/./src/components/base/button-style.js","webpack://AlloyEditor/external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\",\"umd\":\"react-dom\"}","webpack://AlloyEditor/./node_modules/prop-types/index.js","webpack://AlloyEditor/./src/components/base/widget-focus-manager.js","webpack://AlloyEditor/./src/components/base/button-command-active.js","webpack://AlloyEditor/./src/components/base/button-props.js","webpack://AlloyEditor/./src/components/buttons/button-dropdown.jsx","webpack://AlloyEditor/./src/components/base/button-keystroke.js","webpack://AlloyEditor/./src/components/buttons/button-commands-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list.jsx","webpack://AlloyEditor/./src/components/base/button-action-style.js","webpack://AlloyEditor/./src/selections/selection-test.js","webpack://AlloyEditor/./src/oop/oop.js","webpack://AlloyEditor/./src/components/base/widget-exclusive.js","webpack://AlloyEditor/./src/components/buttons/button-link-edit.jsx","webpack://AlloyEditor/./src/components/base/widget-dropdown.js","webpack://AlloyEditor/./src/plugins/index.js","webpack://AlloyEditor/./src/oop/attribute.js","webpack://AlloyEditor/./src/selections/selections.js","webpack://AlloyEditor/./src/selections/selection-arrowbox.js","webpack://AlloyEditor/./src/selections/selection-position.js","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-item-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles-list-header.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera-image.jsx","webpack://AlloyEditor/./src/components/buttons/button-command-list-item.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed-video-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-autocomplete-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-link.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-target-edit.jsx","webpack://AlloyEditor/./src/components/buttons/button-target-list.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-edit-browse.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-edit.jsx","webpack://AlloyEditor/./src/components/base/toolbar-buttons.js","webpack://AlloyEditor/./src/components/base/widget-arrow-box.js","webpack://AlloyEditor/./src/components/base/widget-position.js","webpack://AlloyEditor/./src/adapter/main.js","webpack://AlloyEditor/./src/adapter/core.js","webpack://AlloyEditor/./src/core/index.js","webpack://AlloyEditor/./src/core/debounce.js","webpack://AlloyEditor/./src/core/link.js","webpack://AlloyEditor/./src/core/plugins.js","webpack://AlloyEditor/./src/core/selection-region.js","webpack://AlloyEditor/./src/core/table.js","webpack://AlloyEditor/./src/core/tools.js","webpack://AlloyEditor/./src/core/uicore.js","webpack://AlloyEditor/./src/plugins/addimages.js","webpack://AlloyEditor/./src/plugins/autolink.js","webpack://AlloyEditor/./src/plugins/autolist.js","webpack://AlloyEditor/./src/plugins/dragresize.js","webpack://AlloyEditor/./src/plugins/dragresize_ie.js","webpack://AlloyEditor/./src/plugins/dragresize_ie11.js","webpack://AlloyEditor/./src/plugins/embed.js","webpack://AlloyEditor/./src/plugins/embedurl.js","webpack://AlloyEditor/./src/plugins/Resizer.es.js","webpack://AlloyEditor/./src/plugins/DragEvent.es.js","webpack://AlloyEditor/./src/plugins/imagealignment.js","webpack://AlloyEditor/./src/plugins/pasteimages.js","webpack://AlloyEditor/./src/plugins/placeholder.js","webpack://AlloyEditor/./src/plugins/selectionkeystrokes.js","webpack://AlloyEditor/./src/plugins/tableresize.js","webpack://AlloyEditor/./src/plugins/tabletools.js","webpack://AlloyEditor/./src/components/uibridge/index.js","webpack://AlloyEditor/./src/components/uibridge/button.jsx","webpack://AlloyEditor/./src/components/uibridge/menu-button.jsx","webpack://AlloyEditor/./src/components/uibridge/menu.jsx","webpack://AlloyEditor/./src/components/uibridge/panel-menu-button.jsx","webpack://AlloyEditor/./src/components/uibridge/richcombo.jsx","webpack://AlloyEditor/./src/components/uibridge/uibridge.js","webpack://AlloyEditor/./src/oop/base.js","webpack://AlloyEditor/./src/components/main.jsx","webpack://AlloyEditor/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://AlloyEditor/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://AlloyEditor/./src/components/buttons/index.js","webpack://AlloyEditor/./src/components/buttons/button-accessibility-image-alt.jsx","webpack://AlloyEditor/./src/components/buttons/button-background-color.jsx","webpack://AlloyEditor/./src/components/buttons/button-bold.jsx","webpack://AlloyEditor/./src/components/buttons/button-camera.jsx","webpack://AlloyEditor/./src/components/buttons/button-code.jsx","webpack://AlloyEditor/./src/components/buttons/button-color.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed.jsx","webpack://AlloyEditor/./src/components/buttons/button-embed-video.jsx","webpack://AlloyEditor/./src/components/buttons/button-h1.jsx","webpack://AlloyEditor/./src/components/buttons/button-h2.jsx","webpack://AlloyEditor/./src/components/buttons/button-hline.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-image-align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-image.jsx","webpack://AlloyEditor/./src/components/buttons/button-indent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-italic.jsx","webpack://AlloyEditor/./src/components/buttons/button-item-selector-audio.jsx","webpack://AlloyEditor/./src/components/buttons/button-item-selector-image.jsx","webpack://AlloyEditor/./src/components/buttons/button-item-selector-video.jsx","webpack://AlloyEditor/./src/components/buttons/button-link-browse.jsx","webpack://AlloyEditor/./src/components/buttons/button-ol.jsx","webpack://AlloyEditor/./src/components/buttons/button-outdent-block.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-left.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-align-right.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-center.jsx","webpack://AlloyEditor/./src/components/buttons/button-paragraph-justify.jsx","webpack://AlloyEditor/./src/components/buttons/button-quote.jsx","webpack://AlloyEditor/./src/components/buttons/button-remove-format.jsx","webpack://AlloyEditor/./src/components/buttons/button-separator.jsx","webpack://AlloyEditor/./src/components/buttons/button-spacing.jsx","webpack://AlloyEditor/./src/components/buttons/button-strike.jsx","webpack://AlloyEditor/./src/components/buttons/button-styles.jsx","webpack://AlloyEditor/./src/components/buttons/button-subscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-superscript.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-cell.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-column.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-heading.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-remove.jsx","webpack://AlloyEditor/./src/components/buttons/button-table-row.jsx","webpack://AlloyEditor/./src/components/buttons/button-table.jsx","webpack://AlloyEditor/./src/components/buttons/button-twitter.jsx","webpack://AlloyEditor/./src/components/buttons/button-ul.jsx","webpack://AlloyEditor/./src/components/buttons/button-underline.jsx","webpack://AlloyEditor/./src/components/toolbars/index.js","webpack://AlloyEditor/./src/components/toolbars/toolbar-add.jsx","webpack://AlloyEditor/./src/components/toolbars/toolbar-styles.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","undefined","ButtonIcon","_react","_ref","editor","symbol","_ref$className","className","nativeEditor","spritemap","config","path","classNamePrefix","combinedClassName","_react2","default","createElement","width","height","href","_lang","WrappedComponent","_WrappedComponent","_class","_classCallCheck","this","_possibleConstructorReturn","__proto__","getPrototypeOf","apply","arguments","_inherits","_createClass","stateClasses","Lang","isFunction","isActive","isDisabled","_class2","_temp","_this","_ret","_len","length","args","Array","_key","concat","execCommand","data","props","command","modifiesSelection","selectionChange","fire","isArray","toString","isBoolean","isNull","isNumber","isFinite","isObject","valueType","_typeof","isString","mix","receiver","supplier","toInt","parseInt","_get","style","parts","split","currentMember","shift","_style","CKEDITOR","result","elementPath","getStyle","checkActive","_reactDom","DIRECTION_NONE","DIRECTION_NEXT","DIRECTION_PREV","ACTION_NONE","ACTION_MOVE_FOCUS","ACTION_DISMISS_FOCUS","focus","event","_isValidTarget","target","_descendants","activeDescendantEl","_activeDescendant","document","activeElement","focusFirstChild","indexOf","stopPropagation","preventDefault","handleKey","action","_getFocusAction","type","_moveFocus","direction","onDismiss","_refresh","keys","_getFocusMoveDirection","dismissAction","_getFocusDismissAction","dismiss","focusMoveDirection","_isValidKey","keyCode","dismissNext","dismissPrev","circular","next","prev","shifKey","element","tagName","toLowerCase","numDescendants","descendant","setAttribute","Math","max","min","domNode","ReactDOM","findDOMNode","descendants","querySelectorAll","priorityDescendants","slice","forEach","item","dataTabIndex","getAttribute","push","sort","a","b","some","index","getCommand","state","TRISTATE_ON","buttonCfg","tools","merge","_widgetFocusManager","ButtonDropdown","onFocus","onKeyDown","tabIndex","role","children","React","Component","defaultProps","_widgetFocusManager2","keystroke","commandName","random","exec","keystrokeFn","fn","addCommand","_defaultKeystrokeCommand","keystrokeHandler","keystrokes","setKeystroke","_buttonCommandListItem","ButtonCommandsList","createRef","current","ref","id","listId","_renderActions","commands","items","map","_buttonCommandListItem2","description","label","icon","_buttonDropdown","_buttonStylesListItem","_buttonStylesListItemRemove","_buttonStylesListHeader","ButtonStylesList","blockStyles","inlineStyles","objectStyles","styles","STYLE_BLOCK","STYLE_INLINE","STYLE_OBJECT","_blockStyles","_inlineStyles","_objectStyles","removeStylesItem","showRemoveStylesItem","_buttonStylesListItemRemove2","toggleDropdown","_buttonDropdown2","_buttonStylesListHeader2","AlloyEditor","Strings","_renderStylesItems","_this2","_buttonStylesListItem2","activeStyle","applyStyle","getSelection","lock","removeStyle","unlock","_isRangeAtElementEnd","range","getText","endOffset","equals","startContainer","endContainer","startOffset","embedSelectionTest","payload","selectionData","embedUrlSelectionTest","headingTextSelectionTest","headings","selectionEmpty","isSelectionEmpty","region","getCommonAncestor","isReadOnly","contains","linkSelectionTest","getRanges","Link","getFromSelection","elementIsNotImage","getName","imageSelectionTest","textSelectionTest","tableSelectionTest","table","Table","isEditable","SelectionTest","embed","embedUrl","header","image","link","text","extend","protoProps","staticProps","Error","supplierProto","receiverProto","constructor","superclass","requestExclusive","itemExclusive","setState","nextProps","filter","obj","itemKey","cancelExclusive","renderExclusive","_buttonProps","_buttonIcon","_buttonLinkAutocompleteList","_buttonLinkTargetEdit","_widgetDropdown","ButtonLinkEdit","_clearLink","linkHref","_focusLinkInput","_handleKeyDown","_updateLink","autocompleteSelected","advanceSelection","_handleLinkHrefChange","_handleLinkTargetChange","itemDropdown","linkTarget","_removeLink","linkUtils","selection","bookmarks","createBookmarks","remove","advance","selectBookmarks","appendProtocol","linkAttrs","modifySelection","update","linkInput","_getInitialState","manualSelection","targetSelector","allowedTargets","handleLinkTargetChange","selectedTarget","linkTargetDefault","mergeDropdownProps","ButtonLinkTargetEdit","autocompleteDropdown","dataFn","autocompleteDropdownProps","handleLinkAutocompleteClick","_handleLinkAutocompleteClick","setAutocompleteState","_setAutocompleteState","term","ButtonLinkAutocompleteList","_buttonLinkAutocompleteList2","buttonClearLink","aria-label","clearInput","onClick","title","clear","_buttonIcon2","placeholderProp","env","ie","placeholder","editLink","removeLink","disabled","showTargetSelector","_buttonLinkTargetEdit2","_extends","onChange","confirm","_isValidState","_props","defaultLinkTarget","initialLink","instance","focusLinkEl","requestAnimationFrame","setTimeout","validState","selected","autocompleteUrl","customIndexStart","_buttonProps2","_widgetDropdown2","expanded","dropdownTrigger","toggleDirection","moveFocus","_addimages","_autolink","_autolist","_dragresize","_dragresize_ie","_dragresize_ie3","_embed","_embedurl","_imagealignment","_pasteimages","_placeholder","_selectionkeystrokes","_tableresize","_tabletools","addimages","autolink","autolist","dragresize","dragresizeie","embedurl","imagealignment","pasteimages","selectionkeystrokes","tableresize","tabletools","Attribute","__config__","__ATTRS__","attr","currentAttr","ATTRS","_isInitialized","_init","curValue","_callStringOrFunction","set","readOnly","writeOnce","validator","setter","stringOrFunction","_toConsumableArray","hasDefaultValue","hasPassedValueViaConfig","valueFn","_selectionArrowbox","_selectionPosition","_selectionTest","Selections","buttons","test","setPosition","SelectionSetPosition","full","simple","getArrowBoxClasses","SelectionGetArrowBoxClasses","tableSelectionGetArrowBoxClasses","DEFAULT_GUTTER","left","top","centerToolbar","toolbar","rect","toolbarNode","uiNode","body","uiNodeStyle","getComputedStyle","uiNodeMarginLeft","getPropertyValue","uiNodeMarginRight","totalWidth","clientWidth","halfNodeWidth","offsetWidth","scrollPosition","dom","getScrollPosition","gutter","widgetXY","getWidgetXYPoint","x","y","SELECTION_BOTTOM_TO_TOP","endPosition","offsetHeight","moveToPoint","imageSelectionSetPosition","editorEvent","getClientRect","tableSelectionSetPosition","scrollTop","_buttonActionStyle","_buttonStyle","ButtonStylesListItem","_onClick","styleCfg","margin","_preview","buildPreview","dangerouslySetInnerHTML","__html","_buttonActionStyle2","_buttonStyle2","ButtonStylesListItemRemove","_removeStyles","removeBlocks","blockItem","blockStyle","normal","ButtonsStylesListHeader","ButtonCameraImage","takePhoto","videoEl","_videoContainerRef","canvasEl","_canvasContainerRef","context","getContext","_videoHeight","videoWidth","drawImage","imgURL","toDataURL","el","createFromHtml","insertElement","_handleStreamError","error","alert","_handleStreamSuccess","stream","addEventListener","videoHeight","isNaN","_stream","navigator","mozGetUserMedia","mozSrcObject","srcObject","play","_buttonTakePhotoRef","stop","getVideoTracks","track","getUserMedia","webkitGetUserMedia","msGetUserMedia","video","audio","_buttonCommand","ButtonCommandListItem","_getClassName","_buttonCommand2","KEY_ENTER","KEY_ESC","ButtonEmbedEdit","_embedLink","url","_removeEmbed","embedWrapper","getAscendant","hasClass","getInitialState","selectedElement","getSelectedElement","findOne","clearLinkStyle","opacity","deleteEmbed","data-type","_propTypes","ButtonEmbedVideoEdit","_embedVideoURL","videoURL","_focusVideoUrlInput","refs","_handleVideoURLChange","replaceState","initialEmbed","inputPlaceholder","pasteVideoLink","clearVideoURLStyle","propTypes","PropTypes","isRequired","clearTimeout","_timeout","_updateItems","delay","_renderAutocompleteItems","nextState","data-value","_this3","promise","Promise","resolve","then","_buttonKeystroke","_buttonLinkEdit","_buttonStateClasses","ButtonLink","_requestExclusive","cssClass","getStateClasses","mergeButtonCfgProps","_buttonLinkEdit2","CTRL","_buttonKeystroke2","_buttonStateClasses2","_buttonTargetList","allowedLinkTargets","aria-expanded","_buttonTargetList2","ButtonTargetList","listTargets","_renderListTargets","linkTargetSelf","linkTargetBlank","linkTargetParent","linkTargetTop","targets","_getAllowedTargetItems","ButtonLinkEditBrowse","_browseClick","documentBrowseLinkUrl","browseLinkCallback","documentBrowseLinkCallback","linkEditButtonRef","changeLinkCallback","selectedItem","linkTitle","plugins","creole","location","origin","ButtonTableEdit","_createTable","tableUtils","attrs","tableAttributes","cols","rows","_handleChange","inputName","rowsRef","colsRef","time","Date","now","rowsId","colsId","htmlFor","columns","border","cellPadding","cellSpacing","additionalProps","reduce","list","button","getToolbarButtons","buttonProps","toolbarButtons","filterExclusive","Buttons","cfg","mergeExclusiveProps","tabKey","trigger","arrowBoxClasses","getInteractionPoint","SELECTION_TOP_TO_BOTTOM","cancelAnimationFrame","_animationFrameId","viewPaneSize","getViewPaneSize","eventPayload","nativeEvent","pos","pageX","endRect","startRect","_getXPoint","_getYPoint","eventX","right","leftDist","abs","rightDist","elementTarget","$","offsetTop","bottom","SELECTION_LEFT_TO_RIGHT","SELECTION_RIGHT_TO_LEFT","domElement","startPoint","endPoint","setStyles","removeClass","_animate","addClass","isVisible","interactionPoint","finalX","finalY","initialX","initialY","parseFloat","constrainToViewport","res","getConstrainedPosition","xy","callback","_core","_buttons","_toolbars","_selections","_attribute","_oop","BRIDGE_BUTTONS","editable","node","srcNode","implementEventTarget","Core","getBasePath","ALLOYEDITOR_BASEPATH","scripts","getElementsByTagName","match","src","regexBasePath","loadLanguageResources","once","_langResourceRequested","languages","userLanguage","language","lang","locale","scriptLoader","load","getUrl","loaded","resource","basePath","timestamp","charAt","on","implementOn","getButtons","acc","val","registerBridgeButton","buttonName","pluginName","OOP","Toolbars","_base","_main","EMBED_VIDEO_WIDTH","EMBED_VIDEO_HEIGHT","_oop2","Base","initializer","inline","allowedContent","toolbars","removePlugins","extraPlugins","embedProviders","placeholderClass","pasteFromWordRemoveStyles","pasteFromWordRemoveFontStyles","selectionKeystrokes","edge","plugin","version","replace","_addReadOnlyLinkClickListener","_editor","_renderUI","destructor","_destroyed","_editorUIElement","unmountComponentAtNode","parentNode","removeChild","_clearSelections","destroy","isMSSelection","empty","getWindow","removeAllRanges","_defaultReadOnlyClickFn","mouseEvent","hasCtrlKey","ctrlKey","metaKey","shouldOpen","listenerData","ckElement","getTarget","lastElement","attributes","_redirectLink","_getNativeEditor","open","editorUIElement","appendChild","_mainUI","render","_main2","eventsDelay","_toElement","getElementById","_validateAllowedContent","_validateToolbars","tpl","urlSchemes","enableContentEditable","SHIFT","add","selections","_debounce","_link","_plugins","_selectionRegion","_table","_tools","_uicore","debounce","selectionRegion","uicore","timeout","debounceHandle","callFn","callArgs","callContext","detach","REGEX_BOOKMARK_SCHEME","REGEX_EMAIL_SCHEME","REGEX_URI_SCHEME","moveToElementEditEnd","nextNode","getNextEditableNode","whitespace","offset","setStart","setEnd","selectRanges","URI","collapsed","insertNode","selectNodeContents","_getCompleteURI","data-cke-saved-href","applyToRange","select","is","getChildren","count","getItem","shrink","SHRINK_TEXT","alwaysRemoveElement","selectElement","getStartElement","uri","setAttributes","removeAttrs","setAttrs","removeAttributes","wrapPluginLifecycle","methods","methodName","override","originalPluginMethod","phase","__processingPlugin__","filterUnwantedDependencies","requires","require","pluginsLoad","names","scope","SelectionRegion","createSelectionFromPoint","createSelectionFromRange","startX","startY","endX","endY","end","start","caretPositionFromPoint","offsetNode","createRange","caretRangeFromPoint","createTextRange","endRange","duplicate","setEndPoint","getCaretRegion","bookmarkNodeEl","startNode","display","scrollPos","getSelectionData","getNative","getSelectedText","getSelectionRegion","getClientRectsRegion","getSelectionDirection","ranges","getType","SELECTION_NONE","nativeSelection","defaultRect","clientRects","Infinity","getClientRects","rangeCount","getRangeAt","anchorNode","compareDocumentPosition","position","focusNode","anchorOffset","focusOffset","Node","DOCUMENT_POSITION_PRECEDING","init","IE_NON_DIRECTLY_EDITABLE_ELEMENT","col","colgroup","tbody","td","tfoot","th","thead","tr","HEADING_BOTH","HEADING_COL","HEADING_NONE","HEADING_ROW","_createElement","append","row","j","cell","appendBogus","setHeading","heading","firstCell","cells","moveToPosition","POSITION_AFTER_START","webkit","NODE_ELEMENT","hasAttribute","getParent","getHeading","rowHeadingSettings","tHead","colHeadingSettings","nodeName","headingSettings","parent","getChildCount","POSITION_BEFORE_START","newCell","tableHead","tableBody","getElementsByTag","tableHeading","hadColHeading","needColHeading","needRowHeading","tableFirstRow","tableFirstRowChildCount","getChild","renameNode","createTHead","previousFirstRow","getFirst","newFirstRow","newFirstRowChildCount","removeAttribute","insertBefore","hasColHeading","headingCommands","jsonp","urlTemplate","urlParams","errorCallback","callbackKey","getNextNumber","_","jsonpCallbacks","response","cleanUp","scriptElement","output","getBody","cancel","simulate","eventInstance","createEvent","initEvent","dispatchEvent","ariaState","ariaElement","_createAriaElement","uiTasksTimeout","handleUI","allowEsc","handleAria","_event","innerHTML","join","handleMouseLeave","aeUINodes","found","relatedTarget","message","focusHandler","attachListener","removeListener","statusElement","isIE","_onDragEnter","_onDragOver","_onDragDrop","_onPaste","_handleFiles","files","file","imageFiles","_processFile","transferFiles","dataTransfer","clientX","clientY","_preventEvent","clipboardData","pastedData","imageFile","getAsFile","reader","FileReader","bin","imageData","readAsDataURL","userAgent","KEY_BACK","KEY_COMMA","KEY_SEMICOLON","KEY_SPACE","DELIMITERS","REGEX_LAST_WORD","REGEX_URL","REGEX_EMAIL","_onKeyUp","method","dataValue","RegExp","_isValidURL","_isValidEmail","_getLastWord","previousText","_currentKeyCode","previousNode","getPrevious","lastChild","getLast","_startContainer","_offset","substring","lastWord","pop","email","_onKeyDown","_ckLink","_replaceContentByLink","content","ckLink","linkNode","_subscribeToKeyEvent","nextEditableNode","getNextNode","caretOffset","getNext","newRange","setEndAfter","DEFAULT_CONFIG","regex","_checkForBackspaceAndUndo","insertHtml","bullet","_getListConfig","configRegex","textContainer","regexLen","autolistCfg","regexItem","_createList","listConfig","setText","IMAGE_HANDLES","both","scale","POSITION_ELEMENT_FN","bl","handle","box","positionElement","bm","round","br","lm","tl","_box","tm","rm","IMAGE_SNAP_TO_SIZE","isFirefox","documentElement","isWebKit","enablePlugin","addCss","onLoad","_evt","Resizer","container","preview","handles","imageScaleResize","handleName","createHandle","classList","isHandle","show","snapToSize","otherImages","toArray","splice","getBoundingBox","showHandles","hide","elements","getElementsByClassName","hideHandles","initDrag","e","resizer","drag","DragEvent","onStart","showPreview","isDragging","onDrag","calculateSize","updatePreview","previewBox","updateHandles","onRelease","hidePreview","onComplete","resizeComplete","backgroundImage","delta","ratio","others","other","resizeElement","startPos","events","mousemove","keydown","mouseup","currentPos","shiftKey","ctrl","alt","altKey","which","release","removeEventListener","mouseDownListener","html","self","resizeTimeout","len","arr","ctx","String","getBoundingClientRect","pageXOffset","pageYOffset","alignmentsObj","center","cursor","regexPercent","template","hidpi","icons","widgetDef","widgets","image2","checkHasNaturalRatio","natural","getNatural","clientHeight","dimensions","naturalWidth","naturalHeigh","img","Image","heigh","initOn","alignClasses","image2_alignClasses","captionedClass","image2_captionedClass","helpers","hasCaption","caption","ready","wrapper","align","alignElement","setData","image2_disableResizer","setupResizer","getStyleableElement","getWidgetAllowedContent","contentTransformations","features","checkFeature","contenteditable","data-cke-saved-src","oldData","classes","dimension","setDimensions","downcast","downcastWidgetElement","draggable","editables","selector","getWidgetFeatures","getClasses","classRegex","repository","parseElementClasses","getLabel","pathName","requiredContent","styleableElements","upcast","upcastWidgetElement","isCenterWrapper","centerWrapperChecker","figure","replaceWith","isLinkedOrStandaloneImage","attrsHolder","resizeWrapper","parseCssText","wrapWith","htmlParser","class","isEmpty","writeCssText","validChildren","div","child","enterMode","ENTER_P","widget","doc","imageOrLink","oldResizeWrapper","evt","factor","screenX","screenY","startWidth","startHeight","listeners","cursorClass","nativeEvt","newWidth","newHeight","updateData","moveDiffX","moveDiffY","attachToDocuments","collection","globalDoc","onMouseMove","onMouseUp","widgetElement","rules","figcaption","templateBlock","afterInit","block","integrate","alignCommandIntegrator","ae_dragresize_ie11","stateShifter","ae_dragresize_ie11_alignClasses","ae_dragresize_ie11_captionedClass","shiftables","stateActions","oldValue","newValue","changed","newData","deflate","wrapInCentering","unwrapFromCentering","setStyle","captionPlaceholder","replaceSafely","needsDeflate","newEl","wrapInLink","getLinkAttributesGetter","removed","unwrapFromLink","attribsAndStyles","text-align","activeEnterMode","move","linkData","replacing","replaced","insertElementIntoRange","inflate","naturalHeight","getLinkAttributes","getLinkAttributesParser","parseLinkAttributes","removeWidgetAlignment","imageAlignment","deflated","focused","setWrapperAlign","shiftState","advanced","advCSSClasses","trim","ae_dragresize_ie11_disableResizer","TRISTATE_OFF","unlink","querySelector","resizerNE","resizerNW","resizerSE","resizerSW","factorX","factorY","adjustToX","adjustToY","execCallbacks","enabled","refresh","getFocusedWidget","allowed","registered","TRISTATE_DISABLED","REGEX_HTTP","REGEX_DEFAULT_LINK","DEFAULT_AE_EMBED_URL_TPL","DEFAULT_AE_EMBED_WIDGET_TPL","DEFAULT_AE_EMBED_DEFAULT_LINK_TPL","AE_EMBED_URL_TPL","embedUrlTemplate","AE_EMBED_WIDGET_TPL","embedWidgetTpl","AE_EMBED_DEFAULT_LINK_TPL","embedLinkDefaultTpl","defaultEmbedWidgetUpcastFn","mask","encodeURIComponent","createATag","setHtml","_msg","aTagHtml","embedWidgetUpcastFn","addElementCallback","FILTER_SKIP_TREE","_Resizer","DEFAULT_LFR_EMBED_WIDGET_TPL","EMBED_ALIGNMENT","CENTER","LEFT","RIGHT","ALIGN_VALUES","CENTERED_EMBED_STYLE","getEmbedAlignment","embedAlignment","centeredEmbed","every","styleCheck","vendorPrefixes","vendorPrefix","removeEmbedAlignment","setEmbedAlignment","alignment","wrapperElement","parentElement","pwidth","floor","JSON","parse","stringify","iframeElement","selectWidget","root","find","elementList","imageElement","currentAlignment","currentElement","LFR_EMBED_WIDGET_TPL","providers","provider","scheme","generateEmbedContent","helpMessage","videoPlaybackDisabled","helpMessageIcon","Liferay","Util","getLexiconIconTpl","upcastWidget","iframe","embedContent","getOuterHtml","widgetFragment","fragment","fromHtml","showError","errorMsg","validProvider","embedId","_selectEmbedWidget","platformNotSupported","enterValidUrl","stylesJSON","bounds","alignValue","selectedEmbed","sender","_DragEvent","editorBounds","IMAGE_ALIGNMENT","CENTERED_IMAGE_STYLE","getImageAlignment","centeredImage","imageContainer","textAlign","removeImageAlignment","setImageAlignment","refreshCommands","onload","brFiller","needsBrFiller","enterModeEmptyValue","1","2","3","_checkEmptyData","_removePlaceholderClass","editableNode","innerHtml","editorNode","selectionKeystroke","pxUnit","cssLength","isInline","getPageOffset","isResizing","pillars","getCustomData","setCustomData","buildTableColumnPillars","clearPillarsCache","pillar","getPillarAtPosition","ColumnResizer","getWidth","getBorderWidth","side","computed","borderMap","thin","medium","thick","getMasterPillarRow","$rows","maxCells","cellsCount","$elected","$tr","pillarIndex","rtl","tBodies","tbodyPosition","getDocumentPosition","nextTd","colSpan","pillarLeft","pillarRight","pillarWidth","positionX","resizing","currentShift","leftSideCells","rightSideCells","leftShiftBoundary","rightShiftBoundary","onMouseDown","resizeStart","columnIndex","buildTableMap","leftColumnCells","rightColumnCells","leftMinSize","Number","MAX_VALUE","rightMinSize","leftCell","rightCell","setOpacity","resizeEnd","resizeColumn","removeCustomData","_loop","leftOldWidth","rightOldWidth","tableWidth","sizeShift","getDocumentElement","posX","resizerNewPosition","dest","toElement","cellNodeRegex","createDef","def","contextSensitive","addCmd","cmd","addFeature","placeCursorInCell","deleteRows","insertRow","deleteColumns","insertColumn","deleteCells","mergeCells","verticalSplitCell","horizontalSplitCell","insertCell","getSelectedCells","retval","database","moveOutOfCellGuard","setMarker","nearestCell","walker","guard","dtd","clearAllMarkers","getFocusElementAfterDelCells","cellsToDelete","last","focusedCell","getDocument","startRow","startRowIndex","rowIndex","lastCell","endRowIndex","rowSpan","endRow","cloneRow","nextRow","newRow","clone","insertAfter","selectionOrRow","rowsToDelete","mapRow","cellRowIndex","nextMapRow","cursorPosition","getCellColIndex","isStart","rowCells","colIndex","mapCell","getColumnsIndices","startCol","lastCol","cloneCol","nextCol","nextCell","selectionOrCell","startColIndex","endColIndex","firstRowCells","startElement","cellToFocus","trimCell","bogus","getBogus","placeAtEnd","docInner","docOuter","collapse","cellInRow","tableMap","oRow","cellInCol","oCol","mergeDirection","isDetect","commonAncestor","mapHeight","mapWidth","startColumn","targetCell","rowspan","colspan","er","lastRowIndex","totalRowSpan","totalColSpan","frag","documentFragment","cellFirstChild","isBlockBoundary","whitespaces","moveChildren","trs","nodeList","tailTr","newRowSpan","newCellRowSpan","newRowIndex","ceil","newCellTr","newCellRow","candidateCell","cellsInSameRow","newColSpan","newCellColSpan","cellsInSameCol","aRows","aMap","oCell","iColSpan","iRowSpan","rs","cs","_button","_menuButton","_menu","_panelMenuButton","_richcombo","_uibridge","menuButton","menu","panelMenuButton","richcombo","uibridge","BUTTON_DEFS","UI_BUTTON","beforeInit","ui","addButton","buttonDefinition","addHandler","generateButtonBridge","ButtonBridge","_temp2","_handleClick","buttonCommand","buttonOnClick","_React$Component","buttonClassName","buttonDisplayName","buttonLabel","buttonType","iconClassName","iconStyle","cssStyle","skin","getIconStyle","cssStyleParts","backgroundPosition","backgroundSize","displayName","MENUBUTTON_DEFS","UI_MENU_BUTTON","addMenuButton","menuButtonName","menuButtonDefinition","UI_MENUBUTTON","generateMenuButtonBridge","MenuButtonBridge","panelMenuButtonDisplayName","_getMenuItems","onMenu","menuItems","menuItem","getMenuItem","menuItemDefinition","definition","menuItemState","groups","groupsOrder","menuGroups","addMenuGroup","order","addMenuItem","group","addMenuItems","definitions","itemName","removeMenuItem","PANEL_MENU_DEFS","generatePanelMenuButtonBridge","panelMenuButtonName","panelMenuButtonDefinition","PanelMenuButtonBridge","panel","_getPanel","panelMenuButtonOnBlock","onBlock","blockElement","getHtml","UI_PANELBUTTON","addPanelMenuButton","RICH_COMBO_DEFS","generateRichComboBridge","richComboName","richComboDefinition","RichComboBridge","currentValue","editorCombo","currentTarget","_items","setValue","_setValue","onRender","_cacheValue","richComboLabel","_getItems","richCombo","UI_RICHCOMBO","addRichCombo","originalUIAddFn","typeHandler","handlers","_callChain","wat","ctor","reverse","_widgetExclusive","UI","_onDismissToolbarFocus","hidden","_onEditorInteraction","_onActionPerformed","_onEditorKey","_mousedownListener","_setUIHidden","_keyDownListener","prevProps","prevState","_getAvailableToolbarsMessage","ariaUpdate","_ariaUpdateTemplates","_getAriaUpdates","ariaUpdates","noToolbar","ariaUpdateNoToolbar","oneToolbar","ariaUpdateOneToolbar","manyToolbars","ariaUpdateManyToolbars","toolbarsNodeList","toolbarNames","_getAriaUpdateTemplate","domEvent","targetNode","number","_widgetExclusive2","ReactPropTypesSecret","emptyFunction","shim","propName","componentName","propFullName","secret","err","getShim","ReactPropTypes","array","bool","func","string","any","arrayOf","instanceOf","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","_buttonAccessibilityImageAlt","_buttonBackgroundColor","_buttonBold","_buttonCameraImage","_buttonCamera","_buttonCode","_buttonColor","_buttonCommandsList","_buttonEmbedEdit","_buttonEmbed","_buttonEmbedVideoEdit","_buttonEmbedVideo","_buttonH","_buttonH3","_buttonHline","_buttonImageAlignCenter","_buttonImageAlignLeft","_buttonImageAlignRight","_buttonImage","_buttonIndentBlock","_buttonItalic","_buttonItemSelectorAudio","_buttonItemSelectorImage","_buttonItemSelectorVideo","_buttonLinkBrowse","_buttonLinkEditBrowse","_buttonLink","_buttonOl","_buttonOutdentBlock","_buttonParagraphAlign","_buttonParagraphAlignLeft","_buttonParagraphAlignRight","_buttonParagraphCenter","_buttonParagraphJustify","_buttonQuote","_buttonRemoveFormat","_buttonSeparator","_buttonSpacing","_buttonStrike","_buttonStylesList","_buttonStyles","_buttonSubscript","_buttonSuperscript","_buttonTableCell","_buttonTableColumn","_buttonTableEdit","_buttonTableHeading","_buttonTableRemove","_buttonTableRow","_buttonTable","_buttonTwitter","_buttonUl","_buttonUnderline","ButtonAccessibilityImageAlt","ButtonBackgroundColor","ButtonBold","ButtonCamera","ButtonCode","ButtonColor","ButtonEmbed","ButtonEmbedVideo","ButtonH1","ButtonH2","ButtonHline","ButtonImageAlignCenter","ButtonImageAlignLeft","ButtonImageAlignRight","ButtonImage","ButtonIndentBlock","ButtonItalic","ButtonItemSelectorAudio","ButtonItemSelectorImage","ButtonItemSelectorVideo","ButtonLinkBrowse","ButtonOl","ButtonOutdentBlock","ButtonParagraphAlign","ButtonParagraphAlignLeft","ButtonParagraphAlignRight","ButtonParagraphCenter","ButtonParagraphJustify","ButtonQuote","ButtonRemoveFormat","ButtonSeparator","ButtonSpacing","ButtonStrike","ButtonStylesListHeader","ButtonStyles","ButtonSubscript","ButtonSuperscript","ButtonTableCell","ButtonTableColumn","ButtonTableHeading","ButtonTableRemove","ButtonTableRow","ButtonTable","ButtonTwitter","ButtonUl","ButtonUnderline","prop","_initialiseProps","imageAlt","_handleAltChange","_updateImageAlt","focusAltEl","refAltInput","_focusAltInput","activeColor","activeColorClass","colors","_getColors","itemStyle","styleClass","_checkActive","buttonStylesProps","_buttonStylesList2","styleConfig","styleFn","_applyStyle","primary","success","danger","warning","info","bold","aria-pressed","_buttonCameraImage2","protocol","cameraDisabled","camera","code","_buttonEmbedEdit2","_buttonEmbedVideoEdit2","h1","h2","horizontalrule","_buttonCommandActive","alignCenter","_buttonCommandActive2","alignLeft","alignRight","handleClick","fileInput","click","inputSyle","accept","_onInputChange","inputEl","indent","italic","_buttonLinkEditBrowse2","_buttonLink2","ButtonOrderedList","numberedlist","outdent","buttonCommandsList","buttonCommandsListId","_buttonCommandsList2","_getCommands","inlineIcons","activeCommand","aria-owns","alignJustify","quote","removeformat","activeSpacing","spacings","_getSpacings","active","strike","_getStyles","buttonStylesList","formatted","cite","subscript","superscript","cellInsertBefore","cellInsertAfter","cellDelete","cellMerge","cellMergeDown","cellMergeRight","cellSplitHorizontal","cellSplitVertical","column","columnInsertBefore","columnInsertAfter","columnDelete","activeHeading","activeHeadingIntro","headers","activeHeadingLabel","headersNone","headersRow","headersColumn","headersBoth","_removeTable","deleteTable","rowInsertBefore","rowInsertAfter","rowDelete","_buttonTableEdit2","MAX_TWEET_LENGTH","_getHref","twitter","selectedText","via","twitterHref","ButtonUnorderedlist","bulletedlist","underline","_toolbarAdd","_toolbarStyles","ToolbarAdd","ToolbarStyles","_toolbarButtons","_widgetArrowBox","_widgetPosition","POSITION_LEFT","POSITION_RIGHT","_updatePosition","_prevProps","_prevState","isContentEditable","_getButtons","_getToolbarClassName","data-tabindex","updatePosition","clientRect","offsetLeft","gutterExclusive","cancelAnimation","_widgetArrowBox2","_widgetPosition2","_toolbarButtons2","currentSelection","_getCurrentSelection","getArrowBoxClassesFn","_getSelectionFunction","cssClasses","buttonsGroup","getToolbarButtonGroups","selectionType","hasGroups","selectionFn","selectionFunction","testFn","setPositionFn"],"mappings":"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","file":"alloy-editor-core-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 42);\n","(function() { module.exports = window[undefined]; }());","import React from 'react';\n\nexport default function ButtonIcon({editor, symbol, className = ''}) {\n\tconst nativeEditor = editor.get('nativeEditor');\n\tconst spritemap = nativeEditor.config.spritemap || '';\n\tconst path = `${spritemap}#${symbol}`;\n\tconst classNamePrefix = className ? ` ${className}` : '';\n\tconst combinedClassName = `ae-svg-icon${classNamePrefix}`;\n\n\treturn (\n\t\t<svg className={combinedClassName} width=\"18\" height=\"18\">\n\t\t\t<use href={path} />\n\t\t</svg>\n\t);\n}\n","import Lang from '../../oop/lang';\n\n/**\n * ButtonStateClasses is a mixin that decorates the domElement of a component\n * with different CSS classes based on the current state of the element.\n *\n * To check for state, the component can expose the following methods:\n * - `Function` **isActive** to check the active state\n * - `Function` **isDisabled** to check the disabled state\n *\n * @class ButtonStateClasses\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Returns the list of state classes associated to the current element's state, according\n\t\t * to the results of the isActive and isDisabled methods.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonStateClasses\n\t\t * @method getStateClasses\n\t\t * @return {String} A string with the state CSS classes.\n\t\t */\n\t\tgetStateClasses() {\n\t\t\tlet stateClasses = '';\n\n\t\t\t// Check for active state\n\t\t\tif (Lang.isFunction(this.isActive) && this.isActive()) {\n\t\t\t\tstateClasses += 'ae-button-pressed';\n\t\t\t}\n\n\t\t\t// Check for disabled state\n\t\t\tif (Lang.isFunction(this.isDisabled) && this.isDisabled()) {\n\t\t\t\tstateClasses += ' ae-button-disabled';\n\t\t\t}\n\n\t\t\treturn stateClasses;\n\t\t}\n\t};\n","/**\n * ButtonCommand is a mixin that executes a command via CKEDITOR's API.\n *\n * @class ButtonCommand\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Executes a CKEditor command and fires `actionPerformed` event.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonCommand\n\t\t * @param {Object=} data Optional data to be passed to CKEDITOR's `execCommand` method.\n\t\t * @method execCommand\n\t\t */\n\t\texecCommand = data => {\n\t\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\t\teditor.execCommand(this.props.command, data);\n\n\t\t\tif (this.props.modifiesSelection) {\n\t\t\t\teditor.selectionChange(true);\n\t\t\t}\n\n\t\t\teditor.fire('actionPerformed', this);\n\t\t};\n\t};\n","/**\n * Provides core language utilities.\n *\n * @class Lang\n */\nconst Lang = {\n\t/**\n\t * Check if the passed value is an array.\n\t *\n\t * @memberof Lang\n\t * @method isArray\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is an array, false otherwise.\n\t * @static\n\t */\n\tisArray: function(value) {\n\t\treturn Object.prototype.toString.call(value) === '[object Array]';\n\t},\n\n\t/**\n\t * Check if the passed value is boolean.\n\t *\n\t * @memberof Lang\n\t * @method isBoolean\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is boolean, false otherwise.\n\t * @static\n\t */\n\tisBoolean: function(value) {\n\t\treturn typeof value === 'boolean';\n\t},\n\n\t/**\n\t * Check if the passed value is a function.\n\t *\n\t * @memberof Lang\n\t * @method isFunction\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is a function, false otherwise.\n\t * @static\n\t */\n\tisFunction: function(value) {\n\t\treturn typeof value === 'function';\n\t},\n\n\t/**\n\t * Check if the passed value is NULL.\n\t *\n\t * @memberof Lang\n\t * @method isNull\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is NULL, false otherwise.\n\t * @static\n\t */\n\tisNull: function(value) {\n\t\treturn value === null;\n\t},\n\n\t/**\n\t * Check if the passed value is number.\n\t *\n\t * @memberof Lang\n\t * @method isNumber\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is number, false otherwise.\n\t * @static\n\t */\n\tisNumber: function(value) {\n\t\treturn typeof value === 'number' && isFinite(value);\n\t},\n\n\t/**\n\t * Check if the passed value is an object\n\t *\n\t * @memberof Lang\n\t * @method isObject\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is an object, false otherwise.\n\t * @static\n\t */\n\tisObject: function(value) {\n\t\tlet valueType = typeof value;\n\n\t\treturn value && (valueType === 'object' || Lang.isFunction(value));\n\t},\n\n\t/**\n\t * Check if the passed value is a string.\n\t *\n\t * @memberof Lang\n\t * @method isString\n\t * @param {Any} value The value which have to be checked.\n\t * @return {Boolean} True if the passed value is a string, false otherwise.\n\t * @static\n\t */\n\tisString: function(value) {\n\t\treturn typeof value === 'string';\n\t},\n\n\t/**\n\t * Adds all properties from the supplier to the receiver.\n\t * The function will add all properties, not only these owned by the supplier.\n\t *\n\t * @memberof Lang\n\t * @method mix\n\t * @param {Object} receiver The object which will receive properties.\n\t * @param {Object} supplier The object which provides properties.\n\t * @return {Object} The modified receiver.\n\t * @static\n\t */\n\tmix: function(receiver, supplier) {\n\t\tlet hasOwnProperty = Object.prototype.hasOwnProperty;\n\n\t\tfor (let key in supplier) {\n\t\t\tif (hasOwnProperty.call(supplier, key)) {\n\t\t\t\treceiver[key] = supplier[key];\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Converts value to Integer.\n\t *\n\t * @memberof Lang\n\t * @method toInt\n\t * @param {Any} value The value which have to be converted to Integer.\n\t * @return {Integer} The converted value.\n\t * @static\n\t */\n\ttoInt: function(value) {\n\t\treturn parseInt(value, 10);\n\t},\n};\n\nexport default Lang;\n","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonStyle is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonStyle\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonStyle\n\t\t * @method componentWillMount\n\t\t */\n\t\tcomponentWillMount() {\n\t\t\tif (Lang.isFunction(super.componentWillMount)) {\n\t\t\t\tsuper.componentWillMount();\n\t\t\t}\n\n\t\t\tlet style = this.props.style;\n\n\t\t\tif (Lang.isString(style)) {\n\t\t\t\tlet parts = style.split('.');\n\t\t\t\tlet currentMember = this.props.editor.get('nativeEditor')\n\t\t\t\t\t.config;\n\t\t\t\tlet property = parts.shift();\n\n\t\t\t\twhile (\n\t\t\t\t\tproperty &&\n\t\t\t\t\tLang.isObject(currentMember) &&\n\t\t\t\t\tLang.isObject(currentMember[property])\n\t\t\t\t) {\n\t\t\t\t\tcurrentMember = currentMember[property];\n\t\t\t\t\tproperty = parts.shift();\n\t\t\t\t}\n\n\t\t\t\tif (Lang.isObject(currentMember)) {\n\t\t\t\t\tstyle = currentMember;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._style = new CKEDITOR.style(style);\n\t\t}\n\n\t\t/**\n\t\t * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonStyle\n\t\t * @method componentWillUnmount\n\t\t */\n\t\tcomponentWillUnmount() {\n\t\t\tif (Lang.isFunction(super.componentWillUnmount)) {\n\t\t\t\tsuper.componentWillUnmount();\n\t\t\t}\n\n\t\t\tthis._style = null;\n\t\t}\n\n\t\t/**\n\t\t * Returns instance of CKEDITOR.style which represents the current button style.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonStyle\n\t\t * @method getStyle\n\t\t * @return {CKEDITOR.style} The current style representation.\n\t\t */\n\t\tgetStyle() {\n\t\t\treturn this._style;\n\t\t}\n\n\t\t/**\n\t\t * Checks if style is active in the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonStyle\n\t\t * @method isActive\n\t\t * @return {Boolean} True if style is active, false otherwise.\n\t\t */\n\t\tisActive() {\n\t\t\tlet result;\n\n\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\tlet elementPath = editor.elementPath();\n\n\t\t\tresult = this.getStyle().checkActive(elementPath, editor);\n\n\t\t\treturn result;\n\t\t}\n\t};\n","(function() { module.exports = window[undefined]; }());","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","import Lang from '../../oop/lang.js';\nimport ReactDOM from 'react-dom';\n\nlet DIRECTION_NONE = 0;\nlet DIRECTION_NEXT = 1;\nlet DIRECTION_PREV = -1;\n\nlet ACTION_NONE = 0;\nlet ACTION_MOVE_FOCUS = 1;\nlet ACTION_DISMISS_FOCUS = 2;\n\n/**\n * WidgetFocusManager is a mixin that provides keyboard navigation inside a widget. To do this,\n * it exposes the following props and methods:\n *\n * @class WidgetFocusManager\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method componentDidMount\n\t\t */\n\t\tcomponentDidMount() {\n\t\t\tif (Lang.isFunction(super.componentDidMount)) {\n\t\t\t\tsuper.componentDidMount();\n\t\t\t}\n\n\t\t\tthis._refresh();\n\t\t}\n\n\t\t/**\n\t\t * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n\t\t * Refreshes the descendants list.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method componentDidUpdate\n\t\t */\n\t\tcomponentDidUpdate() {\n\t\t\tif (Lang.isFunction(super.componentDidUpdate)) {\n\t\t\t\tsuper.componentDidUpdate();\n\t\t\t}\n\n\t\t\tthis._refresh();\n\t\t}\n\n\t\t/**\n\t\t * Focuses the current active descendant.\n\t\t *\n\t\t * Several Widgets can be nested in a component hierarchy by attaching this focus method to\n\t\t * the widget DOM node, transferring the DOM focus control to the inner FocusManager.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method focus\n\t\t */\n\t\tfocus = event => {\n\t\t\tif (!event || this._isValidTarget(event.target)) {\n\t\t\t\tif (this._descendants && this._descendants.length) {\n\t\t\t\t\tlet activeDescendantEl = this._descendants[\n\t\t\t\t\t\tthis._activeDescendant\n\t\t\t\t\t];\n\t\t\t\t\t// When user clicks with the mouse, the activeElement is already set and there\n\t\t\t\t\t// is no need to focus it. Focusing of the active descendant (usually some button) is required\n\t\t\t\t\t// in case of keyboard navigation, because the focused element might be not the first button,\n\t\t\t\t\t// but the div element, which contains the button.\n\t\t\t\t\tif (\n\t\t\t\t\t\tdocument.activeElement !== activeDescendantEl &&\n\t\t\t\t\t\t!this.props.focusFirstChild\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis._descendants.indexOf(\n\t\t\t\t\t\t\t\tdocument.activeElement\n\t\t\t\t\t\t\t) === -1\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tactiveDescendantEl.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event) {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Handles the key events on a DOM node to execute the appropriate navigation when needed.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @param {Object} event The Keyboard event that was detected on the widget DOM node.\n\t\t * @method handleKey\n\t\t */\n\t\thandleKey = event => {\n\t\t\tif (this._isValidTarget(event.target) && this._descendants) {\n\t\t\t\tlet action = this._getFocusAction(event);\n\n\t\t\t\tif (action.type) {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\tif (action.type === ACTION_MOVE_FOCUS) {\n\t\t\t\t\t\tthis._moveFocus(action.direction);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (action.type === ACTION_DISMISS_FOCUS) {\n\t\t\t\t\t\tthis.props.onDismiss(action.direction);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Moves the focus among descendants in the especified direction.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method moveFocus\n\t\t * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n\t\t */\n\t\tmoveFocus(direction) {\n\t\t\tdirection = Lang.isNumber(direction) ? direction : 0;\n\n\t\t\tthis._moveFocus(direction);\n\t\t}\n\n\t\t/**\n\t\t * Returns the action, if any, that a keyboard event in the current focus manager state\n\t\t * should produce.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _getFocusAction\n\t\t * @param {object} event The Keyboard event.\n\t\t * @protected\n\t\t * @return {Object} An action object with type and direction properties.\n\t\t */\n\t\t_getFocusAction(event) {\n\t\t\tlet action = {\n\t\t\t\ttype: ACTION_NONE,\n\t\t\t};\n\n\t\t\tif (this.props.keys) {\n\t\t\t\tlet direction = this._getFocusMoveDirection(event);\n\n\t\t\t\tif (direction) {\n\t\t\t\t\taction.direction = direction;\n\t\t\t\t\taction.type = ACTION_MOVE_FOCUS;\n\t\t\t\t}\n\n\t\t\t\tlet dismissAction = this._getFocusDismissAction(\n\t\t\t\t\tevent,\n\t\t\t\t\tdirection\n\t\t\t\t);\n\n\t\t\t\tif (dismissAction.dismiss) {\n\t\t\t\t\taction.direction = dismissAction.direction;\n\t\t\t\t\taction.type = ACTION_DISMISS_FOCUS;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn action;\n\t\t}\n\n\t\t/**\n\t\t * Returns the dismiss action, if any, the focus manager should execute to yield the focus. This\n\t\t * will happen in any of these scenarios if a dismiss callback has been specified:\n\t\t * - A dismiss key has been pressed\n\t\t * - In a non-circular focus manager, when:\n\t\t *     - The active descendant is the first one and a prev key has been pressed.\n\t\t *     - The active descendant is the last one and a next key has been pressed.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _getFocusDismissAction\n\t\t * @param {Number} focusMoveDirection The focus movement direction (if any).\n\t\t * @param {Object} event The Keyboard event.\n\t\t * @protected\n\t\t * @return {Object} A dismiss action with dismiss and direction properties.\n\t\t */\n\t\t_getFocusDismissAction(event, focusMoveDirection) {\n\t\t\tlet dismissAction = {\n\t\t\t\tdirection: focusMoveDirection,\n\t\t\t\tdismiss: false,\n\t\t\t};\n\n\t\t\tif (this.props.onDismiss) {\n\t\t\t\tif (this._isValidKey(event.keyCode, this.props.keys.dismiss)) {\n\t\t\t\t\tdismissAction.dismiss = true;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis._isValidKey(event.keyCode, this.props.keys.dismissNext)\n\t\t\t\t) {\n\t\t\t\t\tdismissAction.dismiss = true;\n\t\t\t\t\tdismissAction.direction = DIRECTION_NEXT;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis._isValidKey(event.keyCode, this.props.keys.dismissPrev)\n\t\t\t\t) {\n\t\t\t\t\tdismissAction.dismiss = true;\n\t\t\t\t\tdismissAction.direction = DIRECTION_PREV;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!dismissAction.dismiss &&\n\t\t\t\t\t!this.props.circular &&\n\t\t\t\t\tfocusMoveDirection\n\t\t\t\t) {\n\t\t\t\t\tdismissAction.dismiss =\n\t\t\t\t\t\t(focusMoveDirection === DIRECTION_PREV &&\n\t\t\t\t\t\t\tthis._activeDescendant === 0) ||\n\t\t\t\t\t\t(focusMoveDirection === DIRECTION_NEXT &&\n\t\t\t\t\t\t\tthis._activeDescendant ===\n\t\t\t\t\t\t\t\tthis._descendants.length - 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn dismissAction;\n\t\t}\n\n\t\t/**\n\t\t * Returns the direction, if any, in which the focus should be moved. In presence of the\n\t\t * shift key modifier, the direction of the movement is inverted.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _getFocusMoveDirection\n\t\t * @param {Object} event The Keyboard event.\n\t\t * @protected\n\t\t * @return {Number} The computed direction of the expected focus movement.\n\t\t */\n\t\t_getFocusMoveDirection(event) {\n\t\t\tlet direction = DIRECTION_NONE;\n\n\t\t\tif (this._isValidKey(event.keyCode, this.props.keys.next)) {\n\t\t\t\tdirection = DIRECTION_NEXT;\n\t\t\t}\n\t\t\tif (this._isValidKey(event.keyCode, this.props.keys.prev)) {\n\t\t\t\tdirection = DIRECTION_PREV;\n\t\t\t}\n\n\t\t\tif (event.shifKey) {\n\t\t\t\tdirection *= -1;\n\t\t\t}\n\n\t\t\treturn direction;\n\t\t}\n\n\t\t/**\n\t\t * Indicates if a given keyCode is valid for the given set of keys.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _isValidKey\n\t\t * @param {Array|Number} keys A key set. Can be a number an array of numbers representing the allowed keyCodes.\n\t\t * @param {Number} keyCode An event keyCode.\n\t\t * @protected\n\t\t * @return {Boolean} A boolean value indicating if the key is valid.\n\t\t */\n\t\t_isValidKey(keyCode, keys) {\n\t\t\treturn Lang.isArray(keys)\n\t\t\t\t? keys.indexOf(keyCode) !== -1\n\t\t\t\t: keyCode === keys;\n\t\t}\n\n\t\t/**\n\t\t * Indicates if a given element is valid for focus management. User input elements such as\n\t\t * input, select or textarea are excluded.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _isValidKey\n\t\t * @param {DOMNode} element A DOM element.\n\t\t * @protected\n\t\t * @return {Boolean} A boolean value indicating if the element is valid.\n\t\t */\n\t\t_isValidTarget(element) {\n\t\t\tlet tagName = element.tagName.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\ttagName !== 'input' &&\n\t\t\t\ttagName !== 'select' &&\n\t\t\t\ttagName !== 'textarea'\n\t\t\t);\n\t\t}\n\n\t\t/**\n\t\t * Moves the focus among descendants in the especified direction.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _moveFocus\n\t\t * @param {number} direction The direction (1 or -1) of the focus movement among descendants.\n\t\t * @protected\n\t\t */\n\t\t_moveFocus(direction) {\n\t\t\tlet numDescendants = this._descendants.length;\n\n\t\t\tlet descendant = this._descendants[this._activeDescendant];\n\n\t\t\tdescendant.setAttribute('tabIndex', -1);\n\n\t\t\tthis._activeDescendant += direction;\n\n\t\t\tif (this.props.circular) {\n\t\t\t\t// Calculate proper modulo result since remainder operator doesn't behave in the\n\t\t\t\t// same way for negative numbers\n\t\t\t\tthis._activeDescendant =\n\t\t\t\t\t((this._activeDescendant % numDescendants) +\n\t\t\t\t\t\tnumDescendants) %\n\t\t\t\t\tnumDescendants;\n\t\t\t} else {\n\t\t\t\tthis._activeDescendant = Math.max(\n\t\t\t\t\tMath.min(this._activeDescendant, numDescendants - 1),\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdescendant = this._descendants[this._activeDescendant];\n\n\t\t\tdescendant.setAttribute('tabIndex', 0);\n\t\t\tdescendant.focus();\n\t\t}\n\n\t\t/**\n\t\t * Refreshes the descendants list by executing the CSS selector again and resets the descendants tabIndex.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetFocusManager\n\t\t * @method _refresh\n\t\t * @protected\n\t\t */\n\t\t_refresh() {\n\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\n\t\t\tif (domNode) {\n\t\t\t\tlet descendants = domNode.querySelectorAll(\n\t\t\t\t\tthis.props.descendants\n\t\t\t\t);\n\n\t\t\t\tlet priorityDescendants = [];\n\n\t\t\t\tthis._descendants = [];\n\n\t\t\t\tArray.prototype.slice.call(descendants).forEach(\n\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\tlet dataTabIndex = item.getAttribute('data-tabindex');\n\n\t\t\t\t\t\tif (dataTabIndex) {\n\t\t\t\t\t\t\tpriorityDescendants.push(item);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._descendants.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this)\n\t\t\t\t);\n\n\t\t\t\tpriorityDescendants = priorityDescendants.sort(function(a, b) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tLang.toInt(a.getAttribute('data-tabindex')) >\n\t\t\t\t\t\tLang.toInt(b.getAttribute('data-tabindex'))\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\tthis._descendants = priorityDescendants.concat(\n\t\t\t\t\tthis._descendants\n\t\t\t\t);\n\n\t\t\t\tthis._activeDescendant = 0;\n\n\t\t\t\tthis._descendants.some(\n\t\t\t\t\tfunction(item, index) {\n\t\t\t\t\t\tif (item.getAttribute('tabindex') === '0') {\n\t\t\t\t\t\t\tthis._activeDescendant = index;\n\t\t\t\t\t\t\tthis.focus();\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n","/**\n * ButtonCommandActive is a mixin that provides an `isActive` method to determine if\n * a context-aware command is currently in an active state.\n *\n * @class ButtonCommandActive\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Checks if the command is active in the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonCommandActive\n\t\t * @method isActive\n\t\t * @return {Boolean} True if the command is active, false otherwise.\n\t\t */\n\t\tisActive() {\n\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\tlet command = editor.getCommand(this.props.command);\n\n\t\t\treturn command ? command.state === CKEDITOR.TRISTATE_ON : false;\n\t\t}\n\t};\n","/**\n * ButtonCfgProps is a mixin that provides a style prop and some methods to apply the resulting\n * style and checking if it is present in a given path or selection.\n *\n * @class ButtonCfgProps\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Merges the properties, passed to the current component with user's configuration\n\t\t * via `buttonCfg` property.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonCfgProps\n\t\t * @method mergeButtonCfgProps\n\t\t * @param {Object} props The properties to be merged with the provided configuration for this\n\t\t * button. If not passed, the user configuration will be merged with `this.props`\n\t\t * @return {Object} The merged properties\n\t\t */\n\t\tmergeButtonCfgProps(props) {\n\t\t\tprops = props || this.props;\n\n\t\t\tlet nativeEditor = this.props.editor.get('nativeEditor');\n\t\t\tlet buttonCfg = nativeEditor.config.buttonCfg || {};\n\t\t\tlet result = CKEDITOR.tools.merge(props, buttonCfg['linkEdit']);\n\n\t\t\treturn result;\n\t\t}\n\t};\n","import WidgetFocusManager from '../base/widget-focus-manager.js';\nimport React from 'react';\n\n/**\n * The ButtonDropdown class provides markup and keyboard navigation behaviour to a dropdown\n * opened from a button.\n *\n * @class ButtonDropdown\n */\nclass ButtonDropdown extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonDropdown\n\t * @method getDefaultProps\n\t */\n\tstatic defaultProps = {\n\t\tcircular: false,\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the dropdown in the configuration.\n\t *\n\t * @default dropdown\n\t * @memberof ButtonDropdown\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'dropdown';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonDropdown\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\"\n\t\t\t\tonFocus={this.focus}\n\t\t\t\tonKeyDown={this.handleKey}\n\t\t\t\ttabIndex=\"0\">\n\t\t\t\t<ul className=\"ae-listbox\" role=\"listbox\">\n\t\t\t\t\t{this.props.children}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default WidgetFocusManager(ButtonDropdown);\n","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonKeystroke is a mixin that provides a `keystroke` prop that allows configuring\n * a function of the instance to be invoked upon the keystroke activation.\n *\n * @class ButtonKeystroke\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonKeystroke\n\t\t * @method componentWillMount\n\t\t */\n\t\tcomponentWillMount() {\n\t\t\tif (Lang.isFunction(super.componentWillMount)) {\n\t\t\t\tsuper.componentWillMount();\n\t\t\t}\n\n\t\t\tlet nativeEditor = this.props.editor.get('nativeEditor');\n\t\t\tlet keystroke = this.props.keystroke;\n\n\t\t\tlet commandName =\n\t\t\t\tkeystroke.name || ((Math.random() * 1e9) >>> 0).toString();\n\n\t\t\tlet command = nativeEditor.getCommand(commandName);\n\n\t\t\tif (!command) {\n\t\t\t\tcommand = new CKEDITOR.command(nativeEditor, {\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet keystrokeFn = keystroke.fn;\n\n\t\t\t\t\t\tif (Lang.isString(keystrokeFn)) {\n\t\t\t\t\t\t\tthis[keystrokeFn].call(this, editor);\n\t\t\t\t\t\t} else if (Lang.isFunction(keystrokeFn)) {\n\t\t\t\t\t\t\tkeystrokeFn.call(this, editor);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this),\n\t\t\t\t});\n\n\t\t\t\tnativeEditor.addCommand(commandName, command);\n\t\t\t}\n\n\t\t\tthis._defaultKeystrokeCommand =\n\t\t\t\tnativeEditor.keystrokeHandler.keystrokes[keystroke.keys];\n\n\t\t\tnativeEditor.setKeystroke(keystroke.keys, commandName);\n\t\t}\n\n\t\t/**\n\t\t * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonKeystroke\n\t\t * @method componentWillUnmount\n\t\t */\n\t\tcomponentWillUnmount() {\n\t\t\tif (Lang.isFunction(super.componentWillUnmount)) {\n\t\t\t\tsuper.componentWillUnmount();\n\t\t\t}\n\n\t\t\tthis.props.editor\n\t\t\t\t.get('nativeEditor')\n\t\t\t\t.setKeystroke(\n\t\t\t\t\tthis.props.keystroke.keys,\n\t\t\t\t\tthis._defaultKeystrokeCommand\n\t\t\t\t);\n\t\t}\n\t};\n","import ButtonCommandListItem from './button-command-list-item.jsx';\nimport React from 'react';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonCommandsList class provides functionality for showing a list of commands that can be\n * executed to the current selection..\n *\n * @class ButtonCommandsList\n * @uses WidgetFocusManager\n */\nclass ButtonCommandsList extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandsList\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcircular: false,\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default buttonCommandsList\n\t * @memberof ButtonCommandsList\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'buttonCommandsList';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis._ref = React.createRef();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the list node to allow keyboard interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandsList\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tthis._ref.current.focus();\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the list.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandsList\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"ae-dropdown ae-arrow-box ae-arrow-box-top-left\"\n\t\t\t\tonFocus={this.focus}\n\t\t\t\tonKeyDown={this.handleKey}\n\t\t\t\tref={this._ref}\n\t\t\t\ttabIndex=\"0\">\n\t\t\t\t<ul\n\t\t\t\t\tclassName=\"ae-listbox\"\n\t\t\t\t\tid={this.props.listId}\n\t\t\t\t\trole=\"listbox\">\n\t\t\t\t\t{this._renderActions(this.props.commands)}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Renders instances of ButtonCommandListItem with the description of the row action that will be executed.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandsList\n\t * @method _renderActions\n\t * @protected\n\t * @return {Array} Rendered instances of ButtonCommandListItem class\n\t */\n\t_renderActions(commands) {\n\t\tconst editor = this.props.editor;\n\t\tlet items;\n\n\t\tif (commands && commands.length) {\n\t\t\titems = commands.map(function(item) {\n\t\t\t\treturn (\n\t\t\t\t\t<li key={item.command} role=\"option\">\n\t\t\t\t\t\t<ButtonCommandListItem\n\t\t\t\t\t\t\tcommand={item.command}\n\t\t\t\t\t\t\tdescription={\n\t\t\t\t\t\t\t\ttypeof item.label === 'string'\n\t\t\t\t\t\t\t\t\t? item.label\n\t\t\t\t\t\t\t\t\t: item.label()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={item.icon}\n\t\t\t\t\t\t\teditor={editor}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t}\n}\n\nexport default WidgetFocusManager(ButtonCommandsList);\n","import ButtonDropdown from './button-dropdown.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonsStylesListHeader from './button-styles-list-header.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonStylesList class provides functionality for showing a list of styles that can be\n * applied to the current selection..\n *\n * @class ButtonStylesList\n * @uses WidgetFocusManager\n */\nclass ButtonStylesList extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesList\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcircular: false,\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t\tshowRemoveStylesItem: true,\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @memberof ButtonStylesList\n\t * @static\n\t * @property {String} key\n\t * @default buttonStylesList\n\t */\n\tstatic key = 'buttonStylesList';\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the list node to allow keyboard interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesList\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tReactDOM.findDOMNode(this).focus();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesList\n\t * @method componentWillMount\n\t */\n\tcomponentWillMount() {\n\t\tconst blockStyles = [];\n\t\tconst inlineStyles = [];\n\t\tconst objectStyles = [];\n\n\t\tthis.props.styles.forEach(function(item) {\n\t\t\tconst style = new CKEDITOR.style(item.style);\n\n\t\t\tif (style.type === CKEDITOR.STYLE_BLOCK) {\n\t\t\t\tblockStyles.push(item);\n\t\t\t} else if (style.type === CKEDITOR.STYLE_INLINE) {\n\t\t\t\tinlineStyles.push(item);\n\t\t\t} else if (style.type === CKEDITOR.STYLE_OBJECT) {\n\t\t\t\tobjectStyles.push(item);\n\t\t\t}\n\t\t});\n\n\t\tthis._blockStyles = blockStyles;\n\t\tthis._inlineStyles = inlineStyles;\n\t\tthis._objectStyles = objectStyles;\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the list.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesList\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet removeStylesItem;\n\n\t\tif (this.props.showRemoveStylesItem) {\n\t\t\tremoveStylesItem = (\n\t\t\t\t<ButtonStylesListItemRemove\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<ButtonDropdown {...this.props}>\n\t\t\t\t{removeStylesItem}\n\n\t\t\t\t<ButtonsStylesListHeader\n\t\t\t\t\tname={AlloyEditor.Strings.blockStyles}\n\t\t\t\t\tstyles={this._blockStyles}\n\t\t\t\t/>\n\t\t\t\t{this._renderStylesItems(this._blockStyles)}\n\n\t\t\t\t<ButtonsStylesListHeader\n\t\t\t\t\tname={AlloyEditor.Strings.inlineStyles}\n\t\t\t\t\tstyles={this._inlineStyles}\n\t\t\t\t/>\n\t\t\t\t{this._renderStylesItems(this._inlineStyles)}\n\n\t\t\t\t<ButtonsStylesListHeader\n\t\t\t\t\tname={AlloyEditor.Strings.objectStyles}\n\t\t\t\t\tstyles={this._objectStyles}\n\t\t\t\t/>\n\t\t\t\t{this._renderStylesItems(this._objectStyles)}\n\t\t\t</ButtonDropdown>\n\t\t);\n\t}\n\n\t/**\n\t * Renders instances of ButtonStylesListItem with the preview of the correspondent block, inline or object styles.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesList\n\t * @method _renderStylesItems\n\t * @param {Array} styles List of styles for which preview should be rendered.\n\t * @protected\n\t * @return {Array} Rendered instances of ButtonStylesListItem class\n\t */\n\t_renderStylesItems(styles) {\n\t\tconst editor = this.props.editor;\n\t\tlet items;\n\n\t\tif (styles && styles.length) {\n\t\t\titems = styles.map(item => {\n\t\t\t\treturn (\n\t\t\t\t\t<li key={item.name} role=\"option\">\n\t\t\t\t\t\t<ButtonStylesListItem\n\t\t\t\t\t\t\tactiveStyle={this.props.activeStyle}\n\t\t\t\t\t\t\teditor={editor}\n\t\t\t\t\t\t\tname={item.name}\n\t\t\t\t\t\t\tstyle={item.style}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t}\n}\n\nexport default WidgetFocusManager(ButtonStylesList);\n","import Lang from '../../oop/lang.js';\n\n/**\n * ButtonActionStyle is a mixin that provides applying style implementation for a\n * button based on the `applyStyle` and `removeStyle` API of CKEDITOR.\n *\n * To execute properly, the component has to expose the following methods which can be obtained\n * out of the box using the {{#crossLink \"ButtonStyle\"}}{{/crossLink}} mixin:\n * - `Function` {{#crossLink \"ButtonStyle/isActive\"}}{{/crossLink}} to check the active state\n * - `Function` {{#crossLink \"ButtonStyle/getStyle\"}}{{/crossLink}} to return the style that should be applied\n *\n * @class ButtonActionStyle\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Removes or applies the component style to the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonActionStyle\n\t\t * @method applyStyle\n\t\t */\n\t\tapplyStyle = () => {\n\t\t\tif (\n\t\t\t\tLang.isFunction(this.isActive) &&\n\t\t\t\tLang.isFunction(this.getStyle)\n\t\t\t) {\n\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\teditor.getSelection().lock();\n\n\t\t\t\tif (this.isActive()) {\n\t\t\t\t\teditor.removeStyle(this.getStyle());\n\t\t\t\t} else {\n\t\t\t\t\teditor.applyStyle(this.getStyle());\n\t\t\t\t}\n\n\t\t\t\teditor.getSelection().unlock();\n\n\t\t\t\teditor.fire('actionPerformed', this);\n\t\t\t}\n\t\t};\n\t};\n","let _isRangeAtElementEnd = function(range, element) {\n\t// Finding if a range is at the end of an element is somewhat tricky due to how CKEditor handles\n\t// ranges. It might depend on wether a source node inside the element is selected or not. For now,\n\t// we need to cover the following cases:\n\t//\n\t// - The text length of the element is the same as the endOffset of the range\n\t// - Both start and end containers match the element and the start and end offsets are 1\n\n\treturn (\n\t\telement.getText().length === range.endOffset ||\n\t\t(element.equals(range.startContainer) &&\n\t\t\telement.equals(range.endContainer) &&\n\t\t\trange.startOffset === range.endOffset &&\n\t\t\trange.endOffset === 1)\n\t);\n};\n\nlet embedSelectionTest = function(payload) {\n\tlet selectionData = payload.data.selectionData;\n\n\treturn !!(\n\t\tselectionData.element &&\n\t\tselectionData.element.getAttribute('data-widget') === 'ae_embed'\n\t);\n};\n\nconst embedUrlSelectionTest = function(payload) {\n\tconst selectionData = payload.data.selectionData;\n\n\treturn !!(\n\t\tselectionData.element &&\n\t\tselectionData.element.getAttribute('data-widget') === 'embedurl'\n\t);\n};\n\nconst headingTextSelectionTest = function(payload) {\n\tconst headings = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\tconst nativeEditor = payload.editor.get('nativeEditor');\n\tconst selectionData = payload.data.selectionData;\n\tconst selectionEmpty = nativeEditor.isSelectionEmpty();\n\n\treturn !!(\n\t\t!selectionData.element &&\n\t\tselectionData.region &&\n\t\t!selectionEmpty &&\n\t\t!nativeEditor\n\t\t\t.getSelection()\n\t\t\t.getCommonAncestor()\n\t\t\t.isReadOnly() &&\n\t\tnativeEditor.elementPath().contains(headings)\n\t);\n};\n\nlet linkSelectionTest = function(payload) {\n\tlet nativeEditor = payload.editor.get('nativeEditor');\n\tlet range = nativeEditor.getSelection().getRanges()[0];\n\tlet selectionData = payload.data.selectionData;\n\n\tlet element = new CKEDITOR.Link(nativeEditor).getFromSelection();\n\tlet isSelectionEmpty = nativeEditor.isSelectionEmpty();\n\tlet elementIsNotImage = selectionData.element\n\t\t? selectionData.element.getName() !== 'img'\n\t\t: true;\n\n\treturn !!(\n\t\tisSelectionEmpty &&\n\t\telementIsNotImage &&\n\t\telement &&\n\t\telement.getText().length !== range.endOffset &&\n\t\telement &&\n\t\t!element.isReadOnly() &&\n\t\t!_isRangeAtElementEnd(range, element)\n\t);\n};\n\nlet imageSelectionTest = function(payload) {\n\tlet selectionData = payload.data.selectionData;\n\n\treturn !!(\n\t\tselectionData.element &&\n\t\tselectionData.element.getName() === 'img' &&\n\t\t!selectionData.element.isReadOnly()\n\t);\n};\n\nlet textSelectionTest = function(payload) {\n\tlet nativeEditor = payload.editor.get('nativeEditor');\n\n\tlet selectionEmpty = nativeEditor.isSelectionEmpty();\n\n\tlet selectionData = payload.data.selectionData;\n\n\treturn !!(\n\t\t!selectionData.element &&\n\t\tselectionData.region &&\n\t\t!selectionEmpty &&\n\t\t!nativeEditor\n\t\t\t.getSelection()\n\t\t\t.getCommonAncestor()\n\t\t\t.isReadOnly()\n\t);\n};\n\nlet tableSelectionTest = function(payload) {\n\tlet nativeEditor = payload.editor.get('nativeEditor');\n\n\tlet table = new CKEDITOR.Table(nativeEditor);\n\tlet element = table.getFromSelection();\n\n\treturn !!(element && table.isEditable(element));\n};\n\nconst SelectionTest = {\n\tembed: embedSelectionTest,\n\tembedUrl: embedUrlSelectionTest,\n\theader: headingTextSelectionTest,\n\timage: imageSelectionTest,\n\tlink: linkSelectionTest,\n\ttable: tableSelectionTest,\n\ttext: textSelectionTest,\n};\n\nexport default SelectionTest;\n","import Lang from './lang';\n\n/**\n * Sets the prototype, constructor and superclass properties to support an inheritance strategy\n * that can chain constructors and methods. Static members will not be inherited.\n *\n * @memberof OOP\n * @method extend\n * @param {Function} receiver The class which will extend another class.\n * @param {Function} supplier The class which will provide the properties the child class.\n * @param {Object} protoProps Prototype properties to add/override.\n * @param {Object} staticProps Static properties to add/overwrite.\n * @return {Function} The extended class.\n * @static\n */\nconst extend = function(receiver, supplier, protoProps, staticProps) {\n\tif (!supplier || !receiver) {\n\t\tthrow new Error('extend failed, verify dependencies');\n\t}\n\n\tlet supplierProto = supplier.prototype;\n\n\tlet receiverProto = Object.create(supplierProto);\n\treceiver.prototype = receiverProto;\n\n\treceiverProto.constructor = receiver;\n\treceiver.superclass = supplierProto;\n\n\t// assign constructor property\n\tif (\n\t\tsupplier !== Object &&\n\t\tsupplierProto.constructor === Object.prototype.constructor\n\t) {\n\t\tsupplierProto.constructor = supplier;\n\t}\n\n\t// add prototype overrides\n\tif (protoProps) {\n\t\tLang.mix(receiverProto, protoProps);\n\t}\n\n\t// add object overrides\n\tif (staticProps) {\n\t\tLang.mix(receiver, staticProps);\n\t}\n\n\treturn receiver;\n};\n\nexport default extend;\n","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for managing exclusive state of an widget.\n * The exclusive state means that a button may request to be the only rendered\n * widget in its parent container. WidgetExclusive will manage this state by\n * filtering and suppressing the other sibling widgets from displaying.\n *\n * @class WidgetExclusive\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Cancels the exclusive state of an widget.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetExclusive\n\t\t * @method cancelExclusive\n\t\t * @param {Object} itemExclusive The widget which exclusive state should be canceled.\n\t\t */\n\t\tcancelExclusive(itemExclusive) {\n\t\t\tif (this.state.itemExclusive === itemExclusive) {\n\t\t\t\tthis.setState({\n\t\t\t\t\titemExclusive: null,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Lifecycle. Invoked when a component is receiving new props.\n\t\t * This method is not called for the initial render.\n\t\t * Calling this.setState() within this function will not trigger an additional render.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetExclusive\n\t\t * @method componentWillReceiveProps\n\t\t * @param {Object} nextProps Object containing the current set of properties.\n\t\t */\n\t\tcomponentWillReceiveProps(nextProps) {\n\t\t\tif (Lang.isFunction(super.componentWillReceiveProps)) {\n\t\t\t\tsuper.componentWillReceiveProps(nextProps);\n\t\t\t}\n\n\t\t\t// Receiving properties means that the component is being re-rendered.\n\t\t\t// Re-rendering is triggered by editorInteraction, so we have to\n\t\t\t// reset the exclusive state and render the UI according to the new selection.\n\t\t\tthis.setState({\n\t\t\t\titemExclusive: null,\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Filters the items and returns only those with exclusive state.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetExclusive\n\t\t * @method filterExclusive\n\t\t * @param {Array} items The widgets to be filtered.\n\t\t * @return {Array|Object} The item with executive state.\n\t\t */\n\t\tfilterExclusive(items) {\n\t\t\treturn items.filter(\n\t\t\t\tfunction(item) {\n\t\t\t\t\tif (this.state.itemExclusive) {\n\t\t\t\t\t\tif (this.state.itemExclusive === item.key) {\n\t\t\t\t\t\t\treturn item;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\n\t\t/**\n\t\t * Merges the provided object with three more properties:\n\t\t * - cancelExclusive - function, which can be used by a widget in order to cancel executive state.\n\t\t * - renderExclusive - boolean flag which indicates if an widget should be rendered exclusively.\n\t\t * - requestExclusive - function, which can be used by a widget in order to obtain exclusive state.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetExclusive\n\t\t * @method mergeExclusiveProps\n\t\t * @param {Object} obj The properties container which should be merged with the properties, related\n\t\t *    to exclusive state.\n\t\t * @param {Object} itemKey They key of an React Widget which should be rendered exclusively.\n\t\t * @return {Object} The merged object.\n\t\t */\n\t\tmergeExclusiveProps(obj, itemKey) {\n\t\t\treturn CKEDITOR.tools.merge(obj, {\n\t\t\t\tcancelExclusive: this.cancelExclusive.bind(this, itemKey),\n\t\t\t\trenderExclusive: this.state.itemExclusive === itemKey,\n\t\t\t\trequestExclusive: this.requestExclusive.bind(this, itemKey),\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Requests and sets exclusive state of an widget.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetExclusive\n\t\t * @method requestExclusive\n\t\t * @param {Object} itemExclusive The widget which requests exclusive state.\n\t\t */\n\t\trequestExclusive = itemExclusive => {\n\t\t\tthis.setState({\n\t\t\t\titemExclusive: itemExclusive,\n\t\t\t});\n\t\t};\n\t};\n","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport Lang from '../../oop/lang.js';\nimport React from 'react';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonLinkEdit class provides functionality for creating and editing a link in a document.\n * Provides UI for creating, editing and removing a link.\n *\n * @class ButtonLinkEdit\n * @uses ButtonCfgProps\n * @uses WidgetDropdown\n * @uses WidgetFocusManager\n */\nclass ButtonLinkEdit extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tappendProtocol: true,\n\t\tautocompleteUrl: '',\n\t\tcircular: true,\n\t\tcustomIndexStart: true,\n\t\tdefaultLinkTarget: '',\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t\tshowTargetSelector: true,\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default linkEdit\n\t * @memberof ButtonLinkEdit\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'linkEdit';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.linkInput = React.createRef();\n\t\tthis.state = this._getInitialState();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the link input to immediately allow editing. This should only happen if the component\n\t * is rendered in exclusive mode to prevent aggressive focus stealing.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tif (this.props.renderExclusive || this.props.manualSelection) {\n\t\t\t// We need to wait for the next rendering cycle before focusing to avoid undesired\n\t\t\t// scrolls on the page\n\t\t\tthis._focusLinkInput();\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Invoked when a component is receiving new props.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method componentWillReceiveProps\n\t */\n\tcomponentWillReceiveProps() {\n\t\tthis.setState(this._getInitialState());\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet targetSelector = {\n\t\t\tallowedTargets: this.props.allowedTargets,\n\t\t\teditor: this.props.editor,\n\t\t\thandleLinkTargetChange: this._handleLinkTargetChange,\n\t\t\tselectedTarget:\n\t\t\t\tthis.state.linkTarget || AlloyEditor.Strings.linkTargetDefault,\n\t\t};\n\n\t\ttargetSelector = this.mergeDropdownProps(\n\t\t\ttargetSelector,\n\t\t\tButtonLinkTargetEdit.key\n\t\t);\n\n\t\tlet autocompleteDropdown;\n\n\t\tif (this.props.data) {\n\t\t\tlet dataFn = this.props.data;\n\n\t\t\tif (!Lang.isFunction(dataFn)) {\n\t\t\t\tconst items = this.props.data;\n\n\t\t\t\tdataFn = () => items;\n\t\t\t}\n\n\t\t\tlet autocompleteDropdownProps = {\n\t\t\t\tautocompleteSelected: this.state.autocompleteSelected,\n\t\t\t\tdata: dataFn,\n\t\t\t\teditor: this.props.editor,\n\t\t\t\thandleLinkAutocompleteClick: this._handleLinkAutocompleteClick,\n\t\t\t\tonDismiss: this.props.toggleDropdown,\n\t\t\t\tsetAutocompleteState: this._setAutocompleteState,\n\t\t\t\tterm: this.state.linkHref,\n\t\t\t};\n\n\t\t\tautocompleteDropdownProps = this.mergeDropdownProps(\n\t\t\t\tautocompleteDropdownProps,\n\t\t\t\tButtonLinkAutocompleteList.key\n\t\t\t);\n\n\t\t\tautocompleteDropdown = (\n\t\t\t\t<ButtonLinkAutocompleteList {...autocompleteDropdownProps} />\n\t\t\t);\n\t\t}\n\n\t\tlet buttonClearLink;\n\n\t\tif (this.state.linkHref) {\n\t\t\tbuttonClearLink = (\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.clearInput}\n\t\t\t\t\tclassName=\"ae-button ae-button-clear\"\n\t\t\t\t\tonClick={this._clearLink}\n\t\t\t\t\ttitle={AlloyEditor.Strings.clear}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tsymbol=\"times-circle\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\n\t\tconst placeholderProp = {};\n\n\t\tif (!CKEDITOR.env.ie && AlloyEditor.Strings) {\n\t\t\tplaceholderProp.placeholder = AlloyEditor.Strings.editLink;\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-edit-link\">\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.removeLink}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdisabled={!this.state.element}\n\t\t\t\t\tonClick={this._removeLink}\n\t\t\t\t\ttitle={AlloyEditor.Strings.remove}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tsymbol=\"chain-broken\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t\t<div className=\"ae-container-input xxl\">\n\t\t\t\t\t{this.props.showTargetSelector && (\n\t\t\t\t\t\t<ButtonLinkTargetEdit {...targetSelector} />\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"ae-container-input\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\t\tonChange={this._handleLinkHrefChange}\n\t\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\t\t{...placeholderProp}\n\t\t\t\t\t\t\tref={this.linkInput}\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvalue={this.state.linkHref}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{autocompleteDropdown}\n\t\t\t\t\t</div>\n\t\t\t\t\t{buttonClearLink}\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.confirm}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdisabled={!this._isValidState()}\n\t\t\t\t\tonClick={this._updateLink}\n\t\t\t\t\ttitle={AlloyEditor.Strings.confirm}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tsymbol=\"check\"\n\t\t\t\t\t\tclassName=\"ae-icon-svg-check\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * The return value will be used as the initial value of this.state.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _getInitialState\n\t * @protected\n\t * @return {Object}\n\t */\n\t_getInitialState() {\n\t\tconst {editor, defaultLinkTarget} = this.props;\n\n\t\tconst link = new CKEDITOR.Link(\n\t\t\teditor.get('nativeEditor')\n\t\t).getFromSelection();\n\t\tconst href = link ? link.getAttribute('href') : '';\n\t\tconst target = link ? link.getAttribute('target') : defaultLinkTarget;\n\n\t\treturn {\n\t\t\tautocompleteSelected: false,\n\t\t\telement: link,\n\t\t\tinitialLink: {\n\t\t\t\thref: href,\n\t\t\t\ttarget: target,\n\t\t\t},\n\t\t\tlinkHref: href,\n\t\t\tlinkTarget: target,\n\t\t};\n\t}\n\n\t/**\n\t * Clears the link input. This only changes the component internal state, but does not\n\t * affect the link element of the editor. Only the _removeLink and _updateLink methods\n\t * are translated to the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _clearLink\n\t * @protected\n\t */\n\t_clearLink = () => {\n\t\tthis.setState({\n\t\t\tlinkHref: '',\n\t\t});\n\n\t\tthis._focusLinkInput();\n\t};\n\n\t/**\n\t * Focuses the user cursor on the widget's input.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _focusLinkInput\n\t * @protected\n\t */\n\t_focusLinkInput() {\n\t\tconst instance = this;\n\n\t\tconst focusLinkEl = function() {\n\t\t\tinstance.linkInput.current.focus();\n\t\t};\n\n\t\tif (window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame(focusLinkEl);\n\t\t} else {\n\t\t\tsetTimeout(focusLinkEl, 0);\n\t\t}\n\t}\n\n\t/**\n\t * Monitors key interaction inside the input element to respond to the keys:\n\t * - Enter: Creates/updates the link.\n\t * - Escape: Discards the changes.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _handleKeyDown\n\t * @param {SyntheticEvent} event The keyboard event.\n\t * @protected\n\t */\n\t_handleKeyDown = event => {\n\t\tif (event.keyCode === 13 || event.keyCode === 27) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif (event.keyCode === 13) {\n\t\t\tthis._updateLink();\n\t\t} else if (event.keyCode === 40) {\n\t\t\tthis.setState({\n\t\t\t\tautocompleteSelected: true,\n\t\t\t});\n\t\t} else if (event.keyCode === 27) {\n\t\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\t\tnew CKEDITOR.Link(editor).advanceSelection();\n\n\t\t\tthis.props.editor.get('nativeEditor').fire('actionPerformed', this);\n\t\t}\n\t};\n\n\t/**\n\t * Updates the component state when the link input changes on user interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _handleLinkHrefChange\n\t * @param {SyntheticEvent} event The change event.\n\t * @protected\n\t */\n\t_handleLinkHrefChange = event => {\n\t\tthis.setState({\n\t\t\tlinkHref: event.target.value,\n\t\t});\n\n\t\tthis._focusLinkInput();\n\t};\n\n\t/**\n\t * Updates the component state when the link target changes on user interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _handleLinkTargetChange\n\t * @param {SyntheticEvent} event The click event.\n\t * @protected\n\t */\n\t_handleLinkTargetChange = event => {\n\t\tthis.setState({\n\t\t\titemDropdown: null,\n\t\t\tlinkTarget: event.target.getAttribute('data-value'),\n\t\t});\n\n\t\tthis._focusLinkInput();\n\t};\n\n\t/**\n\t * Updates the component state when an autocomplete link result is selected by user interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _handleLinkAutocompleteClick\n\t * @param {SyntheticEvent} event The click event.\n\t * @protected\n\t */\n\t_handleLinkAutocompleteClick(event) {\n\t\tthis.setState({\n\t\t\titemDropdown: null,\n\t\t\tlinkHref: event.target.getAttribute('data-value'),\n\t\t});\n\n\t\tthis._focusLinkInput();\n\t}\n\n\t/**\n\t * Verifies that the current link state is valid so the user can save the link. A valid state\n\t * means that we have a non-empty href and that either that or the link target are different\n\t * from the original link.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _isValidState\n\t * @protected\n\t * @return {Boolean} [description]\n\t */\n\t_isValidState() {\n\t\tconst validState =\n\t\t\tthis.state.linkHref &&\n\t\t\t(this.state.linkHref !== this.state.initialLink.href ||\n\t\t\t\tthis.state.linkTarget !== this.state.initialLink.target);\n\n\t\treturn validState;\n\t}\n\n\t/**\n\t * Removes the link in the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _removeLink\n\t * @protected\n\t */\n\t_removeLink = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst linkUtils = new CKEDITOR.Link(editor);\n\t\tconst selection = editor.getSelection();\n\t\tconst bookmarks = selection.createBookmarks();\n\n\t\tlinkUtils.remove(this.state.element, {advance: true});\n\n\t\tselection.selectBookmarks(bookmarks);\n\n\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t// inside another in exclusive mode (such is the case of the link button)\n\t\tthis.props.cancelExclusive();\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n\n\t/**\n\t * Update autocompleteSelected state to focus and select autocomplete´s dropdown\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _setAutocompleteState\n\t * @protected\n\t */\n\t_setAutocompleteState(state) {\n\t\tthis.setState({\n\t\t\tautocompleteSelected: state.selected,\n\t\t});\n\t}\n\n\t/**\n\t * Updates the link in the editor element. If the element didn't exist previously, it will\n\t * create a new <a> element with the href specified in the link input.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkEdit\n\t * @method _updateLink\n\t * @protected\n\t */\n\t_updateLink = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst linkUtils = new CKEDITOR.Link(editor, {\n\t\t\tappendProtocol: this.props.appendProtocol,\n\t\t});\n\t\tconst linkAttrs = {\n\t\t\ttarget: this.state.linkTarget,\n\t\t};\n\t\tconst modifySelection = {advance: true};\n\n\t\tif (this.state.linkHref) {\n\t\t\tif (this.state.element) {\n\t\t\t\tlinkAttrs.href = this.state.linkHref;\n\n\t\t\t\tlinkUtils.update(\n\t\t\t\t\tlinkAttrs,\n\t\t\t\t\tthis.state.element,\n\t\t\t\t\tmodifySelection\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tlinkUtils.create(\n\t\t\t\t\tthis.state.linkHref,\n\t\t\t\t\tlinkAttrs,\n\t\t\t\t\tmodifySelection\n\t\t\t\t);\n\t\t\t}\n\n\t\t\teditor.fire('actionPerformed', this);\n\t\t}\n\n\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t// inside another in exclusive mode (such is the case of the link button)\n\t\tthis.props.cancelExclusive();\n\t};\n}\n\nexport default ButtonCfgProps(\n\tWidgetDropdown(WidgetFocusManager(ButtonLinkEdit))\n);\n","import Lang from '../../oop/lang.js';\nimport ReactDOM from 'react-dom';\n\n/**\n * Provides functionality for managing different dropdowns inside a widget.\n *\n * @class WidgetDropdown\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\tconstructor(props) {\n\t\t\tsuper(props);\n\n\t\t\tthis.state = {\n\t\t\t\t...this.state,\n\t\t\t\tdropdownTrigger: null,\n\t\t\t\titemDropdown: null,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Lifecycle. Invoked when a component is receiving new props.\n\t\t * This method is not called for the initial render.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetDropdown\n\t\t * @method componentWillReceiveProps\n\t\t */\n\t\tcomponentWillReceiveProps(nextProps) {\n\t\t\tif (Lang.isFunction(super.componentWillReceiveProps)) {\n\t\t\t\tsuper.componentWillReceiveProps(nextProps);\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tdropdownTrigger: null,\n\t\t\t\titemDropdown: null,\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Merges the provided object with two more properties:\n\t\t * - expanded - boolean flag which indicates if an widget should be rendered exclusively.\n\t\t * - toggleDropdown - function, which can be used by an widget in order to obtain exclusive state.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetDropdown\n\t\t * @method mergeDropdownProps\n\t\t * @param {Object} obj The properties container which should be merged with the properties, related\n\t\t *    to dropdown state.\n\t\t * @param {Object} itemKey They key of an React Widget which contains the dropdown.\n\t\t * @return {Object} The merged object.\n\t\t */\n\t\tmergeDropdownProps = (obj, itemKey) => {\n\t\t\treturn CKEDITOR.tools.merge(obj, {\n\t\t\t\texpanded: this.state.itemDropdown === itemKey ? true : false,\n\t\t\t\ttabIndex: this.state.dropdownTrigger === itemKey ? 0 : -1,\n\t\t\t\ttoggleDropdown: this.toggleDropdown.bind(this, itemKey),\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Sets the active dropdown of the widget or discards the toggled item from the state.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetDropdown\n\t\t * @method toggleDropdown\n\t\t * @param {Object} itemDropdown The widget which requests to toggle its dropdown.\n\t\t * @param {Number} toggleDirection User movement direction when toggled via keyboard.\n\t\t */\n\t\ttoggleDropdown = (itemDropdown, toggleDirection) => {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdropdownTrigger: itemDropdown,\n\t\t\t\t\titemDropdown:\n\t\t\t\t\t\titemDropdown !== this.state.itemDropdown\n\t\t\t\t\t\t\t? itemDropdown\n\t\t\t\t\t\t\t: null,\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tif (!this.state.itemDropdown) {\n\t\t\t\t\t\tif (this.moveFocus) {\n\t\t\t\t\t\t\tthis.moveFocus(toggleDirection);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tReactDOM.findDOMNode(this).focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t};\n\t};\n","import addimages from './addimages';\nimport autolink from './autolink';\nimport autolist from './autolist';\nimport dragresize from './dragresize';\nimport dragresizeie from './dragresize_ie';\nimport dragresizeie11 from './dragresize_ie11';\nimport embed from './embed';\nimport embedurl from './embedurl';\nimport imagealignment from './imagealignment';\nimport pasteimages from './pasteimages';\nimport placeholder from './placeholder';\nimport selectionkeystrokes from './selectionkeystrokes';\nimport tableresize from './tableresize';\nimport tabletools from './tabletools';\n\nexport {\n\taddimages,\n\tautolink,\n\tautolist,\n\tdragresize,\n\tdragresizeie,\n\tembed,\n\tembedurl,\n\timagealignment,\n\tpasteimages,\n\tplaceholder,\n\tselectionkeystrokes,\n\ttableresize,\n\ttabletools,\n};\n","import Lang from './lang.js';\n\n/**\n * Attribute implementation.\n *\n * @class Attribute\n * @constructor\n */\nfunction Attribute(config) {\n\tthis.__config__ = config || {};\n\tthis.__ATTRS__ = {};\n}\n\nAttribute.prototype = {\n\tconstructor: Attribute,\n\n\t/**\n\t * Retrieves the value of an attribute.\n\t *\n\t * @instance\n\t * @memberof Attribute\n\t * @method get\n\t * @param {String} attr The attribute which value should be retrieved.\n\t * @return {Any} The value of the attribute.\n\t */\n\tget: function(attr) {\n\t\tlet currentAttr = this.constructor.ATTRS[attr];\n\n\t\tif (!currentAttr) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isInitialized(attr)) {\n\t\t\tthis._init(attr);\n\t\t}\n\n\t\tlet curValue = this.__ATTRS__[attr];\n\n\t\tif (currentAttr.getter) {\n\t\t\tcurValue = this._callStringOrFunction(currentAttr.getter, curValue);\n\t\t}\n\n\t\treturn curValue;\n\t},\n\n\t/**\n\t * Sets the value of an attribute.\n\t *\n\t * @instance\n\t * @memberof Attribute\n\t * @method set\n\t * @param {String} attr The attribute which value should be set.\n\t * @param {Any} value The value which should be set to the attribute.\n\t */\n\tset: function(attr, value) {\n\t\tlet currentAttr = this.constructor.ATTRS[attr];\n\n\t\tif (!currentAttr) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isInitialized(attr)) {\n\t\t\tthis._init(attr);\n\t\t}\n\n\t\tif (currentAttr.readOnly) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (currentAttr.writeOnce && this._isInitialized(attr)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tcurrentAttr.validator &&\n\t\t\t!this._callStringOrFunction(currentAttr.validator, value)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (currentAttr.setter) {\n\t\t\tvalue = this._callStringOrFunction(currentAttr.setter, value);\n\t\t}\n\n\t\tthis.__ATTRS__[attr] = value;\n\t},\n\n\t/**\n\t * Calls the provided param as function with the supplied arguments.\n\t * If param provided as string, a corresponding function in this object will\n\t * be called. If provided param is a function, it will be directly called.\n\t *\n\t * @instance\n\t * @memberof Attribute\n\t * @method _callStringOrFunction\n\t * @param  {Any|Array} args The arguments which will be provided to the called function\n\t * @param  {String|Function} stringOrFunction The function which should be called\n\t * @protected\n\t * @return {Any} The returned value from the called function\n\t */\n\t_callStringOrFunction: function(stringOrFunction, args) {\n\t\tlet result = null;\n\n\t\tif (!Lang.isArray(args)) {\n\t\t\targs = [args];\n\t\t}\n\n\t\tif (\n\t\t\tLang.isString(stringOrFunction) &&\n\t\t\tLang.isFunction(this[stringOrFunction])\n\t\t) {\n\t\t\tresult = this[stringOrFunction](...args);\n\t\t} else if (Lang.isFunction(stringOrFunction)) {\n\t\t\tresult = stringOrFunction.apply(this, args);\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Initializes an attribute. Sets its default value depending on the flags of the\n\t * attribute and the passed configuration object to the constructor.\n\t *\n\t * @instance\n\t * @memberof Attribute\n\t * @method _init\n\t * @param {String} attr The name of the attribute which have to be initialized.\n\t * @protected\n\t */\n\t_init: function(attr) {\n\t\tlet value;\n\n\t\tlet currentAttr = this.constructor.ATTRS[attr];\n\n\t\t// Check if there is default value or passed one via configuration object\n\t\tlet hasDefaultValue = Object.prototype.hasOwnProperty.call(\n\t\t\tcurrentAttr,\n\t\t\t'value'\n\t\t);\n\t\tlet hasPassedValueViaConfig = Object.prototype.hasOwnProperty.call(\n\t\t\tthis.__config__,\n\t\t\tattr\n\t\t);\n\n\t\t// If there is valueFn, set the value to be the result of invocation of this function\n\t\tif (currentAttr.valueFn) {\n\t\t\tvalue = this._callStringOrFunction(currentAttr.valueFn, value);\n\n\t\t\tthis.__ATTRS__[attr] = value;\n\t\t}\n\t\t// else if the attribute has readOnly flag, set the default value from the attribute,\n\t\t// regardless if there is value or not\n\t\telse if (currentAttr.readOnly) {\n\t\t\tvalue = currentAttr.value;\n\t\t}\n\t\t// else if the attribute has writeOnce value, set it from the passed configuration or from the\n\t\t// default value, in this order. Otherwise, return miserable.\n\t\telse if (currentAttr.writeOnce) {\n\t\t\tif (hasPassedValueViaConfig) {\n\t\t\t\tvalue = this.__config__[attr];\n\t\t\t} else if (hasDefaultValue) {\n\t\t\t\tvalue = currentAttr.value;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// These two cases below are easy - set the value to be from the passed config or\n\t\t// from the default value, in this order.\n\t\telse if (hasPassedValueViaConfig) {\n\t\t\tvalue = this.__config__[attr];\n\t\t} else if (hasDefaultValue) {\n\t\t\tvalue = currentAttr.value;\n\t\t}\n\n\t\t// If there is validator, and user passed config object - check the returned value.\n\t\t// If it is false, then set as initial value the default one.\n\t\t// However, if there is no default value, just return.\n\t\tif (\n\t\t\tcurrentAttr.validator &&\n\t\t\thasPassedValueViaConfig &&\n\t\t\t!this._callStringOrFunction(currentAttr.validator, value)\n\t\t) {\n\t\t\tif (hasDefaultValue) {\n\t\t\t\tvalue = currentAttr.value;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// If there is setter and user passed config object - pass the value thought the setter.\n\t\t// The value might be one from defaultFn, default value or provided from the config.\n\t\tif (currentAttr.setter && hasPassedValueViaConfig) {\n\t\t\tvalue = this._callStringOrFunction(currentAttr.setter, value);\n\t\t}\n\n\t\t// Finally, set the value as initial value to the storage with values.\n\t\tthis.__ATTRS__[attr] = value;\n\t},\n\n\t/**\n\t * Checks if an attribute is initialized. An attribute is considered as initialized\n\t * when there is an own property with this name in the local collection of attribute values\n\t * for the current instance.\n\t *\n\t * @instance\n\t * @memberof Attribute\n\t * @method _isInitialized\n\t * @param {String} attr The attribute which should be checked if it is initialized.\n\t * @protected\n\t * @return {Boolean} Returns true if the attribute has been initialized, false otherwise.\n\t */\n\t_isInitialized: function(attr) {\n\t\treturn Object.prototype.hasOwnProperty.call(this.__ATTRS__, attr);\n\t},\n};\n\nexport default Attribute;\n","import SelectionGetArrowBoxClasses from './selection-arrowbox.js';\nimport SelectionSetPosition from './selection-position.js';\nimport SelectionTest from './selection-test.js';\n\nconst Selections = [\n\t{\n\t\tname: 'embed',\n\t\tbuttons: ['embedRemove', 'embedEdit'],\n\t\ttest: SelectionTest.embed,\n\t},\n\t{\n\t\tname: 'embedUrl',\n\t\tbuttons: ['embedVideo', 'embedVideoEdit'],\n\t\ttest: SelectionTest.embedUrl,\n\t},\n\t{\n\t\tname: 'link',\n\t\tbuttons: ['linkEdit'],\n\t\ttest: SelectionTest.link,\n\t},\n\t{\n\t\tname: 'image',\n\t\tbuttons: [\n\t\t\t'imageLeft',\n\t\t\t'imageCenter',\n\t\t\t'imageRight',\n\t\t\t'AccessibilityImageAlt',\n\t\t],\n\t\tsetPosition: SelectionSetPosition.image,\n\t\ttest: SelectionTest.image,\n\t},\n\t{\n\t\tname: 'text',\n\t\tbuttons: {\n\t\t\tfull: [\n\t\t\t\t[\n\t\t\t\t\t'Font',\n\t\t\t\t\t'FontSize',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'bold',\n\t\t\t\t\t'italic',\n\t\t\t\t\t'underline',\n\t\t\t\t\t'strike',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'link',\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\t'paragraphAlign',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'ul',\n\t\t\t\t\t'ol',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'h1',\n\t\t\t\t\t'h2',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'indentBlock',\n\t\t\t\t\t'outdentBlock',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'TextColor',\n\t\t\t\t\t'BGColor',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'code',\n\t\t\t\t\t'quote',\n\t\t\t\t\t'separator',\n\t\t\t\t\t'removeFormat',\n\t\t\t\t],\n\t\t\t],\n\n\t\t\tsimple: ['styles', 'bold', 'italic', 'underline', 'link'],\n\n\t\t\t// simple: [\n\t\t\t//     'backgroundColor',\n\t\t\t//     'camera',\n\t\t\t//     'color',\n\t\t\t//     'embed',\n\t\t\t//     'h1',\n\t\t\t//     'h2',\n\t\t\t//     'hline',\n\t\t\t//     'image',\n\t\t\t//     'imageCenter',\n\t\t\t//     'imageLeft',\n\t\t\t//     'imageRight',\n\t\t\t//     'indentBlock',\n\t\t\t//     'italic',\n\t\t\t//     'link',\n\t\t\t//     'linkBrowse',\n\t\t\t//     'linkTargetEdit',\n\t\t\t//     'ol',\n\t\t\t//     'outdentBlock',\n\t\t\t//     'paragraphAlign',\n\t\t\t//     'paragraphCenter',\n\t\t\t//     'paragraphJustify',\n\t\t\t//     'paragraphLeft',\n\t\t\t//     'paragraphRight',\n\t\t\t//     'quote',\n\t\t\t//     'removeFormat',\n\t\t\t//     'spacing',\n\t\t\t//     'spacing',\n\t\t\t//     'strike',\n\t\t\t//     'styles',\n\t\t\t//     'subscript',\n\t\t\t//     'superscript',\n\t\t\t//     'tableCell',\n\t\t\t//     'tableColumn',\n\t\t\t//     'tableEdit',\n\t\t\t//     'tableHeading',\n\t\t\t//     'tableRemove',\n\t\t\t//     'tableRow',\n\t\t\t//     'table',\n\t\t\t//     'twitter',\n\t\t\t//     'ul',\n\t\t\t//     'underline'\n\t\t\t// ]\n\t\t},\n\t\ttest: SelectionTest.text,\n\t},\n\t{\n\t\tname: 'table',\n\t\tbuttons: [\n\t\t\t'tableHeading',\n\t\t\t'tableRow',\n\t\t\t'tableColumn',\n\t\t\t'tableCell',\n\t\t\t'tableRemove',\n\t\t],\n\t\tgetArrowBoxClasses: SelectionGetArrowBoxClasses.table,\n\t\tsetPosition: SelectionSetPosition.table,\n\t\ttest: SelectionTest.table,\n\t},\n];\n\nexport default Selections;\n","let tableSelectionGetArrowBoxClasses = function() {\n\treturn 'ae-arrow-box ae-arrow-box-bottom';\n};\n\nconst SelectionGetArrowBoxClasses = {\n\ttable: tableSelectionGetArrowBoxClasses,\n};\n\nexport default SelectionGetArrowBoxClasses;\n","import ReactDOM from 'react-dom';\n\n// Default gutter value for toolbar positioning\nlet DEFAULT_GUTTER = {\n\tleft: 0,\n\ttop: 0,\n};\n\n/**\n * Centers a Toolbar according to given rectangle\n *\n * @method centerToolbar\n * @param {Object} toolbar The toolbar to be centered\n * @param {Object} rect The rectangle according to which the Toolbar will be centered\n */\nlet centerToolbar = function(toolbar, rect) {\n\tlet toolbarNode = ReactDOM.findDOMNode(toolbar);\n\n\tlet nativeEditor = toolbar.props.editor.get('nativeEditor');\n\tlet uiNode = nativeEditor.config.uiNode || document.body;\n\tlet uiNodeStyle = getComputedStyle(uiNode);\n\tlet uiNodeMarginLeft = parseInt(\n\t\tuiNodeStyle.getPropertyValue('margin-left'),\n\t\t10\n\t);\n\tlet uiNodeMarginRight = parseInt(\n\t\tuiNodeStyle.getPropertyValue('margin-right'),\n\t\t10\n\t);\n\tlet totalWidth = uiNodeMarginLeft + uiNode.clientWidth + uiNodeMarginRight;\n\n\tlet halfNodeWidth = toolbarNode.offsetWidth / 2;\n\tlet scrollPosition = new CKEDITOR.dom.window(window).getScrollPosition();\n\n\tlet gutter = toolbar.props.gutter || DEFAULT_GUTTER;\n\n\tlet widgetXY = toolbar.getWidgetXYPoint(\n\t\trect.left + rect.width / 2 - scrollPosition.x,\n\t\trect.top + scrollPosition.y,\n\t\tCKEDITOR.SELECTION_BOTTOM_TO_TOP\n\t);\n\n\tlet endPosition = [\n\t\trect.left + rect.width / 2 - halfNodeWidth - scrollPosition.x,\n\t\trect.top - toolbarNode.offsetHeight + scrollPosition.y - gutter.top,\n\t];\n\n\tif (endPosition[0] < 0) {\n\t\tendPosition[0] = 0;\n\t} else if (endPosition[0] > totalWidth - toolbarNode.offsetWidth) {\n\t\tendPosition[0] = totalWidth - toolbarNode.offsetWidth;\n\t}\n\n\ttoolbar.moveToPoint(widgetXY, endPosition);\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method imageSelectionSetPosition\n * @param {Object} payload Payload, should contain the selection data for retrieving the\n * client rectangle of the selected image\n * @return {Boolean} True, in all cases\n */\nlet imageSelectionSetPosition = function(payload) {\n\tlet selectionData = payload.selectionData\n\t\t? payload.selectionData\n\t\t: payload.editorEvent\n\t\t? payload.editorEvent.data.selectionData\n\t\t: null;\n\n\tif (selectionData && selectionData.element) {\n\t\tcenterToolbar(this, selectionData.element.getClientRect());\n\n\t\treturn true;\n\t}\n};\n\n/**\n * Sets the position of a toolbar according to the position of the selected image\n *\n * @method tableSelectionSetPosition\n * @param {Object} payload Object, which contains the selection data for retrieving the\n * client rectangle of the selected table\n * @return {Boolean} True, in all cases\n */\nlet tableSelectionSetPosition = function(payload) {\n\tlet nativeEditor = payload.editor.get('nativeEditor');\n\tlet uiNode = nativeEditor.config.uiNode;\n\n\tlet scrollTop = uiNode ? uiNode.scrollTop : 0;\n\n\tlet table = new CKEDITOR.Table(nativeEditor).getFromSelection();\n\tlet rect = table.getClientRect();\n\trect.top += scrollTop;\n\n\tcenterToolbar(this, rect);\n\n\treturn true;\n};\n\nconst SelectionSetPosition = {\n\timage: imageSelectionSetPosition,\n\ttable: tableSelectionSetPosition,\n};\n\nexport default SelectionSetPosition;\n","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStylesListItem class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItem\n * @uses ButtonActionStyle\n * @uses ButtonStyle\n */\nclass ButtonStylesListItem extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default buttonStylesListItem\n\t * @memberof ButtonStylesListItem\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'buttonStylesListItem';\n\n\t/**\n\t * Lifecycle. Invoked once, both on the client and server, immediately before the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItem\n\t * @method componentWillMount\n\t */\n\tcomponentWillMount() {\n\t\t// Styles with wildcard element (*) generate an empty tag in their preview < class=\"custom-class\" />.\n\t\t// We default to element span and remove the margins to obtain a more consistent set of previews.\n\t\tlet styleCfg = {\n\t\t\telement: 'span',\n\t\t\tstyles: {\n\t\t\t\tmargin: 0,\n\t\t\t},\n\t\t};\n\n\t\tstyleCfg = CKEDITOR.tools.merge(styleCfg, this.props.style);\n\n\t\tthis._preview = new CKEDITOR.style(styleCfg).buildPreview(\n\t\t\tthis.props.name\n\t\t);\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItem\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\t// We need to use dangerouselySetInnterHTML since we're not in control of the style\n\t\t// preview that is generated by CKEditor.\n\t\tconst className =\n\t\t\tthis.props.name === this.props.activeStyle\n\t\t\t\t? 'ae-toolbar-element active'\n\t\t\t\t: 'ae-toolbar-element';\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName={className}\n\t\t\t\tdangerouslySetInnerHTML={{__html: this._preview}}\n\t\t\t\tonClick={this._onClick}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t/>\n\t\t);\n\t}\n\n\t/**\n\t * Applies the item style to the editor selection.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItem\n\t * @method _onClick\n\t * @protected\n\t */\n\t_onClick = () => {\n\t\t// Typically, we want the style to be the only one applied to the current selection, so\n\t\t// we execute the 'removeFormat' command first. Note that block styles won't be cleaned.\n\t\t// However, this is consistent with other editors implementations of this feature.\n\t\tthis.props.editor.get('nativeEditor').execCommand('removeFormat');\n\n\t\tthis.applyStyle();\n\t};\n}\n\nexport default ButtonActionStyle(ButtonStyle(ButtonStylesListItem));\n","import React from 'react';\n\n/**\n * The ButtonStylesListItemRemove class provides functionality for previewing a style definition\n * inside a list and applying it to the current editor selection.\n *\n * @class ButtonStylesListItemRemove\n */\nclass ButtonStylesListItemRemove extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItemRemove\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tremoveBlocks: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'pre'],\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default buttonStylesListItemRemove\n\t * @memberof ButtonStylesListItemRemove\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'buttonStylesListItemRemove';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItemRemove\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<li role=\"option\">\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={this._removeStyles}\n\t\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t\t{AlloyEditor.Strings.normal}\n\t\t\t\t</button>\n\t\t\t</li>\n\t\t);\n\t}\n\n\t/**\n\t * Removes all inline styles and configured block elements applied to the current selection.\n\t *\n\t * @instance\n\t * @memberof ButtonStylesListItemRemove\n\t * @method _removeStyles\n\t * @protected\n\t */\n\t_removeStyles = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\teditor.execCommand('removeFormat');\n\n\t\tthis.props.removeBlocks.forEach(function(blockItem) {\n\t\t\tconst blockStyle = new CKEDITOR.style({element: blockItem});\n\n\t\t\teditor.removeStyle(blockStyle);\n\t\t});\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n}\n\nexport default ButtonStylesListItemRemove;\n","import React from 'react';\n\n/**\n * The ButtonsStylesListHeader class provides the header of an list of style items.\n *\n * @class ButtonsStylesListHeader\n */\nclass ButtonsStylesListHeader extends React.Component {\n\tstatic key = 'buttonStylesListHeader';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonsStylesListHeader\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.styles && this.props.styles.length) {\n\t\t\treturn <span className=\"ae-list-header\">{this.props.name}</span>;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nexport default ButtonsStylesListHeader;\n","import React from 'react';\n\n/**\n * The ButtonCameraImage class takes photo from camera and inserts it to the content.\n *\n * @class ButtonCameraImage\n */\nclass ButtonCameraImage extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t */\n\tstatic defaultProps = {\n\t\tvideoWidth: 320,\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default cameraImage\n\t * @memberof ButtonCameraImage\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'cameraImage';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis._buttonTakePhotoRef = React.createRef();\n\t\tthis._canvasContainerRef = React.createRef();\n\t\tthis._videoContainerRef = React.createRef();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses the take photo button.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tthis._buttonTakePhotoRef.current.focus();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method componentWillUnmount\n\t */\n\tcomponentWillUnmount() {\n\t\tif (this._stream) {\n\t\t\tif (this._stream.stop) {\n\t\t\t\tthis._stream.stop();\n\t\t\t} else if (this._stream.getVideoTracks) {\n\t\t\t\tthis._stream.getVideoTracks().forEach(function(track) {\n\t\t\t\t\ttrack.stop();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._stream = null;\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst getUserMedia =\n\t\t\tnavigator.getUserMedia ||\n\t\t\tnavigator.webkitGetUserMedia ||\n\t\t\tnavigator.mozGetUserMedia ||\n\t\t\tnavigator.msGetUserMedia;\n\n\t\tgetUserMedia.call(\n\t\t\tnavigator,\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\taudio: false,\n\t\t\t},\n\t\t\tthis._handleStreamSuccess,\n\t\t\tthis._handleStreamError\n\t\t);\n\n\t\treturn (\n\t\t\t<div className=\"ae-camera\">\n\t\t\t\t<video ref={this._videoContainerRef}>\n\t\t\t\t\tVideo stream not available.\n\t\t\t\t</video>\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"ae-camera-shoot\"\n\t\t\t\t\tonClick={this.takePhoto}\n\t\t\t\t\tref={this._buttonTakePhotoRef}>\n\t\t\t\t\tTake photo\n\t\t\t\t</button>\n\t\t\t\t<canvas\n\t\t\t\t\tclassName=\"ae-camera-canvas\"\n\t\t\t\t\tref={this._canvasContainerRef}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Takes photo from the video stream and inserts in into editor's content.\n\t *\n\t * @fires ButtonCameraImage#imageCameraAdd\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method takePhoto\n\t */\n\ttakePhoto = () => {\n\t\tconst videoEl = this._videoContainerRef.current;\n\t\tconst canvasEl = this._canvasContainerRef.current;\n\n\t\tconst context = canvasEl.getContext('2d');\n\n\t\tconst height = this._videoHeight;\n\t\tconst width = this.props.videoWidth;\n\n\t\tif (width && height) {\n\t\t\tcanvasEl.width = width;\n\t\t\tcanvasEl.height = height;\n\n\t\t\tcontext.drawImage(videoEl, 0, 0, width, height);\n\n\t\t\tconst imgURL = canvasEl.toDataURL('image/png');\n\n\t\t\tconst el = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t'<img src=\"' + imgURL + '\">'\n\t\t\t);\n\n\t\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\t\teditor.insertElement(el);\n\n\t\t\tthis.props.cancelExclusive();\n\n\t\t\teditor.fire('actionPerformed', this);\n\n\t\t\teditor.fire('imageCameraAdd', el);\n\t\t}\n\t};\n\n\t/**\n\t * Displays error message in case of video stream capturing failure.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method _handleStreamError\n\t * @param {Event} error The fired event in case of error.\n\t * @protected\n\t */\n\t_handleStreamError = error => {\n\t\twindow.alert('An error occurred! ' + error);\n\t};\n\n\t/**\n\t * Starts streaming video in the video element and sets width/height to the video\n\t * and canvas elements.\n\t *\n\t * @instance\n\t * @memberof ButtonCameraImage\n\t * @method _handleStreamSuccess\n\t * @param {Object} stream The video stream\n\t * @protected\n\t */\n\t_handleStreamSuccess = stream => {\n\t\tconst videoEl = this._videoContainerRef.current;\n\t\tconst canvasEl = this._canvasContainerRef.current;\n\n\t\tvideoEl.addEventListener(\n\t\t\t'canplay',\n\t\t\t() => {\n\t\t\t\tlet height =\n\t\t\t\t\tvideoEl.videoHeight /\n\t\t\t\t\t(videoEl.videoWidth / this.props.videoWidth);\n\n\t\t\t\tif (isNaN(height)) {\n\t\t\t\t\theight = this.props.videoWidth / (4 / 3);\n\t\t\t\t}\n\n\t\t\t\tvideoEl.setAttribute('width', this.props.videoWidth);\n\t\t\t\tvideoEl.setAttribute('height', height);\n\t\t\t\tcanvasEl.setAttribute('width', this.props.videoWidth);\n\t\t\t\tcanvasEl.setAttribute('height', height);\n\n\t\t\t\tthis._videoHeight = height;\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\n\t\tthis._stream = stream;\n\n\t\tif (navigator.mozGetUserMedia) {\n\t\t\tvideoEl.mozSrcObject = stream;\n\t\t} else {\n\t\t\tvideoEl.srcObject = stream;\n\t\t}\n\n\t\tvideoEl.play();\n\n\t\tthis._buttonTakePhotoRef.current.disabled = false;\n\t};\n\n\t/**\n\t * Fired when an image is being taken from the camera and added as an element to the editor.\n\t *\n\t * @event ButtonCameraImage#imageCameraAdd\n\t * @memberof ButtonCameraImage\n\t * @param {CKEDITOR.dom.element} el The created img element in editor.\n\t */\n}\n\nexport default ButtonCameraImage;\n","import ButtonCommand from '../base/button-command.js';\nimport React from 'react';\n\n/**\n * The ButtonCommandListItem class is a UI class that renders a ButtonCommand that can be used inside\n * a list as an item, with a string representation of its behaviour.\n *\n * @class ButtonCommandListItem\n * @uses ButtonCommand\n */\nclass ButtonCommandListItem extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default buttonCommandListItem\n\t * @memberof ButtonCommandListItem\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'buttonCommandListItem';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandListItem\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={this.props.description}\n\t\t\t\tclassName={this._getClassName()}\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t{this.props.description}\n\t\t\t</button>\n\t\t);\n\t}\n\n\t/**\n\t * Returns the class name of Widget.\n\t *\n\t * @instance\n\t * @memberof ButtonCommandListItem\n\t * @method _getClassName\n\t * @protected\n\t * @return {String} The class name of the Widget.\n\t */\n\t_getClassName() {\n\t\tconst className = 'ae-container ae-toolbar-element';\n\n\t\treturn className;\n\t}\n}\n\nexport default ButtonCommand(ButtonCommandListItem);\n","import ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\nconst KEY_ENTER = 13;\nconst KEY_ESC = 27;\n\n/**\n * The ButtonEmbedEdit class provides functionality for creating and editing an embed link in a document.\n * Provides UI for creating and editing an embed link.\n *\n * @class ButtonEmbedEdit\n */\nclass ButtonEmbedEdit extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default embedEdit\n\t * @memberof ButtonEmbedEdit\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'embedEdit';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.linkInput = React.createRef();\n\t\tthis.state = this.getInitialState();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the link input to immediately allow editing. This should only happen if the component\n\t * is rendered in exclusive mode to prevent aggressive focus stealing.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tif (this.props.renderExclusive || this.props.manualSelection) {\n\t\t\t// We need to wait for the next rendering cycle before focusing to avoid undesired\n\t\t\t// scrolls on the page\n\t\t\tif (window.requestAnimationFrame) {\n\t\t\t\twindow.requestAnimationFrame(this._focusLinkInput);\n\t\t\t} else {\n\t\t\t\tsetTimeout(this._focusLinkInput, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Invoked when a component is receiving new props.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method componentWillReceiveProps\n\t */\n\tcomponentWillReceiveProps() {\n\t\tthis.setState(this.getInitialState());\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once before the component is mounted.\n\t * The return value will be used as the initial value of this.state.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method getInitialState\n\t */\n\tgetInitialState() {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tlet embed;\n\n\t\tconst selection = editor.getSelection();\n\n\t\tif (selection) {\n\t\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\t\tif (selectedElement) {\n\t\t\t\tembed = selectedElement.findOne('[data-widget=\"ae_embed\"]');\n\t\t\t}\n\t\t}\n\n\t\tconst href = embed ? embed.getAttribute('data-ae-embed-url') : '';\n\n\t\treturn {\n\t\t\telement: embed,\n\t\t\tinitialLink: {\n\t\t\t\thref: href,\n\t\t\t},\n\t\t\tlinkHref: href,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst clearLinkStyle = {\n\t\t\topacity: this.state.linkHref ? 1 : 0,\n\t\t};\n\n\t\tconst editor = this.props.editor;\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-edit-link\">\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.deleteEmbed}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-embed-remove\"\n\t\t\t\t\tdisabled={!this.state.element}\n\t\t\t\t\tonClick={this._removeEmbed}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.deleteEmbed}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={editor}\n\t\t\t\t\t\tsymbol=\"trash\"\n\t\t\t\t\t\tclassName=\"ae-icon-svg-trash\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t\t<div className=\"ae-container-input xxl\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\tonChange={this._handleLinkHrefChange}\n\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\tplaceholder={AlloyEditor.Strings.editLink}\n\t\t\t\t\t\tref={this.linkInput}\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tvalue={this.state.linkHref}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label={AlloyEditor.Strings.clearInput}\n\t\t\t\t\t\tclassName=\"ae-button ae-button-clear\"\n\t\t\t\t\t\tonClick={this._clearLink}\n\t\t\t\t\t\tstyle={clearLinkStyle}\n\t\t\t\t\t\ttitle={AlloyEditor.Strings.clear}>\n\t\t\t\t\t\t<ButtonIcon editor={editor} symbol=\"times-clear\" />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.confirm}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdisabled={!this._isValidState()}\n\t\t\t\t\tonClick={this._embedLink}\n\t\t\t\t\ttitle={AlloyEditor.Strings.confirm}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={editor}\n\t\t\t\t\t\tsymbol=\"check\"\n\t\t\t\t\t\tclassName=\"ae-icon-svg-check\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Clears the link input. This only changes the component internal state, but does not\n\t * affect the link element of the editor. Only the _removeLink and _updateLink methods\n\t * are translated to the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _clearLink\n\t * @protected\n\t */\n\t_clearLink = () => {\n\t\tthis.setState({\n\t\t\tlinkHref: '',\n\t\t});\n\t};\n\n\t/**\n\t * Triggers the embedUrl command to transform the link into an embed media object\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _embedLink\n\t * @protected\n\t */\n\t_embedLink = () => {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\tnativeEditor.execCommand('embedUrl', {\n\t\t\turl: this.state.linkHref,\n\t\t});\n\n\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t// inside another in exclusive mode (such is the case of the link button)\n\t\tthis.props.cancelExclusive();\n\t};\n\n\t/**\n\t * Focuses the user cursor on the widget's input.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _focusLinkInput\n\t * @protected\n\t */\n\t_focusLinkInput = () => {\n\t\tthis.linkInput.current.focus();\n\t};\n\n\t/**\n\t * Monitors key interaction inside the input element to respond to the keys:\n\t * - Enter: Creates/updates the link.\n\t * - Escape: Discards the changes.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _handleKeyDown\n\t * @param {SyntheticEvent} event The keyboard event.\n\t * @protected\n\t */\n\t_handleKeyDown = event => {\n\t\tif (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif (event.keyCode === KEY_ENTER) {\n\t\t\tthis._embedLink();\n\t\t} else if (event.keyCode === KEY_ESC) {\n\t\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t\t// inside another in exclusive mode (such is the case of the link button)\n\t\t\tthis.props.cancelExclusive();\n\n\t\t\teditor.fire('actionPerformed', this);\n\t\t}\n\t};\n\n\t/**\n\t * Updates the component state when the link input changes on user interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _handleLinkHrefChange\n\t * @param {SyntheticEvent} event The change event.\n\t * @protected\n\t */\n\t_handleLinkHrefChange = event => {\n\t\tthis.setState({\n\t\t\tlinkHref: event.target.value,\n\t\t});\n\t};\n\n\t/**\n\t * Verifies that the current link state is valid so the user can save the link. A valid state\n\t * means that we have a non-empty href that's different from the original one.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _isValidState\n\t * @protected\n\t * @return {Boolean} True if the state is valid, false otherwise\n\t */\n\t_isValidState() {\n\t\tconst validState =\n\t\t\tthis.state.linkHref &&\n\t\t\tthis.state.linkHref !== this.state.initialLink.href;\n\n\t\treturn validState;\n\t}\n\n\t/**\n\t * Removes the embed in the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedEdit\n\t * @method _removeEmbed\n\t * @protected\n\t */\n\t_removeEmbed = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst embedWrapper = this.state.element.getAscendant(function(element) {\n\t\t\treturn element.hasClass('cke_widget_wrapper');\n\t\t});\n\n\t\tembedWrapper.remove();\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n}\n\nexport default ButtonEmbedEdit;\n","import ButtonIcon from './button-icon.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\n\nconst KEY_ENTER = 13;\nconst KEY_ESC = 27;\n\n/**\n * The ButtonEmbedVideoEdit class provides functionality for changing text color in a document.\n *\n * @uses ButtonIcon\n *\n * @class ButtonEmbedVideoEdit\n */\nclass ButtonEmbedVideoEdit extends React.Component {\n\tstatic key = 'embedVideoEdit';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonEmbedVideoEdit\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tthis.state = this.getInitialState();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the link input to immediately allow editing. This should only happen if the component\n\t * is rendered in exclusive mode to prevent aggressive focus stealing.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tif (this.props.renderExclusive || this.props.manualSelection) {\n\t\t\t// We need to wait for the next rendering cycle before focusing to avoid undesired\n\t\t\t// scrolls on the page\n\t\t\tif (window.requestAnimationFrame) {\n\t\t\t\twindow.requestAnimationFrame(this._focusVideoUrlInput);\n\t\t\t} else {\n\t\t\t\tsetTimeout(this._focusVideoUrlInput, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Invoked when a component is receiving new props.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method componentWillReceiveProps\n\t */\n\tcomponentWillReceiveProps() {\n\t\tthis.replaceState(this.getInitialState());\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once before the component is mounted.\n\t * The return value will be used as the initial value of this.state.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method getInitialState\n\t */\n\tgetInitialState() {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tlet element;\n\n\t\tconst selection = editor.getSelection();\n\n\t\tif (selection) {\n\t\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\t\tif (selectedElement) {\n\t\t\t\telement = selectedElement.findOne('[data-widget=\"videoembed\"]');\n\t\t\t}\n\t\t}\n\n\t\tconst videoURL = element\n\t\t\t? element.getAttribute('data-embed-video-url')\n\t\t\t: '';\n\n\t\treturn {\n\t\t\telement,\n\t\t\tinitialEmbed: {\n\t\t\t\tvideoURL,\n\t\t\t},\n\t\t\tvideoURL,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst inputPlaceholder = AlloyEditor.Strings.pasteVideoLink;\n\n\t\tconst clearVideoURLStyle = {\n\t\t\topacity: this.state.videoURL ? 1 : 0,\n\t\t};\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-embed-video-edit\">\n\t\t\t\t<div className=\"ae-container-input xxl\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\tonChange={this._handleVideoURLChange}\n\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\tplaceholder={inputPlaceholder}\n\t\t\t\t\t\tref=\"linkInput\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tvalue={this.state.videoURL}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label={AlloyEditor.Strings.clearInput}\n\t\t\t\t\t\tclassName=\"ae-button ae-icon-remove\"\n\t\t\t\t\t\tonClick={this._clearLink}\n\t\t\t\t\t\tstyle={clearVideoURLStyle}\n\t\t\t\t\t\ttitle={AlloyEditor.Strings.clear}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.confirm}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdisabled={!this._isValidState()}\n\t\t\t\t\tonClick={this._embedVideoURL}\n\t\t\t\t\ttitle={AlloyEditor.Strings.confirm}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"check\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Clears the link input. This only changes the component internal state, but does not\n\t * affect the link element of the editor. Only the _removeLink and _updateLink methods\n\t * are translated to the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method _clearLink\n\t * @protected\n\t */\n\t_clearLink() {\n\t\tthis.setState({\n\t\t\tvideoURL: '',\n\t\t});\n\t}\n\n\t/**\n\t * Triggers the embedVideoUrl command to transform the link into an embed media object\n\t *\n\t * @instance\n\t * @memberof EmbedVideoEdit\n\t * @method _embedVideoURL\n\t * @protected\n\t */\n\t_embedVideoURL = () => {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\tnativeEditor.execCommand('embedUrl', {\n\t\t\ttype: 'video',\n\t\t\turl: this.state.videoURL,\n\t\t});\n\n\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t// inside another in exclusive mode (such is the case of the link button)\n\t\tthis.props.cancelExclusive();\n\t};\n\n\t/**\n\t * Focuses the user cursor on the widget's input.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method _focusVideoUrlInput\n\t * @protected\n\t */\n\t_focusVideoUrlInput = () => {\n\t\tReactDOM.findDOMNode(this.refs.linkInput).focus();\n\t};\n\n\t/**\n\t * Monitors key interaction inside the input element to respond to the keys:\n\t * - Enter: Creates/updates the link.\n\t * - Escape: Discards the changes.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method _handleKeyDown\n\t * @param {SyntheticEvent} event The keyboard event.\n\t * @protected\n\t */\n\t_handleKeyDown = event => {\n\t\tif (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif (event.keyCode === KEY_ENTER) {\n\t\t\tthis._embedVideoURL();\n\t\t} else if (event.keyCode === KEY_ESC) {\n\t\t\tthis.props.cancelExclusive();\n\t\t}\n\t};\n\n\t/**\n\t * Updates the component state when the link input changes on user interaction.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbedVideoEdit\n\t * @method _handleVideoURLChange\n\t * @param {SyntheticEvent} event The change event.\n\t * @protected\n\t */\n\t_handleVideoURLChange = event => {\n\t\tthis.setState({\n\t\t\tvideoURL: event.target.value,\n\t\t});\n\t};\n\n\t/**\n\t * Verifies that the current link state is valid so the user can save the link. A valid state\n\t * means that we have a non-empty videoURL that's different from the original one.\n\t *\n\t * @instance\n\t * @memberof EmbedVideoEdit\n\t * @method _isValidState\n\t * @protected\n\t * @return {Boolean} True if the state is valid, false otherwise\n\t */\n\t_isValidState() {\n\t\tconst validState =\n\t\t\tthis.state.videoURL &&\n\t\t\tthis.state.videoURL !== this.state.initialEmbed.videoURL;\n\n\t\treturn validState;\n\t}\n}\n\nexport default ButtonEmbedVideoEdit;\n","import ButtonDropdown from './button-dropdown.jsx';\nimport React from 'react';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonLinkAutocompleteList class provides functionality for showing a list of\n * items that can be selected for the link.\n *\n * @class ButtonLinkAutocompleteList\n * @uses WidgetFocusManager\n */\nclass ButtonLinkAutocompleteList extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcircular: false,\n\t\tdata: [],\n\t\tdelay: 100,\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default buttonLinkAutocompleteList\n\t * @memberof ButtonLinkAutocompleteList\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'buttonLinkAutocompleteList';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\titems: [],\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Invoked when a component is receiving new props.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method componentWillReceiveProps\n\t */\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (!nextProps.term || nextProps.term !== this.props.term) {\n\t\t\tclearTimeout(this._timeout);\n\n\t\t\tif (nextProps.term) {\n\t\t\t\tthis._timeout = setTimeout(this._updateItems, this.props.delay);\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\titems: [],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (nextProps.autocompleteSelected) {\n\t\t\tsetTimeout(this.focus, 0);\n\t\t\tthis.props.setAutocompleteState({\n\t\t\t\tselected: false,\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method componentWillUnmount\n\t */\n\tcomponentWillUnmount() {\n\t\tclearTimeout(this._timeout);\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the list.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (!this.props.expanded || !this.state.items.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<ButtonDropdown>\n\t\t\t\t{this._renderAutocompleteItems(this.state.items)}\n\t\t\t</ButtonDropdown>\n\t\t);\n\t}\n\n\t/**\n\t * Lifecycle. Invoked before rendering when new props or state are being received.\n\t * This method is not called for the initial render or when forceUpdate is used.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method  shouldComponentUpdate\n\t * @return {Boolean} Returns false when the transition to the new props and state will not\n\t * require a component update.\n\t */\n\tshouldComponentUpdate(nextProps, nextState) {\n\t\treturn (\n\t\t\tnextProps.expanded !== this.props.expanded ||\n\t\t\tnextProps.term !== this.props.term ||\n\t\t\tnextState.items !== this.state.items\n\t\t);\n\t}\n\n\t/**\n\t * Renders a set of list items for the provided items\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method _renderAutocompleteItems\n\t * @param {Array} items List of autocomplete items to render\n\t * @protected\n\t * @return {Array} Rendered list item instances\n\t */\n\t_renderAutocompleteItems(items) {\n\t\titems = items || [];\n\n\t\tconst handleLinkAutocompleteClick = this.props\n\t\t\t.handleLinkAutocompleteClick;\n\n\t\treturn items.map(item => {\n\t\t\tconst className =\n\t\t\t\tthis.props.term === item.url\n\t\t\t\t\t? 'ae-toolbar-element active'\n\t\t\t\t\t: 'ae-toolbar-element';\n\n\t\t\treturn (\n\t\t\t\t<li key={item.url} role=\"option\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\tonClick={handleLinkAutocompleteClick}\n\t\t\t\t\t\tdata-value={item.url}>\n\t\t\t\t\t\t{item.title}\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Retrieves the data according to {this.props.term} and calls setState() with the returned data\n\t *\n\t * @instance\n\t * @memberof ButtonLinkAutocompleteList\n\t * @method _updateItems\n\t * @protected\n\t */\n\t_updateItems() {\n\t\tif (!this.props.term) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst promise = Promise.resolve(this.props.data(this.props.term));\n\n\t\tpromise.then(items => {\n\t\t\tif (items.length) {\n\t\t\t\t!this.props.expanded && this.props.toggleDropdown();\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\titems: items,\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default WidgetFocusManager(ButtonLinkAutocompleteList);\n","import ButtonCfgProps from '../base/button-props.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonLink class provides functionality for creating and editing a link in a document. ButtonLink\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonLinkEdit UI with all the link edition controls.\n *\n * @class ButtonLink\n * @uses ButtonCfgProps\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n */\nclass ButtonLink extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonLink\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tkeystroke: {\n\t\t\tfn: '_requestExclusive',\n\t\t\tkeys: CKEDITOR.CTRL + 76 /* L*/,\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default link\n\t * @memberof ButtonLink\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'link';\n\n\t/**\n\t * Checks if the current selection is contained within a link.\n\t *\n\t * @instance\n\t * @memberof ButtonLink\n\t * @method isActive\n\t * @return {Boolean} True if the selection is inside a link, false otherwise.\n\t */\n\tisActive() {\n\t\treturn (\n\t\t\tnew CKEDITOR.Link(\n\t\t\t\tthis.props.editor.get('nativeEditor')\n\t\t\t).getFromSelection() !== null\n\t\t);\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonLink\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\tif (this.props.renderExclusive) {\n\t\t\tconst props = this.mergeButtonCfgProps();\n\n\t\t\treturn <ButtonLinkEdit {...props} />;\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.link}\n\t\t\t\t\tclassName={cssClass}\n\t\t\t\t\tdata-type=\"button-link\"\n\t\t\t\t\tonClick={this._requestExclusive}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.link}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"link\" />\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Requests the link button to be rendered in exclusive mode to allow the creation of a link.\n\t *\n\t * @instance\n\t * @memberof ButtonLink\n\t * @method _requestExclusive\n\t * @protected\n\t */\n\t_requestExclusive = () => {\n\t\tthis.props.requestExclusive(ButtonLink.key);\n\t};\n}\n\nexport default ButtonCfgProps(ButtonKeystroke(ButtonStateClasses(ButtonLink)));\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonTargetList from './button-target-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonLinkTargetEdit class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonLinkTargetEdit\n */\nclass ButtonLinkTargetEdit extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default linkTargetEdit\n\t * @memberof ButtonLinkTargetEdit\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'linkTargetEdit';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkTargetEdit\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst handleLinkTargetChange = this.props.handleLinkTargetChange;\n\t\tconst allowedLinkTargets = this.props.allowedTargets;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"ae-container-edit-link-target ae-container-dropdown ae-container-dropdown-medium ae-has-dropdown\"\n\t\t\t\ttabIndex=\"0\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={this.props.selectedTarget}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={this.props.selectedTarget}>\n\t\t\t\t\t<div className=\"ae-container\">\n\t\t\t\t\t\t<span className=\"ae-container-dropdown-selected-item\">\n\t\t\t\t\t\t\t{this.props.selectedTarget}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\tsymbol=\"caret-bottom\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t\t{this.props.expanded && (\n\t\t\t\t\t<ButtonTargetList\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t\t\tallowedLinkTargets={allowedLinkTargets}\n\t\t\t\t\t\thandleLinkTargetChange={handleLinkTargetChange}\n\t\t\t\t\t\tselectedTarget={this.props.selectedTarget}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Lifecycle. Invoked before rendering when new props or state are being received.\n\t * This method is not called for the initial render or when forceUpdate is used.\n\t *\n\t * @instance\n\t * @memberof ButtonLinkTargetEdit\n\t * @method  shouldComponentUpdate\n\t * @return {Boolean} Returns false when the transition to the new props and state will not\n\t * require a component update.\n\t */\n\tshouldComponentUpdate(nextProps) {\n\t\treturn (\n\t\t\tnextProps.expanded !== this.props.expanded ||\n\t\t\tnextProps.selectedTarget !== this.props.selectedTarget\n\t\t);\n\t}\n}\n\nexport default ButtonLinkTargetEdit;\n","import ButtonDropdown from './button-dropdown.jsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\n\n/**\n * The ButtonTargetList class provides functionality for changing the target of a link\n * in the document.\n *\n * @class ButtonTargetList\n * @uses WidgetFocusManager\n */\nclass ButtonTargetList extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonTargetList\n\t * @method getDefaultProps\n\t */\n\tstatic defaultProps = {\n\t\tcircular: true,\n\t\tdescendants: '.ae-toolbar-element',\n\t\tkeys: {\n\t\t\tdismiss: [27],\n\t\t\tdismissNext: [39],\n\t\t\tdismissPrev: [37],\n\t\t\tnext: [40],\n\t\t\tprev: [38],\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default linkTargetEdit\n\t * @memberof ButtonTargetList\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'targetList';\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof ButtonTargetList\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tReactDOM.findDOMNode(this).focus();\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTargetList\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst listTargets = this._renderListTargets();\n\n\t\treturn <ButtonDropdown {...this.props}>{listTargets}</ButtonDropdown>;\n\t}\n\n\t/**\n\t * Returns the the allowed link target items.\n\t *\n\t * @instance\n\t * @memberof ButtonTargetList\n\t * @method _getAllowedTargetItems\n\t * @protected\n\t * @return {Array} The allowed target items.\n\t */\n\t_getAllowedTargetItems() {\n\t\treturn (\n\t\t\tthis.props.allowedLinkTargets || [\n\t\t\t\t{\n\t\t\t\t\tlabel: AlloyEditor.Strings.linkTargetDefault,\n\t\t\t\t\tvalue: '',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: AlloyEditor.Strings.linkTargetSelf,\n\t\t\t\t\tvalue: '_self',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: AlloyEditor.Strings.linkTargetBlank,\n\t\t\t\t\tvalue: '_blank',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: AlloyEditor.Strings.linkTargetParent,\n\t\t\t\t\tvalue: '_parent',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: AlloyEditor.Strings.linkTargetTop,\n\t\t\t\t\tvalue: '_top',\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n\n\t/**\n\t * Renders the allowed link target items.\n\t *\n\t * @instance\n\t * @memberof ButtonTargetList\n\t * @method _renderListTargets\n\t * @protected\n\t * @return {Object} Returns the rendered link items\n\t */\n\t_renderListTargets() {\n\t\tlet targets = this._getAllowedTargetItems();\n\n\t\tconst handleLinkTargetChange = this.props.handleLinkTargetChange;\n\n\t\ttargets = targets.map(target => {\n\t\t\tconst className =\n\t\t\t\tthis.props.selectedTarget === target.value\n\t\t\t\t\t? 'ae-toolbar-element active'\n\t\t\t\t\t: 'ae-toolbar-element';\n\n\t\t\treturn (\n\t\t\t\t<li key={target.value} role=\"option\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\tdata-value={target.value}\n\t\t\t\t\t\tonClick={handleLinkTargetChange}>\n\t\t\t\t\t\t{target.label}\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t);\n\t\t});\n\n\t\treturn targets;\n\t}\n}\n\nexport default WidgetFocusManager(ButtonTargetList);\n","import Lang from '../../oop/lang';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * The LinkEditBrowse class provides functionality for creating and editing a link in a document,\n * and also allows to link to an existing file in DM.\n * Provides UI for creating, editing and removing a link.\n *\n * @class ButtonLinkEditBrowse\n */\nclass ButtonLinkEditBrowse extends React.Component {\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\tstatic key = 'linkEditBrowse';\n\t/**\n\t *\n\t * @inheritDoc\n\t */\n\tconstructor(props, context) {\n\t\tsuper(props, context);\n\n\t\tconst link = new CKEDITOR.Link(\n\t\t\tthis.props.editor.get('nativeEditor')\n\t\t).getFromSelection();\n\n\t\tconst href = link ? link.getAttribute('href') : '';\n\n\t\tthis.linkEditButtonRef = React.createRef();\n\n\t\tthis.state = {\n\t\t\telement: link,\n\t\t\tlinkHref: href,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"ae-container-link-edit-browse\">\n\t\t\t\t<ButtonLinkEdit ref={this.linkEditButtonRef} {...this.props} />\n\t\t\t\t<button\n\t\t\t\t\taria-label=\"Browse\"\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tonClick={this._browseClick}\n\t\t\t\t\ttitle=\"browse\">\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"folder\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Opens an item selector dialog.\n\t *\n\t * @protected\n\t * @method _browseClick\n\t */\n\t_browseClick = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst url = editor.config.documentBrowseLinkUrl;\n\t\tconst browseLinkCallback = editor.config.documentBrowseLinkCallback;\n\t\tconst linkTarget = this.linkEditButtonRef.current.state.linkTarget;\n\t\tconst changeLinkCallback = selectedItem => {\n\t\t\tthis._updateLink(selectedItem.value, linkTarget, selectedItem.href);\n\t\t};\n\n\t\tif (Lang.isFunction(browseLinkCallback)) {\n\t\t\tbrowseLinkCallback.apply(null, [editor, url, changeLinkCallback]);\n\t\t}\n\t};\n\n\t/**\n\t * Updates the link in the editor element. If the element didn't exist previously, it will\n\t * create a new <a> element with the href specified in the link input.\n\t *\n\t * @protected\n\t * @method _updateLink\n\t * @param {String} linkHref href value for the link\n\t * @param {String} linkTarget target value for the link\n\t * @param {String} linkTitle if the link is a title that points to a wiki page (only works for creole)\n\t */\n\t_updateLink = (linkHref, linkTarget, linkTitle) => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst linkUtils = new CKEDITOR.Link(editor, {appendProtocol: false});\n\t\tconst linkAttrs = {\n\t\t\ttarget: linkTarget,\n\t\t};\n\t\tconst modifySelection = {advance: true};\n\n\t\tif (linkHref) {\n\t\t\tif (editor.plugins && editor.plugins.creole && !linkTitle) {\n\t\t\t\tlinkHref = location.origin + linkHref;\n\t\t\t}\n\n\t\t\tif (this.state.element) {\n\t\t\t\tlinkAttrs.href = linkHref;\n\n\t\t\t\tlinkUtils.update(\n\t\t\t\t\tlinkAttrs,\n\t\t\t\t\tthis.state.element,\n\t\t\t\t\tmodifySelection\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tlinkUtils.create(linkHref, linkAttrs, modifySelection);\n\t\t\t}\n\n\t\t\teditor.fire('actionPerformed', this);\n\t\t}\n\t};\n}\n\nexport default ButtonLinkEditBrowse;\n","import ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\nconst KEY_ENTER = 13;\nconst KEY_ESC = 27;\n\n/**\n * The ButtonTableEdit class provides functionality for creating and editing a table in a document.\n * Provides UI for creating a table.\n *\n * @class ButtonTableEdit\n */\nclass ButtonTableEdit extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method getDefaultProps\n\t */\n\tstatic defaultProps = {\n\t\ttableAttributes: {\n\t\t\tborder: 1,\n\t\t\tcellPadding: 0,\n\t\t\tcellSpacing: 0,\n\t\t\tstyle: 'width: 100%',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableEdit\n\t * @memberof ButtonTableEdit\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableEdit';\n\n\t/**\n\t * Lifecycle. Invoked once before the component is mounted.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method getInitialState\n\t */\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.rowsRef = React.createRef();\n\t\tthis.colsRef = React.createRef();\n\t\tthis.state = {\n\t\t\tcols: 3,\n\t\t\trows: 3,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client (not on the server),\n\t * immediately after the initial rendering occurs.\n\t *\n\t * Focuses on the link input to immediately allow editing.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tthis.rowsRef.current.focus();\n\t}\n\n\t/**\n\t * Creates a table.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method _createTable\n\t * @protected\n\t */\n\t_createTable = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst tableUtils = new CKEDITOR.Table(editor);\n\n\t\ttableUtils.create({\n\t\t\tattrs: this.props.tableAttributes,\n\t\t\tcols: this.state.cols,\n\t\t\trows: this.state.rows,\n\t\t});\n\n\t\tthis.props.cancelExclusive();\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n\n\t/**\n\t * Handles a change in input value. Sets the provided value from the user back to the input.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method _handleChange\n\t * @param {String} inputName The name of the input which value should be updated.\n\t * @param {SyntheticEvent} event The provided event.\n\t * @protected\n\t */\n\t_handleChange = (inputName, event) => {\n\t\tconst state = {};\n\t\tstate[inputName] = event.target.value;\n\n\t\tthis.setState(state);\n\t};\n\n\t/**\n\t * Monitors key interaction inside the input element to respond to the keys:\n\t * - Enter: Creates the table.\n\t * - Escape: Discards the changes.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method _handleKeyDown\n\t * @param {SyntheticEvent} event The keyboard event.\n\t * @protected\n\t */\n\t_handleKeyDown = event => {\n\t\tif (event.keyCode === KEY_ENTER || event.keyCode === KEY_ESC) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif (event.keyCode === KEY_ENTER) {\n\t\t\tthis._createTable();\n\t\t} else if (event.keyCode === KEY_ESC) {\n\t\t\tthis.props.cancelExclusive();\n\t\t}\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableEdit\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst time = Date.now();\n\t\tconst rowsId = time + 'rows';\n\t\tconst colsId = time + 'cols';\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-edit-table\">\n\t\t\t\t<label htmlFor={rowsId}>{AlloyEditor.Strings.rows}</label>\n\t\t\t\t<div className=\"ae-container-input small\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\tid={rowsId}\n\t\t\t\t\t\tonChange={this._handleChange.bind(this, 'rows')}\n\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\tplaceholder=\"Rows\"\n\t\t\t\t\t\tref={this.rowsRef}\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tvalue={this.state.rows}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<label htmlFor={colsId}>{AlloyEditor.Strings.columns}</label>\n\t\t\t\t<div className=\"ae-container-input small\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\tid={colsId}\n\t\t\t\t\t\tonChange={this._handleChange.bind(this, 'cols')}\n\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\tplaceholder=\"Colums\"\n\t\t\t\t\t\tref={this.colsRef}\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tvalue={this.state.cols}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<button\n\t\t\t\t\taria-label=\"Confirm\"\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tonClick={this._createTable}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"check\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default ButtonTableEdit;\n","import Lang from '../../oop/lang.js';\nimport React from 'react';\n\n/**\n * ToolbarButtons is a mixin which provides a list of buttons which have to be\n * displayed on the current toolbar depending on user preferences and given state.\n *\n * @class ToolbarButtons\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Analayses the current selection and returns the buttons or button groups to be rendered.\n\t\t *\n\t\t * @instance\n\t\t * @method getToolbarButtonGroups\n\t\t * @param {Array} buttons The buttons could be shown, prior to the state filtering.\n\t\t * @param {Object} additionalProps Additional props that should be passed down to the buttons.\n\t\t * @return {Array} An Array which contains the buttons or button groups that should be rendered.\n\t\t */\n\t\tgetToolbarButtonGroups(buttons, additionalProps) {\n\t\t\tif (Lang.isFunction(buttons)) {\n\t\t\t\tbuttons = buttons.call(this) || [];\n\t\t\t}\n\n\t\t\treturn buttons.reduce((list, button) => {\n\t\t\t\tif (Array.isArray(button)) {\n\t\t\t\t\tlist.push(this.getToolbarButtons(button, additionalProps));\n\t\t\t\t\treturn list;\n\t\t\t\t} else {\n\t\t\t\t\treturn this.getToolbarButtons(buttons, additionalProps);\n\t\t\t\t}\n\t\t\t}, []);\n\t\t}\n\n\t\t/**\n\t\t * Analyzes the current selection and the buttons exclusive mode value to figure out which\n\t\t * buttons should be present in a given state.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ToolbarButtons\n\t\t * @method getToolbarButtons\n\t\t * @param {Array} buttons The buttons could be shown, prior to the state filtering.\n\t\t * @param {Object} additionalProps Additional props that should be passed down to the buttons.\n\t\t * @return {Array} An Array which contains the buttons that should be rendered.\n\t\t */\n\t\tgetToolbarButtons(buttons, additionalProps) {\n\t\t\tlet buttonProps = {};\n\n\t\t\tlet nativeEditor = this.props.editor.get('nativeEditor');\n\t\t\tlet buttonCfg = nativeEditor.config.buttonCfg || {};\n\n\t\t\tif (Lang.isFunction(buttons)) {\n\t\t\t\tbuttons = buttons.call(this) || [];\n\t\t\t}\n\n\t\t\tlet toolbarButtons = this.filterExclusive(\n\t\t\t\tbuttons\n\t\t\t\t\t.filter(function(button) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tbutton &&\n\t\t\t\t\t\t\t(AlloyEditor.Buttons[button] ||\n\t\t\t\t\t\t\t\tAlloyEditor.Buttons[button.name])\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t\t.map(function(button) {\n\t\t\t\t\t\tif (Lang.isString(button)) {\n\t\t\t\t\t\t\tbuttonProps[button] = buttonCfg[button];\n\t\t\t\t\t\t\tbutton = AlloyEditor.Buttons[button];\n\t\t\t\t\t\t} else if (Lang.isString(button.name)) {\n\t\t\t\t\t\t\tbuttonProps[\n\t\t\t\t\t\t\t\tAlloyEditor.Buttons[button.name].key\n\t\t\t\t\t\t\t] = CKEDITOR.tools.merge(\n\t\t\t\t\t\t\t\tbuttonCfg[button],\n\t\t\t\t\t\t\t\tbutton.cfg\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tbutton = AlloyEditor.Buttons[button.name];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn button;\n\t\t\t\t\t})\n\t\t\t).map(function(button, index) {\n\t\t\t\tlet props = this.mergeExclusiveProps(\n\t\t\t\t\t{\n\t\t\t\t\t\teditor: this.props.editor,\n\t\t\t\t\t\tkey:\n\t\t\t\t\t\t\tbutton.key !== 'separator'\n\t\t\t\t\t\t\t\t? button.key\n\t\t\t\t\t\t\t\t: `${button.key}-${index}`,\n\t\t\t\t\t\ttabKey: button.key,\n\t\t\t\t\t\ttabIndex:\n\t\t\t\t\t\t\tthis.props.trigger &&\n\t\t\t\t\t\t\tthis.props.trigger.props.tabKey === button.key\n\t\t\t\t\t\t\t\t? 0\n\t\t\t\t\t\t\t\t: -1,\n\t\t\t\t\t\ttrigger: this.props.trigger,\n\t\t\t\t\t},\n\t\t\t\t\tbutton.key\n\t\t\t\t);\n\n\t\t\t\tprops = this.mergeDropdownProps(props, button.key);\n\n\t\t\t\tif (additionalProps) {\n\t\t\t\t\tprops = CKEDITOR.tools.merge(props, additionalProps);\n\t\t\t\t}\n\n\t\t\t\tprops = CKEDITOR.tools.merge(props, buttonProps[button.key]);\n\n\t\t\t\treturn React.createElement(button, props);\n\t\t\t}, this);\n\n\t\t\treturn toolbarButtons;\n\t\t}\n\t};\n","import Lang from '../../oop/lang.js';\n\n/**\n * Provides functionality for displaying Widget Arrow box on top or on bottom of the widget\n * depending on the point of user interaction with the editor.\n *\n * @class WidgetArrowBox\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Returns the list of arrow box classes associated to the current element's state. It relies\n\t\t * on the getInteractionPoint method to calculate the selection direction.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetArrowBox\n\t\t * @method getArrowBoxClasses\n\t\t * @return {String} A string with the arrow box CSS classes.\n\t\t */\n\t\tgetArrowBoxClasses() {\n\t\t\tlet arrowBoxClasses = 'ae-arrow-box';\n\n\t\t\tif (\n\t\t\t\tLang.isFunction(this.getInteractionPoint) &&\n\t\t\t\tthis.getInteractionPoint()\n\t\t\t) {\n\t\t\t\tif (\n\t\t\t\t\tthis.getInteractionPoint().direction ===\n\t\t\t\t\tCKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t\t\t) {\n\t\t\t\t\tarrowBoxClasses += ' ae-arrow-box-top';\n\t\t\t\t} else {\n\t\t\t\t\tarrowBoxClasses += ' ae-arrow-box-bottom';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn arrowBoxClasses;\n\t\t}\n\t};\n","import ReactDOM from 'react-dom';\n\n/**\n * Calculates the position where an Widget should be displayed based on the point\n * where user interacted with the editor.\n *\n * @class WidgetPosition\n */\nexport default WrappedComponent =>\n\tclass extends WrappedComponent {\n\t\t/**\n\t\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method getDefaultProps\n\t\t */\n\t\tstatic defaultProps = {\n\t\t\t...WrappedComponent.defaultProps,\n\t\t\tgutter: {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 10,\n\t\t\t},\n\t\t\tconstrainToViewport: true,\n\t\t};\n\n\t\t/**\n\t\t * Cancels an scheduled animation frame.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method cancelAnimation\n\t\t */\n\t\tcancelAnimation() {\n\t\t\tif (window.cancelAnimationFrame) {\n\t\t\t\twindow.cancelAnimationFrame(this._animationFrameId);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Returns an object which contains the position of the element in page coordinates,\n\t\t * restricted to fit to given viewport.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method getConstrainedPosition\n\t\t * @param {Object} attrs The following properties, provided as numbers:\n\t\t * - height\n\t\t * - left\n\t\t * - top\n\t\t * - width\n\t\t * @param {Object} viewPaneSize Optional. If not provided, the current viewport will be used. Should contain at least these properties:\n\t\t * - width\n\t\t * @return {Object} An object with `x` and `y` properties, which represent the constrained position of the\n\t\t * element.\n\t\t */\n\t\tgetConstrainedPosition(attrs, viewPaneSize) {\n\t\t\tviewPaneSize =\n\t\t\t\tviewPaneSize ||\n\t\t\t\tnew CKEDITOR.dom.window(window).getViewPaneSize();\n\n\t\t\tlet x = attrs.left;\n\t\t\tlet y = attrs.top;\n\n\t\t\tif (attrs.left + attrs.width > viewPaneSize.width) {\n\t\t\t\tx -= attrs.left + attrs.width - viewPaneSize.width;\n\t\t\t}\n\n\t\t\tif (y < 0) {\n\t\t\t\ty = 0;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Returns the position, in page coordinates, according to which a widget should appear.\n\t\t * Depending on the direction of the selection, the wdiget may appear above of or on bottom of the selection.\n\t\t *\n\t\t * It depends on the props editorEvent to analyze the following user-interaction parameters:\n\t\t * - {Object} selectionData The data about the selection in the editor as returned from\n\t\t * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n\t\t * - {Number} pos Contains the coordinates of the position, considered as most appropriate.\n\t\t * This may be the point where the user released the mouse, or just the beginning or the end of\n\t\t * the selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetInteractionPoint\n\t\t * @method getInteractionPoint\n\t\t * @return {Object} An Object which contains the following properties:\n\t\t * direction, x, y, where x and y are in page coordinates and direction can be one of these:\n\t\t * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t */\n\t\tgetInteractionPoint() {\n\t\t\tlet eventPayload = this.props.editorEvent\n\t\t\t\t? this.props.editorEvent.data\n\t\t\t\t: null;\n\n\t\t\tif (!eventPayload) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet selectionData = eventPayload.selectionData;\n\n\t\t\tlet nativeEvent = eventPayload.nativeEvent;\n\n\t\t\tlet pos = {\n\t\t\t\tx: eventPayload.nativeEvent.pageX,\n\t\t\t\ty: selectionData.region.top,\n\t\t\t};\n\n\t\t\tlet direction = selectionData.region.direction;\n\n\t\t\tlet endRect = selectionData.region.endRect;\n\n\t\t\tlet startRect = selectionData.region.startRect;\n\n\t\t\tif (endRect && startRect && startRect.top === endRect.top) {\n\t\t\t\tdirection = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\t\t\t}\n\n\t\t\tlet x;\n\t\t\tlet y;\n\n\t\t\t// If we have the point where user released the mouse, show Toolbar at this point\n\t\t\t// otherwise show it on the middle of the selection.\n\n\t\t\tif (pos.x && pos.y) {\n\t\t\t\tx = this._getXPoint(selectionData, pos.x);\n\n\t\t\t\tif (direction === CKEDITOR.SELECTION_BOTTOM_TO_TOP) {\n\t\t\t\t\ty = Math.min(pos.y, selectionData.region.top);\n\t\t\t\t} else {\n\t\t\t\t\ty = Math.max(\n\t\t\t\t\t\tpos.y,\n\t\t\t\t\t\tthis._getYPoint(selectionData, nativeEvent)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tx = selectionData.region.left + selectionData.region.width / 2;\n\n\t\t\t\tif (direction === CKEDITOR.SELECTION_TOP_TO_BOTTOM) {\n\t\t\t\t\ty = this._getYPoint(selectionData, nativeEvent);\n\t\t\t\t} else {\n\t\t\t\t\ty = selectionData.region.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdirection: direction,\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Returns the position of the Widget.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetInteractionPoint\n\t\t * @method _getXPoint\n\t\t * @param {Object} eventX The X coordinate received from the native event (mouseup).\n\t\t * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n\t\t * @protected\n\t\t * @return {Number} The calculated X point in page coordinates.\n\t\t */\n\t\t_getXPoint(selectionData, eventX) {\n\t\t\tlet region = selectionData.region;\n\n\t\t\tlet left = region.startRect ? region.startRect.left : region.left;\n\t\t\tlet right = region.endRect ? region.endRect.right : region.right;\n\n\t\t\tlet x;\n\n\t\t\tif (left < eventX && right > eventX) {\n\t\t\t\tx = eventX;\n\t\t\t} else {\n\t\t\t\tlet leftDist = Math.abs(left - eventX);\n\t\t\t\tlet rightDist = Math.abs(right - eventX);\n\n\t\t\t\tif (leftDist < rightDist) {\n\t\t\t\t\t// user raised the mouse on left on the selection\n\t\t\t\t\tx = left;\n\t\t\t\t} else {\n\t\t\t\t\tx = right;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn x;\n\t\t}\n\n\t\t/**\n\t\t * Returns the position of the Widget.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetInteractionPoint\n\t\t * @method _getYPoint\n\t\t * @param {Object} nativeEvent The data about event is fired\n\t\t * @param {Object} selectionData The data about the selection in the editor as returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n\t\t * @protected\n\t\t * @return {Number} The calculated Y point in page coordinates.\n\t\t */\n\t\t_getYPoint(selectionData, nativeEvent) {\n\t\t\tlet y = 0;\n\n\t\t\tif (selectionData && nativeEvent) {\n\t\t\t\tlet elementTarget = new CKEDITOR.dom.element(\n\t\t\t\t\tnativeEvent.target\n\t\t\t\t);\n\n\t\t\t\tif (\n\t\t\t\t\telementTarget.$ &&\n\t\t\t\t\telementTarget.getStyle('overflow') === 'auto'\n\t\t\t\t) {\n\t\t\t\t\ty =\n\t\t\t\t\t\tnativeEvent.target.offsetTop +\n\t\t\t\t\t\tnativeEvent.target.offsetHeight;\n\t\t\t\t} else {\n\t\t\t\t\ty = selectionData.region.bottom;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn y;\n\t\t}\n\n\t\t/**\n\t\t * Returns the position of the Widget taking in consideration the\n\t\t * {{#crossLink \"WidgetPosition/gutter:attribute\"}}{{/crossLink}} attribute.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @protected\n\t\t * @method  getWidgetXYPoint\n\t\t * @param {Number} left The left offset in page coordinates where Toolbar should be shown.\n\t\t * @param {Number} top The top offset in page coordinates where Toolbar should be shown.\n\t\t * @param {Number} direction The direction of the selection. May be one of the following:\n\t\t * CKEDITOR.SELECTION_BOTTOM_TO_TOP or CKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t * @return {Array} An Array with left and top offsets in page coordinates.\n\t\t */\n\t\tgetWidgetXYPoint(left, top, direction) {\n\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\n\t\t\tlet gutter = this.props.gutter;\n\n\t\t\tif (\n\t\t\t\tdirection === CKEDITOR.SELECTION_TOP_TO_BOTTOM ||\n\t\t\t\tdirection === CKEDITOR.SELECTION_BOTTOM_TO_TOP\n\t\t\t) {\n\t\t\t\tleft = left - gutter.left - domNode.offsetWidth / 2;\n\n\t\t\t\ttop =\n\t\t\t\t\tdirection === CKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t\t\t\t\t? top + gutter.top\n\t\t\t\t\t\t: top - domNode.offsetHeight - gutter.top;\n\t\t\t} else if (\n\t\t\t\tdirection === CKEDITOR.SELECTION_LEFT_TO_RIGHT ||\n\t\t\t\tdirection === CKEDITOR.SELECTION_RIGHT_TO_LEFT\n\t\t\t) {\n\t\t\t\tleft =\n\t\t\t\t\tdirection === CKEDITOR.SELECTION_LEFT_TO_RIGHT\n\t\t\t\t\t\t? left + gutter.left + domNode.offsetHeight / 2\n\t\t\t\t\t\t: left - (3 * domNode.offsetHeight) / 2 - gutter.left;\n\n\t\t\t\ttop = top - gutter.top - domNode.offsetHeight / 2;\n\t\t\t}\n\n\t\t\tif (left < 0) {\n\t\t\t\tleft = 0;\n\t\t\t}\n\n\t\t\tif (top < 0) {\n\t\t\t\ttop = 0;\n\t\t\t}\n\n\t\t\treturn [left, top];\n\t\t}\n\n\t\t/**\n\t\t * Returns true if the widget is visible, false otherwise\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method isVisible\n\t\t * @return {Boolean} True if the widget is visible, false otherwise\n\t\t */\n\t\tisVisible() {\n\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\n\t\t\tif (domNode) {\n\t\t\t\tlet domElement = new CKEDITOR.dom.element(domNode);\n\n\t\t\t\treturn domElement.hasClass('alloy-editor-visible');\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t/**\n\t\t * Moves a widget from a starting point to a destination point.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method moveToPoint\n\t\t * @param  {Object} startPoint The starting point for the movement.\n\t\t * @param  {Object} endPoint The destination point for the movement.\n\t\t */\n\t\tmoveToPoint(startPoint, endPoint) {\n\t\t\tlet domElement = new CKEDITOR.dom.element(\n\t\t\t\tReactDOM.findDOMNode(this)\n\t\t\t);\n\n\t\t\tdomElement.setStyles({\n\t\t\t\tleft: startPoint[0] + 'px',\n\t\t\t\ttop: startPoint[1] + 'px',\n\t\t\t\topacity: 0,\n\t\t\t});\n\n\t\t\tdomElement.removeClass('alloy-editor-invisible');\n\n\t\t\tthis._animate(function() {\n\t\t\t\tdomElement.addClass('ae-toolbar-transition');\n\t\t\t\tdomElement.addClass('alloy-editor-visible');\n\t\t\t\tdomElement.setStyles({\n\t\t\t\t\tleft: endPoint[0] + 'px',\n\t\t\t\t\ttop: endPoint[1] + 'px',\n\t\t\t\t\topacity: 1,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Shows the widget with the default animation transition.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method show\n\t\t */\n\t\tshow() {\n\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\t\t\tlet uiNode = this.props.editor.get('uiNode');\n\n\t\t\tlet scrollTop = uiNode ? uiNode.scrollTop : 0;\n\n\t\t\tif (!this.isVisible() && domNode) {\n\t\t\t\tlet interactionPoint = this.getInteractionPoint();\n\n\t\t\t\tif (interactionPoint) {\n\t\t\t\t\tlet domElement = new CKEDITOR.dom.element(domNode);\n\n\t\t\t\t\tlet finalX;\n\t\t\t\t\tlet finalY;\n\t\t\t\t\tlet initialX;\n\t\t\t\t\tlet initialY;\n\n\t\t\t\t\tfinalX = initialX = parseFloat(domElement.getStyle('left'));\n\t\t\t\t\tfinalY = initialY = parseFloat(domElement.getStyle('top'));\n\n\t\t\t\t\tif (this.props.constrainToViewport) {\n\t\t\t\t\t\tlet res = this.getConstrainedPosition({\n\t\t\t\t\t\t\theight: parseFloat(domNode.offsetHeight),\n\t\t\t\t\t\t\tleft: finalX,\n\t\t\t\t\t\t\ttop: finalY,\n\t\t\t\t\t\t\twidth: parseFloat(domNode.offsetWidth),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tfinalX = res.x;\n\t\t\t\t\t\tfinalY = res.y;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tinteractionPoint.direction ===\n\t\t\t\t\t\tCKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t\t\t\t) {\n\t\t\t\t\t\tinitialY =\n\t\t\t\t\t\t\tthis.props.selectionData.region.bottom + scrollTop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinitialY =\n\t\t\t\t\t\t\tthis.props.selectionData.region.top + scrollTop;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.moveToPoint([initialX, initialY], [finalX, finalY]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Updates the widget position based on the current interaction point.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method updatePosition\n\t\t */\n\t\tupdatePosition() {\n\t\t\tlet interactionPoint = this.getInteractionPoint();\n\n\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\n\t\t\tif (interactionPoint && domNode) {\n\t\t\t\tlet uiNode = this.props.editor.get('uiNode') || document.body;\n\t\t\t\tlet uiNodeStyle = getComputedStyle(uiNode);\n\t\t\t\tlet uiNodeMarginLeft = parseInt(\n\t\t\t\t\tuiNodeStyle.getPropertyValue('margin-left'),\n\t\t\t\t\t10\n\t\t\t\t);\n\t\t\t\tlet uiNodeMarginRight = parseInt(\n\t\t\t\t\tuiNodeStyle.getPropertyValue('margin-right'),\n\t\t\t\t\t10\n\t\t\t\t);\n\t\t\t\tlet totalWidth =\n\t\t\t\t\tuiNodeMarginLeft + uiNode.clientWidth + uiNodeMarginRight;\n\n\t\t\t\tlet scrollTop =\n\t\t\t\t\tuiNode.tagName !== 'BODY' ? uiNode.scrollTop : 0;\n\n\t\t\t\tlet xy = this.getWidgetXYPoint(\n\t\t\t\t\tinteractionPoint.x,\n\t\t\t\t\tinteractionPoint.y,\n\t\t\t\t\tinteractionPoint.direction\n\t\t\t\t);\n\t\t\t\txy[1] += scrollTop;\n\n\t\t\t\tif (xy[0] < 0) {\n\t\t\t\t\txy[0] = 0;\n\t\t\t\t}\n\t\t\t\tif (xy[0] > totalWidth - domNode.offsetWidth) {\n\t\t\t\t\txy[0] = totalWidth - domNode.offsetWidth;\n\t\t\t\t}\n\n\t\t\t\tnew CKEDITOR.dom.element(domNode).setStyles({\n\t\t\t\t\tleft: xy[0] + 'px',\n\t\t\t\t\ttop: xy[1] + 'px',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Requests an animation frame, if possible, to simulate an animation.\n\t\t *\n\t\t * @instance\n\t\t * @memberof WidgetPosition\n\t\t * @method _animate\n\t\t * @param {Function} callback The function to be executed on the scheduled frame.\n\t\t * @protected\n\t\t */\n\t\t_animate(callback) {\n\t\t\tif (window.requestAnimationFrame) {\n\t\t\t\tthis._animationFrameId = window.requestAnimationFrame(callback);\n\t\t\t} else {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t};\n","import Core from './core.js';\nimport Lang from '../oop/lang.js';\n\nimport Buttons from '../components/buttons';\nimport Toolbars from '../components/toolbars';\n\nimport SelectionGetArrowBoxClasses from '../selections/selection-arrowbox';\nimport Selections from '../selections/selections';\nimport SelectionSetPosition from '../selections/selection-position';\nimport SelectionTest from '../selections/selection-test';\n\nimport Attribute from '../oop/attribute';\nimport extend from '../oop/oop';\nimport '../plugins';\n\n// An object containing all currently registered plugins in AlloyEditor.\nlet BRIDGE_BUTTONS = {};\n\n/**\n * Creates an instance of AlloyEditor.\n *\n * @memberof AlloyEditor\n * @method editable\n * @static\n * @param {String|Node} node The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n * @param {Object} config Configuration attributes for the current instance of AlloyEditor.\n * @return {Object} An instance of {{#crossLink \"Core\"}}{{/crossLink}}\n */\nconst editable = function(node, config) {\n\tconfig = config || {};\n\tconfig.srcNode = node;\n\n\tAlloyEditor.implementEventTarget();\n\n\treturn new Core(config);\n};\n\n/**\n * The full URL for the AlloyEditor installation directory.\n * It is possible to manually provide the base path by setting a\n * global variable named `ALLOYEDITOR_BASEPATH`. This global variable\n * must be set **before** the editor script loading.\n *\n * @memberof AlloyEditor\n * @method getBasePath\n * @static\n * @return {String} The found base path\n */\nconst getBasePath = function() {\n\t// Find out the editor directory path, based on its <script> tag.\n\tlet path = window.ALLOYEDITOR_BASEPATH || '';\n\n\tif (!path) {\n\t\tlet scripts = document.getElementsByTagName('script');\n\n\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\tlet match = scripts[i].src.match(AlloyEditor.regexBasePath);\n\n\t\t\tif (match) {\n\t\t\t\tpath = match[1];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// In IE (only) the script.src string is the raw value entered in the\n\t// HTML source. Other browsers return the full resolved URL instead.\n\tif (path.indexOf(':/') === -1 && path.slice(0, 2) !== '//') {\n\t\t// Absolute path.\n\t\tif (path.indexOf('/') === 0) {\n\t\t\tpath = location.href.match(/^.*?:\\/\\/[^/]*/)[0] + path;\n\t\t}\n\t\t// Relative path.\n\t\telse {\n\t\t\tpath = location.href.match(/^[^?]*\\/(?:)/)[0] + path;\n\t\t}\n\t}\n\n\tif (!path) {\n\t\tthrow new Error(\n\t\t\t'The AlloyEditor installation path could not be automatically detected. Please set the global variable \"ALLOYEDITOR_BASEPATH\" before creating editor instances.'\n\t\t);\n\t}\n\n\treturn path;\n};\n\n/**\n * Detects and load the corresponding language file if AlloyEditor language strings are not already present.\n * The function fires a {{#crossLink \"AlloyEditor/languageResourcesLoaded:event\"}}{{/crossLink}} event\n *\n * @memberof AlloyEditor\n * @method loadLanguageResources\n * @static\n * @param {Function} callback Optional callback to be called when AlloyEditor loads the language resource.\n */\nconst loadLanguageResources = function(callback) {\n\tAlloyEditor.implementEventTarget();\n\n\tif (Lang.isFunction(callback)) {\n\t\tif (AlloyEditor.Strings) {\n\t\t\tsetTimeout(callback, 0);\n\t\t} else {\n\t\t\tAlloyEditor.once('languageResourcesLoaded', function() {\n\t\t\t\tsetTimeout(callback, 0);\n\t\t\t});\n\t\t}\n\t}\n\n\tif (!AlloyEditor._langResourceRequested) {\n\t\tAlloyEditor._langResourceRequested = true;\n\n\t\tlet languages = [\n\t\t\t'af',\n\t\t\t'ar',\n\t\t\t'bg',\n\t\t\t'bn',\n\t\t\t'bs',\n\t\t\t'ca',\n\t\t\t'cs',\n\t\t\t'cy',\n\t\t\t'da',\n\t\t\t'de',\n\t\t\t'el',\n\t\t\t'en-au',\n\t\t\t'en-ca',\n\t\t\t'en-gb',\n\t\t\t'en',\n\t\t\t'eo',\n\t\t\t'es',\n\t\t\t'et',\n\t\t\t'eu',\n\t\t\t'fa',\n\t\t\t'fi',\n\t\t\t'fo',\n\t\t\t'fr-ca',\n\t\t\t'fr',\n\t\t\t'gl',\n\t\t\t'gu',\n\t\t\t'he',\n\t\t\t'hi',\n\t\t\t'hr',\n\t\t\t'hu',\n\t\t\t'id',\n\t\t\t'is',\n\t\t\t'it',\n\t\t\t'ja',\n\t\t\t'ka',\n\t\t\t'km',\n\t\t\t'ko',\n\t\t\t'ku',\n\t\t\t'lt',\n\t\t\t'lv',\n\t\t\t'mk',\n\t\t\t'mn',\n\t\t\t'ms',\n\t\t\t'nb',\n\t\t\t'nl',\n\t\t\t'no',\n\t\t\t'pl',\n\t\t\t'pt-br',\n\t\t\t'pt',\n\t\t\t'ro',\n\t\t\t'ru',\n\t\t\t'si',\n\t\t\t'sk',\n\t\t\t'sl',\n\t\t\t'sq',\n\t\t\t'sr-latn',\n\t\t\t'sr',\n\t\t\t'sv',\n\t\t\t'th',\n\t\t\t'tr',\n\t\t\t'tt',\n\t\t\t'ug',\n\t\t\t'uk',\n\t\t\t'vi',\n\t\t\t'zh-cn',\n\t\t\t'zh',\n\t\t];\n\n\t\tlet userLanguage = navigator.language || navigator.userLanguage || 'en';\n\n\t\tlet parts = userLanguage.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/);\n\t\tlet lang = parts[1];\n\t\tlet locale = parts[2];\n\n\t\tif (languages.indexOf(lang + '-' + locale) >= 0) {\n\t\t\tlang = lang + '-' + locale;\n\t\t} else if (languages.indexOf(lang) === -1) {\n\t\t\tlang = 'en';\n\t\t}\n\n\t\tCKEDITOR.scriptLoader.load(\n\t\t\tAlloyEditor.getUrl('lang/alloy-editor/' + lang + '.js'),\n\t\t\tfunction(loaded) {\n\t\t\t\tif (loaded) {\n\t\t\t\t\tAlloyEditor.fire('languageResourcesLoaded');\n\t\t\t\t}\n\t\t\t},\n\t\t\t/* eslint-disable babel/no-invalid-this */\n\t\t\tthis // Always `AlloyEditor`.\n\t\t\t/* eslint-enable babel/no-invalid-this */\n\t\t);\n\t}\n};\n\n/**\n * Gets the full URL for AlloyEditor resources. By default, URLs\n * returned by this function contain a querystring parameter (\"t\")\n * set to the {@link CKEDITOR#timestamp} value.\n *\n * @memberof AlloyEditor\n * @method getUrl\n * @static\n * @param {String} resource The resource whose full URL we want to get.\n * It may be a full, absolute, or relative URL.\n * @return {String} The full URL.\n */\nconst getUrl = function(resource) {\n\tlet basePath = AlloyEditor.getBasePath();\n\n\t// If this is not a full or absolute path.\n\tif (resource.indexOf(':/') === -1 && resource.indexOf('/') !== 0) {\n\t\tresource = basePath + resource;\n\t}\n\n\t// Add the timestamp, except for directories.\n\tif (\n\t\tCKEDITOR.timestamp &&\n\t\tresource.charAt(resource.length - 1) !== '/' &&\n\t\t!/[&?]t=/.test(resource)\n\t) {\n\t\tresource +=\n\t\t\t(resource.indexOf('?') >= 0 ? '&' : '?') +\n\t\t\t't=' +\n\t\t\tCKEDITOR.timestamp;\n\t}\n\n\treturn resource;\n};\n\n/**\n * Implements event firing and subscribing via CKEDITOR.event.\n *\n * @memberof AlloyEditor\n * @method implementEventTarget\n * @static\n */\nconst implementEventTarget = function() {\n\tif (!AlloyEditor.fire && !AlloyEditor.on) {\n\t\tCKEDITOR.event.implementOn(AlloyEditor);\n\t}\n};\n\n/**\n * Regular expression which should match the script which have been used to load AlloyEditor.\n *\n * @memberof AlloyEditor\n * @property regexBasePath\n * @type {RegExp}\n * @static\n */\nconst regexBasePath = /(^|.*[\\\\/])(?:alloy-editor[^/]+|alloy-editor)\\.js(?:\\?.*|;.*)?$/i;\n\n/**\n * Fired when AlloyEditor detects the browser language and loads the corresponding language file. Once this event\n * is fired, AlloyEditor.Strings will be populated with data.\n *\n * @event languageResourcesLoaded\n */\n\n/**\n * Returns the required plugin names needed for a given plugin\n * if it is already registered or an empty array.\n *\n * @memberof AlloyEditor\n * @method getButtons\n * @param {Array} buttons An array of buttons or plugin names.\n * @return {Function} A function that can be invoked to resolve the requested button names.\n * @static\n */\nconst getButtons = function(buttons) {\n\treturn function() {\n\t\treturn buttons.reduce(function(acc, val) {\n\t\t\tval = BRIDGE_BUTTONS[val] || [val];\n\t\t\treturn acc.concat(val);\n\t\t}, []);\n\t};\n};\n\n/**\n * Register a button and try to get its required plugins.\n *\n * @memberof AlloyEditor\n * @method registerBridgeButton\n * @param {String} buttonName The name of the button.\n * @param {String} pluginName The name of the plugin that registers the button.\n * @static\n */\nconst registerBridgeButton = function(buttonName, pluginName) {\n\tif (!BRIDGE_BUTTONS[pluginName]) {\n\t\tBRIDGE_BUTTONS[pluginName] = [];\n\t}\n\n\tBRIDGE_BUTTONS[pluginName].push(buttonName);\n};\n\n/**\n * @method OOP\n * @memberof AlloyEditor\n */\nconst OOP = {\n\textend,\n};\n\nexport {\n\tAttribute,\n\tButtons,\n\tCore,\n\tLang,\n\tOOP,\n\tSelectionGetArrowBoxClasses,\n\tSelectionSetPosition,\n\tSelectionTest,\n\tSelections,\n\tToolbars,\n\teditable,\n\tgetBasePath,\n\tgetButtons,\n\tgetUrl,\n\timplementEventTarget,\n\tloadLanguageResources,\n\tregexBasePath,\n\tregisterBridgeButton,\n};\n","import '../core';\nimport '../plugins';\n\nimport '../components/uibridge';\n\nimport extend from '../oop/oop';\nimport Lang from '../oop/lang';\nimport Base from '../oop/base';\nimport Selections from '../selections/selections';\nimport UI from '../components/main.jsx';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nconst EMBED_VIDEO_WIDTH = 560;\nconst EMBED_VIDEO_HEIGHT = 315;\n\n/**\n * AlloyEditor main class. Creates instance of the editor and provides the user configuration\n * to the UI.\n *\n * @class Core\n * @constructor\n * @param {Object} config The configuration to be used.\n */\nfunction Core(config) {\n\tCore.superclass.constructor.call(this, config);\n}\n\nextend(\n\tCore,\n\tBase,\n\t{\n\t\t/**\n\t\t * Initializer lifecycle implementation for the AlloyEditor class. Creates a CKEditor\n\t\t * instance, passing it the provided configuration attributes.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method initializer\n\t\t * @param {Object} config Configuration object literal for the editor.\n\t\t */\n\t\tinitializer: function(config) {\n\t\t\tlet node = this.get('srcNode');\n\n\t\t\tif (this.get('enableContentEditable')) {\n\t\t\t\tnode.setAttribute('contenteditable', 'true');\n\t\t\t}\n\n\t\t\tlet editor = CKEDITOR.inline(node);\n\n\t\t\teditor.config.allowedContent = this.get('allowedContent');\n\n\t\t\teditor.config.toolbars = this.get('toolbars');\n\n\t\t\teditor.config.removePlugins = this.get('removePlugins');\n\n\t\t\teditor.config.extraPlugins = this.get('extraPlugins');\n\n\t\t\teditor.config.embedProviders = this.get('embedProviders');\n\n\t\t\teditor.config.placeholderClass = this.get('placeholderClass');\n\n\t\t\teditor.config.pasteFromWordRemoveStyles = false;\n\t\t\teditor.config.pasteFromWordRemoveFontStyles = false;\n\n\t\t\teditor.config.selectionKeystrokes = this.get('selectionKeystrokes');\n\n\t\t\teditor.config.spritemap = this.get('spritemap');\n\n\t\t\tLang.mix(editor.config, config);\n\n\t\t\tif (CKEDITOR.env.ie && !CKEDITOR.env.edge) {\n\t\t\t\t// editor.config.extraPlugins = editor.config.extraPlugins.replace(\n\t\t\t\t// \t'ae_dragresize',\n\t\t\t\t// \t'ae_dragresize_ie'\n\t\t\t\t// );\n\t\t\t\t// editor.config.removePlugins = editor.config.removePlugins.replace(\n\t\t\t\t// \t'ae_dragresize',\n\t\t\t\t// \t'ae_dragresize_ie'\n\t\t\t\t// );\n\t\t\t\tconst plugin = (CKEDITOR.env.version === 11) ? 'ae_dragresize_ie11' : 'ae_dragresize_ie';\n\n\t\t\t\teditor.config.extraPlugins = editor.config.extraPlugins.replace('ae_dragresize', plugin);\n\t\t\t\teditor.config.removePlugins = editor.config.removePlugins.replace('ae_dragresize', plugin);\n\t\t\t}\n\n\t\t\teditor.once(\n\t\t\t\t'contentDom',\n\t\t\t\tfunction() {\n\t\t\t\t\tthis._addReadOnlyLinkClickListener(editor);\n\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\teditable.addClass('ae-editable');\n\t\t\t\t}.bind(this)\n\t\t\t);\n\n\t\t\tthis._editor = editor;\n\n\t\t\tAlloyEditor.loadLanguageResources(this._renderUI.bind(this));\n\t\t},\n\n\t\t/**\n\t\t * Destructor lifecycle implementation for the AlloyEdtor class. Destroys the CKEditor\n\t\t * instance and destroys all created toolbars.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method destructor\n\t\t */\n\t\tdestructor: function() {\n\t\t\tthis._destroyed = true;\n\n\t\t\tif (this._editorUIElement) {\n\t\t\t\tReactDOM.unmountComponentAtNode(this._editorUIElement);\n\t\t\t\tthis._editorUIElement.parentNode.removeChild(\n\t\t\t\t\tthis._editorUIElement\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet nativeEditor = this.get('nativeEditor');\n\n\t\t\tif (nativeEditor) {\n\t\t\t\tlet editable = nativeEditor.editable();\n\n\t\t\t\tif (editable) {\n\t\t\t\t\teditable.removeClass('ae-editable');\n\n\t\t\t\t\tif (this.get('enableContentEditable')) {\n\t\t\t\t\t\tthis.get('srcNode').setAttribute(\n\t\t\t\t\t\t\t'contenteditable',\n\t\t\t\t\t\t\t'false'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._clearSelections();\n\n\t\t\t\tnativeEditor.destroy();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Clear selections from window object\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _clearSelections\n\t\t */\n\t\t_clearSelections: function() {\n\t\t\tlet nativeEditor = this.get('nativeEditor');\n\t\t\tlet isMSSelection = typeof window.getSelection != 'function';\n\n\t\t\tif (isMSSelection) {\n\t\t\t\tnativeEditor.document.$.selection.empty();\n\t\t\t} else {\n\t\t\t\tnativeEditor.document\n\t\t\t\t\t.getWindow()\n\t\t\t\t\t.$.getSelection()\n\t\t\t\t\t.removeAllRanges();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Method to set default link behavior\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _addReadOnlyLinkClickListener\n\t\t * @param {Object} editor\n\t\t */\n\t\t_addReadOnlyLinkClickListener: function(editor) {\n\t\t\teditor.editable().on('click', this._defaultReadOnlyClickFn, this, {\n\t\t\t\teditor: editor,\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Called on `click` event when the editor is in read only mode. Navigates to link's URL or opens\n\t\t * the link in a new window.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @event readOnlyClick\n\t\t * @protected\n\t\t * @method _defaultReadOnlyClickFn\n\t\t * @param {Object} event The fired `click` event payload\n\t\t */\n\t\t_defaultReadOnlyClickFn: function(event) {\n\t\t\tlet mouseEvent = event.data.$;\n\t\t\tlet hasCtrlKey = mouseEvent.ctrlKey || mouseEvent.metaKey;\n\t\t\tlet shouldOpen = this._editor.config.readOnly || hasCtrlKey;\n\n\t\t\tmouseEvent.preventDefault();\n\n\t\t\tif (!shouldOpen) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.listenerData.editor\n\t\t\t\t\t.editable()\n\t\t\t\t\t.editor.fire('readOnlyClick', event.data) !== false\n\t\t\t) {\n\t\t\t\tlet ckElement = new CKEDITOR.dom.elementPath(\n\t\t\t\t\tevent.data.getTarget(),\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t\tlet link = ckElement.lastElement;\n\n\t\t\t\tif (link) {\n\t\t\t\t\tlet href = link.$.attributes.href\n\t\t\t\t\t\t? link.$.attributes.href.value\n\t\t\t\t\t\t: null;\n\t\t\t\t\tlet target = hasCtrlKey\n\t\t\t\t\t\t? '_blank'\n\t\t\t\t\t\t: link.$.attributes.target\n\t\t\t\t\t\t? link.$.attributes.target.value\n\t\t\t\t\t\t: null;\n\t\t\t\t\tthis._redirectLink(href, target);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the native CKEditor instance. Having this, the developer may use the API of CKEditor OOTB.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _getNativeEditor\n\t\t * @return {Object} The current instance of CKEditor.\n\t\t */\n\t\t_getNativeEditor: function() {\n\t\t\treturn this._editor;\n\t\t},\n\n\t\t/**\n\t\t * Redirects the browser to a given link\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _redirectLink\n\t\t * @param {string} href The href to take the browser to\n\t\t * @param {string=} target Specifies where to display the link\n\t\t */\n\t\t_redirectLink: function(href, target) {\n\t\t\tif (target && href) {\n\t\t\t\twindow.open(href, target);\n\t\t\t} else if (href) {\n\t\t\t\twindow.location.href = href;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Renders the specified from the user toolbars.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _renderUI\n\t\t */\n\t\t_renderUI: function() {\n\t\t\tif (!this._destroyed) {\n\t\t\t\tlet editorUIElement = document.createElement('div');\n\t\t\t\teditorUIElement.className = 'ae-ui';\n\n\t\t\t\tlet uiNode = this.get('uiNode') || document.body;\n\n\t\t\t\tuiNode.appendChild(editorUIElement);\n\n\t\t\t\tthis._mainUI = ReactDOM.render(\n\t\t\t\t\t<UI\n\t\t\t\t\t\teditor={this}\n\t\t\t\t\t\teventsDelay={this.get('eventsDelay')}\n\t\t\t\t\t\ttoolbars={this.get('toolbars')}\n\t\t\t\t\t/>,\n\t\t\t\t\teditorUIElement\n\t\t\t\t);\n\n\t\t\t\tthis._editorUIElement = editorUIElement;\n\n\t\t\t\tthis.get('nativeEditor').fire('uiReady');\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * The function returns an HTML element from the passed value. If the passed value is a string, it should be\n\t\t * the Id of the element which have to be retrieved from the DOM.\n\t\t * If an HTML Element is passed, the element itself will be returned.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @method _toElement\n\t\t * @protected\n\t\t * @param {!(String|HTMLElement)} value String, which have to correspond to an HTML element from the DOM,\n\t\t * or the HTML element itself. If Id is passed, the HTML element will be retrieved from the DOM.\n\t\t * @return {HTMLElement} An HTML element.\n\t\t */\n\t\t_toElement: function(value) {\n\t\t\tif (Lang.isString(value)) {\n\t\t\t\tvalue = document.getElementById(value);\n\t\t\t}\n\n\t\t\treturn value;\n\t\t},\n\n\t\t/**\n\t\t * Validates the allowed content attribute. Look\n\t\t * [here](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent) for more information about the\n\t\t * supported values.\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _validateAllowedContent\n\t\t * @param {Any} value The value to be checked\n\t\t * @return {Boolean} True if the current value is valid configuration, false otherwise\n\t\t */\n\t\t_validateAllowedContent: function(value) {\n\t\t\treturn (\n\t\t\t\tLang.isString(value) ||\n\t\t\t\tLang.isObject(value) ||\n\t\t\t\tLang.isBoolean(value)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Validates the value of toolbars attribute\n\t\t *\n\t\t * @memberof Core\n\t\t * @instance\n\t\t * @protected\n\t\t * @method _validateToolbars\n\t\t * @param {Any} value The value to be checked\n\t\t * @return {Boolean} True if the current value is valid toolbars configuration, false otherwise\n\t\t */\n\t\t_validateToolbars: function(value) {\n\t\t\treturn Lang.isObject(value) || Lang.isNull(value);\n\t\t},\n\t},\n\t{\n\t\tATTRS: {\n\t\t\t/**\n\t\t\t * Configures the allowed content for the current instance of AlloyEditor.\n\t\t\t * Look on the [official CKEditor API](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-allowedContent)\n\t\t\t * for more information about the valid values.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property allowedContent\n\t\t\t * @default true\n\t\t\t * @writeOnce\n\t\t\t * @type {Boolean, String, Object}\n\t\t\t */\n\t\t\tallowedContent: {\n\t\t\t\tvalidator: '_validateAllowedContent',\n\t\t\t\tvalue: true,\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Callback to be invoked when clicking on the\n\t\t\t * <code>src/components/buttons/button-link-edit-browse.jsx</code>\n\t\t\t * component.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @propety documentBrowseLinkCallback\n\t\t\t * @default undefined\n\t\t\t * @type {Function|undefined}\n\t\t\t */\n\t\t\tdocumentBrowseLinkCallback: {\n\t\t\t\tvalidator: Lang.isFunction,\n\t\t\t\tvalue: undefined,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Configuration for the\n\t\t\t * <code>src/components/buttons/button-link-edit-browse.jsx</code>\n\t\t\t * component.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @propety documentBrowseLinkUrl\n\t\t\t * @default undefined\n\t\t\t * @type {String|undefined}\n\t\t\t */\n\t\t\tdocumentBrowseLinkUrl: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue: undefined,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * List of embed providers for videos\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property embedProviders\n\t\t\t * @default []\n\t\t\t * @type Array}\n\t\t\t */\n\t\t\tembedProviders: {\n\t\t\t\tvalidator: Lang.isArray,\n\t\t\t\tvalue: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'facebook',\n\t\t\t\t\t\ttpl: `<iframe allowFullScreen=\"true\" allowTransparency=\"true\"\n                         frameborder=\"0\" height=\"${EMBED_VIDEO_HEIGHT}\"\n                         src=\"https://www.facebook.com/plugins/video.php?href={embedId}'\n                         &show_text=0&width=${EMBED_VIDEO_WIDTH}&height=${EMBED_VIDEO_HEIGHT}\" scrolling=\"no\"\n                         style=\"border:none;overflow:hidden\" width=\"${EMBED_VIDEO_WIDTH}}\"></iframe>`,\n\t\t\t\t\t\turlSchemes: [\n\t\t\t\t\t\t\t'(https?:\\\\/\\\\/(?:www\\\\.)?facebook.com\\\\/\\\\S*\\\\/videos\\\\/\\\\S*)',\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'twitch',\n\t\t\t\t\t\ttpl: `<iframe allowfullscreen=\"true\" frameborder=\"0\"\n                         height=\"${EMBED_VIDEO_HEIGHT}\"\n                         src=\"https://player.twitch.tv/?autoplay=false&video={embedId}\"\n                         scrolling=\"no\" width=\"${EMBED_VIDEO_WIDTH}\"></iframe>`,\n\t\t\t\t\t\turlSchemes: [\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?twitch.tv\\\\/videos\\\\/(\\\\S*)$',\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'vimeo',\n\t\t\t\t\t\ttpl: `<iframe allowfullscreen frameborder=\"0\" height=\"${EMBED_VIDEO_HEIGHT}\"\n                         mozallowfullscreen src=\"https://player.vimeo.com/video/{embedId}\"\n                         webkitallowfullscreen width=\"${EMBED_VIDEO_WIDTH}\"></iframe>`,\n\t\t\t\t\t\turlSchemes: [\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?vimeo\\\\.com\\\\/album\\\\/.*\\\\/video\\\\/(\\\\S*)',\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?vimeo\\\\.com\\\\/channels\\\\/.*\\\\/(\\\\S*)',\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?vimeo\\\\.com\\\\/groups\\\\/.*\\\\/videos\\\\/(\\\\S*)',\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?vimeo\\\\.com\\\\/(\\\\S*)$',\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'youtube',\n\t\t\t\t\t\ttpl: `<iframe allow=\"autoplay; encrypted-media\" allowfullscreen\n                         height=\"${EMBED_VIDEO_HEIGHT}\" frameborder=\"0\"\n                         src=\"https://www.youtube.com/embed/{embedId}?rel=0\"\n                         width=\"${EMBED_VIDEO_WIDTH}\"></iframe>`,\n\t\t\t\t\t\turlSchemes: [\n\t\t\t\t\t\t\t'https?:\\\\/\\\\/(?:www\\\\.)?youtube.com\\\\/watch\\\\?v=(\\\\S*)$',\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specifies whether AlloyEditor set the contenteditable attribute\n\t\t\t * to \"true\" on its srcNode.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property enableContentEditable\n\t\t\t * @type Boolean\n\t\t\t * @default true\n\t\t\t * @writeOnce\n\t\t\t */\n\t\t\tenableContentEditable: {\n\t\t\t\tvalidator: Lang.isBoolean,\n\t\t\t\tvalue: true,\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The delay (timeout), in ms, after which events such like key or mouse events will be processed.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property eventsDelay\n\t\t\t * @type {Number}\n\t\t\t */\n\t\t\teventsDelay: {\n\t\t\t\tvalidator: Lang.isNumber,\n\t\t\t\tvalue: 100,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specifies the extra plugins which have to be loaded to the current CKEditor instance in order to\n\t\t\t * make AlloyEditor to work properly.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property extraPlugins\n\t\t\t * @default 'uicore,selectionregion,dragresize,addimages,placeholder,tabletools,tableresize,autolink'\n\t\t\t * @writeOnce\n\t\t\t * @type {String}\n\t\t\t */\n\t\t\textraPlugins: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue:\n\t\t\t\t\t'ae_uicore,ae_selectionregion,ae_selectionkeystrokes,ae_imagealignment,ae_addimages,ae_placeholder,' +\n\t\t\t\t\t'ae_tabletools,ae_tableresize,ae_autolink,ae_embed,ae_autolist,ae_dragresize,ae_dragresize_ie11,' +\n\t\t\t\t\t'ae_uibridge,ae_richcombobridge,ae_panelmenubuttonbridge,ae_menubridge,ae_menubuttonbridge,ae_buttonbridge,font,colorbutton',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specifies the \"mode\" for alloy editor\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property mode\n\t\t\t * @default 'simple'\n\t\t\t * @writeOnce\n\t\t\t * @type {String}\n\t\t\t */\n\t\t\tmode: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue: 'simple',\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Retrieves the native CKEditor instance. Having this, the developer may use the full API of CKEditor.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property nativeEditor\n\t\t\t * @readOnly\n\t\t\t * @type {Object}\n\t\t\t */\n\t\t\tnativeEditor: {\n\t\t\t\tgetter: '_getNativeEditor',\n\t\t\t\treadOnly: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specifies the class, which should be added by Placeholder plugin\n\t\t\t * {{#crossLink \"CKEDITOR.plugins.ae_placeholder}}{{/crossLink}}\n\t\t\t * when editor is not focused.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property placeholderClass\n\t\t\t * @default 'ae-placeholder'\n\t\t\t * @writeOnce\n\t\t\t * @type {String}\n\t\t\t */\n\t\t\tplaceholderClass: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue: 'ae-placeholder',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Specifies the plugins, which come by default with CKEditor, but which are not needed by AlloyEditor.\n\t\t\t * These plugins add the default UI for CKeditor, which is no more needed. Please note that AlloyEdtor\n\t\t\t * comes with its own highly optimized copy of CKEditor (just customized via their official download page).\n\t\t\t * This version does not come with the unneeded plugins, so the value of this property won't be needed.\n\t\t\t * However, if you decide to go with the OOTB version of CKEditor, you will have to remove some of the\n\t\t\t * plugins if you decide to use AlloyEditor. Keep in mind that removing these plugins doesn't remove them\n\t\t\t * entirely from CKEditor. It just removes them from its current instance, in which you will use different\n\t\t\t * UI - those of AlloyEditor. You will be fully able to use both OOTB CKEditor and AlloyEditor on the same\n\t\t\t * page!\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property removePlugins\n\t\t\t * @default 'contextmenu,toolbar,elementspath,resize,liststyle,link'\n\t\t\t * @writeOnce\n\t\t\t * @type {String}\n\t\t\t */\n\t\t\tremovePlugins: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue: 'contextmenu,toolbar,elementspath,resize,liststyle,link',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Array of manual selection triggers. They can be configured to manually show a specific selection toolbar\n\t\t\t * by forcing the selection type. A selectionKeystroke item consists of a keys property with a [CKEditor keystroke\n\t\t\t * definition](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-keystrokes) and a selection property with\n\t\t\t * the selection name to trigger.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property selectionKeystrokes\n\t\t\t * @type {Array}\n\t\t\t */\n\t\t\tselectionKeystrokes: {\n\t\t\t\tvalidator: Lang.isArray,\n\t\t\t\tvalue: [\n\t\t\t\t\t{\n\t\t\t\t\t\tkeys: CKEDITOR.CTRL + 76 /* L*/,\n\t\t\t\t\t\tselection: 'link',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tkeys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /* L*/,\n\t\t\t\t\t\tselection: 'embed',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The path to the spritemap SVG used for icons\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property spritemap\n\t\t\t * @type String\n\t\t\t * @writeOnce\n\t\t\t */\n\t\t\tspritemap: {\n\t\t\t\tvalidator: Lang.isString,\n\t\t\t\tvalue: 'alloy-editor/assets/icons/icons.svg',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The Node ID or HTMl node, which AlloyEditor should use as an editable area.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property srcNode\n\t\t\t * @type String | Node\n\t\t\t * @writeOnce\n\t\t\t */\n\t\t\tsrcNode: {\n\t\t\t\tsetter: '_toElement',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The toolbars configuration for this editor instance\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property {Object} toolbars\n\t\t\t */\n\t\t\ttoolbars: {\n\t\t\t\tvalidator: '_validateToolbars',\n\t\t\t\tvalue: {\n\t\t\t\t\tadd: {\n\t\t\t\t\t\tbuttons: ['image', 'embed', 'camera', 'hline', 'table'],\n\t\t\t\t\t\ttabIndex: 2,\n\t\t\t\t\t},\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\tselections: Selections,\n\t\t\t\t\t\ttabIndex: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * The Node ID or HTMl node, where AlloyEditor's UI should be rendered.\n\t\t\t *\n\t\t\t * @memberof Core\n\t\t\t * @instance\n\t\t\t * @property uiNode\n\t\t\t * @type String | Node\n\t\t\t * @writeOnce\n\t\t\t */\n\t\t\tuiNode: {\n\t\t\t\tsetter: '_toElement',\n\t\t\t\twriteOnce: true,\n\t\t\t},\n\t\t},\n\t}\n);\n\nCKEDITOR.event.implementOn(Core);\n\nexport default Core;\n","import debounce from './debounce';\nimport link from './link';\nimport plugins from './plugins';\nimport selectionRegion from './selection-region';\nimport table from './table';\nimport tools from './tools';\nimport uicore from './uicore';\n\nexport {debounce, link, plugins, selectionRegion, table, tools, uicore};\n","(function() {\n\t'use strict';\n\n\t/**\n\t * Debounce util function. If a function execution is expensive, it might be debounced. This means\n\t * that it will be executed after some amount of time after its last call. For example, if we attach a\n\t * a function on scroll event, it might be called hundreds times per second. In this case it may be\n\t * debounced with, let's say 100ms. The real execution of this function will happen 100ms after last\n\t * scroll event.\n\t *\n\t * @memberof CKEDITOR.tools\n\t * @method debounce\n\t * @param {Array} args An array of arguments which the callback will receive.\n\t * @param {Function} callback The callback which has to be called after given timeout.\n\t * @param {Number} timeout Timeout in milliseconds after which the callback will be called.\n\t * @param {Object} context The context in which the callback will be called. This argument is optional.\n\t * @static\n\t */\n\tCKEDITOR.tools.debounce =\n\t\tCKEDITOR.tools.debounce ||\n\t\tfunction(callback, timeout, context, args = []) {\n\t\t\tlet debounceHandle;\n\n\t\t\tlet callFn = function(...callArgs) {\n\t\t\t\t/* eslint-disable babel/no-invalid-this */\n\t\t\t\tlet callContext = context || this;\n\t\t\t\t/* eslint-enable babel/no-invalid-this */\n\n\t\t\t\tclearTimeout(debounceHandle);\n\n\t\t\t\tdebounceHandle = setTimeout(function() {\n\t\t\t\t\tcallback.apply(callContext, [...callArgs, ...args]);\n\t\t\t\t}, timeout);\n\t\t\t};\n\n\t\t\tcallFn.detach = function() {\n\t\t\t\tclearTimeout(debounceHandle);\n\t\t\t};\n\n\t\t\treturn callFn;\n\t\t};\n})();\n","(function() {\n\t'use strict';\n\n\tlet REGEX_BOOKMARK_SCHEME = /^#.*/i;\n\tlet REGEX_EMAIL_SCHEME = /^[a-z0-9\\u0430-\\u044F._-]+@/i;\n\tlet REGEX_URI_SCHEME = /^(?:[a-z][a-z0-9+\\-.]*):|^\\//i;\n\n\t/**\n\t * Link class utility. Provides methods for create, delete and update links.\n\t *\n\t * @class CKEDITOR.Link\n\t * @constructor\n\t * @param {Object} editor The CKEditor instance.\n\t */\n\tfunction Link(editor, config) {\n\t\tthis._editor = editor;\n\t\tthis.appendProtocol =\n\t\t\tconfig && config.appendProtocol === false ? false : true;\n\t}\n\n\tLink.prototype = {\n\t\tconstructor: Link,\n\n\t\t/**\n\t\t * Advances the editor selection to the next available position after a\n\t\t * given link or the one in the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method advanceSelection\n\t\t * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n\t\t */\n\t\tadvanceSelection: function(link) {\n\t\t\tlink = link || this.getFromSelection();\n\n\t\t\tlet range = this._editor.getSelection().getRanges()[0];\n\n\t\t\tif (link) {\n\t\t\t\trange.moveToElementEditEnd(link);\n\n\t\t\t\tlet nextNode = range.getNextEditableNode();\n\n\t\t\t\tif (\n\t\t\t\t\tnextNode &&\n\t\t\t\t\t!this._editor.element.equals(\n\t\t\t\t\t\tnextNode.getCommonAncestor(link)\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tlet whitespace = /\\s/.exec(nextNode.getText());\n\n\t\t\t\t\tlet offset = whitespace ? whitespace.index + 1 : 0;\n\n\t\t\t\t\trange.setStart(nextNode, offset);\n\t\t\t\t\trange.setEnd(nextNode, offset);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._editor.getSelection().selectRanges([range]);\n\t\t},\n\n\t\t/**\n\t\t * Create a link with given URI as href.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method create\n\t\t * @param {Object} attrs A config object with link attributes. These might be arbitrary DOM attributes.\n\t\t * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n\t\t * @param {String} URI The URI of the link.\n\t\t */\n\t\tcreate: function(URI, attrs, modifySelection) {\n\t\t\tlet selection = this._editor.getSelection();\n\n\t\t\tlet range = selection.getRanges()[0];\n\n\t\t\tif (range.collapsed) {\n\t\t\t\tlet text = new CKEDITOR.dom.text(URI, this._editor.document);\n\t\t\t\trange.insertNode(text);\n\t\t\t\trange.selectNodeContents(text);\n\t\t\t}\n\n\t\t\tURI = this._getCompleteURI(URI);\n\n\t\t\tlet linkAttrs = CKEDITOR.tools.merge(\n\t\t\t\t{\n\t\t\t\t\t'data-cke-saved-href': URI,\n\t\t\t\t\thref: URI,\n\t\t\t\t},\n\t\t\t\tattrs\n\t\t\t);\n\n\t\t\tlet style = new CKEDITOR.style({\n\t\t\t\tattributes: linkAttrs,\n\t\t\t\telement: 'a',\n\t\t\t});\n\n\t\t\tstyle.type = CKEDITOR.STYLE_INLINE;\n\t\t\tstyle.applyToRange(range, this._editor);\n\n\t\t\tif (modifySelection && modifySelection.advance) {\n\t\t\t\tthis.advanceSelection();\n\t\t\t} else {\n\t\t\t\trange.select();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Retrieves a link from the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method getFromSelection\n\t\t * @return {CKEDITOR.dom.element} The retrieved link or null if not found.\n\t\t */\n\t\tgetFromSelection: function() {\n\t\t\tlet selection = this._editor.getSelection();\n\n\t\t\tlet selectedElement = selection.getSelectedElement();\n\n\t\t\tif (selectedElement && selectedElement.is('a')) {\n\t\t\t\treturn selectedElement;\n\t\t\t}\n\n\t\t\tif (selectedElement && CKEDITOR.env.ie) {\n\t\t\t\tlet children = selectedElement.getChildren();\n\n\t\t\t\tlet count = children.count();\n\n\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\tlet node = children.getItem(i);\n\n\t\t\t\t\tif (node.is('a')) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet range = selection.getRanges()[0];\n\n\t\t\tif (range) {\n\t\t\t\trange.shrink(CKEDITOR.SHRINK_TEXT);\n\n\t\t\t\treturn this._editor\n\t\t\t\t\t.elementPath(range.getCommonAncestor())\n\t\t\t\t\t.contains('a', 1);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Removes a link from the editor.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method remove\n\t\t * @param {CKEDITOR.dom.element} link The link element which link style should be removed.\n\t\t * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n\t\t */\n\t\tremove: function(link, modifySelection) {\n\t\t\tlet editor = this._editor;\n\n\t\t\tif (link) {\n\t\t\t\tif (modifySelection && modifySelection.advance) {\n\t\t\t\t\tthis.advanceSelection();\n\t\t\t\t}\n\n\t\t\t\tlink.remove(editor);\n\t\t\t} else {\n\t\t\t\tlet style = new CKEDITOR.style({\n\t\t\t\t\talwaysRemoveElement: 1,\n\t\t\t\t\telement: 'a',\n\t\t\t\t\ttype: CKEDITOR.STYLE_INLINE,\n\t\t\t\t});\n\n\t\t\t\t// 'removeStyle()' removes the style from the editor's current selection.\n\t\t\t\t//  We need to force the selection to be the whole link element\n\t\t\t\t//  to remove it properly.\n\n\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\tselection.selectElement(selection.getStartElement());\n\n\t\t\t\teditor.removeStyle(style);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Updates the href of an already existing link.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method update\n\t\t * @param {CKEDITOR.dom.element} link The link element which href should be removed.\n\t\t * @param {Object|String} attrs The attributes to update or remove. Attributes with null values will be removed.\n\t\t * @param {Object} modifySelection A config object with an advance attribute to indicate if the selection should be moved after the link creation.\n\t\t */\n\t\tupdate: function(attrs, link, modifySelection) {\n\t\t\tlet instance = this;\n\n\t\t\tlink = link || this.getFromSelection();\n\n\t\t\tif (typeof attrs === 'string') {\n\t\t\t\tlet uri = instance._getCompleteURI(attrs);\n\n\t\t\t\tlink.setAttributes({\n\t\t\t\t\t'data-cke-saved-href': uri,\n\t\t\t\t\thref: uri,\n\t\t\t\t});\n\t\t\t} else if (typeof attrs === 'object') {\n\t\t\t\tlet removeAttrs = [];\n\n\t\t\t\tlet setAttrs = {};\n\n\t\t\t\tObject.keys(attrs).forEach(function(key) {\n\t\t\t\t\tif (attrs[key] === null) {\n\t\t\t\t\t\tif (key === 'href') {\n\t\t\t\t\t\t\tremoveAttrs.push('data-cke-saved-href');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tremoveAttrs.push(key);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (key === 'href') {\n\t\t\t\t\t\t\tlet uri = instance._getCompleteURI(attrs[key]);\n\n\t\t\t\t\t\t\tsetAttrs['data-cke-saved-href'] = uri;\n\t\t\t\t\t\t\tsetAttrs[key] = uri;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetAttrs[key] = attrs[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlink.removeAttributes(removeAttrs);\n\t\t\t\tlink.setAttributes(setAttrs);\n\t\t\t}\n\n\t\t\tif (modifySelection && modifySelection.advance) {\n\t\t\t\tthis.advanceSelection(link);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks if the URI begins with a '#' symbol to determine if it's an on page bookmark.\n\t\t * If it doesn't, it then checks if the URI has an '@' symbol. If it does and the URI\n\t\t * looks like an email and doesn't have 'mailto:', 'mailto:' is added to the URI.\n\t\t * If it doesn't and the URI doesn't have a scheme, the default 'http' scheme with\n\t\t * hierarchical path '//' is added to the URI.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Link\n\t\t * @method _getCompleteURI\n\t\t * @param {String} URI The URI of the link.\n\t\t * @protected\n\t\t * @return {String} The URI updated with the protocol.\n\t\t */\n\t\t_getCompleteURI: function(URI) {\n\t\t\tif (REGEX_BOOKMARK_SCHEME.test(URI)) {\n\t\t\t\treturn URI;\n\t\t\t} else if (REGEX_EMAIL_SCHEME.test(URI)) {\n\t\t\t\tURI = 'mailto:' + URI;\n\t\t\t} else if (!REGEX_URI_SCHEME.test(URI)) {\n\t\t\t\tURI = this.appendProtocol ? 'http://' + URI : URI;\n\t\t\t}\n\n\t\t\treturn URI;\n\t\t},\n\t};\n\n\tCKEDITOR.Link = CKEDITOR.Link || Link;\n})();\n","(function() {\n\t'use strict';\n\n\t// Wraps each of the plugin lifecycle methods in a closure that will\n\t// set up the editor.__processingPlugin__ variable so it can be globally\n\t// accessed exposing the plugin being processed and the lifecycle phase\n\t// in which it is happening\n\t//\n\t// @param {Object} plugin The plugin to wrap lifecycle methods\n\tlet wrapPluginLifecycle = function(plugin) {\n\t\tlet methods = ['beforeInit', 'init', 'afterInit'];\n\n\t\tmethods.forEach(function(methodName) {\n\t\t\tif (plugin[methodName]) {\n\t\t\t\tplugin[methodName] = CKEDITOR.tools.override(\n\t\t\t\t\tplugin[methodName],\n\t\t\t\t\tfunction(originalPluginMethod) {\n\t\t\t\t\t\tlet payload = {\n\t\t\t\t\t\t\tphase: methodName,\n\t\t\t\t\t\t\tplugin: plugin,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treturn function(editor) {\n\t\t\t\t\t\t\teditor.__processingPlugin__ = payload;\n\n\t\t\t\t\t\t\t// eslint-disable-next-line babel/no-invalid-this\n\t\t\t\t\t\t\toriginalPluginMethod.call(this, editor);\n\n\t\t\t\t\t\t\teditor.__processingPlugin__ = null;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t};\n\n\t// Filters the requires object to remove unwanted dependencies. At this point\n\t// only 'toolbar' has been identified, but more can appear. An unwanted plugin\n\t// dependency is one that prevents a necessary plugin from being removed\n\t//\n\t// @param {string|Array<string>} requires The requires object\n\t// @return {string} The filtered requires object\n\tlet filterUnwantedDependencies = function(requires) {\n\t\tif (typeof requires === 'string') {\n\t\t\trequires = requires.split(',');\n\t\t}\n\n\t\treturn requires.filter(function(require) {\n\t\t\treturn require !== 'toolbar';\n\t\t});\n\t};\n\n\t/**\n\t * CKEDITOR.plugins class utility which adds additional methods to those of CKEditor.\n\t *\n\t * @class CKEDITOR.plugins\n\t */\n\n\t/**\n\t * Overrides CKEDITOR.plugins.load method so we can extend the lifecycle methods of\n\t * the loaded plugins to add some metainformation about the plugin being processed\n\t *\n\t * @param {String/Array} names The name of the resource to load. It may be a\n\t * string with a single resource name, or an array with several names.\n\t * @param {Function} callback A function to be called when all resources\n\t * are loaded. The callback will receive an array containing all loaded names.\n\t * @param {Object} [scope] The scope object to be used for the callback call.\n\t * @memberof CKEDITOR.plugins\n\t * @method load\n\t * @static\n\t */\n\tCKEDITOR.plugins.load = CKEDITOR.tools.override(\n\t\tCKEDITOR.plugins.load,\n\t\tfunction(pluginsLoad) {\n\t\t\t// Wrap original load function so we can transform the plugin input parameter\n\t\t\t// before passing it down to the original callback\n\t\t\treturn function(names, callback, scope) {\n\t\t\t\t// eslint-disable-next-line babel/no-invalid-this\n\t\t\t\tpluginsLoad.call(this, names, function(plugins) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tObject.keys(plugins).forEach(function(pluginName) {\n\t\t\t\t\t\t\tlet plugin = plugins[pluginName];\n\n\t\t\t\t\t\t\tif (plugin.requires) {\n\t\t\t\t\t\t\t\tplugin.requires = filterUnwantedDependencies(\n\t\t\t\t\t\t\t\t\tplugin.requires\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\twrapPluginLifecycle(plugin);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcallback.call(scope, plugins);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t);\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_selectionregion')) {\n\t\treturn;\n\t}\n\n\tCKEDITOR.SELECTION_TOP_TO_BOTTOM = 0;\n\tCKEDITOR.SELECTION_BOTTOM_TO_TOP = 1;\n\tCKEDITOR.SELECTION_LEFT_TO_RIGHT = 2;\n\tCKEDITOR.SELECTION_RIGHT_TO_LEFT = 3;\n\n\t/**\n\t * SelectionRegion utility class which provides metadata about the selection. The metadata may be the start and end\n\t * rectangles, caret region, etc. **This class is not intended to be used standalone. Its functions will\n\t * be merged into each editor instance, so the developer may use them directly via the editor, without making\n\t * an instance of this class**.\n\t *\n\t * @class SelectionRegion\n\t * @constructor\n\t */\n\tfunction SelectionRegion() {}\n\n\tSelectionRegion.prototype = {\n\t\tconstructor: SelectionRegion,\n\n\t\t/**\n\t\t * Creates selection from two points in page coordinates.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method createSelectionFromPoint\n\t\t * @param {Number} x X point in page coordinates.\n\t\t * @param {Number} y Y point in page coordinates.\n\t\t */\n\t\tcreateSelectionFromPoint: function(x, y) {\n\t\t\tthis.createSelectionFromRange(x, y, x, y);\n\t\t},\n\n\t\t/**\n\t\t * Creates selection from range. A range consists from two points in page coordinates.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method createSelectionFromRange\n\t\t * @param {Number} startX X coordinate of the first point.\n\t\t * @param {Number} startY Y coordinate of the first point.\n\t\t * @param {Number} endX X coordinate of the second point.\n\t\t * @param {Number} endY Y coordinate of the second point.\n\t\t */\n\t\tcreateSelectionFromRange: function(startX, startY, endX, endY) {\n\t\t\tlet end;\n\t\t\tlet endContainer;\n\t\t\tlet endOffset;\n\t\t\tlet range;\n\t\t\tlet start;\n\t\t\tlet startContainer;\n\t\t\tlet startOffset;\n\n\t\t\tif (typeof document.caretPositionFromPoint === 'function') {\n\t\t\t\tstart = document.caretPositionFromPoint(startX, startY);\n\t\t\t\tend = document.caretPositionFromPoint(endX, endY);\n\n\t\t\t\tstartContainer = start.offsetNode;\n\t\t\t\tendContainer = end.offsetNode;\n\n\t\t\t\tstartOffset = start.offset;\n\t\t\t\tendOffset = end.offset;\n\n\t\t\t\trange = this.createRange();\n\t\t\t} else if (typeof document.caretRangeFromPoint === 'function') {\n\t\t\t\tstart = document.caretRangeFromPoint(startX, startY);\n\t\t\t\tend = document.caretRangeFromPoint(endX, endY);\n\n\t\t\t\tstartContainer = start.startContainer;\n\t\t\t\tendContainer = end.startContainer;\n\n\t\t\t\tstartOffset = start.startOffset;\n\t\t\t\tendOffset = end.startOffset;\n\n\t\t\t\trange = this.createRange();\n\t\t\t}\n\n\t\t\tif (range && document.getSelection) {\n\t\t\t\trange.setStart(\n\t\t\t\t\tnew CKEDITOR.dom.node(startContainer),\n\t\t\t\t\tstartOffset\n\t\t\t\t);\n\t\t\t\trange.setEnd(new CKEDITOR.dom.node(endContainer), endOffset);\n\n\t\t\t\tthis.getSelection().selectRanges([range]);\n\t\t\t} else if (typeof document.body.createTextRange === 'function') {\n\t\t\t\tlet selection = this.getSelection();\n\n\t\t\t\tselection.unlock();\n\n\t\t\t\trange = document.body.createTextRange();\n\t\t\t\trange.moveToPoint(startX, startY);\n\n\t\t\t\tlet endRange = range.duplicate();\n\t\t\t\tendRange.moveToPoint(endX, endY);\n\n\t\t\t\trange.setEndPoint('EndToEnd', endRange);\n\t\t\t\trange.select();\n\n\t\t\t\tthis.getSelection().lock();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns the region of the current position of the caret. The points are in page coordinates.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method getCaretRegion\n\t\t * @return {Object} Returns object with the following properties:\n\t\t * - bottom\n\t\t * - left\n\t\t * - right\n\t\t * - top\n\t\t */\n\t\tgetCaretRegion: function() {\n\t\t\tlet selection = this.getSelection();\n\n\t\t\tlet region = {\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t};\n\n\t\t\tlet bookmarks = selection.createBookmarks();\n\n\t\t\tif (!bookmarks.length) {\n\t\t\t\treturn region;\n\t\t\t}\n\n\t\t\tlet bookmarkNodeEl = bookmarks[0].startNode.$;\n\n\t\t\tbookmarkNodeEl.style.display = 'inline-block';\n\n\t\t\tregion = new CKEDITOR.dom.element(bookmarkNodeEl).getClientRect();\n\n\t\t\tbookmarkNodeEl.parentNode.removeChild(bookmarkNodeEl);\n\n\t\t\tlet scrollPos = new CKEDITOR.dom.window(window).getScrollPosition();\n\n\t\t\tregion.bottom = scrollPos.y + region.bottom;\n\t\t\tregion.left = scrollPos.x + region.left;\n\t\t\tregion.right = scrollPos.x + region.right;\n\t\t\tregion.top = scrollPos.y + region.top;\n\n\t\t\treturn region;\n\t\t},\n\n\t\t/**\n\t\t * Returns data for the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method getSelectionData\n\t\t * @return {Object|null} Returns an object with the following data:\n\t\t * - element - The currently selected element, if any\n\t\t * - text - The selected text\n\t\t * - region - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionRegion:method\"}}{{/crossLink}}\n\t\t */\n\t\tgetSelectionData: function() {\n\t\t\tlet selection = this.getSelection();\n\n\t\t\tif (!selection.getNative()) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tlet result = {\n\t\t\t\telement: selection.getSelectedElement(),\n\t\t\t\ttext: selection.getSelectedText(),\n\t\t\t};\n\n\t\t\tresult.region = this.getSelectionRegion(selection);\n\n\t\t\treturn result;\n\t\t},\n\n\t\t/**\n\t\t * Returns the region of the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method getSelectionRegion\n\t\t * @return {Object} Returns object which is being returned from\n\t\t * {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getClientRectsRegion:method\"}}{{/crossLink}} with three more properties:\n\t\t * - direction - the direction of the selection. Can be one of these:\n\t\t *   1. CKEDITOR.SELECTION_TOP_TO_BOTTOM\n\t\t *   2. CKEDITOR.SELECTION_BOTTOM_TO_TOP\n\t\t * - height - The height of the selection region\n\t\t * - width - The width of the selection region\n\t\t */\n\t\tgetSelectionRegion: function() {\n\t\t\tlet region = this.getClientRectsRegion();\n\n\t\t\tregion.direction = this.getSelectionDirection();\n\n\t\t\tregion.height = region.bottom - region.top;\n\t\t\tregion.width = region.right - region.left;\n\n\t\t\treturn region;\n\t\t},\n\n\t\t/**\n\t\t * Returns true if the current selection is empty, false otherwise.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method isSelectionEmpty\n\t\t * @return {Boolean} Returns true if the current selection is empty, false otherwise.\n\t\t */\n\t\tisSelectionEmpty: function() {\n\t\t\tlet ranges;\n\n\t\t\tlet selection = this.getSelection();\n\n\t\t\treturn (\n\t\t\t\tselection.getType() === CKEDITOR.SELECTION_NONE ||\n\t\t\t\t((ranges = selection.getRanges()) &&\n\t\t\t\t\tranges.length === 1 &&\n\t\t\t\t\tranges[0].collapsed)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Returns object with data about the [client rectangles](https://developer.mozilla.org/en-US/docs/Web/API/Element.getClientRects) of the selection,\n\t\t * normalized across browses. All offsets below are in page coordinates.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method getClientRectsRegion\n\t\t * @return {Object} Returns object with the following data:\n\t\t * - bottom - bottom offset of all client rectangles\n\t\t * - left - left offset of all client rectangles\n\t\t * - right - right offset of all client rectangles\n\t\t * - top - top offset of all client rectangles\n\t\t * - startRect - An Object, which contains the following information:\n\t\t *     + bottom - bottom offset\n\t\t *     + height - the height of the rectangle\n\t\t *     + left - left offset of the selection\n\t\t *     + right - right offset of the selection\n\t\t *     + top - top offset of the selection\n\t\t *     + width - the width of the rectangle\n\t\t * - endRect - An Object, which contains the following information:\n\t\t *     + bottom - bottom offset\n\t\t *     + height - the height of the rectangle\n\t\t *     + left - left offset of the selection\n\t\t *     + right - right offset of the selection\n\t\t *     + top - top offset of the selection\n\t\t *     + width - the width of the rectangle\n\t\t *\n\t\t * If there is no native selection, the objects will be filled with 0.\n\t\t */\n\t\tgetClientRectsRegion: function() {\n\t\t\tlet selection = this.getSelection();\n\t\t\tlet nativeSelection = selection.getNative();\n\n\t\t\tlet defaultRect = {\n\t\t\t\tbottom: 0,\n\t\t\t\theight: 0,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t\twidth: 0,\n\t\t\t};\n\n\t\t\tlet region = {\n\t\t\t\tbottom: 0,\n\t\t\t\tendRect: defaultRect,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tstartRect: defaultRect,\n\t\t\t};\n\n\t\t\tif (!nativeSelection) {\n\t\t\t\treturn region;\n\t\t\t}\n\n\t\t\tlet bottom = 0;\n\t\t\tlet clientRects;\n\t\t\tlet left = Infinity;\n\t\t\tlet right = -Infinity;\n\t\t\tlet top = Infinity;\n\n\t\t\tif (nativeSelection.createRange) {\n\t\t\t\tclientRects = nativeSelection.createRange().getClientRects();\n\t\t\t} else {\n\t\t\t\tclientRects =\n\t\t\t\t\tnativeSelection.rangeCount > 0\n\t\t\t\t\t\t? nativeSelection.getRangeAt(0).getClientRects()\n\t\t\t\t\t\t: [];\n\t\t\t}\n\n\t\t\tif (clientRects.length === 0) {\n\t\t\t\tregion = this.getCaretRegion();\n\t\t\t} else {\n\t\t\t\tfor (let i = 0, length = clientRects.length; i < length; i++) {\n\t\t\t\t\tlet item = clientRects[i];\n\n\t\t\t\t\tif (item.left < left) {\n\t\t\t\t\t\tleft = item.left;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.right > right) {\n\t\t\t\t\t\tright = item.right;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.top < top) {\n\t\t\t\t\t\ttop = item.top;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.bottom > bottom) {\n\t\t\t\t\t\tbottom = item.bottom;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet scrollPos = new CKEDITOR.dom.window(\n\t\t\t\t\twindow\n\t\t\t\t).getScrollPosition();\n\n\t\t\t\tregion.bottom = scrollPos.y + bottom;\n\t\t\t\tregion.left = scrollPos.x + left;\n\t\t\t\tregion.right = scrollPos.x + right;\n\t\t\t\tregion.top = scrollPos.y + top;\n\n\t\t\t\tif (clientRects.length) {\n\t\t\t\t\tlet endRect = clientRects[clientRects.length - 1];\n\t\t\t\t\tlet startRect = clientRects[0];\n\n\t\t\t\t\tregion.endRect = {\n\t\t\t\t\t\tbottom: scrollPos.y + endRect.bottom,\n\t\t\t\t\t\theight: endRect.height,\n\t\t\t\t\t\tleft: scrollPos.x + endRect.left,\n\t\t\t\t\t\tright: scrollPos.x + endRect.right,\n\t\t\t\t\t\ttop: scrollPos.y + endRect.top,\n\t\t\t\t\t\twidth: endRect.width,\n\t\t\t\t\t};\n\n\t\t\t\t\tregion.startRect = {\n\t\t\t\t\t\tbottom: scrollPos.y + startRect.bottom,\n\t\t\t\t\t\theight: startRect.height,\n\t\t\t\t\t\tleft: scrollPos.x + startRect.left,\n\t\t\t\t\t\tright: scrollPos.x + startRect.right,\n\t\t\t\t\t\ttop: scrollPos.y + startRect.top,\n\t\t\t\t\t\twidth: startRect.width,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn region;\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the direction of the selection. The direction is from top to bottom or from bottom to top.\n\t\t * For IE < 9 it is not possible, so the direction for these browsers will be always CKEDITOR.SELECTION_TOP_TO_BOTTOM.\n\t\t *\n\t\t * @instance\n\t\t * @memberof SelectionRegion\n\t\t * @method getSelectionDirection\n\t\t * @return {Number} Returns a number which represents selection direction. It might be one of these:\n\t\t * - CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n\t\t * - CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\t\t */\n\t\tgetSelectionDirection: function() {\n\t\t\tlet direction = CKEDITOR.SELECTION_TOP_TO_BOTTOM;\n\t\t\tlet selection = this.getSelection();\n\t\t\tlet nativeSelection = selection.getNative();\n\n\t\t\tif (!nativeSelection) {\n\t\t\t\treturn direction;\n\t\t\t}\n\n\t\t\tlet anchorNode;\n\n\t\t\tif (\n\t\t\t\t(anchorNode = nativeSelection.anchorNode) &&\n\t\t\t\tanchorNode.compareDocumentPosition\n\t\t\t) {\n\t\t\t\tlet position = anchorNode.compareDocumentPosition(\n\t\t\t\t\tnativeSelection.focusNode\n\t\t\t\t);\n\n\t\t\t\tif (\n\t\t\t\t\t(!position &&\n\t\t\t\t\t\tnativeSelection.anchorOffset >\n\t\t\t\t\t\t\tnativeSelection.focusOffset) ||\n\t\t\t\t\tposition === Node.DOCUMENT_POSITION_PRECEDING\n\t\t\t\t) {\n\t\t\t\t\tdirection = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn direction;\n\t\t},\n\t};\n\n\tCKEDITOR.plugins.add('ae_selectionregion', {\n\t\tinit: function(editor) {\n\t\t\tlet attr;\n\t\t\tlet hasOwnProperty;\n\n\t\t\thasOwnProperty = Object.prototype.hasOwnProperty;\n\n\t\t\tfor (attr in SelectionRegion.prototype) {\n\t\t\t\tif (\n\t\t\t\t\thasOwnProperty.call(SelectionRegion.prototype, attr) &&\n\t\t\t\t\ttypeof editor[attr] === 'undefined'\n\t\t\t\t) {\n\t\t\t\t\teditor[attr] = SelectionRegion.prototype[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tlet IE_NON_DIRECTLY_EDITABLE_ELEMENT = {\n\t\ttable: 1,\n\t\tcol: 1,\n\t\tcolgroup: 1,\n\t\ttbody: 1,\n\t\ttd: 1,\n\t\ttfoot: 1,\n\t\tth: 1,\n\t\tthead: 1,\n\t\ttr: 1,\n\t};\n\n\t/**\n\t * Table class utility. Provides methods for create, delete and update tables.\n\t *\n\t * @class CKEDITOR.Table\n\t * @constructor\n\t * @param {Object} editor The CKEditor instance.\n\t */\n\n\tfunction Table(editor) {\n\t\tthis._editor = editor;\n\t}\n\n\tTable.HEADING_BOTH = 'Both';\n\tTable.HEADING_COL = 'Column';\n\tTable.HEADING_NONE = 'None';\n\tTable.HEADING_ROW = 'Row';\n\n\tTable.prototype = {\n\t\tconstructor: Table,\n\n\t\t/**\n\t\t * Creates a table.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method create\n\t\t * @param {Object} config Table configuration object\n\t\t * @return {Object} The created table\n\t\t */\n\t\tcreate: function(config) {\n\t\t\tlet editor = this._editor;\n\t\t\tlet table = this._createElement('table');\n\n\t\t\tconfig = config || {};\n\n\t\t\t// Generate the rows and cols.\n\t\t\tlet tbody = table.append(this._createElement('tbody'));\n\t\t\tlet rows = config.rows || 1;\n\t\t\tlet cols = config.cols || 1;\n\n\t\t\tfor (let i = 0; i < rows; i++) {\n\t\t\t\tlet row = tbody.append(this._createElement('tr'));\n\t\t\t\tfor (let j = 0; j < cols; j++) {\n\t\t\t\t\tlet cell = row.append(this._createElement('td'));\n\n\t\t\t\t\tcell.appendBogus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setAttributes(table, config.attrs);\n\t\t\tthis.setHeading(table, config.heading);\n\n\t\t\t// Insert the table element if we're creating one.\n\t\t\teditor.insertElement(table);\n\n\t\t\tlet firstCell = new CKEDITOR.dom.element(table.$.rows[0].cells[0]);\n\t\t\tlet range = editor.createRange();\n\t\t\trange.moveToPosition(firstCell, CKEDITOR.POSITION_AFTER_START);\n\t\t\trange.select();\n\n\t\t\treturn table;\n\t\t},\n\n\t\t/**\n\t\t * Retrieves a table from the current selection.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method getFromSelection\n\t\t * @return {CKEDITOR.dom.element} The retrieved table or null if not found.\n\t\t */\n\t\tgetFromSelection: function() {\n\t\t\tlet table;\n\t\t\tlet selection = this._editor.getSelection();\n\t\t\tlet selected = selection.getSelectedElement();\n\n\t\t\tif (selected && selected.is('table')) {\n\t\t\t\ttable = selected;\n\t\t\t} else {\n\t\t\t\tlet ranges = selection.getRanges();\n\n\t\t\t\tif (ranges.length > 0) {\n\t\t\t\t\t// Webkit could report the following range on cell selection (#4948):\n\t\t\t\t\t// <table><tr><td>[&nbsp;</td></tr></table>]\n\n\t\t\t\t\t/* istanbul ignore else */\n\t\t\t\t\tif (CKEDITOR.env.webkit) {\n\t\t\t\t\t\tranges[0].shrink(CKEDITOR.NODE_ELEMENT);\n\t\t\t\t\t}\n\n\t\t\t\t\ttable = this._editor\n\t\t\t\t\t\t.elementPath(ranges[0].getCommonAncestor(true))\n\t\t\t\t\t\t.contains('table', 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn table;\n\t\t},\n\n\t\t/**\n\t\t * Checks if a given table can be considered as editable. This method\n\t\t * workarounds a limitation of IE where for some elements (like table),\n\t\t * `isContentEditable` returns always false. This is because IE does not support\n\t\t * `contenteditable` on such elements. However, despite such elements\n\t\t * cannot be set as content editable directly, a content editable SPAN,\n\t\t * or DIV element can be placed inside the individual table cells.\n\t\t * See https://msdn.microsoft.com/en-us/library/ms537837%28v=VS.85%29.aspx\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method isEditable\n\t\t * @param {CKEDITOR.dom.element} el The table element to test if editable\n\t\t * @return {Boolean}\n\t\t */\n\t\tisEditable: function(el) {\n\t\t\tif (!CKEDITOR.env.ie || !el.is(IE_NON_DIRECTLY_EDITABLE_ELEMENT)) {\n\t\t\t\treturn !el.isReadOnly();\n\t\t\t}\n\n\t\t\tif (el.hasAttribute('contenteditable')) {\n\t\t\t\treturn el.getAttribute('contenteditable') !== 'false';\n\t\t\t}\n\n\t\t\treturn this.isEditable(el.getParent());\n\t\t},\n\n\t\t/**\n\t\t * Returns which heading style is set for the given table.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method getHeading\n\t\t * @param {CKEDITOR.dom.element} table The table to gather the heading from. If null, it will be retrieved from the current selection.\n\t\t * @return {String} The heading of the table. Expected values are `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n\t\t */\n\t\tgetHeading: function(table) {\n\t\t\ttable = table || this.getFromSelection();\n\n\t\t\tif (!table) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tlet rowHeadingSettings = table.$.tHead !== null;\n\n\t\t\tlet colHeadingSettings = true;\n\n\t\t\t// Check if all of the first cells in every row are TH\n\t\t\tfor (let row = 0; row < table.$.rows.length; row++) {\n\t\t\t\t// If just one cell isn't a TH then it isn't a header column\n\t\t\t\tlet cell = table.$.rows[row].cells[0];\n\n\t\t\t\tif (cell && cell.nodeName.toLowerCase() !== 'th') {\n\t\t\t\t\tcolHeadingSettings = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet headingSettings = Table.HEADING_NONE;\n\n\t\t\tif (rowHeadingSettings) {\n\t\t\t\theadingSettings = Table.HEADING_ROW;\n\t\t\t}\n\n\t\t\tif (colHeadingSettings) {\n\t\t\t\theadingSettings =\n\t\t\t\t\theadingSettings === Table.HEADING_ROW\n\t\t\t\t\t\t? Table.HEADING_BOTH\n\t\t\t\t\t\t: Table.HEADING_COL;\n\t\t\t}\n\n\t\t\treturn headingSettings;\n\t\t},\n\n\t\t/**\n\t\t * Removes a table from the editor.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method remove\n\t\t * @param {CKEDITOR.dom.element} table The table element which table style should be removed.\n\t\t */\n\t\tremove: function(table) {\n\t\t\tlet editor = this._editor;\n\n\t\t\tif (table) {\n\t\t\t\ttable.remove();\n\t\t\t} else {\n\t\t\t\ttable = editor.elementPath().contains('table', 1);\n\n\t\t\t\tif (table) {\n\t\t\t\t\t// If the table's parent has only one child remove it as well (unless it's a table cell, or the editable element) (#5416, #6289, #12110)\n\t\t\t\t\tlet parent = table.getParent();\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tparent.getChildCount() === 1 &&\n\t\t\t\t\t\t!parent.is('td', 'th') &&\n\t\t\t\t\t\t!parent.equals(editable)\n\t\t\t\t\t) {\n\t\t\t\t\t\ttable = parent;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet range = editor.createRange();\n\t\t\t\t\trange.moveToPosition(table, CKEDITOR.POSITION_BEFORE_START);\n\t\t\t\t\ttable.remove();\n\t\t\t\t\trange.select();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Assigns provided attributes to a table.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method setAttributes\n\t\t * @param {Object} table The table to which the attributes should be assigned\n\t\t * @param {Object} attrs The attributes which have to be assigned to the table\n\t\t */\n\t\tsetAttributes: function(table, attrs) {\n\t\t\tif (attrs) {\n\t\t\t\tObject.keys(attrs).forEach(function(attr) {\n\t\t\t\t\ttable.setAttribute(attr, attrs[attr]);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Sets the appropriate table heading style to a table.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @method setHeading\n\t\t * @param {CKEDITOR.dom.element} table The table element to which the heading should be set. If null, it will be retrieved from the current selection.\n\t\t * @param {String} heading The table heading to be set. Accepted values are: `CKEDITOR.Table.NONE`, `CKEDITOR.Table.ROW`, `CKEDITOR.Table.COL` and `CKEDITOR.Table.BOTH`.\n\t\t */\n\t\tsetHeading: function(table, heading) {\n\t\t\ttable = table || this.getFromSelection();\n\n\t\t\tlet i;\n\t\t\tlet newCell;\n\t\t\tlet tableHead;\n\t\t\tlet tableBody = table.getElementsByTag('tbody').getItem(0);\n\n\t\t\tlet tableHeading = this.getHeading(table);\n\t\t\tlet hadColHeading =\n\t\t\t\ttableHeading === Table.HEADING_COL ||\n\t\t\t\ttableHeading === Table.HEADING_BOTH;\n\n\t\t\tlet needColHeading =\n\t\t\t\theading === Table.HEADING_COL || heading === Table.HEADING_BOTH;\n\t\t\tlet needRowHeading =\n\t\t\t\theading === Table.HEADING_ROW || heading === Table.HEADING_BOTH;\n\n\t\t\t// If we need row heading and don't have a <thead> element yet, move the\n\t\t\t// first row of the table to the head and convert the nodes to <th> ones.\n\t\t\tif (!table.$.tHead && needRowHeading) {\n\t\t\t\tlet tableFirstRow = tableBody.getElementsByTag('tr').getItem(0);\n\t\t\t\tlet tableFirstRowChildCount = tableFirstRow.getChildCount();\n\n\t\t\t\t// Change TD to TH:\n\t\t\t\tfor (i = 0; i < tableFirstRowChildCount; i++) {\n\t\t\t\t\tlet cell = tableFirstRow.getChild(i);\n\n\t\t\t\t\t// Skip bookmark nodes. (#6155)\n\t\t\t\t\tif (\n\t\t\t\t\t\tcell.type === CKEDITOR.NODE_ELEMENT &&\n\t\t\t\t\t\t!cell.data('cke-bookmark')\n\t\t\t\t\t) {\n\t\t\t\t\t\tcell.renameNode('th');\n\t\t\t\t\t\tcell.setAttribute('scope', 'col');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttableHead = this._createElement(table.$.createTHead());\n\t\t\t\ttableHead.append(tableFirstRow.remove());\n\t\t\t}\n\n\t\t\t// If we don't need row heading and we have a <thead> element, move the\n\t\t\t// row out of there and into the <tbody> element.\n\t\t\tif (table.$.tHead !== null && !needRowHeading) {\n\t\t\t\t// Move the row out of the THead and put it in the TBody:\n\t\t\t\ttableHead = this._createElement(table.$.tHead);\n\n\t\t\t\tlet previousFirstRow = tableBody.getFirst();\n\n\t\t\t\twhile (tableHead.getChildCount() > 0) {\n\t\t\t\t\tlet newFirstRow = tableHead.getFirst();\n\t\t\t\t\tlet newFirstRowChildCount = newFirstRow.getChildCount();\n\n\t\t\t\t\tfor (i = 0; i < newFirstRowChildCount; i++) {\n\t\t\t\t\t\tnewCell = newFirstRow.getChild(i);\n\n\t\t\t\t\t\tif (newCell.type === CKEDITOR.NODE_ELEMENT) {\n\t\t\t\t\t\t\tnewCell.renameNode('td');\n\t\t\t\t\t\t\tnewCell.removeAttribute('scope');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tnewFirstRow.insertBefore(previousFirstRow);\n\t\t\t\t}\n\n\t\t\t\ttableHead.remove();\n\t\t\t}\n\n\t\t\ttableHeading = this.getHeading(table);\n\t\t\tlet hasColHeading =\n\t\t\t\ttableHeading === Table.HEADING_COL ||\n\t\t\t\ttableHeading === Table.HEADING_BOTH;\n\n\t\t\t// If we need column heading and the table doesn't have it, convert every first cell in\n\t\t\t// every row into a `<th scope=\"row\">` element.\n\t\t\tif (!hasColHeading && needColHeading) {\n\t\t\t\tfor (i = 0; i < table.$.rows.length; i++) {\n\t\t\t\t\tif (\n\t\t\t\t\t\ttable.$.rows[i].cells[0].nodeName.toLowerCase() !== 'th'\n\t\t\t\t\t) {\n\t\t\t\t\t\tnewCell = new CKEDITOR.dom.element(\n\t\t\t\t\t\t\ttable.$.rows[i].cells[0]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tnewCell.renameNode('th');\n\t\t\t\t\t\tnewCell.setAttribute('scope', 'row');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we don't need column heading but the table has it, convert every first cell in every\n\t\t\t// row back into a `<td>` element.\n\t\t\tif (hadColHeading && !needColHeading) {\n\t\t\t\tfor (i = 0; i < table.$.rows.length; i++) {\n\t\t\t\t\tlet row = new CKEDITOR.dom.element(table.$.rows[i]);\n\n\t\t\t\t\tif (row.getParent().getName() === 'tbody') {\n\t\t\t\t\t\tnewCell = new CKEDITOR.dom.element(row.$.cells[0]);\n\t\t\t\t\t\tnewCell.renameNode('td');\n\t\t\t\t\t\tnewCell.removeAttribute('scope');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Creates a new CKEDITOR.dom.element using the passed tag name.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.Table\n\t\t * @protected\n\t\t * @method _createElement\n\t\t * @param {String} name The tag name from which an element should be created\n\t\t * @return {CKEDITOR.dom.element} Instance of CKEDITOR DOM element class\n\t\t */\n\t\t_createElement: function(name) {\n\t\t\treturn new CKEDITOR.dom.element(name, this._editor.document);\n\t\t},\n\t};\n\n\tCKEDITOR.on('instanceReady', function(event) {\n\t\tlet headingCommands = [\n\t\t\tTable.HEADING_NONE,\n\t\t\tTable.HEADING_ROW,\n\t\t\tTable.HEADING_COL,\n\t\t\tTable.HEADING_BOTH,\n\t\t];\n\n\t\tlet tableUtils = new Table(event.editor);\n\n\t\theadingCommands.forEach(function(heading) {\n\t\t\tevent.editor.addCommand('tableHeading' + heading, {\n\t\t\t\texec: function(_editor) {\n\t\t\t\t\ttableUtils.setHeading(null, heading);\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t});\n\n\tCKEDITOR.Table = CKEDITOR.Table || Table;\n})();\n","(function() {\n\t'use strict';\n\n\t/**\n\t * CKEDITOR.tools class utility which adds additional methods to those of CKEditor.\n\t *\n\t * @class CKEDITOR.tools\n\t */\n\n\t/**\n\t * Sends a request using the JSONP technique.\n\t *\n\t * @memberof CKEDITOR.tools\n\t * @method jsonp\n\t * @param {CKEDITOR.template} urlTemplate The template of the URL to be requested. All properties passed in `urlParams` can be used, plus a `{callback}`, which represent a JSONP callback, must be defined.\n\t * @param {Function} callback A function to be called in case of success.\n\t * @param {Function} errorCallback A function to be called in case of failure.\n\t * @param {Object} urlParams Parameters to be passed to the `urlTemplate`.\n\t * @return {Object} An object with the following properties:\n\t *  - id: the transaction ID\n\t *  - a `cancel()` method\n\t * @static\n\t */\n\tCKEDITOR.tools.jsonp = function(\n\t\turlTemplate,\n\t\turlParams,\n\t\tcallback,\n\t\terrorCallback\n\t) {\n\t\tlet callbackKey = CKEDITOR.tools.getNextNumber();\n\n\t\turlParams = urlParams || {};\n\t\turlParams.callback = 'CKEDITOR._.jsonpCallbacks[' + callbackKey + ']';\n\n\t\tif (!CKEDITOR._.jsonpCallbacks) {\n\t\t\tCKEDITOR._.jsonpCallbacks = {};\n\t\t}\n\n\t\tCKEDITOR._.jsonpCallbacks[callbackKey] = function(response) {\n\t\t\tsetTimeout(function() {\n\t\t\t\tcleanUp();\n\n\t\t\t\tcallback(response);\n\t\t\t});\n\t\t};\n\n\t\tlet scriptElement = new CKEDITOR.dom.element('script');\n\t\tscriptElement.setAttribute('src', urlTemplate.output(urlParams));\n\t\tscriptElement.on('error', function() {\n\t\t\tcleanUp();\n\n\t\t\tif (errorCallback) {\n\t\t\t\terrorCallback();\n\t\t\t}\n\t\t});\n\n\t\tfunction cleanUp() {\n\t\t\tif (scriptElement) {\n\t\t\t\tscriptElement.remove();\n\t\t\t\tdelete CKEDITOR._.jsonpCallbacks[callbackKey];\n\t\t\t\tscriptElement = null;\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.document.getBody().append(scriptElement);\n\n\t\treturn {\n\t\t\tcancel: cleanUp,\n\t\t\tid: callbackKey,\n\t\t};\n\t};\n\n\t/**\n\t * Returns a new object containing all of the properties of all the supplied\n\t * objects. The properties from later objects will overwrite those in earlier\n\t * objects.\n\t *\n\t * Passing in a single object will create a shallow copy of it.\n\t *\n\t * @memberof CKEDITOR.tools\n\t * @method merge\n\t * @param {Object} objects* One or more objects to merge.\n\t * @return {Object} A new merged object.\n\t * @static\n\t */\n\tCKEDITOR.tools.merge =\n\t\tCKEDITOR.tools.merge ||\n\t\tfunction(...args) {\n\t\t\tlet result = {};\n\n\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\tlet obj = args[i];\n\n\t\t\t\tfor (let key in obj) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\t\t\t\tresult[key] = obj[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\n\t/**\n\t * Simulates event on a DOM element.\n\t *\n\t * @memberof CKEDITOR.tools\n\t * @method simulate\n\t * @param {DOMElement} element The element on which the event shoud be simualted.\n\t * @param {String} event The name of the event which have to be simulated.\n\t * @static\n\t */\n\tCKEDITOR.tools.simulate = function(element, event) {\n\t\tlet eventInstance = document.createEvent('Events');\n\t\teventInstance.initEvent(event, true, false);\n\t\telement.dispatchEvent(eventInstance);\n\t};\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_uicore')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * UICore class which will handle user interactions with the editor. These interactions\n\t * might be triggered via mouse, keyboard or touch devices. The class fill fire an event via\n\t * CKEditor's event system - \"editorInteraction\". The UI may listen to this event and\n\t * execute some actions - for example to show/hide toolbars.\n\t *\n\t * By default if user presses the Esc key, 'editorInteraction' event won't be fired. However, this behaviour can be changed\n\t * by setting {{#crossLink \"CKEDITOR.plugins.ae_uicore/allowEsc:attribute\"}}{{/crossLink}} config property in editor's configuration to true.\n\t *\n\t * @class ae_uicore\n\t */\n\n\t/**\n\t * Fired when user interacts somehow with the browser. This may be clicking with the mouse, pressing keyboard button,\n\t * or touching screen. This even will be not fired after each interaction. It will be debounced. By default the timeout\n\t * is 50ms. This value can be overwritten via {{#crossLink \"CKEDITOR.plugins.ae_uicore/timeout:attribute\"}}{{/crossLink}}\n\t * property of editor's configuration, like: editor.config.uicore.timeout = 100\n\t *\n\t * @memberof ae_uicore\n\t * @event ae_uicore#editorInteraction\n\t * @param {Object} data An object which contains the following properties:\n\t * - nativeEvent - The event as received from CKEditor.\n\t * - selectionData - The data, returned from {{#crossLink \"CKEDITOR.plugins.ae_selectionregion/getSelectionData:method\"}}{{/crossLink}}\n\t */\n\n\t/**\n\t * Fired by UI elements like Toolbars or Buttons when their state changes. The listener updates the live region with the provided data.\n\t *\n\t * @memberof ae_uicore\n\t * @event ae_uicore#ariaUpdate\n\t * @param {Object} data An object which contains the following properties:\n\t * - message - The provided message from the UI element.\n\t */\n\n\t/**\n\t * If set to true, the editor will still fire {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event,\n\t * if user presses Esc key.\n\t *\n\t * @memberof ae_uicore\n\t * @attribute allowEsc\n\t * @default false\n\t * @type Boolean\n\t */\n\n\t/**\n\t * Specifies the default timeout after which the {{#crossLink \"CKEDITOR.plugins.ae_uicore/editorInteraction:event\"}}{{/crossLink}} event\n\t * will be fired.\n\t *\n\t * @memberof ae_uicore\n\t * @attribute timeout\n\t * @default 50 (ms)\n\t * @type Number\n\t */\n\n\tCKEDITOR.plugins.add('ae_uicore', {\n\t\t/**\n\t\t * Initializer lifecycle implementation for the UICore plugin.\n\t\t *\n\t\t * @memberof ae_uicore\n\t\t * @method init\n\t\t * @param {Object} editor The current CKEditor instance.\n\t\t * @protected\n\t\t */\n\t\tinit: function(editor) {\n\t\t\tlet ariaState = [];\n\n\t\t\tlet ariaElement = this._createAriaElement(editor.id);\n\n\t\t\tlet uiTasksTimeout = editor.config.uicore\n\t\t\t\t? editor.config.uicore.timeout\n\t\t\t\t: 50;\n\n\t\t\tlet handleUI = CKEDITOR.tools.debounce(function(event) {\n\t\t\t\tariaState = [];\n\n\t\t\t\tif (\n\t\t\t\t\tevent.name !== 'keyup' ||\n\t\t\t\t\tevent.data.$.keyCode !== 27 ||\n\t\t\t\t\teditor.config.allowEsc\n\t\t\t\t) {\n\t\t\t\t\tlet selectionData = editor.getSelectionData();\n\n\t\t\t\t\tif (selectionData) {\n\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\tnativeEvent: event.data.$,\n\t\t\t\t\t\t\tselectionData: selectionData,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, uiTasksTimeout);\n\n\t\t\tlet handleAria = CKEDITOR.tools.debounce(function(_event) {\n\t\t\t\tariaElement.innerHTML = ariaState.join('. ');\n\t\t\t}, uiTasksTimeout);\n\n\t\t\tlet handleMouseLeave = CKEDITOR.tools.debounce(function(event) {\n\t\t\t\tlet aeUINodes = document.querySelectorAll('.ae-ui');\n\n\t\t\t\tlet found;\n\n\t\t\t\tfor (let i = 0; i < aeUINodes.length; i++) {\n\t\t\t\t\tif (aeUINodes[i].contains(event.data.$.relatedTarget)) {\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!found) {\n\t\t\t\t\thandleUI(event);\n\t\t\t\t}\n\t\t\t}, uiTasksTimeout);\n\n\t\t\teditor.on('ariaUpdate', function(event) {\n\t\t\t\t// handleAria is debounced function, so if it is being called multiple times, it will\n\t\t\t\t// be canceled until some time passes.\n\t\t\t\t// For that reason here we explicitly append the current message to the list of messages\n\t\t\t\t// and call handleAria. Since it is debounced, when some timeout passes,\n\t\t\t\t// all the messages will be applied to the live region and not only the last one.\n\n\t\t\t\tariaState.push(event.data.message);\n\n\t\t\t\thandleAria();\n\t\t\t});\n\n\t\t\teditor.once('contentDom', function() {\n\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\tconst focusHandler = editable.attachListener(\n\t\t\t\t\teditable,\n\t\t\t\t\t'focus',\n\t\t\t\t\tfunction(event) {\n\t\t\t\t\t\tfocusHandler.removeListener();\n\n\t\t\t\t\t\teditable.attachListener(editable, 'keyup', handleUI);\n\t\t\t\t\t\teditable.attachListener(editable, 'mouseup', handleUI);\n\t\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\t\teditable,\n\t\t\t\t\t\t\t'mouseleave',\n\t\t\t\t\t\t\thandleMouseLeave\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\thandleUI(event);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\n\t\t\teditor.on('destroy', function(_event) {\n\t\t\t\tariaElement.parentNode.removeChild(ariaElement);\n\n\t\t\t\thandleUI.detach();\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Creates and applies an HTML element to the body of the document which will contain ARIA messages.\n\t\t *\n\t\t * @memberof ae_uicore\n\t\t * @method _createAriaElement\n\t\t * @param {String} id The provided id of the element. It will be used as prefix for the final element Id.\n\t\t * @protected\n\t\t * @return {HTMLElement} The created and applied to DOM element.\n\t\t */\n\t\t_createAriaElement: function(id) {\n\t\t\tlet statusElement = document.createElement('div');\n\n\t\t\tstatusElement.className = 'ae-sr-only';\n\n\t\t\tstatusElement.setAttribute('aria-live', 'polite');\n\t\t\tstatusElement.setAttribute('role', 'status');\n\t\t\tstatusElement.setAttribute('id', id + 'LiveRegion');\n\n\t\t\tdocument.body.appendChild(statusElement);\n\n\t\t\treturn statusElement;\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tlet isIE = CKEDITOR.env.ie;\n\n\tif (CKEDITOR.plugins.get('ae_addimages')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEditor plugin which allows Drag&Drop of images directly into the editable area. The image will be encoded\n\t * as Data URI. An event `beforeImageAdd` will be fired with the list of dropped images. If any of the listeners\n\t * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n\t * an event `imageAdd` will be fired with the inserted element into the editable area.\n\t *\n\t * @class CKEDITOR.plugins.ae_addimages\n\t */\n\n\t/**\n\t * Fired before adding images to the editor.\n\t *\n\t * @event CKEDITOR.plugins.ae_addimages#beforeImageAdd\n\t * @instance\n\t * @memberof CKEDITOR.plugins.ae_addimages\n\t * @param {Array} imageFiles Array of image files\n\t */\n\n\t/**\n\t * Fired when an image is being added to the editor successfully.\n\t *\n\t * @event CKEDITOR.plugins.ae_addimages#imageAdd\n\t * @instance\n\t * @memberof CKEDITOR.plugins.ae_addimages\n\t * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n\t * @param {File} file The image file\n\t */\n\n\tCKEDITOR.plugins.add('ae_addimages', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function registers a 'dragenter', 'dragover', 'drop' and `paste` events on the editing area.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\teditor.once(\n\t\t\t\t'contentDom',\n\t\t\t\tfunction() {\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'dragenter',\n\t\t\t\t\t\tthis._onDragEnter,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'dragover',\n\t\t\t\t\t\tthis._onDragOver,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'drop',\n\t\t\t\t\t\tthis._onDragDrop,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'paste',\n\t\t\t\t\t\tthis._onPaste,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Accepts an array of dropped files to the editor. Then, it filters the images and sends them for further\n\t\t * processing to {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}}\n\t\t *\n\t\t * @fires CKEDITOR.plugins.ae_addimages#beforeImageAdd\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _handleFiles\n\t\t * @param {Array} files Array of dropped files. Only the images from this list will be processed.\n\t\t * @param {Object} editor The current editor instance\n\t\t * @protected\n\t\t */\n\t\t_handleFiles: function(files, editor) {\n\t\t\tlet file;\n\t\t\tlet i;\n\n\t\t\tlet imageFiles = [];\n\n\t\t\tfor (i = 0; i < files.length; i++) {\n\t\t\t\tfile = files[i];\n\n\t\t\t\tif (file.type.indexOf('image') === 0) {\n\t\t\t\t\timageFiles.push(file);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet result = editor.fire('beforeImageAdd', {\n\t\t\t\timageFiles: imageFiles,\n\t\t\t});\n\n\t\t\tif (result) {\n\t\t\t\tfor (i = 0; i < imageFiles.length; i++) {\n\t\t\t\t\tfile = imageFiles[i];\n\n\t\t\t\t\tthis._processFile(file, editor);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Handles drag drop event. The function will create a selection from the current\n\t\t * point and will send a list of files to be processed to\n\t\t * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_handleFiles:method\"}}{{/crossLink}} method.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _onDragDrop\n\t\t * @param {CKEDITOR.dom.event} event dragdrop event, as received natively from CKEditor\n\t\t * @protected\n\t\t */\n\t\t_onDragDrop: function(event) {\n\t\t\tlet nativeEvent = event.data.$;\n\n\t\t\tlet transferFiles = nativeEvent.dataTransfer.files;\n\n\t\t\tif (transferFiles.length > 0) {\n\t\t\t\tnew CKEDITOR.dom.event(nativeEvent).preventDefault();\n\n\t\t\t\tlet editor = event.listenerData.editor;\n\n\t\t\t\tevent.listenerData.editor.createSelectionFromPoint(\n\t\t\t\t\tnativeEvent.clientX,\n\t\t\t\t\tnativeEvent.clientY\n\t\t\t\t);\n\n\t\t\t\tthis._handleFiles(transferFiles, editor);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Handles drag enter event. In case of IE, this function will prevent the event.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _onDragEnter\n\t\t * @param {DOM event} event dragenter event, as received natively from CKEditor\n\t\t * @protected\n\t\t */\n\t\t_onDragEnter: function(event) {\n\t\t\tif (isIE) {\n\t\t\t\tthis._preventEvent(event);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Handles drag over event. In case of IE, this function will prevent the event.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _onDragOver\n\t\t * @param {DOM event} event dragover event, as received natively from CKEditor\n\t\t * @protected\n\t\t */\n\t\t_onDragOver: function(event) {\n\t\t\tif (isIE) {\n\t\t\t\tthis._preventEvent(event);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks if the pasted data is image and passes it to\n\t\t * {{#crossLink \"CKEDITOR.plugins.ae_addimages/_processFile:method\"}}{{/crossLink}} for processing.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _onPaste\n\t\t * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n\t\t * @protected\n\t\t */\n\t\t_onPaste: function(event) {\n\t\t\tif (\n\t\t\t\tevent.data &&\n\t\t\t\tevent.data.$ &&\n\t\t\t\tevent.data.$.clipboardData &&\n\t\t\t\tevent.data.$.clipboardData.items &&\n\t\t\t\tevent.data.$.clipboardData.items.length > 0\n\t\t\t) {\n\t\t\t\tlet pastedData = event.data.$.clipboardData.items[0];\n\n\t\t\t\tif (pastedData.type.indexOf('image') === 0) {\n\t\t\t\t\tlet imageFile = pastedData.getAsFile();\n\n\t\t\t\t\tthis._processFile(imageFile, event.listenerData.editor);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Prevents a native event.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _preventEvent\n\t\t * @param {DOM event} event The event to be prevented.\n\t\t * @protected\n\t\t */\n\t\t_preventEvent: function(event) {\n\t\t\tevent = new CKEDITOR.dom.event(event.data.$);\n\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t},\n\n\t\t/**\n\t\t * Processes an image file. The function creates an img element and sets as source\n\t\t * a Data URI, then fires an 'imageAdd' event via CKEditor's event system.\n\t\t *\n\t\t * @fires CKEDITOR.plugins.ae_addimages#imageAdd\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_addimages\n\t\t * @method _preventEvent\n\t\t * @param {DOM event} event The event to be prevented.\n\t\t * @protected\n\t\t */\n\t\t_processFile: function(file, editor) {\n\t\t\tlet reader = new FileReader();\n\n\t\t\treader.addEventListener('loadend', function() {\n\t\t\t\tlet bin = reader.result;\n\n\t\t\t\tlet el = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t\t'<img src=\"' + bin + '\">'\n\t\t\t\t);\n\n\t\t\t\teditor.insertElement(el);\n\n\t\t\t\tlet imageData = {\n\t\t\t\t\tel: el,\n\t\t\t\t\tfile: file,\n\t\t\t\t};\n\n\t\t\t\teditor.fire('imageAdd', imageData);\n\t\t\t});\n\n\t\t\treader.readAsDataURL(file);\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_autolink')) {\n\t\treturn;\n\t}\n\n\t// Disables the auto URL detection feature in IE, their lacks functionality:\n\t// They convert the links only on space. We do on space, comma, semicolon and Enter.\n\tif (/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/.test(navigator.userAgent)) {\n\t\tdocument.execCommand('AutoUrlDetect', false, false);\n\t}\n\n\tlet KEY_BACK = 8;\n\n\tlet KEY_COMMA = 188;\n\n\tlet KEY_ENTER = 13;\n\n\tlet KEY_SEMICOLON = 186;\n\n\tlet KEY_SPACE = 32;\n\n\tlet DELIMITERS = [KEY_COMMA, KEY_ENTER, KEY_SEMICOLON, KEY_SPACE];\n\n\tlet REGEX_LAST_WORD = /[^\\s]+/gim;\n\n\tlet REGEX_URL =\n\t\t'((([A - Za - z]{ 3, 9}: (?: \\\\/\\\\/)?)(?:[-;:&=\\\\+\\\\$,\\\\w]+@)?[A-Za-z0-9.-]+|(https?\\\\:\\\\/\\\\/|www.|[-;:&=.\\\\+\\\\$,\\\\w]+@)[A-Za-z0-9.-]+)((?:\\\\/[\\\\+~%\\\\/.\\\\w-_]*)?\\\\??(?:[-\\\\+=&;%@.\\\\w_]*)#?(?:[\\\\w]*))((.*):(\\\\d*)\\\\/?(.*))?)';\n\n\tlet REGEX_EMAIL = /[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}/i;\n\n\t/**\n\t * CKEditor plugin which automatically generates links when user types text which looks like URL.\n\t *\n\t * @class CKEDITOR.plugins.ae_autolink\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_autolink', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function registers the `keyup` event on the editing area.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\teditor.once(\n\t\t\t\t'contentDom',\n\t\t\t\tfunction() {\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'keyup',\n\t\t\t\t\t\tthis._onKeyUp,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\n\t\t\teditor.on(\n\t\t\t\t'paste',\n\t\t\t\tfunction(event) {\n\t\t\t\t\tif (event.data.method === 'paste') {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tevent.data.dataValue.indexOf('<') > -1 ||\n\t\t\t\t\t\t\tevent.data.dataValue.indexOf('&lt;') > -1\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tevent.data.dataValue.indexOf(\n\t\t\t\t\t\t\t\t\t'<u><font color=\"'\n\t\t\t\t\t\t\t\t) > -1\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tevent.data.dataValue = event.data.dataValue.replace(\n\t\t\t\t\t\t\t\t\t/<u><font color=\"#(.*?)\">|<\\/font><\\/u>/g,\n\t\t\t\t\t\t\t\t\t''\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet instance = this;\n\n\t\t\t\t\t\tevent.data.dataValue = event.data.dataValue.replace(\n\t\t\t\t\t\t\tRegExp(REGEX_URL, 'gim'),\n\t\t\t\t\t\t\tfunction(url) {\n\t\t\t\t\t\t\t\tif (instance._isValidURL(url)) {\n\t\t\t\t\t\t\t\t\tif (instance._isValidEmail(url)) {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t'<a href=\"mailto:' +\n\t\t\t\t\t\t\t\t\t\t\turl +\n\t\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\t\turl +\n\t\t\t\t\t\t\t\t\t\t\t'</a>'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t'<a href=\"' +\n\t\t\t\t\t\t\t\t\t\t\turl +\n\t\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\t\turl +\n\t\t\t\t\t\t\t\t\t\t\t'</a>'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Retrieves the last word introduced by the user. Reads from the current\n\t\t * caret position backwards until it finds the first white space.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _getLastWord\n\t\t * @protected\n\t\t * @return {String} The last word introduced by user\n\t\t */\n\t\t_getLastWord: function(editor) {\n\t\t\tlet range = editor.getSelection().getRanges()[0];\n\n\t\t\tlet offset = range.startOffset;\n\n\t\t\tlet previousText = '';\n\n\t\t\t// The user pressed Enter, so we have to look on the previous node\n\t\t\tif (this._currentKeyCode === KEY_ENTER) {\n\t\t\t\tlet previousNode = range.startContainer.getPrevious();\n\n\t\t\t\tlet lastChild;\n\n\t\t\t\tif (previousNode) {\n\t\t\t\t\t// If previous node is a SPACE, (it does not have 'getLast' method),\n\t\t\t\t\t// ignore it and find the previous text node\n\t\t\t\t\twhile (!previousNode.getLast) {\n\t\t\t\t\t\tpreviousNode = previousNode.getPrevious();\n\t\t\t\t\t}\n\n\t\t\t\t\tlastChild = previousNode.getLast();\n\n\t\t\t\t\t// Depending on the browser, the last child node may be a <BR>\n\t\t\t\t\t// (which does not have 'getText' method),\n\t\t\t\t\t// so ignore it and find the previous text node\n\t\t\t\t\twhile (lastChild && !lastChild.getText()) {\n\t\t\t\t\t\tlastChild = lastChild.getPrevious();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Check if the lastChild is already a link\n\t\t\t\tif (!(lastChild && lastChild.$.href)) {\n\t\t\t\t\tthis._startContainer = lastChild;\n\t\t\t\t\tpreviousText = lastChild ? lastChild.getText() : '';\n\t\t\t\t\tthis._offset = previousText.length;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._startContainer = range.startContainer;\n\n\t\t\t\t// Last character is the delimiter, ignore it\n\t\t\t\tpreviousText = this._startContainer\n\t\t\t\t\t.getText()\n\t\t\t\t\t.substring(0, offset - 1);\n\n\t\t\t\tthis._offset = offset - 1;\n\t\t\t}\n\n\t\t\tlet lastWord = '';\n\n\t\t\tlet match = previousText.match(REGEX_LAST_WORD);\n\n\t\t\tif (match) {\n\t\t\t\tlastWord = match.pop();\n\t\t\t}\n\n\t\t\treturn lastWord;\n\t\t},\n\n\t\t/**\n\t\t * Checks if the given link is a valid Email.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method isValidEmail\n\t\t * @param {String} link The email we want to know if it is a valid Email\n\t\t * @protected\n\t\t * @return {Boolean} Returns true if the email is a valid Email, false otherwise\n\t\t */\n\t\t_isValidEmail: function(email) {\n\t\t\treturn REGEX_EMAIL.test(email);\n\t\t},\n\n\t\t/**\n\t\t * Checks if the given link is a valid URL.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method isValidURL\n\t\t * @param {String} link The link we want to know if it is a valid URL\n\t\t * @protected\n\t\t * @return {Boolean} Returns true if the link is a valid URL, false otherwise\n\t\t */\n\t\t_isValidURL: function(link) {\n\t\t\treturn RegExp(REGEX_URL, 'i').test(link);\n\t\t},\n\n\t\t/**\n\t\t * Listens to the `keydown` event and if the keycode is `Backspace`, removes the previously\n\t\t * created link.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _onKeyDown\n\t\t * @param {EventFacade} event EventFacade object\n\t\t * @protected\n\t\t */\n\t\t_onKeyDown: function(event) {\n\t\t\tlet nativeEvent = event.data.$;\n\n\t\t\tlet editor = event.listenerData.editor;\n\n\t\t\tlet editable = editor.editable();\n\n\t\t\teditable.removeListener('keydown', this._onKeyDown);\n\n\t\t\tif (nativeEvent.keyCode === KEY_BACK) {\n\t\t\t\tevent.cancel();\n\t\t\t\tevent.data.preventDefault();\n\n\t\t\t\tthis._removeLink(editor);\n\t\t\t}\n\n\t\t\tthis._ckLink = null;\n\t\t},\n\n\t\t/**\n\t\t * Listens to the `Enter` and `Space` key events in order to check if the last word\n\t\t * introduced by the user should be replaced by a link element.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _onKeyUp\n\t\t * @param {EventFacade} event EventFacade object\n\t\t * @protected\n\t\t */\n\t\t_onKeyUp: function(event) {\n\t\t\tlet nativeEvent = event.data.$;\n\n\t\t\tthis._currentKeyCode = nativeEvent.keyCode;\n\n\t\t\tif (DELIMITERS.indexOf(this._currentKeyCode) !== -1) {\n\t\t\t\tlet editor = event.listenerData.editor;\n\n\t\t\t\tlet lastWord = this._getLastWord(editor);\n\n\t\t\t\tif (this._isValidURL(lastWord)) {\n\t\t\t\t\tthis._replaceContentByLink(editor, lastWord);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Replaces content by a link element.\n\t\t *\n\t\t * @fires CKEDITOR.plugins.ae_autolink#autolinkAdd\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _replaceContentByLink\n\t\t * @param {String} content The text that has to be replaced by an link element\n\t\t * @protected\n\t\t */\n\t\t_replaceContentByLink: function(editor, content) {\n\t\t\tlet range = editor.createRange();\n\t\t\tlet node = CKEDITOR.dom.element.get(this._startContainer);\n\t\t\tlet offset = this._offset;\n\n\t\t\t// Select the content, so CKEDITOR.Link can properly replace it\n\t\t\trange.setStart(node, offset - content.length);\n\t\t\trange.setEnd(node, offset);\n\t\t\trange.select();\n\n\t\t\tlet ckLink = new CKEDITOR.Link(editor);\n\t\t\tckLink.create(content);\n\t\t\tthis._ckLink = ckLink;\n\n\t\t\tlet linkNode = ckLink.getFromSelection();\n\t\t\teditor.fire('autolinkAdd', linkNode);\n\n\t\t\tthis._subscribeToKeyEvent(editor);\n\n\t\t\t// Now range is on the link and it is selected. We have to\n\t\t\t// return focus to the caret position.\n\t\t\trange = editor.getSelection().getRanges()[0];\n\n\t\t\t// If user pressed `Enter`, get the next editable node at position 0,\n\t\t\t// otherwise set the cursor at the next character of the link (the white space)\n\t\t\tif (this._currentKeyCode === KEY_ENTER) {\n\t\t\t\tlet nextEditableNode = range.getNextEditableNode();\n\n\t\t\t\trange.setStart(nextEditableNode, 0);\n\t\t\t\trange.setEnd(nextEditableNode, 0);\n\t\t\t} else {\n\t\t\t\tlet nextNode = range.getNextNode();\n\n\t\t\t\trange.setStart(nextNode, 1);\n\t\t\t\trange.setEnd(nextNode, 1);\n\t\t\t}\n\n\t\t\trange.select();\n\t\t},\n\n\t\t/**\n\t\t * Fired when a URL is detected in text and converted to a link.\n\t\t *\n\t\t * @event CKEDITOR.plugins.ae_autolink#autolinkAdd\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @param {CKEDITOR.dom.element} el Node of the created link.\n\t\t */\n\n\t\t/**\n\t\t * Removes the created link element, and replaces it by its text.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _removeLink\n\t\t * @protected\n\t\t */\n\t\t_removeLink: function(editor) {\n\t\t\tlet range = editor.getSelection().getRanges()[0];\n\t\t\tlet caretOffset = range.startOffset;\n\n\t\t\t// Select the link, so CKEDITOR.Link can properly remove it\n\t\t\tlet linkNode =\n\t\t\t\tthis._startContainer.getNext() || this._startContainer;\n\n\t\t\tlet newRange = editor.createRange();\n\t\t\tnewRange.setStart(linkNode, 0);\n\t\t\tnewRange.setEndAfter(linkNode);\n\t\t\tnewRange.select();\n\n\t\t\tthis._ckLink.remove();\n\n\t\t\t// Return focus to the caret position\n\t\t\trange.setEnd(range.startContainer, caretOffset);\n\t\t\trange.setStart(range.startContainer, caretOffset);\n\n\t\t\trange.select();\n\t\t},\n\n\t\t/**\n\t\t * Subscribe to a key event of the editable aria.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolink\n\t\t * @method _subscribeToKeyEvent\n\t\t * @protected\n\t\t */\n\t\t_subscribeToKeyEvent: function(editor) {\n\t\t\tlet editable = editor.editable();\n\n\t\t\t// Change the priority of keydown listener - 1 means the highest priority.\n\t\t\t// In Chrome on pressing `Enter` the listener is not being invoked.\n\t\t\t// See http://dev.ckeditor.com/ticket/11861 for more information.\n\t\t\teditable.attachListener(\n\t\t\t\teditable,\n\t\t\t\t'keydown',\n\t\t\t\tthis._onKeyDown,\n\t\t\t\tthis,\n\t\t\t\t{\n\t\t\t\t\teditor: editor,\n\t\t\t\t},\n\t\t\t\t1\n\t\t\t);\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_autolist')) {\n\t\treturn;\n\t}\n\n\tlet KEY_BACK = 8;\n\n\tlet KEY_SPACE = 32;\n\n\tlet DEFAULT_CONFIG = [\n\t\t{\n\t\t\tregex: /^\\*$/,\n\t\t\ttype: 'bulletedlist',\n\t\t},\n\t\t{\n\t\t\tregex: /^1\\.$/,\n\t\t\ttype: 'numberedlist',\n\t\t},\n\t];\n\n\t/**\n\t * CKEditor plugin which automatically generates ordered/unordered list when user types text which looks like a list.\n\t *\n\t * @class CKEDITOR.plugins.ae_autolist\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_autolist', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKeditor plugin lifecycle.\n\t\t * The function registers the `keydown` event on the content editing area.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolist\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\teditor.once(\n\t\t\t\t'contentDom',\n\t\t\t\tfunction() {\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'keydown',\n\t\t\t\t\t\tthis._onKeyDown,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Checks for pressing the `Backspace` key in order to undo the list creation.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolist\n\t\t * @method _checkForBackspaceAndUndo\n\t\t * @param {Event} event Event object\n\t\t * @protected\n\t\t */\n\t\t_checkForBackspaceAndUndo: function(event) {\n\t\t\tlet editor = event.listenerData.editor;\n\n\t\t\tlet nativeEvent = event.data.$;\n\n\t\t\tlet editable = editor.editable();\n\n\t\t\teditable.removeListener('keydown', this._checkForBackspaceAndUndo);\n\n\t\t\tif (nativeEvent.keyCode === KEY_BACK) {\n\t\t\t\teditor.execCommand('undo');\n\t\t\t\teditor.insertHtml(event.listenerData.bullet + '&nbsp;');\n\t\t\t\tevent.data.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Checks current line to find match with MATCHES object to create OL or UL.\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolist\n\t\t * @method _checkLine\n\t\t * @param {editor} Editor object\n\t\t * @protected\n\t\t * @return {Object|null} Returns an object which contains the detected list config if any\n\t\t */\n\t\t_getListConfig: function(editor) {\n\t\t\tlet configRegex = editor.config.autolist || DEFAULT_CONFIG;\n\n\t\t\tlet range = editor.getSelection().getRanges()[0];\n\n\t\t\tlet textContainer = range.endContainer.getText();\n\n\t\t\tlet bullet = textContainer.substring(0, range.startOffset);\n\n\t\t\tlet text = textContainer.substring(\n\t\t\t\trange.startOffset,\n\t\t\t\ttextContainer.length\n\t\t\t);\n\n\t\t\tlet index = 0;\n\n\t\t\tlet regexLen = configRegex.length;\n\n\t\t\tlet autolistCfg = null;\n\n\t\t\twhile (!autolistCfg && regexLen > index) {\n\t\t\t\tlet regexItem = configRegex[index];\n\n\t\t\t\tif (regexItem.regex.test(bullet)) {\n\t\t\t\t\tautolistCfg = {\n\t\t\t\t\t\tbullet: bullet,\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\ttype: regexItem.type,\n\t\t\t\t\t};\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\treturn autolistCfg;\n\t\t},\n\n\t\t/**\n\t\t * Create list with different types: Bulleted or Numbered list\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolist\n\t\t * @method _createList\n\t\t * @param {Object} listConfig Object that contains bullet, text and type for creating the list\n\t\t * @protected\n\t\t */\n\t\t_createList: function(listConfig) {\n\t\t\tlet editor = listConfig.editor;\n\n\t\t\tlet range = editor.getSelection().getRanges()[0];\n\n\t\t\trange.endContainer.setText(listConfig.text);\n\t\t\teditor.execCommand(listConfig.type);\n\n\t\t\tlet editable = editor.editable();\n\n\t\t\t// Subscribe to keydown in order to check if the next key press is `Backspace`.\n\t\t\t// If so, the creation of the list will be discarded.\n\t\t\teditable.attachListener(\n\t\t\t\teditable,\n\t\t\t\t'keydown',\n\t\t\t\tthis._checkForBackspaceAndUndo,\n\t\t\t\tthis,\n\t\t\t\t{\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tbullet: listConfig.bullet,\n\t\t\t\t},\n\t\t\t\t1\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Listens to the `Space` key events to check if the last word\n\t\t * introduced by the user should be replaced by a list (OL or UL)\n\t\t *\n\t\t * @instance\n\t\t * @memberof CKEDITOR.plugins.ae_autolist\n\t\t * @method _onKeyDown\n\t\t * @param {Event} event Event object\n\t\t * @protected\n\t\t */\n\t\t_onKeyDown: function(event) {\n\t\t\tlet nativeEvent = event.data.$;\n\n\t\t\tif (nativeEvent.keyCode === KEY_SPACE) {\n\t\t\t\tlet listConfig = this._getListConfig(event.listenerData.editor);\n\n\t\t\t\tif (listConfig) {\n\t\t\t\t\tevent.data.preventDefault();\n\t\t\t\t\tthis._createList(listConfig);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t});\n})();\n","/**\n * CKEditor plugin: Dragable image resizing\n * https://github.com/sstur/ck-dragresize\n * - Shows semi-transparent overlay while resizing\n * - Enforces Aspect Ratio (unless holding shift)\n * - Snap to size of other images in editor\n * - Escape while dragging cancels resize\n */\n(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_dragresize')) {\n\t\treturn;\n\t}\n\n\tlet IMAGE_HANDLES = {\n\t\tboth: ['tl', 'tm', 'tr', 'lm', 'rm', 'bl', 'bm', 'br'],\n\t\theight: ['tl', 'tm', 'tr', 'bl', 'bm', 'br'],\n\t\tscale: ['tl', 'tr', 'bl', 'br'],\n\t\twidth: ['tl', 'tr', 'lm', 'rm', 'bl', 'br'],\n\t};\n\n\tlet POSITION_ELEMENT_FN = {\n\t\tbl: function(handle, left, top, box) {\n\t\t\tpositionElement(handle, -3 + left, box.height - 4 + top);\n\t\t},\n\t\tbm: function(handle, left, top, box) {\n\t\t\tpositionElement(\n\t\t\t\thandle,\n\t\t\t\tMath.round(box.width / 2) - 3 + left,\n\t\t\t\tbox.height - 4 + top\n\t\t\t);\n\t\t},\n\t\tbr: function(handle, left, top, box) {\n\t\t\tpositionElement(handle, box.width - 4 + left, box.height - 4 + top);\n\t\t},\n\t\tlm: function(handle, left, top, box) {\n\t\t\tpositionElement(\n\t\t\t\thandle,\n\t\t\t\t-3 + left,\n\t\t\t\tMath.round(box.height / 2) - 3 + top\n\t\t\t);\n\t\t},\n\t\ttl: function(handle, left, top, _box) {\n\t\t\tpositionElement(handle, left - 3, top - 3);\n\t\t},\n\t\ttm: function(handle, left, top, box) {\n\t\t\tpositionElement(\n\t\t\t\thandle,\n\t\t\t\tMath.round(box.width / 2) - 3 + left,\n\t\t\t\t-3 + top\n\t\t\t);\n\t\t},\n\t\ttr: function(handle, left, top, box) {\n\t\t\tpositionElement(handle, box.width - 4 + left, -3 + top);\n\t\t},\n\t\trm: function(handle, left, top, box) {\n\t\t\tpositionElement(\n\t\t\t\thandle,\n\t\t\t\tbox.width - 4 + left,\n\t\t\t\tMath.round(box.height / 2) - 3 + top\n\t\t\t);\n\t\t},\n\t};\n\n\tlet IMAGE_SNAP_TO_SIZE = 7;\n\n\tlet isFirefox = 'MozAppearance' in document.documentElement.style;\n\n\tlet isWebKit = 'WebkitAppearance' in document.documentElement.style;\n\n\tlet enablePlugin = isWebKit || isFirefox;\n\n\tif (enablePlugin) {\n\t\t// CSS is added in a compressed form\n\t\tCKEDITOR.addCss(\n\t\t\t'img::selection{color:rgba(0,0,0,0)}img.ckimgrsz{outline:1px dashed #000}#ckimgrsz{position:absolute;width:0;height:0;cursor:default;z-index:10001}#ckimgrsz span{display:none;position:absolute;top:0;left:0;width:0;height:0;background-size:100% 100%;opacity:.65;outline:1px dashed #000}#ckimgrsz i{position:absolute;display:block;width:5px;height:5px;background:#fff;border:1px solid #000}#ckimgrsz i.active,#ckimgrsz i:hover{background:#000}#ckimgrsz i.br,#ckimgrsz i.tl{cursor:nwse-resize}#ckimgrsz i.bm,#ckimgrsz i.tm{cursor:ns-resize}#ckimgrsz i.bl,#ckimgrsz i.tr{cursor:nesw-resize}#ckimgrsz i.lm,#ckimgrsz i.rm{cursor:ew-resize}body.dragging-br,body.dragging-br *,body.dragging-tl,body.dragging-tl *{cursor:nwse-resize!important}body.dragging-bm,body.dragging-bm *,body.dragging-tm,body.dragging-tm *{cursor:ns-resize!important}body.dragging-bl,body.dragging-bl *,body.dragging-tr,body.dragging-tr *{cursor:nesw-resize!important}body.dragging-lm,body.dragging-lm *,body.dragging-rm,body.dragging-rm *{cursor:ew-resize!important}'\n\t\t);\n\t}\n\n\t/**\n\t * Initializes the plugin\n\t */\n\tCKEDITOR.plugins.add('ae_dragresize', {\n\t\tonLoad: function() {\n\t\t\tif (!enablePlugin) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t},\n\t\tinit: function(editor) {\n\t\t\tif (!enablePlugin) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditor.once('contentDom', function(_evt) {\n\t\t\t\tinit(editor);\n\t\t\t});\n\t\t},\n\t});\n\n\tfunction init(editor) {\n\t\tlet window = editor.window.$;\n\n\t\tlet document = editor.document.$;\n\n\t\tif (isFirefox) {\n\t\t\t// Disable the native image resizing\n\t\t\tdocument.execCommand('enableObjectResizing', false, false);\n\t\t}\n\n\t\tlet snapToSize =\n\t\t\ttypeof IMAGE_SNAP_TO_SIZE === 'undefined'\n\t\t\t\t? null\n\t\t\t\t: IMAGE_SNAP_TO_SIZE;\n\n\t\teditor.config.imageScaleResize =\n\t\t\teditor.config.imageScaleResize || 'both';\n\n\t\tlet resizer = new Resizer(editor, {\n\t\t\timageScaleResize: editor.config.imageScaleResize,\n\t\t\tsnapToSize: snapToSize,\n\t\t});\n\n\t\tlet mouseDownListener = function(e) {\n\t\t\tif (resizer.isHandle(e.target)) {\n\t\t\t\tresizer.initDrag(e);\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener('mousedown', mouseDownListener, false);\n\n\t\tfunction selectionChange() {\n\t\t\tlet selection = editor.getSelection();\n\n\t\t\tif (!selection) return;\n\t\t\t// If an element is selected and that element is an IMG\n\t\t\tif (\n\t\t\t\tselection.getType() !== CKEDITOR.SELECTION_NONE &&\n\t\t\t\tselection.getStartElement().is('img')\n\t\t\t) {\n\t\t\t\t// And we're not right or middle clicking on the image\n\t\t\t\tif (\n\t\t\t\t\t!window.event ||\n\t\t\t\t\t!window.event.button ||\n\t\t\t\t\twindow.event.button === 0\n\t\t\t\t) {\n\t\t\t\t\tresizer.show(selection.getStartElement().$);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresizer.hide();\n\t\t\t}\n\t\t}\n\n\t\teditor.on('selectionChange', selectionChange);\n\n\t\teditor.on('getData', function(e) {\n\t\t\tlet html = e.data.dataValue || '';\n\t\t\thtml = html.replace(/<div id=\"ckimgrsz\"([\\s\\S]*?)<\\/div>/i, '');\n\t\t\thtml = html.replace(/\\b(ckimgrsz)\\b/g, '');\n\t\t\te.data.dataValue = html;\n\t\t});\n\n\t\teditor.on('beforeUndoImage', function() {\n\t\t\t// Remove the handles before undo images are saved\n\t\t\tresizer.hide();\n\t\t});\n\n\t\teditor.on('afterUndoImage', function() {\n\t\t\t// Restore the handles after undo images are saved\n\t\t\tselectionChange();\n\t\t});\n\n\t\teditor.on('blur', function() {\n\t\t\t// Remove the handles when editor loses focus\n\t\t\tresizer.hide();\n\t\t});\n\n\t\teditor.on('beforeModeUnload', function self() {\n\t\t\teditor.removeListener('beforeModeUnload', self);\n\t\t\tresizer.hide();\n\t\t});\n\n\t\teditor.on('destroy', function() {\n\t\t\tlet resizeElement = document.getElementById('ckimgrsz');\n\n\t\t\tif (resizeElement) {\n\t\t\t\tresizeElement.remove();\n\t\t\t}\n\n\t\t\tif (isFirefox) {\n\t\t\t\tdocument.execCommand('enableObjectResizing', false, true);\n\t\t\t}\n\n\t\t\tdocument.removeEventListener('mousedown', mouseDownListener);\n\t\t});\n\n\t\t// Update the selection when the browser window is resized\n\t\tlet resizeTimeout;\n\t\teditor.window.on('resize', function() {\n\t\t\t// Cancel any resize waiting to happen\n\t\t\tclearTimeout(resizeTimeout);\n\t\t\t// Delay resize to \"debounce\"\n\t\t\tresizeTimeout = setTimeout(selectionChange, 50);\n\t\t});\n\t}\n\n\tfunction Resizer(editor, cfg) {\n\t\tthis.editor = editor;\n\t\tthis.window = editor.window.$;\n\t\tthis.document = editor.document.$;\n\t\tthis.cfg = cfg || {};\n\t\tthis.init();\n\t}\n\n\tResizer.prototype = {\n\t\tinit: function() {\n\t\t\tlet instance = this;\n\n\t\t\tlet container = (this.container = this.document.createElement(\n\t\t\t\t'div'\n\t\t\t));\n\n\t\t\tcontainer.id = 'ckimgrsz';\n\t\t\tthis.preview = this.document.createElement('span');\n\t\t\tcontainer.appendChild(this.preview);\n\n\t\t\tlet handles = (this.handles = {});\n\n\t\t\tIMAGE_HANDLES[this.cfg.imageScaleResize].forEach(function(\n\t\t\t\thandleName\n\t\t\t) {\n\t\t\t\thandles[handleName] = instance.handles[\n\t\t\t\t\thandleName\n\t\t\t\t] = instance.createHandle(handleName);\n\t\t\t});\n\n\t\t\tfor (let n in handles) {\n\t\t\t\tif (handles.hasOwnProperty(n)) {\n\t\t\t\t\tcontainer.appendChild(handles[n]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreateHandle: function(name) {\n\t\t\tlet el = this.document.createElement('i');\n\t\t\tel.classList.add(name);\n\t\t\treturn el;\n\t\t},\n\t\tisHandle: function(el) {\n\t\t\tlet handles = this.handles;\n\t\t\tfor (let n in handles) {\n\t\t\t\tif (handles[n] === el) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tshow: function(el) {\n\t\t\tlet uiNode = this.editor.config.uiNode;\n\n\t\t\tlet scrollTop = uiNode ? uiNode.scrollTop : 0;\n\n\t\t\tthis.el = el;\n\t\t\tif (this.cfg.snapToSize) {\n\t\t\t\tthis.otherImages = toArray(\n\t\t\t\t\tthis.document.getElementsByTagName('img')\n\t\t\t\t);\n\t\t\t\tthis.otherImages.splice(this.otherImages.indexOf(el), 1);\n\t\t\t}\n\t\t\tlet box = (this.box = getBoundingBox(this.window, el));\n\t\t\tpositionElement(this.container, box.left, box.top + scrollTop);\n\n\t\t\tuiNode = uiNode || document.body;\n\n\t\t\tuiNode.appendChild(this.container);\n\n\t\t\tthis.el.classList.add('ckimgrsz');\n\t\t\tthis.showHandles();\n\t\t},\n\t\thide: function() {\n\t\t\t// Remove class from all img.ckimgrsz\n\t\t\tlet elements = this.document.getElementsByClassName('ckimgrsz');\n\t\t\tfor (let i = 0; i < elements.length; ++i) {\n\t\t\t\telements[i].classList.remove('ckimgrsz');\n\t\t\t}\n\t\t\tthis.hideHandles();\n\t\t\tif (this.container.parentNode) {\n\t\t\t\tthis.container.parentNode.removeChild(this.container);\n\t\t\t}\n\t\t},\n\t\tinitDrag: function(e) {\n\t\t\tif (e.button !== 0) {\n\t\t\t\t// right-click or middle-click\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet resizer = this;\n\t\t\tlet drag = new DragEvent(this.window, this.document);\n\t\t\tdrag.onStart = function() {\n\t\t\t\tresizer.showPreview();\n\t\t\t\tresizer.isDragging = true;\n\t\t\t\tresizer.editor.getSelection().lock();\n\t\t\t};\n\t\t\tdrag.onDrag = function() {\n\t\t\t\tresizer.calculateSize(this);\n\t\t\t\tresizer.updatePreview();\n\t\t\t\tlet box = resizer.previewBox;\n\t\t\t\tresizer.updateHandles(box, box.left, box.top);\n\t\t\t};\n\t\t\tdrag.onRelease = function() {\n\t\t\t\tresizer.isDragging = false;\n\t\t\t\tresizer.hidePreview();\n\t\t\t\tresizer.hide();\n\t\t\t\tresizer.editor.getSelection().unlock();\n\t\t\t\t// Save an undo snapshot before the image is permanently changed\n\t\t\t\tresizer.editor.fire('saveSnapshot');\n\t\t\t};\n\t\t\tdrag.onComplete = function() {\n\t\t\t\tresizer.resizeComplete();\n\t\t\t\t// Save another snapshot after the image is changed\n\t\t\t\tresizer.editor.fire('saveSnapshot');\n\t\t\t};\n\t\t\tdrag.start(e);\n\t\t},\n\t\tupdateHandles: function(box, left, top) {\n\t\t\tleft = left || 0;\n\t\t\ttop = top || 0;\n\t\t\tlet handles = this.handles;\n\n\t\t\tfor (let handle in handles) {\n\t\t\t\tif (handles.hasOwnProperty(handle)) {\n\t\t\t\t\tPOSITION_ELEMENT_FN[handle](\n\t\t\t\t\t\thandles[handle],\n\t\t\t\t\t\tleft,\n\t\t\t\t\t\ttop,\n\t\t\t\t\t\tbox\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowHandles: function() {\n\t\t\tlet handles = this.handles;\n\t\t\tthis.updateHandles(this.box);\n\t\t\tfor (let n in handles) {\n\t\t\t\tif (handles.hasOwnProperty(n)) {\n\t\t\t\t\thandles[n].style.display = 'block';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thideHandles: function() {\n\t\t\tlet handles = this.handles;\n\t\t\tfor (let n in handles) {\n\t\t\t\tif (handles.hasOwnProperty(n)) {\n\t\t\t\t\thandles[n].style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tshowPreview: function() {\n\t\t\tthis.preview.style.backgroundImage = 'url(\"' + this.el.src + '\")';\n\t\t\tthis.calculateSize();\n\t\t\tthis.updatePreview();\n\t\t\tthis.preview.style.display = 'block';\n\t\t},\n\t\tupdatePreview: function() {\n\t\t\tlet box = this.previewBox;\n\t\t\tpositionElement(this.preview, box.left, box.top);\n\t\t\tthis.preview.style.width = this.previewBox.width + 'px';\n\t\t\tthis.preview.style.height = this.previewBox.height + 'px';\n\t\t},\n\t\thidePreview: function() {\n\t\t\tlet box = getBoundingBox(this.window, this.preview);\n\t\t\tthis.result = {\n\t\t\t\twidth: box.width,\n\t\t\t\theight: box.height,\n\t\t\t};\n\t\t\tthis.preview.style.display = 'none';\n\t\t},\n\t\tcalculateSize: function(data) {\n\t\t\tlet box = (this.previewBox = {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0,\n\t\t\t\twidth: this.box.width,\n\t\t\t\theight: this.box.height,\n\t\t\t});\n\n\t\t\tif (!data) return;\n\n\t\t\tlet attr = data.target.className;\n\n\t\t\tif (~attr.indexOf('r')) {\n\t\t\t\tbox.width = Math.max(32, this.box.width + data.delta.x);\n\t\t\t}\n\t\t\tif (~attr.indexOf('b')) {\n\t\t\t\tbox.height = Math.max(32, this.box.height + data.delta.y);\n\t\t\t}\n\t\t\tif (~attr.indexOf('l')) {\n\t\t\t\tbox.width = Math.max(32, this.box.width - data.delta.x);\n\t\t\t}\n\t\t\tif (~attr.indexOf('t')) {\n\t\t\t\tbox.height = Math.max(32, this.box.height - data.delta.y);\n\t\t\t}\n\t\t\t// if dragging corner, enforce aspect ratio (unless shift key is being held)\n\t\t\tif (attr.indexOf('m') < 0 && !data.keys.shift) {\n\t\t\t\tlet ratio = this.box.width / this.box.height;\n\t\t\t\tif (box.width / box.height > ratio) {\n\t\t\t\t\tbox.height = Math.round(box.width / ratio);\n\t\t\t\t} else {\n\t\t\t\t\tbox.width = Math.round(box.height * ratio);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet snapToSize = this.cfg.snapToSize;\n\n\t\t\tif (snapToSize) {\n\t\t\t\tlet others = this.otherImages;\n\t\t\t\tfor (let i = 0; i < others.length; i++) {\n\t\t\t\t\tlet other = getBoundingBox(this.window, others[i]);\n\t\t\t\t\tif (\n\t\t\t\t\t\tMath.abs(box.width - other.width) <= snapToSize &&\n\t\t\t\t\t\tMath.abs(box.height - other.height) <= snapToSize\n\t\t\t\t\t) {\n\t\t\t\t\t\tbox.width = other.width;\n\t\t\t\t\t\tbox.height = other.height;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// recalculate left or top position\n\t\t\tif (~attr.indexOf('l')) {\n\t\t\t\tbox.left = this.box.width - box.width;\n\t\t\t}\n\t\t\tif (~attr.indexOf('t')) {\n\t\t\t\tbox.top = this.box.height - box.height;\n\t\t\t}\n\t\t},\n\t\tresizeComplete: function() {\n\t\t\tresizeElement.call(\n\t\t\t\tthis,\n\t\t\t\tthis.el,\n\t\t\t\tthis.result.width,\n\t\t\t\tthis.result.height\n\t\t\t);\n\t\t},\n\t};\n\n\tfunction DragEvent(window, document) {\n\t\tthis.window = window;\n\t\tthis.document = document;\n\t\tthis.events = {\n\t\t\tmousemove: bind(this.mousemove, this),\n\t\t\tkeydown: bind(this.keydown, this),\n\t\t\tmouseup: bind(this.mouseup, this),\n\t\t};\n\t}\n\n\tDragEvent.prototype = {\n\t\tstart: function(e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.target = e.target;\n\t\t\tthis.attr = e.target.className;\n\t\t\tthis.startPos = {\n\t\t\t\tx: e.clientX,\n\t\t\t\ty: e.clientY,\n\t\t\t};\n\t\t\tthis.update(e);\n\t\t\tlet events = this.events;\n\t\t\tthis.document.addEventListener(\n\t\t\t\t'mousemove',\n\t\t\t\tevents.mousemove,\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tthis.document.addEventListener('keydown', events.keydown, false);\n\t\t\tthis.document.addEventListener('mouseup', events.mouseup, false);\n\t\t\tthis.document.body.classList.add('dragging-' + this.attr);\n\t\t\tthis.onStart && this.onStart();\n\t\t},\n\t\tupdate: function(e) {\n\t\t\tthis.currentPos = {\n\t\t\t\tx: e.clientX,\n\t\t\t\ty: e.clientY,\n\t\t\t};\n\t\t\tthis.delta = {\n\t\t\t\tx: e.clientX - this.startPos.x,\n\t\t\t\ty: e.clientY - this.startPos.y,\n\t\t\t};\n\t\t\tthis.keys = {\n\t\t\t\tshift: e.shiftKey,\n\t\t\t\tctrl: e.ctrlKey,\n\t\t\t\talt: e.altKey,\n\t\t\t};\n\t\t},\n\t\tmousemove: function(e) {\n\t\t\tthis.update(e);\n\t\t\tthis.onDrag && this.onDrag();\n\t\t\tif (e.which === 0) {\n\t\t\t\t// mouse button released outside window; mouseup wasn't fired (Chrome)\n\t\t\t\tthis.mouseup(e);\n\t\t\t}\n\t\t},\n\t\tkeydown: function(e) {\n\t\t\t// escape key cancels dragging\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tthis.release();\n\t\t\t}\n\t\t},\n\t\tmouseup: function(e) {\n\t\t\tthis.update(e);\n\t\t\tthis.release();\n\t\t\tthis.onComplete && this.onComplete();\n\t\t},\n\t\trelease: function() {\n\t\t\tthis.document.body.classList.remove('dragging-' + this.attr);\n\t\t\tlet events = this.events;\n\t\t\tthis.document.removeEventListener(\n\t\t\t\t'mousemove',\n\t\t\t\tevents.mousemove,\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tthis.document.removeEventListener('keydown', events.keydown, false);\n\t\t\tthis.document.removeEventListener('mouseup', events.mouseup, false);\n\t\t\tthis.onRelease && this.onRelease();\n\t\t},\n\t};\n\n\t// helper functions\n\tfunction toArray(obj) {\n\t\tlet len = obj.length;\n\n\t\tlet arr = new Array(len);\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tarr[i] = obj[i];\n\t\t}\n\t\treturn arr;\n\t}\n\n\tfunction bind(fn, ctx) {\n\t\tif (fn.bind) {\n\t\t\treturn fn.bind(ctx);\n\t\t}\n\t\treturn function(...args) {\n\t\t\tfn.apply(ctx, args);\n\t\t};\n\t}\n\n\tfunction positionElement(el, left, top) {\n\t\tel.style.left = String(left) + 'px';\n\t\tel.style.top = String(top) + 'px';\n\t}\n\n\tfunction resizeElement(el, width, height) {\n\t\tlet imageScaleResize = this.editor.config.imageScaleResize;\n\t\tif (imageScaleResize === 'both') {\n\t\t\tel.style.width = String(width) + 'px';\n\t\t\tel.style.height = String(height) + 'px';\n\t\t} else if (\n\t\t\timageScaleResize === 'width' ||\n\t\t\timageScaleResize === 'scale'\n\t\t) {\n\t\t\tel.style.height = 'auto';\n\t\t\tel.style.width = String(width) + 'px';\n\t\t} else if (imageScaleResize === 'height') {\n\t\t\tel.style.height = String(height) + 'px';\n\t\t\tel.style.width = 'auto';\n\t\t}\n\t}\n\n\tfunction getBoundingBox(window, el) {\n\t\tlet rect = el.getBoundingClientRect();\n\t\treturn {\n\t\t\tleft: rect.left + window.pageXOffset,\n\t\t\ttop: rect.top + window.pageYOffset,\n\t\t\twidth: rect.width,\n\t\t\theight: rect.height,\n\t\t};\n\t}\n})();\n","/**\n * CKEditor plugin: Image2\n * - Show gripper to resize images on IE\n */\n(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_dragresize_ie')) {\n\t\treturn;\n\t}\n\n\tlet alignmentsObj = {\n\t\tcenter: 1,\n\t\tleft: 0,\n\t\tright: 2,\n\t};\n\n\t/*\n\t * Set cursor css depend on imageScaleResize config\n\t **/\n\n\tlet cursor = {\n\t\tboth: 'nwse-resize',\n\t\theight: 'ns-resize',\n\t\tscale: 'nwse-resize',\n\t\twidth: 'ew-resize',\n\t};\n\n\tlet regexPercent = /^\\s*(\\d+%)\\s*$/i;\n\n\tlet template = '<img alt=\"\" src=\"\" />';\n\n\tCKEDITOR.plugins.add('ae_dragresize_ie', {\n\t\thidpi: true,\n\n\t\ticons: 'image',\n\n\t\tinit: function(editor) {\n\t\t\tlet image = widgetDef(editor);\n\n\t\t\t// Register the widget.\n\t\t\teditor.widgets.add('image', image);\n\t\t},\n\n\t\tonLoad: function() {\n\t\t\tCKEDITOR.addCss(\n\t\t\t\t'.cke_image_resizer_nwse-resize{' +\n\t\t\t\t\t'cursor: nwse-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer_ns-resize{' +\n\t\t\t\t\t'cursor: ns-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer_nwse-resize{' +\n\t\t\t\t\t'cursor: nwse-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer_ew-resize{' +\n\t\t\t\t\t'cursor: ew-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_nocaption{' +\n\t\t\t\t\t// This is to remove unwanted space so resize\n\t\t\t\t\t// wrapper is displayed property.\n\t\t\t\t\t'line-height:0' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer{' +\n\t\t\t\t\t'display:none;' +\n\t\t\t\t\t'position:absolute;' +\n\t\t\t\t\t'width:10px;' +\n\t\t\t\t\t'height:10px;' +\n\t\t\t\t\t'bottom:-5px;' +\n\t\t\t\t\t'right:-5px;' +\n\t\t\t\t\t'background:#000;' +\n\t\t\t\t\t'outline:1px solid #fff;' +\n\t\t\t\t\t// Prevent drag handler from being misplaced (#11207).\n\t\t\t\t\t'line-height:0;' +\n\t\t\t\t\t'cursor:nwse-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer_wrapper{' +\n\t\t\t\t\t'position:relative;' +\n\t\t\t\t\t'display:inline-block;' +\n\t\t\t\t\t'line-height:0;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_widget_wrapper:hover .cke_image_resizer,' +\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizing{' +\n\t\t\t\t\t'display:block' +\n\t\t\t\t\t'}'\n\t\t\t);\n\t\t},\n\n\t\trequires: 'widget',\n\t});\n\n\t// Widget states (forms) depending on alignment and configuration.\n\t//\n\t// Non-captioned widget (inline styles)\n\t// \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n\t// \t\t│Align │Internal form                  │Data                         │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│none  │<wrapper>                      │<img />                      │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│left  │<wrapper style=”float:left”>   │<img style=”float:left” />   │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│center│<wrapper>                      │<p style=”text-align:center”>│\n\t// \t\t│      │ <p style=”text-align:center”> │  <img />                    │\n\t// \t\t│      │   <img />                     │</p>                         │\n\t// \t\t│      │ </p>                          │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│right │<wrapper style=”float:right”>  │<img style=”float:right” />  │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n\t//\n\t// Non-captioned widget (config.image2_alignClasses defined)\n\t// \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n\t// \t\t│Align │Internal form                  │Data                         │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│none  │<wrapper>                      │<img />                      │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│left  │<wrapper class=”left”>         │<img class=”left” />         │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│center│<wrapper>                      │<p class=”center”>           │\n\t// \t\t│      │ <p class=”center”>            │ <img />                     │\n\t// \t\t│      │   <img />                     │</p>                         │\n\t// \t\t│      │ </p>                          │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│right │<wrapper class=”right”>        │<img class=”right” />        │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n\t//\n\t// Captioned widget (inline styles)\n\t// \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n\t// \t\t│Align │Internal form                           │Data                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│none  │<wrapper>                               │<figure />                              │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│left  │<wrapper style=”float:left”>            │<figure style=”float:left” />           │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│center│<wrapper style=”text-align:center”>     │<div style=”text-align:center”>         │\n\t// \t\t│      │ <figure style=”display:inline-block” />│ <figure style=”display:inline-block” />│\n\t// \t\t│      │</wrapper>                              │</p>                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│right │<wrapper style=”float:right”>           │<figure style=”float:right” />          │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n\t//\n\t// Captioned widget (config.image2_alignClasses defined)\n\t// \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n\t// \t\t│Align │Internal form                           │Data                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│none  │<wrapper>                               │<figure />                              │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│left  │<wrapper class=”left”>                  │<figure class=”left” />                 │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│center│<wrapper class=”center”>                │<div class=”center”>                    │\n\t// \t\t│      │ <figure />                             │ <figure />                             │\n\t// \t\t│      │</wrapper>                              │</p>                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│right │<wrapper class=”right”>                 │<figure class=”right” />                │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction widgetDef(editor) {\n\t\teditor.config.imageScaleResize =\n\t\t\teditor.config.imageScaleResize || 'both';\n\n\t\teditor.on('imageAdd', function(imageData) {\n\t\t\teditor.widgets.initOn(imageData.data.el, 'image');\n\t\t});\n\n\t\tlet alignClasses = editor.config.image2_alignClasses;\n\n\t\tlet captionedClass = editor.config.image2_captionedClass;\n\n\t\treturn {\n\t\t\tinit: function() {\n\t\t\t\tlet helpers = CKEDITOR.plugins.image2;\n\n\t\t\t\tlet image = this.parts.image;\n\n\t\t\t\tlet data = {\n\t\t\t\t\talt: image.getAttribute('alt') || '',\n\t\t\t\t\thasCaption: !!this.parts.caption,\n\t\t\t\t\theight: image.getAttribute('height') || '',\n\t\t\t\t\t// Lock ratio is on by default (#10833).\n\t\t\t\t\tlock: this.ready\n\t\t\t\t\t\t? helpers.checkHasNaturalRatio(image)\n\t\t\t\t\t\t: true,\n\t\t\t\t\tsrc: image.getAttribute('src'),\n\t\t\t\t\twidth: image.getAttribute('width') || '',\n\t\t\t\t};\n\n\t\t\t\t// If we used 'a' in widget#parts definition, it could happen that\n\t\t\t\t// selected element is a child of widget.parts#caption. Since there's no clever\n\t\t\t\t// way to solve it with CSS selectors, it's done like that. (#11783).\n\t\t\t\tlet link = image.getAscendant('a');\n\n\t\t\t\tif (link && this.wrapper.contains(link)) {\n\t\t\t\t\tthis.parts.link = link;\n\t\t\t\t}\n\n\t\t\t\t// Depending on configuration, read style/class from element and\n\t\t\t\t// then remove it. Removed style/class will be set on wrapper in #data listener.\n\t\t\t\t// Note: Center alignment is detected during upcast, so only left/right cases\n\t\t\t\t// are checked below.\n\t\t\t\tif (!data.align) {\n\t\t\t\t\tlet alignElement = data.hasCaption ? this.element : image;\n\n\t\t\t\t\t// Read the initial left/right alignment from the class set on element.\n\t\t\t\t\tif (alignClasses) {\n\t\t\t\t\t\tif (alignElement.hasClass(alignClasses[0])) {\n\t\t\t\t\t\t\tdata.align = 'left';\n\t\t\t\t\t\t} else if (alignElement.hasClass(alignClasses[2])) {\n\t\t\t\t\t\t\tdata.align = 'right';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (data.align) {\n\t\t\t\t\t\t\talignElement.removeClass(\n\t\t\t\t\t\t\t\talignClasses[alignmentsObj[data.align]]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata.align = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Read initial float style from figure/image and then remove it.\n\t\t\t\t\telse {\n\t\t\t\t\t\tdata.align = alignElement.getStyle('float') || 'none';\n\t\t\t\t\t\talignElement.removeStyle('float');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Get rid of extra vertical space when there's no caption.\n\t\t\t\t// It will improve the look of the resizer.\n\t\t\t\tthis.wrapper[(data.hasCaption ? 'remove' : 'add') + 'Class'](\n\t\t\t\t\t'cke_image_nocaption'\n\t\t\t\t);\n\n\t\t\t\tthis.setData(data);\n\n\t\t\t\tif (editor.config.image2_disableResizer !== true) {\n\t\t\t\t\tsetupResizer(this);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of Image2.\n\t\t\t// @see CKEDITOR.plugins.widget#addClass\n\t\t\taddClass: function(className) {\n\t\t\t\tgetStyleableElement(this).addClass(className);\n\t\t\t},\n\n\t\t\tallowedContent: getWidgetAllowedContent(editor),\n\n\t\t\t// This widget converts style-driven dimensions to attributes.\n\t\t\tcontentTransformations: [['img[width]: sizeToAttribute']],\n\n\t\t\tdata: function() {\n\t\t\t\tlet features = this.features;\n\n\t\t\t\t// Image can't be captioned when figcaption is disallowed (#11004).\n\t\t\t\tif (\n\t\t\t\t\tthis.data.hasCaption &&\n\t\t\t\t\t!editor.filter.checkFeature(features.caption)\n\t\t\t\t) {\n\t\t\t\t\tthis.data.hasCaption = false;\n\t\t\t\t}\n\n\t\t\t\t// Image can't be aligned when floating is disallowed (#11004).\n\t\t\t\tif (\n\t\t\t\t\tthis.data.align != 'none' &&\n\t\t\t\t\t!editor.filter.checkFeature(features.align)\n\t\t\t\t) {\n\t\t\t\t\tthis.data.align = 'none';\n\t\t\t\t}\n\n\t\t\t\t// Update widget.parts.link since it will not auto-update unless widget\n\t\t\t\t// is destroyed and re-inited.\n\t\t\t\tif (!this.data.link) {\n\t\t\t\t\tif (this.parts.link) {\n\t\t\t\t\t\tdelete this.parts.link;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.parts.link) {\n\t\t\t\t\t\tthis.parts.link = this.parts.image.getParent();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.parts.image.setAttributes({\n\t\t\t\t\talt: this.data.alt,\n\n\t\t\t\t\tcontenteditable: this.parts.image.getAttribute(\n\t\t\t\t\t\t'contenteditable'\n\t\t\t\t\t)\n\t\t\t\t\t\t? this.parts.image.getAttribute('contenteditable')\n\t\t\t\t\t\t: true,\n\n\t\t\t\t\t// This internal is required by the editor.\n\t\t\t\t\t'data-cke-saved-src': this.data.src,\n\n\t\t\t\t\tsrc: this.data.src,\n\t\t\t\t});\n\n\t\t\t\t// If shifting non-captioned -> captioned, remove classes\n\t\t\t\t// related to styles from <img/>.\n\t\t\t\tif (\n\t\t\t\t\tthis.oldData &&\n\t\t\t\t\t!this.oldData.hasCaption &&\n\t\t\t\t\tthis.data.hasCaption\n\t\t\t\t) {\n\t\t\t\t\tfor (let c in this.data.classes) {\n\t\t\t\t\t\tif (this.data.classes.hasOwnProperty(c)) {\n\t\t\t\t\t\t\tthis.parts.image.removeClass(c);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Set dimensions of the image according to gathered data.\n\t\t\t\t// Do it only when the attributes are allowed (#11004).\n\t\t\t\tif (editor.filter.checkFeature(features.dimension)) {\n\t\t\t\t\tsetDimensions(this);\n\t\t\t\t}\n\n\t\t\t\t// Cache current data.\n\t\t\t\tthis.oldData = CKEDITOR.tools.extend({}, this.data);\n\t\t\t},\n\n\t\t\tdowncast: downcastWidgetElement(editor),\n\n\t\t\tdraggable: false,\n\n\t\t\t// This widget has an editable caption.\n\t\t\teditables: {\n\t\t\t\tcaption: {\n\t\t\t\t\tselector: 'figcaption',\n\t\t\t\t\tallowedContent: 'br em strong sub sup u s; a[!href,target]',\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tfeatures: getWidgetFeatures(editor),\n\n\t\t\t// Overrides default method to handle internal mutability of Image2.\n\t\t\t// @see CKEDITOR.plugins.widget#getClasses\n\t\t\tgetClasses: (function() {\n\t\t\t\tlet classRegex = new RegExp(\n\t\t\t\t\t'^(' +\n\t\t\t\t\t\t[].concat(captionedClass, alignClasses).join('|') +\n\t\t\t\t\t\t')$'\n\t\t\t\t);\n\n\t\t\t\treturn function() {\n\t\t\t\t\tlet classes = this.repository.parseElementClasses(\n\t\t\t\t\t\tgetStyleableElement(this).getAttribute('class')\n\t\t\t\t\t);\n\n\t\t\t\t\t// Neither config.image2_captionedClass nor config.image2_alignClasses\n\t\t\t\t\t// do not belong to style classes.\n\t\t\t\t\tfor (let c in classes) {\n\t\t\t\t\t\tif (classRegex.test(c)) {\n\t\t\t\t\t\t\tdelete classes[c];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn classes;\n\t\t\t\t};\n\t\t\t})(),\n\n\t\t\tgetLabel: function() {\n\t\t\t\tlet label = (this.data.alt || '') + ' ' + this.pathName;\n\n\t\t\t\treturn label;\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of Image2.\n\t\t\t// @see CKEDITOR.plugins.widget#hasClass\n\t\t\thasClass: function(className) {\n\t\t\t\treturn getStyleableElement(this).hasClass(className);\n\t\t\t},\n\n\t\t\tparts: {\n\t\t\t\tcaption: 'figcaption',\n\t\t\t\timage: 'img',\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of Image2.\n\t\t\t// @see CKEDITOR.plugins.widget#removeClass\n\t\t\tremoveClass: function(className) {\n\t\t\t\tgetStyleableElement(this).removeClass(className);\n\t\t\t},\n\n\t\t\trequiredContent: 'img[src,alt]',\n\n\t\t\tstyleableElements: 'img figure',\n\n\t\t\t// Template of the widget: plain image.\n\t\t\ttemplate: template,\n\n\t\t\tupcast: upcastWidgetElement(editor),\n\t\t};\n\t}\n\n\t/**\n\t * A set of Enhanced Image (image2) plugin helpers.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.plugins.image2 = {\n\t\t/**\n\t\t * Checks whether the current image ratio matches the natural one\n\t\t * by comparing dimensions.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} image\n\t\t * @return {Boolean}\n\t\t */\n\t\tcheckHasNaturalRatio: function(image) {\n\t\t\tlet $ = image.$;\n\n\t\t\tlet natural = this.getNatural(image);\n\n\t\t\t// The reason for two alternative comparisons is that the rounding can come from\n\t\t\t// both dimensions, e.g. there are two cases:\n\t\t\t// \t1. height is computed as a rounded relation of the real height and the value of width,\n\t\t\t//\t2. width is computed as a rounded relation of the real width and the value of heigh.\n\t\t\treturn (\n\t\t\t\tMath.round(($.clientWidth / natural.width) * natural.height) ==\n\t\t\t\t\t$.clientHeight ||\n\t\t\t\tMath.round(($.clientHeight / natural.height) * natural.width) ==\n\t\t\t\t\t$.clientWidth\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Returns natural dimensions of the image. For modern browsers\n\t\t * it uses natural(Width|Height). For old ones (IE8) it creates\n\t\t * a new image and reads the dimensions.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} image\n\t\t * @return {Object}\n\t\t */\n\t\tgetNatural: function(image) {\n\t\t\tlet dimensions;\n\n\t\t\tif (image.$.naturalWidth) {\n\t\t\t\tdimensions = {\n\t\t\t\t\theight: image.$.naturalHeigh,\n\t\t\t\t\twidth: image.$.naturalWidth,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet img = new Image();\n\n\t\t\t\timg.src = image.getAttribute('src');\n\n\t\t\t\tdimensions = {\n\t\t\t\t\theight: img.heigh,\n\t\t\t\t\twidth: img.width,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn dimensions;\n\t\t},\n\t};\n\n\t// Returns a function that creates widgets from all <img> and\n\t// <figure class=\"{config.image2_captionedClass}\"> elements.\n\t//\n\t// @param {CKEDITOR.editor} editor\n\t// @returns {Function}\n\tfunction upcastWidgetElement(editor) {\n\t\tlet isCenterWrapper = centerWrapperChecker(editor);\n\n\t\tlet captionedClass = editor.config.image2_captionedClass;\n\n\t\t// @param {CKEDITOR.htmlParser.element} el\n\t\t// @param {Object} data\n\t\treturn function(el, data) {\n\t\t\tlet dimensions = {\n\t\t\t\theight: 1,\n\t\t\t\twidth: 1,\n\t\t\t};\n\n\t\t\tlet name = el.name;\n\n\t\t\tlet image;\n\n\t\t\t// #11110 Don't initialize on pasted fake objects.\n\t\t\tif (el.attributes['data-cke-realelement']) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If a center wrapper is found, there are 3 possible cases:\n\t\t\t//\n\t\t\t// 1. <div style=\"text-align:center\"><figure>...</figure></div>.\n\t\t\t//    In this case centering is done with a class set on widget.wrapper.\n\t\t\t//    Simply replace centering wrapper with figure (it's no longer necessary).\n\t\t\t//\n\t\t\t// 2. <p style=\"text-align:center\"><img/></p>.\n\t\t\t//    Nothing to do here: <p> remains for styling purposes.\n\t\t\t//\n\t\t\t// 3. <div style=\"text-align:center\"><img/></div>.\n\t\t\t//    Nothing to do here (2.) but that case is only possible in enterMode different\n\t\t\t//    than ENTER_P.\n\t\t\tif (isCenterWrapper(el)) {\n\t\t\t\tif (name == 'div') {\n\t\t\t\t\tlet figure = el.getFirst('figure');\n\n\t\t\t\t\t// Case #1.\n\t\t\t\t\tif (figure) {\n\t\t\t\t\t\tel.replaceWith(figure);\n\t\t\t\t\t\tel = figure;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Cases #2 and #3 (handled transparently)\n\n\t\t\t\t// If there's a centering wrapper, save it in data.\n\t\t\t\tdata.align = 'center';\n\n\t\t\t\t// Image can be wrapped in link <a><img/></a>.\n\t\t\t\timage = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\t\t\t}\n\n\t\t\t// No center wrapper has been found.\n\t\t\telse if (name == 'figure' && el.hasClass(captionedClass)) {\n\t\t\t\timage = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\n\t\t\t\t// Upcast linked image like <a><img/></a>.\n\t\t\t} else if (isLinkedOrStandaloneImage(el)) {\n\t\t\t\timage = el.name == 'a' ? el.children[0] : el;\n\t\t\t}\n\n\t\t\tif (!image) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If there's an image, then cool, we got a widget.\n\t\t\t// Now just remove dimension attributes expressed with %.\n\t\t\tfor (let d in dimensions) {\n\t\t\t\tif (dimensions.hasOwnProperty(d)) {\n\t\t\t\t\tlet dimension = image.attributes[d];\n\n\t\t\t\t\tif (dimension && dimension.match(regexPercent)) {\n\t\t\t\t\t\tdelete image.attributes[d];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn el;\n\t\t};\n\t}\n\n\t// Returns a function which transforms the widget to the external format\n\t// according to the current configuration.\n\t//\n\t// @param {CKEDITOR.editor}\n\tfunction downcastWidgetElement(editor) {\n\t\tlet alignClasses = editor.config.image2_alignClasses;\n\n\t\t// @param {CKEDITOR.htmlParser.element} el\n\t\treturn function(el) {\n\t\t\t// In case of <a><img/></a>, <img/> is the element to hold\n\t\t\t// inline styles or classes (image2_alignClasses).\n\t\t\tlet attrsHolder = el.name == 'a' ? el.getFirst() : el;\n\n\t\t\tdelete attrsHolder.attributes.contenteditable;\n\n\t\t\tlet attrs = attrsHolder.attributes;\n\n\t\t\tlet align = this.data.align;\n\n\t\t\t// De-wrap the image from resize handle wrapper.\n\t\t\t// Only block widgets have one.\n\t\t\tif (!this.inline) {\n\t\t\t\tlet resizeWrapper = el.getFirst('span');\n\n\t\t\t\tif (resizeWrapper) {\n\t\t\t\t\tresizeWrapper.replaceWith(\n\t\t\t\t\t\tresizeWrapper.getFirst({\n\t\t\t\t\t\t\ta: 1,\n\t\t\t\t\t\t\timg: 1,\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (align && align != 'none') {\n\t\t\t\tlet styles = CKEDITOR.tools.parseCssText(attrs.style || '');\n\n\t\t\t\t// When the widget is captioned (<figure>) and internally centering is done\n\t\t\t\t// with widget's wrapper style/class, in the external data representation,\n\t\t\t\t// <figure> must be wrapped with an element holding an style/class:\n\t\t\t\t//\n\t\t\t\t// \t<div style=\"text-align:center\">\n\t\t\t\t// \t\t<figure class=\"image\" style=\"display:inline-block\">...</figure>\n\t\t\t\t// \t</div>\n\t\t\t\t// or\n\t\t\t\t// \t<div class=\"some-center-class\">\n\t\t\t\t// \t\t<figure class=\"image\">...</figure>\n\t\t\t\t// \t</div>\n\t\t\t\t//\n\t\t\t\tif (align == 'center' && el.name == 'figure') {\n\t\t\t\t\tel = el.wrapWith(\n\t\t\t\t\t\tnew CKEDITOR.htmlParser.element(\n\t\t\t\t\t\t\t'div',\n\t\t\t\t\t\t\talignClasses\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tclass: alignClasses[1],\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\tstyle: 'text-align:center',\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// If left/right, add float style to the downcasted element.\n\t\t\t\telse if (\n\t\t\t\t\talign in\n\t\t\t\t\t{\n\t\t\t\t\t\tleft: 1,\n\t\t\t\t\t\tright: 1,\n\t\t\t\t\t}\n\t\t\t\t) {\n\t\t\t\t\tif (alignClasses) {\n\t\t\t\t\t\tattrsHolder.addClass(\n\t\t\t\t\t\t\talignClasses[alignmentsObj[align]]\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyles['float'] = align;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update element styles.\n\t\t\t\tif (!alignClasses && !CKEDITOR.tools.isEmpty(styles)) {\n\t\t\t\t\tattrs.style = CKEDITOR.tools.writeCssText(styles);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn el;\n\t\t};\n\t}\n\n\t// Returns a function that checks if an element is a centering wrapper.\n\t//\n\t// @param {CKEDITOR.editor} editor\n\t// @returns {Function}\n\tfunction centerWrapperChecker(editor) {\n\t\tlet captionedClass = editor.config.image2_captionedClass;\n\n\t\tlet alignClasses = editor.config.image2_alignClasses;\n\n\t\tlet validChildren = {\n\t\t\ta: 1,\n\t\t\tfigure: 1,\n\t\t\timg: 1,\n\t\t};\n\n\t\treturn function(el) {\n\t\t\t// Wrapper must be either <div> or <p>.\n\t\t\tif (\n\t\t\t\t!(\n\t\t\t\t\tel.name in\n\t\t\t\t\t{\n\t\t\t\t\t\tdiv: 1,\n\t\t\t\t\t\tp: 1,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet children = el.children;\n\n\t\t\t// Centering wrapper can have only one child.\n\t\t\tif (children.length !== 1) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet child = children[0];\n\n\t\t\t// Only <figure> or <img /> can be first (only) child of centering wrapper,\n\t\t\t// regardless of its type.\n\t\t\tif (!(child.name in validChildren)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// If centering wrapper is <p>, only <img /> can be the child.\n\t\t\t//   <p style=\"text-align:center\"><img /></p>\n\t\t\tif (el.name == 'p') {\n\t\t\t\tif (!isLinkedOrStandaloneImage(child)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Centering <div> can hold <img/> or <figure>, depending on enterMode.\n\t\t\telse {\n\t\t\t\t// If a <figure> is the first (only) child, it must have a class.\n\t\t\t\t//   <div style=\"text-align:center\"><figure>...</figure><div>\n\t\t\t\tif (child.name == 'figure') {\n\t\t\t\t\tif (!child.hasClass(captionedClass)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Centering <div> can hold <img/> or <a><img/></a> only when enterMode\n\t\t\t\t\t// is ENTER_(BR|DIV).\n\t\t\t\t\t//   <div style=\"text-align:center\"><img /></div>\n\t\t\t\t\t//   <div style=\"text-align:center\"><a><img /></a></div>\n\t\t\t\t\tif (editor.enterMode == CKEDITOR.ENTER_P) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Regardless of enterMode, a child which is not <figure> must be\n\t\t\t\t\t// either <img/> or <a><img/></a>.\n\t\t\t\t\tif (!isLinkedOrStandaloneImage(child)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Centering wrapper got to be... centering. If image2_alignClasses are defined,\n\t\t\t// check for centering class. Otherwise, check the style.\n\t\t\tif (\n\t\t\t\talignClasses\n\t\t\t\t\t? el.hasClass(alignClasses[1])\n\t\t\t\t\t: CKEDITOR.tools.parseCssText(\n\t\t\t\t\t\t\tel.attributes.style || '',\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t  )['text-align'] == 'center'\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n\n\t// Checks whether element is <img/> or <a><img/></a>.\n\t//\n\t// @param {CKEDITOR.htmlParser.element}\n\tfunction isLinkedOrStandaloneImage(el) {\n\t\tif (el.name == 'img') {\n\t\t\treturn true;\n\t\t} else if (el.name == 'a') {\n\t\t\treturn el.children.length == 1 && el.getFirst('img');\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t// Sets width and height of the widget image according to current widget data.\n\t//\n\t// @param {CKEDITOR.plugins.widget} widget\n\tfunction setDimensions(widget) {\n\t\tlet data = widget.data;\n\n\t\tlet dimensions = {\n\t\t\theight: data.height,\n\t\t\twidth: data.width,\n\t\t};\n\n\t\tlet image = widget.parts.image;\n\n\t\tfor (let d in dimensions) {\n\t\t\tif (dimensions[d]) {\n\t\t\t\timage.setAttribute(d, dimensions[d]);\n\t\t\t} else {\n\t\t\t\timage.removeAttribute(d);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Defines all features related to drag-driven image resizing.\n\t//\n\t// @param {CKEDITOR.plugins.widget} widget\n\tfunction setupResizer(widget) {\n\t\tlet editor = widget.editor;\n\n\t\tlet editable = editor.editable();\n\n\t\tlet doc = editor.document;\n\n\t\t// Store the resizer in a widget for testing (#11004).\n\t\tlet resizer = (widget.resizer = doc.createElement('span'));\n\n\t\tresizer.addClass('cke_image_resizer');\n\t\tresizer.addClass(\n\t\t\t'cke_image_resizer_' + cursor[editor.config.imageScaleResize]\n\t\t);\n\t\tresizer.append(new CKEDITOR.dom.text('\\u200b', doc));\n\n\t\t// Inline widgets don't need a resizer wrapper as an image spans the entire widget.\n\t\tif (!widget.inline) {\n\t\t\tlet imageOrLink = widget.parts.link || widget.parts.image;\n\n\t\t\tlet oldResizeWrapper = imageOrLink.getParent();\n\n\t\t\tlet resizeWrapper = doc.createElement('span');\n\n\t\t\tresizeWrapper.addClass('cke_image_resizer_wrapper');\n\t\t\tresizeWrapper.append(imageOrLink);\n\t\t\tresizeWrapper.append(resizer);\n\t\t\twidget.element.append(resizeWrapper, true);\n\n\t\t\t// Remove the old wrapper which could came from e.g. pasted HTML\n\t\t\t// and which could be corrupted (e.g. resizer span has been lost).\n\t\t\tif (oldResizeWrapper.is('span')) {\n\t\t\t\toldResizeWrapper.remove();\n\t\t\t}\n\t\t} else {\n\t\t\twidget.wrapper.append(resizer);\n\t\t}\n\n\t\t// Calculate values of size variables and mouse offsets.\n\t\tresizer.on('mousedown', function(evt) {\n\t\t\tlet image = widget.parts.image;\n\n\t\t\t// \"factor\" can be either 1 or -1. I.e.: For right-aligned images, we need to\n\t\t\t// subtract the difference to get proper width, etc. Without \"factor\",\n\t\t\t// resizer starts working the opposite way.\n\t\t\tlet factor = widget.data.align == 'right' ? -1 : 1;\n\n\t\t\t// The x-coordinate of the mouse relative to the screen\n\t\t\t// when button gets pressed.\n\t\t\tlet startX = evt.data.$.screenX;\n\n\t\t\tlet startY = evt.data.$.screenY;\n\n\t\t\t// The initial dimensions and aspect ratio of the image.\n\t\t\tlet startWidth = image.$.clientWidth;\n\n\t\t\tlet startHeight = image.$.clientHeight;\n\n\t\t\tlet listeners = [];\n\n\t\t\t// A class applied to editable during resizing.\n\t\t\tlet cursorClass = 'cke_image_s' + (!~factor ? 'w' : 'e');\n\n\t\t\tlet nativeEvt;\n\t\t\tlet newWidth;\n\t\t\tlet newHeight;\n\t\t\tlet updateData;\n\n\t\t\tlet moveDiffX;\n\t\t\tlet moveDiffY;\n\n\t\t\t// Save the undo snapshot first: before resizing.\n\t\t\teditor.fire('saveSnapshot');\n\n\t\t\t// Mousemove listeners are removed on mouseup.\n\t\t\tattachToDocuments('mousemove', onMouseMove, listeners);\n\n\t\t\t// Clean up the mousemove listener. Update widget data if valid.\n\t\t\tattachToDocuments('mouseup', onMouseUp, listeners);\n\n\t\t\t// The entire editable will have the special cursor while resizing goes on.\n\t\t\teditable.addClass(cursorClass);\n\n\t\t\t// This is to always keep the resizer element visible while resizing.\n\t\t\tresizer.addClass('cke_image_resizing');\n\n\t\t\t// Attaches an event to a global document if inline editor.\n\t\t\t// Additionally, if classic (`iframe`-based) editor, also attaches the same event to `iframe`'s document.\n\t\t\tfunction attachToDocuments(name, callback, collection) {\n\t\t\t\tlet globalDoc = CKEDITOR.document;\n\n\t\t\t\tlet listeners = [];\n\n\t\t\t\tif (!doc.equals(globalDoc)) {\n\t\t\t\t\tlisteners.push(globalDoc.on(name, callback));\n\t\t\t\t}\n\n\t\t\t\tlisteners.push(doc.on(name, callback));\n\n\t\t\t\tif (collection) {\n\t\t\t\t\tfor (let i = listeners.length; i--; ) {\n\t\t\t\t\t\tcollection.push(listeners.pop());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// This is how variables refer to the geometry.\n\t\t\t// Note: x corresponds to moveOffset, this is the position of mouse\n\t\t\t// Note: o corresponds to [startX, startY].\n\t\t\t//\n\t\t\t// \t+--------------+--------------+\n\t\t\t// \t|              |              |\n\t\t\t// \t|      I       |      II      |\n\t\t\t// \t|              |              |\n\t\t\t// \t+------------- o -------------+ _ _ _\n\t\t\t// \t|              |              |      ^\n\n\t\t\t// \t|      VI      |     III      |      | moveDiffY\n\t\t\t// \t|              |         x _ _ _ _ _ v\n\t\t\t// \t+--------------+---------|----+\n\t\t\t// \t               |         |\n\t\t\t// \t                <------->\n\t\t\t// \t                moveDiffX\n\t\t\tfunction onMouseMove(evt) {\n\t\t\t\tlet imageScaleResize = editor.config.imageScaleResize;\n\n\t\t\t\tnativeEvt = evt.data.$;\n\n\t\t\t\t// This is how far the mouse is from the point the button was pressed.\n\t\t\t\tmoveDiffX = nativeEvt.screenX - startX;\n\t\t\t\tmoveDiffY = startY - nativeEvt.screenY;\n\n\t\t\t\tif (\n\t\t\t\t\timageScaleResize === 'width' ||\n\t\t\t\t\timageScaleResize === 'both' ||\n\t\t\t\t\timageScaleResize === 'scale'\n\t\t\t\t) {\n\t\t\t\t\tnewWidth = startWidth + factor * moveDiffX;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\timageScaleResize === 'height' ||\n\t\t\t\t\timageScaleResize === 'both'\n\t\t\t\t) {\n\t\t\t\t\tnewHeight = startHeight - moveDiffY;\n\t\t\t\t}\n\n\t\t\t\tif (imageScaleResize === 'scale') {\n\t\t\t\t\tnewHeight = 'auto';\n\t\t\t\t}\n\n\t\t\t\tnewWidth = newWidth || startWidth;\n\t\t\t\tnewHeight = newHeight || startHeight;\n\n\t\t\t\t// Don't update attributes if less than 10.\n\t\t\t\t// This is to prevent images to visually disappear.\n\t\t\t\tif (\n\t\t\t\t\tnewWidth >= 15 &&\n\t\t\t\t\t(newHeight >= 15 || newHeight === 'auto')\n\t\t\t\t) {\n\t\t\t\t\timage.$.style.width = newWidth + 'px';\n\t\t\t\t\timage.$.style.height = newHeight + 'px';\n\n\t\t\t\t\tupdateData = true;\n\t\t\t\t} else {\n\t\t\t\t\tupdateData = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onMouseUp() {\n\t\t\t\tlet l;\n\n\t\t\t\twhile ((l = listeners.pop())) {\n\t\t\t\t\tl.removeListener();\n\t\t\t\t}\n\n\t\t\t\t// Restore default cursor by removing special class.\n\t\t\t\teditable.removeClass(cursorClass);\n\n\t\t\t\t// This is to bring back the regular behaviour of the resizer.\n\t\t\t\tresizer.removeClass('cke_image_resizing');\n\n\t\t\t\tif (updateData) {\n\t\t\t\t\twidget.setData({\n\t\t\t\t\t\theight: newHeight,\n\t\t\t\t\t\twidth: newWidth,\n\t\t\t\t\t});\n\n\t\t\t\t\t// Save another undo snapshot: after resizing.\n\t\t\t\t\teditor.fire('saveSnapshot');\n\t\t\t\t}\n\n\t\t\t\t// Don't update data twice or more.\n\t\t\t\tupdateData = false;\n\t\t\t}\n\t\t});\n\n\t\t// Change the position of the widget resizer when data changes.\n\t\twidget.on('data', function() {\n\t\t\tresizer[widget.data.align == 'right' ? 'addClass' : 'removeClass'](\n\t\t\t\t'cke_image_resizer_left'\n\t\t\t);\n\t\t});\n\n\t\twidget.parts.image.on('click', function() {\n\t\t\tlet selection = editor.getSelection();\n\n\t\t\tif (selection) {\n\t\t\t\tlet element = selection.getStartElement();\n\n\t\t\t\tif (element) {\n\t\t\t\t\tlet widgetElement = element.findOne('img');\n\n\t\t\t\t\tif (widgetElement) {\n\t\t\t\t\t\tlet region = element.getClientRect();\n\n\t\t\t\t\t\tlet scrollPosition = new CKEDITOR.dom.window(\n\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t).getScrollPosition();\n\t\t\t\t\t\tregion.left -= scrollPosition.x;\n\t\t\t\t\t\tregion.top += scrollPosition.y;\n\n\t\t\t\t\t\tregion.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\n\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\tnativeEvent: event,\n\t\t\t\t\t\t\tselectionData: {\n\t\t\t\t\t\t\t\telement: widgetElement,\n\t\t\t\t\t\t\t\tregion: region,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t// Returns a set of widget allowedContent rules, depending\n\t// on configurations like config#image2_alignClasses or\n\t// config#image2_captionedClass.\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction getWidgetAllowedContent(editor) {\n\t\tlet rules = {\n\t\t\tfigcaption: true,\n\t\t\tfigure: {\n\t\t\t\tclasses: '!' + editor.config.image2_captionedClass,\n\t\t\t},\n\t\t\timg: {\n\t\t\t\tattributes: '!src,alt,width,height',\n\t\t\t},\n\t\t};\n\n\t\treturn rules;\n\t}\n\n\t// Returns a set of widget feature rules, depending\n\t// on editor configuration. Note that the following may not cover\n\t// all the possible cases since requiredContent supports a single\n\t// tag only.\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction getWidgetFeatures(editor) {\n\t\tlet alignClasses = editor.config.image2_alignClasses;\n\n\t\tlet features = {\n\t\t\talign: {\n\t\t\t\trequiredContent:\n\t\t\t\t\t'img' +\n\t\t\t\t\t(alignClasses ? '(' + alignClasses[0] + ')' : '{float}'),\n\t\t\t},\n\t\t\tcaption: {\n\t\t\t\trequiredContent: 'figcaption',\n\t\t\t},\n\t\t\tdimension: {\n\t\t\t\trequiredContent: 'img[width,height]',\n\t\t\t},\n\t\t};\n\n\t\treturn features;\n\t}\n\n\t// Returns element which is styled, considering current\n\t// state of the widget.\n\t//\n\t// @see CKEDITOR.plugins.widget#applyStyle\n\t// @param {CKEDITOR.plugins.widget} widget\n\t// @returns {CKEDITOR.dom.element}\n\tfunction getStyleableElement(widget) {\n\t\treturn widget.data.hasCaption ? widget.element : widget.parts.image;\n\t}\n})();\n\nCKEDITOR.config.image2_captionedClass = 'image';\n","/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n(function() {\n\tif (CKEDITOR.plugins.get('ae_dragresize_ie11')) {\n\t\treturn;\n\t}\n\n\tlet template = '<img alt=\"\" src=\"\" />';\n\n\tlet templateBlock = new CKEDITOR.template(\n\t\t'<figure class=\"{captionedClass}\">' +\n\t\t\ttemplate +\n\t\t\t'<figcaption>{captionPlaceholder}</figcaption>' +\n\t\t\t'</figure>'\n\t);\n\n\tlet alignmentsObj = {left: 0, center: 1, right: 2};\n\n\tlet regexPercent = /^\\s*(\\d+%)\\s*$/i;\n\n\tCKEDITOR.plugins.add('ae_dragresize_ie11', {\n\t\trequires: 'widget',\n\t\tonLoad: function() {\n\t\t\tCKEDITOR.addCss(\n\t\t\t\t'.cke_image_nocaption{' +\n\t\t\t\t\t// This is to remove unwanted space so resize\n\t\t\t\t\t// wrapper is displayed property.\n\t\t\t\t\t'line-height:0' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_editable.cke_image_ne, .cke_editable.cke_image_ne *{cursor:ne-resize !important}' +\n\t\t\t\t\t'.cke_editable.cke_image_nw, .cke_editable.cke_image_nw *{cursor:nw-resize !important}' +\n\t\t\t\t\t'.cke_editable.cke_image_sw, .cke_editable.cke_image_sw *{cursor:sw-resize !important}' +\n\t\t\t\t\t'.cke_editable.cke_image_se, .cke_editable.cke_image_se *{cursor:se-resize !important}' +\n\t\t\t\t\t'.cke_image_resizer{' +\n\t\t\t\t\t'display:none;' +\n\t\t\t\t\t'position:absolute;' +\n\t\t\t\t\t'width:10px;' +\n\t\t\t\t\t'height:10px;' +\n\t\t\t\t\t'background:#000;' +\n\t\t\t\t\t'outline:1px solid #fff;' +\n\t\t\t\t\t// Prevent drag handler from being misplaced (#11207).\n\t\t\t\t\t'line-height:0;' +\n\t\t\t\t\t'cursor:se-resize;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_image_resizer_wrapper{' +\n\t\t\t\t\t'position:relative;' +\n\t\t\t\t\t'display:inline-block;' +\n\t\t\t\t\t'line-height:0;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t// Top-right corner style of the resizer.\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizer_ne{' +\n\t\t\t\t\t'cursor:ne-resize;' +\n\t\t\t\t\t'left:auto;' +\n\t\t\t\t\t'right:-5px;' +\n\t\t\t\t\t'top:-5px;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t// Top-left corner style of the resizer.\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizer_nw{' +\n\t\t\t\t\t'cursor:nw-resize;' +\n\t\t\t\t\t'left:-5px;' +\n\t\t\t\t\t'right:auto;' +\n\t\t\t\t\t'top:-5px;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t// Bottom-right corner style of the resizer.\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizer_se{' +\n\t\t\t\t\t'bottom:-5px;' +\n\t\t\t\t\t'cursor:se-resize;' +\n\t\t\t\t\t'left:auto;' +\n\t\t\t\t\t'right:-5px;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t// Bottom-left corner style of the resizer.\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizer_sw{' +\n\t\t\t\t\t'bottom:-5px;' +\n\t\t\t\t\t'cursor:sw-resize;' +\n\t\t\t\t\t'left:-5px;' +\n\t\t\t\t\t'right:auto;' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t'.cke_widget_wrapper:hover .cke_image_resizer,' +\n\t\t\t\t\t'.cke_image_resizer.cke_image_resizing{' +\n\t\t\t\t\t'display:block' +\n\t\t\t\t\t'}' +\n\t\t\t\t\t// Expand widget wrapper when linked inline image.\n\t\t\t\t\t'.cke_widget_wrapper>a{' +\n\t\t\t\t\t'display:inline-block' +\n\t\t\t\t\t'}'\n\t\t\t);\n\t\t},\n\n\t\tinit: function(editor) {\n\t\t\t// Adapts configuration from original image plugin. Should be removed\n\t\t\t// when we'll rename ae_dragresize_ie11 to image.\n\n\t\t\tlet image = widgetDef(editor);\n\n\t\t\t// Register the widget.\n\t\t\teditor.widgets.add('image', image);\n\n\t\t\t// Add a listener to handle selection change events and properly detect editor\n\t\t\t// interactions on the widgets without messing with widget native selection\n\t\t\teditor.on('selectionChange', function(_event) {\n\t\t\t\tlet selection = editor.getSelection();\n\n\t\t\t\tif (selection) {\n\t\t\t\t\tlet element = selection.getSelectedElement();\n\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\tlet widgetElement = element.findOne('img');\n\n\t\t\t\t\t\tif (widgetElement) {\n\t\t\t\t\t\t\tlet region = element.getClientRect();\n\n\t\t\t\t\t\t\tlet scrollPosition = new CKEDITOR.dom.window(\n\t\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t).getScrollPosition();\n\t\t\t\t\t\t\tregion.left -= scrollPosition.x;\n\t\t\t\t\t\t\tregion.top += scrollPosition.y;\n\n\t\t\t\t\t\t\tregion.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\n\t\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\t\tnativeEvent: {},\n\t\t\t\t\t\t\t\tselectionData: {\n\t\t\t\t\t\t\t\t\telement: widgetElement,\n\t\t\t\t\t\t\t\t\tregion: region,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tafterInit: function(editor) {\n\t\t\t// Integrate with align commands (justify plugin).\n\t\t\tlet align = {left: 1, right: 1, center: 1, block: 1};\n\n\t\t\tlet integrate = alignCommandIntegrator(editor);\n\n\t\t\tfor (let value in align) {\n\t\t\t\tif (align.hasOwnProperty(value)) {\n\t\t\t\t\tintegrate(value);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t});\n\n\t// Widget states (forms) depending on alignment and configuration.\n\t//\n\t// Non-captioned widget (inline styles)\n\t// \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n\t// \t\t│Align │Internal form                  │Data                         │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│none  │<wrapper>                      │<img />                      │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│left  │<wrapper style=”float:left”>   │<img style=”float:left” />   │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│center│<wrapper>                      │<p style=”text-align:center”>│\n\t// \t\t│      │ <p style=”text-align:center”> │  <img />                    │\n\t// \t\t│      │   <img />                     │</p>                         │\n\t// \t\t│      │ </p>                          │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│right │<wrapper style=”float:right”>  │<img style=”float:right” />  │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n\t//\n\t// Non-captioned widget (config.ae_dragresize_ie11_alignClasses defined)\n\t// \t\t┌──────┬───────────────────────────────┬─────────────────────────────┐\n\t// \t\t│Align │Internal form                  │Data                         │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│none  │<wrapper>                      │<img />                      │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│left  │<wrapper class=”left”>         │<img class=”left” />         │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│center│<wrapper>                      │<p class=”center”>           │\n\t// \t\t│      │ <p class=”center”>            │ <img />                     │\n\t// \t\t│      │   <img />                     │</p>                         │\n\t// \t\t│      │ </p>                          │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t├──────┼───────────────────────────────┼─────────────────────────────┤\n\t// \t\t│right │<wrapper class=”right”>        │<img class=”right” />        │\n\t// \t\t│      │ <img />                       │                             │\n\t// \t\t│      │</wrapper>                     │                             │\n\t// \t\t└──────┴───────────────────────────────┴─────────────────────────────┘\n\t//\n\t// Captioned widget (inline styles)\n\t// \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n\t// \t\t│Align │Internal form                           │Data                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│none  │<wrapper>                               │<figure />                              │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│left  │<wrapper style=”float:left”>            │<figure style=”float:left” />           │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│center│<wrapper style=”text-align:center”>     │<div style=”text-align:center”>         │\n\t// \t\t│      │ <figure style=”display:inline-block” />│ <figure style=”display:inline-block” />│\n\t// \t\t│      │</wrapper>                              │</p>                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│right │<wrapper style=”float:right”>           │<figure style=”float:right” />          │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n\t//\n\t// Captioned widget (config.ae_dragresize_ie11_alignClasses defined)\n\t// \t\t┌──────┬────────────────────────────────────────┬────────────────────────────────────────┐\n\t// \t\t│Align │Internal form                           │Data                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│none  │<wrapper>                               │<figure />                              │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│left  │<wrapper class=”left”>                  │<figure class=”left” />                 │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│center│<wrapper class=”center”>                │<div class=”center”>                    │\n\t// \t\t│      │ <figure />                             │ <figure />                             │\n\t// \t\t│      │</wrapper>                              │</p>                                    │\n\t// \t\t├──────┼────────────────────────────────────────┼────────────────────────────────────────┤\n\t// \t\t│right │<wrapper class=”right”>                 │<figure class=”right” />                │\n\t// \t\t│      │ <figure />                             │                                        │\n\t// \t\t│      │</wrapper>                              │                                        │\n\t// \t\t└──────┴────────────────────────────────────────┴────────────────────────────────────────┘\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction widgetDef(editor) {\n\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\tlet captionedClass = editor.config.ae_dragresize_ie11_captionedClass;\n\n\t\tfunction deflate() {\n\t\t\tif (this.deflated) return;\n\n\t\t\t// Remember whether widget was focused before destroyed.\n\t\t\tif (editor.widgets.focused == this.widget) this.focused = true;\n\n\t\t\teditor.widgets.destroy(this.widget);\n\n\t\t\t// Mark widget was destroyed.\n\t\t\tthis.deflated = true;\n\t\t}\n\n\t\tfunction inflate() {\n\t\t\tlet editable = editor.editable();\n\n\t\t\tlet doc = editor.document;\n\n\t\t\t// Create a new widget. This widget will be either captioned\n\t\t\t// non-captioned, block or inline according to what is the\n\t\t\t// new state of the widget.\n\t\t\tif (this.deflated) {\n\t\t\t\tthis.widget = editor.widgets.initOn(\n\t\t\t\t\tthis.element,\n\t\t\t\t\t'image',\n\t\t\t\t\tthis.widget.data\n\t\t\t\t);\n\n\t\t\t\t// Once widget was re-created, it may become an inline element without\n\t\t\t\t// block wrapper (i.e. when unaligned, end not captioned). Let's do some\n\t\t\t\t// sort of autoparagraphing here (#10853).\n\t\t\t\tif (\n\t\t\t\t\tthis.widget.inline &&\n\t\t\t\t\t!new CKEDITOR.dom.elementPath(this.widget.wrapper, editable)\n\t\t\t\t\t\t.block\n\t\t\t\t) {\n\t\t\t\t\tlet block = doc.createElement(\n\t\t\t\t\t\teditor.activeEnterMode == CKEDITOR.ENTER_P ? 'p' : 'div'\n\t\t\t\t\t);\n\t\t\t\t\tblock.replace(this.widget.wrapper);\n\t\t\t\t\tthis.widget.wrapper.move(block);\n\t\t\t\t}\n\n\t\t\t\t// The focus must be transferred from the old one (destroyed)\n\t\t\t\t// to the new one (just created).\n\t\t\t\tif (this.focused) {\n\t\t\t\t\tthis.widget.focus();\n\t\t\t\t\tdelete this.focused;\n\t\t\t\t}\n\n\t\t\t\tdelete this.deflated;\n\t\t\t}\n\n\t\t\t// If now widget was destroyed just update wrapper's alignment.\n\t\t\t// According to the new state.\n\t\t\telse {\n\t\t\t\tsetWrapperAlign(this.widget, alignClasses);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tallowedContent: getWidgetAllowedContent(editor),\n\n\t\t\trequiredContent: 'img[src,alt]',\n\n\t\t\tfeatures: getWidgetFeatures(editor),\n\n\t\t\tstyleableElements: 'img figure',\n\n\t\t\t// This widget converts style-driven dimensions to attributes.\n\t\t\tcontentTransformations: [['img[width]: sizeToAttribute']],\n\n\t\t\t// This widget has an editable caption.\n\t\t\teditables: {\n\t\t\t\tcaption: {\n\t\t\t\t\tselector: 'figcaption',\n\t\t\t\t\tallowedContent: 'br em strong sub sup u s; a[!href,target]',\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tparts: {\n\t\t\t\timage: 'img',\n\t\t\t\tcaption: 'figcaption',\n\t\t\t\t// parts#link defined in widget#init\n\t\t\t},\n\n\t\t\t// Template of the widget: plain image.\n\t\t\ttemplate: template,\n\n\t\t\tdata: function() {\n\t\t\t\tlet features = this.features;\n\n\t\t\t\t// Image can't be captioned when figcaption is disallowed (#11004).\n\t\t\t\tif (\n\t\t\t\t\tthis.data.hasCaption &&\n\t\t\t\t\t!editor.filter.checkFeature(features.caption)\n\t\t\t\t)\n\t\t\t\t\tthis.data.hasCaption = false;\n\n\t\t\t\t// Image can't be aligned when floating is disallowed (#11004).\n\t\t\t\tif (\n\t\t\t\t\tthis.data.align != 'none' &&\n\t\t\t\t\t!editor.filter.checkFeature(features.align)\n\t\t\t\t)\n\t\t\t\t\tthis.data.align = 'none';\n\n\t\t\t\t// Convert the internal form of the widget from the old state to the new one.\n\t\t\t\tthis.shiftState({\n\t\t\t\t\twidget: this,\n\t\t\t\t\telement: this.element,\n\t\t\t\t\toldData: this.oldData,\n\t\t\t\t\tnewData: this.data,\n\t\t\t\t\tdeflate: deflate,\n\t\t\t\t\tinflate: inflate,\n\t\t\t\t});\n\n\t\t\t\t// Update widget.parts.link since it will not auto-update unless widget\n\t\t\t\t// is destroyed and re-inited.\n\t\t\t\tif (!this.data.link) {\n\t\t\t\t\tif (this.parts.link) delete this.parts.link;\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.parts.link)\n\t\t\t\t\t\tthis.parts.link = this.parts.image.getParent();\n\t\t\t\t}\n\n\t\t\t\tthis.parts.image.setAttributes({\n\t\t\t\t\tsrc: this.data.src,\n\n\t\t\t\t\t// This internal is required by the editor.\n\t\t\t\t\t'data-cke-saved-src': this.data.src,\n\n\t\t\t\t\talt: this.data.alt,\n\t\t\t\t});\n\n\t\t\t\t// If shifting non-captioned -> captioned, remove classes\n\t\t\t\t// related to styles from <img/>.\n\t\t\t\tif (\n\t\t\t\t\tthis.oldData &&\n\t\t\t\t\t!this.oldData.hasCaption &&\n\t\t\t\t\tthis.data.hasCaption\n\t\t\t\t) {\n\t\t\t\t\tfor (let c in this.data.classes) {\n\t\t\t\t\t\tif (this.data.classes.hasOwnProperty(c)) {\n\t\t\t\t\t\t\tthis.parts.image.removeClass(c);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Set dimensions of the image according to gathered data.\n\t\t\t\t// Do it only when the attributes are allowed (#11004).\n\t\t\t\tif (editor.filter.checkFeature(features.dimension))\n\t\t\t\t\tsetDimensions(this);\n\n\t\t\t\t// Cache current data.\n\t\t\t\tthis.oldData = CKEDITOR.tools.extend({}, this.data);\n\t\t\t},\n\n\t\t\tinit: function() {\n\t\t\t\tlet helpers = CKEDITOR.plugins.ae_dragresize_ie11;\n\n\t\t\t\tlet image = this.parts.image;\n\n\t\t\t\tlet data = {\n\t\t\t\t\thasCaption: !!this.parts.caption,\n\t\t\t\t\tsrc: image.getAttribute('src'),\n\t\t\t\t\talt: image.getAttribute('alt') || '',\n\t\t\t\t\twidth: image.getAttribute('width') || '',\n\t\t\t\t\theight: image.getAttribute('height') || '',\n\n\t\t\t\t\t// Lock ratio is on by default (#10833).\n\t\t\t\t\tlock: this.ready\n\t\t\t\t\t\t? helpers.checkHasNaturalRatio(image)\n\t\t\t\t\t\t: true,\n\t\t\t\t};\n\n\t\t\t\t// If we used 'a' in widget#parts definition, it could happen that\n\t\t\t\t// selected element is a child of widget.parts#caption. Since there's no clever\n\t\t\t\t// way to solve it with CSS selectors, it's done like that. (#11783).\n\t\t\t\tlet link = image.getAscendant('a');\n\n\t\t\t\tif (link && this.wrapper.contains(link)) this.parts.link = link;\n\n\t\t\t\t// Depending on configuration, read style/class from element and\n\t\t\t\t// then remove it. Removed style/class will be set on wrapper in #data listener.\n\t\t\t\t// Note: Center alignment is detected during upcast, so only left/right cases\n\t\t\t\t// are checked below.\n\t\t\t\tif (!data.align) {\n\t\t\t\t\tlet alignElement = data.hasCaption ? this.element : image;\n\n\t\t\t\t\t// Read the initial left/right alignment from the class set on element.\n\t\t\t\t\tif (alignClasses) {\n\t\t\t\t\t\tif (alignElement.hasClass(alignClasses[0])) {\n\t\t\t\t\t\t\tdata.align = 'left';\n\t\t\t\t\t\t} else if (alignElement.hasClass(alignClasses[2])) {\n\t\t\t\t\t\t\tdata.align = 'right';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (data.align) {\n\t\t\t\t\t\t\talignElement.removeClass(\n\t\t\t\t\t\t\t\talignClasses[alignmentsObj[data.align]]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata.align = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Read initial float style from figure/image and then remove it.\n\t\t\t\t\telse {\n\t\t\t\t\t\tdata.align = alignElement.getStyle('float') || 'none';\n\t\t\t\t\t\talignElement.removeStyle('float');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update data.link object with attributes if the link has been discovered.\n\t\t\t\tif (editor.plugins.link && this.parts.link) {\n\t\t\t\t\tdata.link = helpers.getLinkAttributesParser()(\n\t\t\t\t\t\teditor,\n\t\t\t\t\t\tthis.parts.link\n\t\t\t\t\t);\n\n\t\t\t\t\t// Get rid of cke_widget_* classes in data. Otherwise\n\t\t\t\t\t// they might appear in link dialog.\n\t\t\t\t\tlet advanced = data.link.advanced;\n\t\t\t\t\tif (advanced && advanced.advCSSClasses) {\n\t\t\t\t\t\tadvanced.advCSSClasses = CKEDITOR.tools.trim(\n\t\t\t\t\t\t\tadvanced.advCSSClasses.replace(/cke_\\S+/, '')\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Get rid of extra vertical space when there's no caption.\n\t\t\t\t// It will improve the look of the resizer.\n\t\t\t\tthis.wrapper[(data.hasCaption ? 'remove' : 'add') + 'Class'](\n\t\t\t\t\t'cke_image_nocaption'\n\t\t\t\t);\n\n\t\t\t\tthis.setData(data);\n\n\t\t\t\t// Setup dynamic image resizing with mouse.\n\t\t\t\t// Don't initialize resizer when dimensions are disallowed (#11004).\n\t\t\t\tif (\n\t\t\t\t\teditor.filter.checkFeature(this.features.dimension) &&\n\t\t\t\t\teditor.config.ae_dragresize_ie11_disableResizer !== true\n\t\t\t\t)\n\t\t\t\t\tsetupResizer(this);\n\n\t\t\t\tthis.shiftState = helpers.stateShifter(this.editor);\n\n\t\t\t\t// Add widget editing option to its context menu.\n\t\t\t\tthis.on('contextMenu', function(evt) {\n\t\t\t\t\tevt.data.image = CKEDITOR.TRISTATE_OFF;\n\n\t\t\t\t\t// Integrate context menu items for link.\n\t\t\t\t\t// Note that widget may be wrapped in a link, which\n\t\t\t\t\t// does not belong to that widget (#11814).\n\t\t\t\t\tif (this.parts.link || this.wrapper.getAscendant('a'))\n\t\t\t\t\t\tevt.data.link = evt.data.unlink = CKEDITOR.TRISTATE_OFF;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of ae_dragresize_ie11.\n\t\t\t// @see CKEDITOR.plugins.widget#addClass\n\t\t\taddClass: function(className) {\n\t\t\t\tgetStyleableElement(this).addClass(className);\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of ae_dragresize_ie11.\n\t\t\t// @see CKEDITOR.plugins.widget#hasClass\n\t\t\thasClass: function(className) {\n\t\t\t\treturn getStyleableElement(this).hasClass(className);\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of ae_dragresize_ie11.\n\t\t\t// @see CKEDITOR.plugins.widget#removeClass\n\t\t\tremoveClass: function(className) {\n\t\t\t\tgetStyleableElement(this).removeClass(className);\n\t\t\t},\n\n\t\t\t// Overrides default method to handle internal mutability of ae_dragresize_ie11.\n\t\t\t// @see CKEDITOR.plugins.widget#getClasses\n\t\t\tgetClasses: (function() {\n\t\t\t\tlet classRegex = new RegExp(\n\t\t\t\t\t'^(' +\n\t\t\t\t\t\t[].concat(captionedClass, alignClasses).join('|') +\n\t\t\t\t\t\t')$'\n\t\t\t\t);\n\n\t\t\t\treturn function() {\n\t\t\t\t\tlet classes = this.repository.parseElementClasses(\n\t\t\t\t\t\tgetStyleableElement(this).getAttribute('class')\n\t\t\t\t\t);\n\n\t\t\t\t\t// Neither config.ae_dragresize_ie11_captionedClass nor config.ae_dragresize_ie11_alignClasses\n\t\t\t\t\t// do not belong to style classes.\n\t\t\t\t\tfor (let c in classes) {\n\t\t\t\t\t\tif (classRegex.test(c)) delete classes[c];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn classes;\n\t\t\t\t};\n\t\t\t})(),\n\n\t\t\tupcast: upcastWidgetElement(editor),\n\t\t\tdowncast: downcastWidgetElement(editor),\n\n\t\t\tgetLabel: function() {\n\t\t\t\tlet label = (this.data.alt || '') + ' ' + this.pathName;\n\n\t\t\t\treturn this.editor.lang.widget.label.replace(/%1/, label);\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * A set of Enhanced Image (ae_dragresize_ie11) plugin helpers.\n\t *\n\t * @class\n\t * @singleton\n\t */\n\tCKEDITOR.plugins.ae_dragresize_ie11 = {\n\t\tstateShifter: function(editor) {\n\t\t\t// Tag name used for centering non-captioned widgets.\n\t\t\tlet doc = editor.document;\n\n\t\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\t\tlet captionedClass =\n\t\t\t\teditor.config.ae_dragresize_ie11_captionedClass;\n\n\t\t\tlet editable = editor.editable();\n\n\t\t\t// The order that stateActions get executed. It matters!\n\n\t\t\tlet shiftables = ['hasCaption', 'align', 'link'];\n\n\t\t\t// Atomic procedures, one per state variable.\n\t\t\tlet stateActions = {\n\t\t\t\talign: function(shift, oldValue, newValue) {\n\t\t\t\t\tlet el = shift.element;\n\n\t\t\t\t\t// Alignment changed.\n\t\t\t\t\tif (shift.changed.align) {\n\t\t\t\t\t\t// No caption in the new state.\n\t\t\t\t\t\tif (!shift.newData.hasCaption) {\n\t\t\t\t\t\t\t// Changed to \"center\" (non-captioned).\n\t\t\t\t\t\t\tif (newValue == 'center') {\n\t\t\t\t\t\t\t\tshift.deflate();\n\t\t\t\t\t\t\t\tshift.element = wrapInCentering(editor, el);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Changed to \"non-center\" from \"center\" while caption removed.\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!shift.changed.hasCaption &&\n\t\t\t\t\t\t\t\toldValue == 'center' &&\n\t\t\t\t\t\t\t\tnewValue != 'center'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tshift.deflate();\n\t\t\t\t\t\t\t\tshift.element = unwrapFromCentering(el);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Alignment remains and \"center\" removed caption.\n\t\t\t\t\telse if (\n\t\t\t\t\t\tnewValue == 'center' &&\n\t\t\t\t\t\tshift.changed.hasCaption &&\n\t\t\t\t\t\t!shift.newData.hasCaption\n\t\t\t\t\t) {\n\t\t\t\t\t\tshift.deflate();\n\t\t\t\t\t\tshift.element = wrapInCentering(editor, el);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Finally set display for figure.\n\t\t\t\t\tif (!alignClasses && el.is('figure')) {\n\t\t\t\t\t\tif (newValue == 'center')\n\t\t\t\t\t\t\tel.setStyle('display', 'inline-block');\n\t\t\t\t\t\telse el.removeStyle('display');\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\thasCaption: function(shift, oldValue, newValue) {\n\t\t\t\t\t// This action is for real state change only.\n\t\t\t\t\tif (!shift.changed.hasCaption) return;\n\n\t\t\t\t\t// Get <img/> or <a><img/></a> from widget. Note that widget element might itself\n\t\t\t\t\t// be what we're looking for. Also element can be <p style=\"text-align:center\"><a>...</a></p>.\n\t\t\t\t\tlet imageOrLink;\n\t\t\t\t\tif (shift.element.is({img: 1, a: 1}))\n\t\t\t\t\t\timageOrLink = shift.element;\n\t\t\t\t\telse imageOrLink = shift.element.findOne('a,img');\n\n\t\t\t\t\t// Switching hasCaption always destroys the widget.\n\t\t\t\t\tshift.deflate();\n\n\t\t\t\t\t// There was no caption, but the caption is to be added.\n\t\t\t\t\tif (newValue) {\n\t\t\t\t\t\t// Create new <figure> from widget template.\n\t\t\t\t\t\tlet figure = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t\t\t\ttemplateBlock.output({\n\t\t\t\t\t\t\t\tcaptionedClass: captionedClass,\n\t\t\t\t\t\t\t\tcaptionPlaceholder:\n\t\t\t\t\t\t\t\t\teditor.lang.ae_dragresize_ie11\n\t\t\t\t\t\t\t\t\t\t.captionPlaceholder,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tdoc\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Replace element with <figure>.\n\t\t\t\t\t\treplaceSafely(figure, shift.element);\n\n\t\t\t\t\t\t// Use old <img/> or <a><img/></a> instead of the one from the template,\n\t\t\t\t\t\t// so we won't lose additional attributes.\n\t\t\t\t\t\timageOrLink.replace(figure.findOne('img'));\n\n\t\t\t\t\t\t// Update widget's element.\n\t\t\t\t\t\tshift.element = figure;\n\t\t\t\t\t}\n\n\t\t\t\t\t// The caption was present, but now it's to be removed.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Unwrap <img/> or <a><img/></a> from figure.\n\t\t\t\t\t\timageOrLink.replace(shift.element);\n\n\t\t\t\t\t\t// Update widget's element.\n\t\t\t\t\t\tshift.element = imageOrLink;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tlink: function(shift, oldValue, newValue) {\n\t\t\t\t\tif (shift.changed.link) {\n\t\t\t\t\t\tlet img = shift.element.is('img')\n\t\t\t\t\t\t\t? shift.element\n\t\t\t\t\t\t\t: shift.element.findOne('img');\n\n\t\t\t\t\t\tlet link = shift.element.is('a')\n\t\t\t\t\t\t\t? shift.element\n\t\t\t\t\t\t\t: shift.element.findOne('a');\n\n\t\t\t\t\t\t// Why deflate:\n\t\t\t\t\t\t// If element is <img/>, it will be wrapped into <a>,\n\t\t\t\t\t\t// which becomes a new widget.element.\n\t\t\t\t\t\t// If element is <a><img/></a>, it will be unlinked\n\t\t\t\t\t\t// so <img/> becomes a new widget.element.\n\n\t\t\t\t\t\tlet needsDeflate =\n\t\t\t\t\t\t\t(shift.element.is('a') && !newValue) ||\n\t\t\t\t\t\t\t(shift.element.is('img') && newValue);\n\n\t\t\t\t\t\tlet newEl;\n\n\t\t\t\t\t\tif (needsDeflate) shift.deflate();\n\n\t\t\t\t\t\t// If unlinked the image, returned element is <img>.\n\t\t\t\t\t\tif (!newValue) newEl = unwrapFromLink(link);\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// If linked the image, returned element is <a>.\n\t\t\t\t\t\t\tif (!oldValue)\n\t\t\t\t\t\t\t\tnewEl = wrapInLink(img, shift.newData.link);\n\n\t\t\t\t\t\t\t// Set and remove all attributes associated with this state.\n\t\t\t\t\t\t\tlet attributes = CKEDITOR.plugins.ae_dragresize_ie11.getLinkAttributesGetter()(\n\t\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\t\tnewValue\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (!CKEDITOR.tools.isEmpty(attributes.set))\n\t\t\t\t\t\t\t\t(newEl || link).setAttributes(attributes.set);\n\n\t\t\t\t\t\t\tif (attributes.removed.length)\n\t\t\t\t\t\t\t\t(newEl || link).removeAttributes(\n\t\t\t\t\t\t\t\t\tattributes.removed\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (needsDeflate) shift.element = newEl;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tfunction wrapInCentering(editor, element) {\n\t\t\t\tlet attribsAndStyles = {};\n\n\t\t\t\tif (alignClasses)\n\t\t\t\t\tattribsAndStyles.attributes = {class: alignClasses[1]};\n\t\t\t\telse attribsAndStyles.styles = {'text-align': 'center'};\n\n\t\t\t\t// There's no gentle way to center inline element with CSS, so create p/div\n\t\t\t\t// that wraps widget contents and does the trick either with style or class.\n\t\t\t\tlet center = doc.createElement(\n\t\t\t\t\teditor.activeEnterMode == CKEDITOR.ENTER_P ? 'p' : 'div',\n\t\t\t\t\tattribsAndStyles\n\t\t\t\t);\n\n\t\t\t\t// Replace element with centering wrapper.\n\t\t\t\treplaceSafely(center, element);\n\t\t\t\telement.move(center);\n\n\t\t\t\treturn center;\n\t\t\t}\n\n\t\t\tfunction unwrapFromCentering(element) {\n\t\t\t\tlet imageOrLink = element.findOne('a,img');\n\n\t\t\t\timageOrLink.replace(element);\n\n\t\t\t\treturn imageOrLink;\n\t\t\t}\n\n\t\t\t// Wraps <img/> -> <a><img/></a>.\n\t\t\t// Returns reference to <a>.\n\t\t\t//\n\t\t\t// @param {CKEDITOR.dom.element} img\n\t\t\t// @param {Object} linkData\n\t\t\t// @returns {CKEDITOR.dom.element}\n\t\t\tfunction wrapInLink(img, linkData) {\n\t\t\t\tlet link = doc.createElement('a', {\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\thref: linkData.url,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tlink.replace(img);\n\t\t\t\timg.move(link);\n\n\t\t\t\treturn link;\n\t\t\t}\n\n\t\t\t// De-wraps <a><img/></a> -> <img/>.\n\t\t\t// Returns the reference to <img/>\n\t\t\t//\n\t\t\t// @param {CKEDITOR.dom.element} link\n\t\t\t// @returns {CKEDITOR.dom.element}\n\t\t\tfunction unwrapFromLink(link) {\n\t\t\t\tlet img = link.findOne('img');\n\n\t\t\t\timg.replace(link);\n\n\t\t\t\treturn img;\n\t\t\t}\n\n\t\t\tfunction replaceSafely(replacing, replaced) {\n\t\t\t\tif (replaced.getParent()) {\n\t\t\t\t\tlet range = editor.createRange();\n\n\t\t\t\t\trange.moveToPosition(\n\t\t\t\t\t\treplaced,\n\t\t\t\t\t\tCKEDITOR.POSITION_BEFORE_START\n\t\t\t\t\t);\n\n\t\t\t\t\t// Remove old element. Do it before insertion to avoid a case when\n\t\t\t\t\t// element is moved from 'replaced' element before it, what creates\n\t\t\t\t\t// a tricky case which insertElementIntorRange does not handle.\n\t\t\t\t\treplaced.remove();\n\n\t\t\t\t\teditable.insertElementIntoRange(replacing, range);\n\t\t\t\t} else {\n\t\t\t\t\treplacing.replace(replaced);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function(shift) {\n\t\t\t\tlet name;\n\t\t\t\tlet i;\n\n\t\t\t\tshift.changed = {};\n\n\t\t\t\tfor (i = 0; i < shiftables.length; i++) {\n\t\t\t\t\tname = shiftables[i];\n\n\t\t\t\t\tshift.changed[name] = shift.oldData\n\t\t\t\t\t\t? shift.oldData[name] !== shift.newData[name]\n\t\t\t\t\t\t: false;\n\t\t\t\t}\n\n\t\t\t\t// Iterate over possible state variables.\n\t\t\t\tfor (i = 0; i < shiftables.length; i++) {\n\t\t\t\t\tname = shiftables[i];\n\n\t\t\t\t\tstateActions[name](\n\t\t\t\t\t\tshift,\n\t\t\t\t\t\tshift.oldData ? shift.oldData[name] : null,\n\t\t\t\t\t\tshift.newData[name]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tshift.inflate();\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Checks whether the current image ratio matches the natural one\n\t\t * by comparing dimensions.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} image\n\t\t * @return {Boolean}\n\t\t */\n\t\tcheckHasNaturalRatio: function(image) {\n\t\t\tlet $ = image.$;\n\n\t\t\tlet natural = this.getNatural(image);\n\n\t\t\t// The reason for two alternative comparisons is that the rounding can come from\n\t\t\t// both dimensions, e.g. there are two cases:\n\t\t\t// \t1. height is computed as a rounded relation of the real height and the value of width,\n\t\t\t//\t2. width is computed as a rounded relation of the real width and the value of heigh.\n\t\t\treturn (\n\t\t\t\tMath.round(($.clientWidth / natural.width) * natural.height) ==\n\t\t\t\t\t$.clientHeight ||\n\t\t\t\tMath.round(($.clientHeight / natural.height) * natural.width) ==\n\t\t\t\t\t$.clientWidth\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Returns natural dimensions of the image. For modern browsers\n\t\t * it uses natural(Width|Height). For old ones (IE8) it creates\n\t\t * a new image and reads the dimensions.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} image\n\t\t * @return {Object}\n\t\t */\n\t\tgetNatural: function(image) {\n\t\t\tlet dimensions;\n\n\t\t\tif (image.$.naturalWidth) {\n\t\t\t\tdimensions = {\n\t\t\t\t\twidth: image.$.naturalWidth,\n\t\t\t\t\theight: image.$.naturalHeight,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlet img = new Image();\n\t\t\t\timg.src = image.getAttribute('src');\n\n\t\t\t\tdimensions = {\n\t\t\t\t\twidth: img.width,\n\t\t\t\t\theight: img.height,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn dimensions;\n\t\t},\n\n\t\t/**\n\t\t * Returns an attribute getter function. Default getter comes from the Link plugin\n\t\t * and is documented by {@link CKEDITOR.plugins.link#getLinkAttributes}.\n\t\t *\n\t\t * **Note:** It is possible to override this method and use a custom getter e.g.\n\t\t * in the absence of the Link plugin.\n\t\t *\n\t\t * **Note:** If a custom getter is used, a data model format it produces\n\t\t * must be compatible with {@link CKEDITOR.plugins.link#getLinkAttributes}.\n\t\t *\n\t\t * **Note:** A custom getter must understand the data model format produced by\n\t\t * {@link #getLinkAttributesParser} to work correctly.\n\t\t *\n\t\t * @return {Function} A function that gets (composes) link attributes.\n\t\t * @since 4.5.5\n\t\t */\n\t\tgetLinkAttributesGetter: function() {\n\t\t\t// #13885\n\t\t\treturn CKEDITOR.plugins.link.getLinkAttributes;\n\t\t},\n\n\t\t/**\n\t\t * Returns an attribute parser function. Default parser comes from the Link plugin\n\t\t * and is documented by {@link CKEDITOR.plugins.link#parseLinkAttributes}.\n\t\t *\n\t\t * **Note:** It is possible to override this method and use a custom parser e.g.\n\t\t * in the absence of the Link plugin.\n\t\t *\n\t\t * **Note:** If a custom parser is used, a data model format produced by the parser\n\t\t * must be compatible with {@link #getLinkAttributesGetter}.\n\t\t *\n\t\t * **Note:** If a custom parser is used, it should be compatible with the\n\t\t * {@link CKEDITOR.plugins.link#parseLinkAttributes} data model format. Otherwise the\n\t\t * Link plugin dialog may not be populated correctly with parsed data. However\n\t\t * as long as Enhanced Image is **not** used with the Link plugin dialog, any custom data model\n\t\t * will work, being stored as an internal property of Enhanced Image widget's data only.\n\t\t *\n\t\t * @return {Function} A function that parses attributes.\n\t\t * @since 4.5.5\n\t\t */\n\t\tgetLinkAttributesParser: function() {\n\t\t\t// #13885\n\t\t\treturn CKEDITOR.plugins.link.parseLinkAttributes;\n\t\t},\n\t};\n\n\tfunction setWrapperAlign(widget, alignClasses) {\n\t\tlet wrapper = widget.wrapper;\n\n\t\tlet align = widget.data.align;\n\n\t\tlet hasCaption = widget.data.hasCaption;\n\n\t\tif (alignClasses) {\n\t\t\t// Remove all align classes first.\n\t\t\tfor (let i = 3; i--; ) wrapper.removeClass(alignClasses[i]);\n\n\t\t\tif (align == 'center') {\n\t\t\t\t// Avoid touching non-captioned, centered widgets because\n\t\t\t\t// they have the class set on the element instead of wrapper:\n\t\t\t\t//\n\t\t\t\t// \t<div class=\"cke_widget_wrapper\">\n\t\t\t\t// \t\t<p class=\"center-class\">\n\t\t\t\t// \t\t\t<img />\n\t\t\t\t// \t\t</p>\n\t\t\t\t// \t</div>\n\t\t\t\tif (hasCaption) {\n\t\t\t\t\twrapper.addClass(alignClasses[1]);\n\t\t\t\t}\n\t\t\t} else if (align != 'none') {\n\t\t\t\twrapper.addClass(alignClasses[alignmentsObj[align]]);\n\t\t\t}\n\t\t} else {\n\t\t\tif (align == 'center') {\n\t\t\t\tif (hasCaption) wrapper.setStyle('text-align', 'center');\n\t\t\t\telse wrapper.removeStyle('text-align');\n\n\t\t\t\twrapper.removeStyle('float');\n\t\t\t} else {\n\t\t\t\tif (align == 'none') wrapper.removeStyle('float');\n\t\t\t\telse wrapper.setStyle('float', align);\n\n\t\t\t\twrapper.removeStyle('text-align');\n\t\t\t}\n\n\t\t\tlet image = wrapper.$.querySelector('img');\n\n\t\t\timage.removeAttribute('style');\n\t\t}\n\t}\n\n\t// Returns a function that creates widgets from all <img> and\n\t// <figure class=\"{config.ae_dragresize_ie11_captionedClass}\"> elements.\n\t//\n\t// @param {CKEDITOR.editor} editor\n\t// @returns {Function}\n\tfunction upcastWidgetElement(editor) {\n\t\tlet isCenterWrapper = centerWrapperChecker(editor);\n\n\t\tlet captionedClass = editor.config.ae_dragresize_ie11_captionedClass;\n\n\t\t// @param {CKEDITOR.htmlParser.element} el\n\t\t// @param {Object} data\n\t\treturn function(el, data) {\n\t\t\tlet dimensions = {width: 1, height: 1};\n\n\t\t\tlet name = el.name;\n\n\t\t\tlet image;\n\n\t\t\t// #11110 Don't initialize on pasted fake objects.\n\t\t\tif (el.attributes['data-cke-realelement']) return;\n\n\t\t\t// If a center wrapper is found, there are 3 possible cases:\n\t\t\t//\n\t\t\t// 1. <div style=\"text-align:center\"><figure>...</figure></div>.\n\t\t\t//    In this case centering is done with a class set on widget.wrapper.\n\t\t\t//    Simply replace centering wrapper with figure (it's no longer necessary).\n\t\t\t//\n\t\t\t// 2. <p style=\"text-align:center\"><img/></p>.\n\t\t\t//    Nothing to do here: <p> remains for styling purposes.\n\t\t\t//\n\t\t\t// 3. <div style=\"text-align:center\"><img/></div>.\n\t\t\t//    Nothing to do here (2.) but that case is only possible in enterMode different\n\t\t\t//    than ENTER_P.\n\t\t\tif (isCenterWrapper(el)) {\n\t\t\t\tif (name == 'div') {\n\t\t\t\t\tlet figure = el.getFirst('figure');\n\n\t\t\t\t\t// Case #1.\n\t\t\t\t\tif (figure) {\n\t\t\t\t\t\tel.replaceWith(figure);\n\t\t\t\t\t\tel = figure;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Cases #2 and #3 (handled transparently)\n\n\t\t\t\t// If there's a centering wrapper, save it in data.\n\t\t\t\tdata.align = 'center';\n\n\t\t\t\t// Image can be wrapped in link <a><img/></a>.\n\t\t\t\timage = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\t\t\t}\n\n\t\t\t// No center wrapper has been found.\n\t\t\telse if (name == 'figure' && el.hasClass(captionedClass)) {\n\t\t\t\timage = el.getFirst('img') || el.getFirst('a').getFirst('img');\n\n\t\t\t\t// Upcast linked image like <a><img/></a>.\n\t\t\t} else if (isLinkedOrStandaloneImage(el)) {\n\t\t\t\timage = el.name == 'a' ? el.children[0] : el;\n\t\t\t}\n\n\t\t\tif (!image) return;\n\n\t\t\t// If there's an image, then cool, we got a widget.\n\t\t\t// Now just remove dimension attributes expressed with %.\n\t\t\tfor (let d in dimensions) {\n\t\t\t\tif (dimensions.hasOwnProperty(d)) {\n\t\t\t\t\tlet dimension = image.attributes[d];\n\t\t\t\t\tif (dimension && dimension.match(regexPercent))\n\t\t\t\t\t\tdelete image.attributes[d];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn el;\n\t\t};\n\t}\n\n\t// Returns a function which transforms the widget to the external format\n\t// according to the current configuration.\n\t//\n\t// @param {CKEDITOR.editor}\n\tfunction downcastWidgetElement(editor) {\n\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\t// @param {CKEDITOR.htmlParser.element} el\n\t\treturn function(el) {\n\t\t\t// In case of <a><img/></a>, <img/> is the element to hold\n\t\t\t// inline styles or classes (ae_dragresize_ie11_alignClasses).\n\t\t\tlet attrsHolder = el.name == 'a' ? el.getFirst() : el;\n\n\t\t\tlet attrs = attrsHolder.attributes;\n\n\t\t\tlet align = this.data.align;\n\n\t\t\t// De-wrap the image from resize handle wrapper.\n\t\t\t// Only block widgets have one.\n\t\t\tif (!this.inline) {\n\t\t\t\tlet resizeWrapper = el.getFirst('span');\n\n\t\t\t\tif (resizeWrapper)\n\t\t\t\t\tresizeWrapper.replaceWith(\n\t\t\t\t\t\tresizeWrapper.getFirst({img: 1, a: 1})\n\t\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (align && align != 'none') {\n\t\t\t\tlet styles = CKEDITOR.tools.parseCssText(attrs.style || '');\n\n\t\t\t\t// When the widget is captioned (<figure>) and internally centering is done\n\t\t\t\t// with widget's wrapper style/class, in the external data representation,\n\t\t\t\t// <figure> must be wrapped with an element holding an style/class:\n\t\t\t\t//\n\t\t\t\t// \t<div style=\"text-align:center\">\n\t\t\t\t// \t\t<figure class=\"image\" style=\"display:inline-block\">...</figure>\n\t\t\t\t// \t</div>\n\t\t\t\t// or\n\t\t\t\t// \t<div class=\"some-center-class\">\n\t\t\t\t// \t\t<figure class=\"image\">...</figure>\n\t\t\t\t// \t</div>\n\t\t\t\t//\n\t\t\t\tif (align == 'center' && el.name == 'figure') {\n\t\t\t\t\tel = el.wrapWith(\n\t\t\t\t\t\tnew CKEDITOR.htmlParser.element(\n\t\t\t\t\t\t\t'div',\n\t\t\t\t\t\t\talignClasses\n\t\t\t\t\t\t\t\t? {class: alignClasses[1]}\n\t\t\t\t\t\t\t\t: {style: 'text-align:center'}\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// If left/right, add float style to the downcasted element.\n\t\t\t\telse if (align in {left: 1, right: 1}) {\n\t\t\t\t\tif (alignClasses)\n\t\t\t\t\t\tattrsHolder.addClass(\n\t\t\t\t\t\t\talignClasses[alignmentsObj[align]]\n\t\t\t\t\t\t);\n\t\t\t\t\telse styles['float'] = align;\n\t\t\t\t}\n\n\t\t\t\t// Update element styles.\n\t\t\t\tif (!alignClasses && !CKEDITOR.tools.isEmpty(styles))\n\t\t\t\t\tattrs.style = CKEDITOR.tools.writeCssText(styles) + ';';\n\t\t\t}\n\n\t\t\treturn el;\n\t\t};\n\t}\n\n\t// Returns a function that checks if an element is a centering wrapper.\n\t//\n\t// @param {CKEDITOR.editor} editor\n\t// @returns {Function}\n\tfunction centerWrapperChecker(editor) {\n\t\tlet captionedClass = editor.config.ae_dragresize_ie11_captionedClass;\n\n\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\tlet validChildren = {figure: 1, a: 1, img: 1};\n\n\t\treturn function(el) {\n\t\t\t// Wrapper must be either <div> or <p>.\n\t\t\tif (!(el.name in {div: 1, p: 1})) return false;\n\n\t\t\tlet children = el.children;\n\n\t\t\t// Centering wrapper can have only one child.\n\t\t\tif (children.length !== 1) return false;\n\n\t\t\tlet child = children[0];\n\n\t\t\t// Only <figure> or <img /> can be first (only) child of centering wrapper,\n\t\t\t// regardless of its type.\n\t\t\tif (!(child.name in validChildren)) return false;\n\n\t\t\t// If centering wrapper is <p>, only <img /> can be the child.\n\t\t\t//   <p style=\"text-align:center\"><img /></p>\n\t\t\tif (el.name == 'p') {\n\t\t\t\tif (!isLinkedOrStandaloneImage(child)) return false;\n\t\t\t}\n\t\t\t// Centering <div> can hold <img/> or <figure>, depending on enterMode.\n\t\t\telse {\n\t\t\t\t// If a <figure> is the first (only) child, it must have a class.\n\t\t\t\t//   <div style=\"text-align:center\"><figure>...</figure><div>\n\t\t\t\tif (child.name == 'figure') {\n\t\t\t\t\tif (!child.hasClass(captionedClass)) return false;\n\t\t\t\t} else {\n\t\t\t\t\t// Centering <div> can hold <img/> or <a><img/></a> only when enterMode\n\t\t\t\t\t// is ENTER_(BR|DIV).\n\t\t\t\t\t//   <div style=\"text-align:center\"><img /></div>\n\t\t\t\t\t//   <div style=\"text-align:center\"><a><img /></a></div>\n\t\t\t\t\tif (editor.enterMode == CKEDITOR.ENTER_P) return false;\n\n\t\t\t\t\t// Regardless of enterMode, a child which is not <figure> must be\n\t\t\t\t\t// either <img/> or <a><img/></a>.\n\t\t\t\t\tif (!isLinkedOrStandaloneImage(child)) return false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Centering wrapper got to be... centering. If ae_dragresize_ie11_alignClasses are defined,\n\t\t\t// check for centering class. Otherwise, check the style.\n\t\t\tif (\n\t\t\t\talignClasses\n\t\t\t\t\t? el.hasClass(alignClasses[1])\n\t\t\t\t\t: CKEDITOR.tools.parseCssText(\n\t\t\t\t\t\t\tel.attributes.style || '',\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t  )['text-align'] == 'center'\n\t\t\t)\n\t\t\t\treturn true;\n\n\t\t\treturn false;\n\t\t};\n\t}\n\n\t// Checks whether element is <img/> or <a><img/></a>.\n\t//\n\t// @param {CKEDITOR.htmlParser.element}\n\tfunction isLinkedOrStandaloneImage(el) {\n\t\tif (el.name == 'img') return true;\n\t\telse if (el.name == 'a')\n\t\t\treturn el.children.length == 1 && el.getFirst('img');\n\n\t\treturn false;\n\t}\n\n\t// Sets width and height of the widget image according to current widget data.\n\t//\n\t// @param {CKEDITOR.plugins.widget} widget\n\tfunction setDimensions(widget) {\n\t\tlet data = widget.data;\n\n\t\tlet dimensions = {width: data.width, height: data.height};\n\n\t\tlet image = widget.parts.image;\n\n\t\tfor (let d in dimensions) {\n\t\t\tif (dimensions[d]) image.setAttribute(d, dimensions[d]);\n\t\t\telse image.removeAttribute(d);\n\t\t}\n\t}\n\n\t// Defines all features related to drag-driven image resizing.\n\t//\n\t// @param {CKEDITOR.plugins.widget} widget\n\tfunction setupResizer(widget) {\n\t\tlet editor = widget.editor;\n\n\t\tlet editable = editor.editable();\n\n\t\tlet doc = editor.document;\n\n\t\t// Store the resizer in a widget for testing (#11004).\n\n\t\tlet resizer = (widget.resizer = doc.createElement('span'));\n\n\t\t// Create resizer for each corner (NE, NW, SE, SW)\n\n\t\tlet resizerNE = doc.createElement('span');\n\n\t\tlet resizerNW = doc.createElement('span');\n\n\t\tlet resizerSE = doc.createElement('span');\n\n\t\tlet resizerSW = doc.createElement('span');\n\n\t\tresizerNE.addClass('cke_image_resizer');\n\t\tresizerNE.addClass('cke_image_resizer_ne');\n\n\t\tresizerNW.addClass('cke_image_resizer');\n\t\tresizerNW.addClass('cke_image_resizer_nw');\n\n\t\tresizerSE.addClass('cke_image_resizer');\n\t\tresizerSE.addClass('cke_image_resizer_se');\n\n\t\tresizerSW.addClass('cke_image_resizer');\n\t\tresizerSW.addClass('cke_image_resizer_sw');\n\n\t\t// Add each directional resizer as a child of resizer\n\t\tresizer.append(resizerNE);\n\t\tresizer.append(resizerNW);\n\t\tresizer.append(resizerSE);\n\t\tresizer.append(resizerSW);\n\n\t\t// resizer.setAttribute( 'title', editor.lang.ae_dragresize_ie11.resizer );\n\t\tresizer.append(new CKEDITOR.dom.text('\\u200b', doc));\n\n\t\t// Inline widgets don't need a resizer wrapper as an image spans the entire widget.\n\t\tif (!widget.inline) {\n\t\t\tlet imageOrLink = widget.parts.link || widget.parts.image;\n\n\t\t\tlet oldResizeWrapper = imageOrLink.getParent();\n\n\t\t\tlet resizeWrapper = doc.createElement('span');\n\n\t\t\tresizeWrapper.addClass('cke_image_resizer_wrapper');\n\t\t\tresizeWrapper.append(imageOrLink);\n\t\t\tresizeWrapper.append(resizer);\n\t\t\twidget.element.append(resizeWrapper, true);\n\n\t\t\t// Remove the old wrapper which could came from e.g. pasted HTML\n\t\t\t// and which could be corrupted (e.g. resizer span has been lost).\n\t\t\tif (oldResizeWrapper.is('span')) oldResizeWrapper.remove();\n\t\t} else {\n\t\t\twidget.wrapper.append(resizer);\n\t\t}\n\n\t\t// Calculate values of size variables and mouse offsets.\n\t\tresizer.on('mousedown', function(evt) {\n\t\t\tlet image = widget.parts.image;\n\n\t\t\t// The x-coordinate of the mouse relative to the screen\n\t\t\t// when button gets pressed.\n\n\t\t\tlet startX = evt.data.$.screenX;\n\n\t\t\tlet startY = evt.data.$.screenY;\n\n\t\t\t// The initial dimensions and aspect ratio of the image.\n\n\t\t\tlet startWidth = image.$.clientWidth;\n\n\t\t\tlet startHeight = image.$.clientHeight;\n\n\t\t\tlet ratio = startWidth / startHeight;\n\n\t\t\tlet listeners = [];\n\n\t\t\tlet target = evt.data.getTarget();\n\n\t\t\tlet factorX;\n\n\t\t\tlet factorY;\n\n\t\t\tlet moveDiffX;\n\n\t\t\tlet moveDiffY;\n\n\t\t\tlet nativeEvt;\n\n\t\t\tlet newHeight;\n\n\t\t\tlet newWidth;\n\n\t\t\tlet updateData;\n\n\t\t\t// \"factorX\" and \"factorY\" can be either 1 or -1. I.e.: We need to\n\t\t\t// add/subtract the difference to get proper width, etc. Without \"factorX\"\n\t\t\t// and \"factorY\", resizer starts working the opposite way.\n\t\t\tif (target.hasClass('cke_image_resizer_ne')) {\n\t\t\t\tfactorX = 1;\n\t\t\t\tfactorY = 1;\n\t\t\t} else if (target.hasClass('cke_image_resizer_nw')) {\n\t\t\t\tfactorX = -1;\n\t\t\t\tfactorY = 1;\n\t\t\t} else if (target.hasClass('cke_image_resizer_se')) {\n\t\t\t\tfactorX = 1;\n\t\t\t\tfactorY = -1;\n\t\t\t} else if (target.hasClass('cke_image_resizer_sw')) {\n\t\t\t\tfactorX = -1;\n\t\t\t\tfactorY = -1;\n\t\t\t}\n\n\t\t\t// A class applied to editable during resizing.\n\t\t\tlet cursorClass =\n\t\t\t\t'cke_image_' +\n\t\t\t\t(!~factorY ? 's' : 'n') +\n\t\t\t\t(!~factorX ? 'w' : 'e');\n\n\t\t\t// Save the undo snapshot first: before resizing.\n\t\t\teditor.fire('saveSnapshot');\n\n\t\t\t// Mousemove listeners are removed on mouseup.\n\t\t\tattachToDocuments('mousemove', onMouseMove, listeners);\n\n\t\t\t// Clean up the mousemove listener. Update widget data if valid.\n\t\t\tattachToDocuments('mouseup', onMouseUp, listeners);\n\n\t\t\t// The entire editable will have the special cursor while resizing goes on.\n\t\t\teditable.addClass(cursorClass);\n\n\t\t\t// This is to always keep the resizer element visible while resizing.\n\t\t\tresizer.addClass('cke_image_resizing');\n\n\t\t\t// Attaches an event to a global document if inline editor.\n\t\t\t// Additionally, if classic (`iframe`-based) editor, also attaches the same event to `iframe`'s document.\n\t\t\tfunction attachToDocuments(name, callback, collection) {\n\t\t\t\tlet globalDoc = CKEDITOR.document;\n\n\t\t\t\tlet listeners = [];\n\n\t\t\t\tif (!doc.equals(globalDoc))\n\t\t\t\t\tlisteners.push(globalDoc.on(name, callback));\n\n\t\t\t\tlisteners.push(doc.on(name, callback));\n\n\t\t\t\tif (collection) {\n\t\t\t\t\tfor (let i = listeners.length; i--; )\n\t\t\t\t\t\tcollection.push(listeners.pop());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Calculate width first, and then adjust height, preserving ratio.\n\t\t\tfunction adjustToX() {\n\t\t\t\tnewWidth = startWidth + factorX * moveDiffX;\n\t\t\t\tnewHeight = Math.round(newWidth / ratio);\n\t\t\t}\n\n\t\t\t// Calculate height first, and then adjust width, preserving ratio.\n\t\t\tfunction adjustToY() {\n\t\t\t\tnewHeight = startHeight + factorY * moveDiffY;\n\t\t\t\tnewWidth = Math.round(newHeight * ratio);\n\t\t\t}\n\n\t\t\t// This is how variables refer to the geometry.\n\t\t\t// Note: x corresponds to moveOffset, this is the position of mouse\n\t\t\t// Note: o corresponds to [startX, startY].\n\t\t\t//\n\t\t\t// \t+--------------+--------------+\n\t\t\t// \t|              |              |\n\t\t\t// \t|      I       |      II      |\n\t\t\t// \t|              |              |\n\t\t\t// \t+------------- o -------------+ _ _ _\n\t\t\t// \t|              |              |      ^\n\t\t\t// \t|      VI      |     III      |      | moveDiffY\n\t\t\t// \t|              |         x _ _ _ _ _ v\n\t\t\t// \t+--------------+---------|----+\n\t\t\t// \t               |         |\n\t\t\t// \t                <------->\n\t\t\t// \t                moveDiffX\n\t\t\tfunction onMouseMove(evt) {\n\t\t\t\tnativeEvt = evt.data.$;\n\n\t\t\t\t// This is how far the mouse is from the point the button was pressed.\n\t\t\t\tmoveDiffX = nativeEvt.screenX - startX;\n\t\t\t\tmoveDiffY = startY - nativeEvt.screenY;\n\n\t\t\t\t// Resize with NE, SE drag handles\n\t\t\t\tif (factorX == 1) {\n\t\t\t\t\tif (moveDiffX <= 0) {\n\t\t\t\t\t\tadjustToY();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadjustToX();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Resize with NW, SW drag handles\n\t\t\t\telse {\n\t\t\t\t\tif (moveDiffX <= 0) {\n\t\t\t\t\t\tadjustToX();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadjustToY();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Don't update attributes if less than 10.\n\t\t\t\t// This is to prevent images to visually disappear.\n\t\t\t\tif (newWidth >= 15 && newHeight >= 15) {\n\t\t\t\t\timage.$.style.width = newWidth + 'px';\n\t\t\t\t\timage.$.style.height = newHeight + 'px';\n\n\t\t\t\t\tupdateData = true;\n\t\t\t\t} else {\n\t\t\t\t\tupdateData = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onMouseUp() {\n\t\t\t\tlet l;\n\n\t\t\t\twhile ((l = listeners.pop())) l.removeListener();\n\n\t\t\t\t// Restore default cursor by removing special class.\n\t\t\t\teditable.removeClass(cursorClass);\n\n\t\t\t\t// This is to bring back the regular behaviour of the resizer.\n\t\t\t\tresizer.removeClass('cke_image_resizing');\n\n\t\t\t\tif (updateData) {\n\t\t\t\t\twidget.setData({\n\t\t\t\t\t\theight: newHeight,\n\t\t\t\t\t\twidth: newWidth,\n\t\t\t\t\t});\n\n\t\t\t\t\t// Save another undo snapshot: after resizing.\n\t\t\t\t\teditor.fire('saveSnapshot');\n\t\t\t\t}\n\n\t\t\t\t// Don't update data twice or more.\n\t\t\t\tupdateData = false;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Removes the alignment value of an image\n\t *\n\t * @param {CKEDITOR.dom.element} image The image element\n\t * @param {String} imageAlignment The image alignment value to be removed\n\t */\n\tlet removeWidgetAlignment = function(widget, imageAlignment) {\n\t\tif (imageAlignment === 'left' || imageAlignment === 'right') {\n\t\t\twidget.wrapper.removeStyle('float');\n\t\t} else if (imageAlignment === 'center') {\n\t\t\twidget.editor.execCommand('justifyleft');\n\t\t\twidget.editor.execCommand('justifyleft');\n\t\t}\n\t};\n\n\t// Integrates widget alignment setting with justify\n\t// plugin's commands (execution and refreshment).\n\t// @param {CKEDITOR.editor} editor\n\t// @param {String} value 'left', 'right', 'center' or 'block'\n\tfunction alignCommandIntegrator(editor) {\n\t\tlet execCallbacks = [];\n\n\t\tlet enabled;\n\n\t\treturn function(value) {\n\t\t\tlet command = editor.getCommand('justify' + value);\n\n\t\t\t// Most likely, the justify plugin isn't loaded.\n\t\t\tif (!command) return;\n\n\t\t\t// This command will be manually refreshed along with\n\t\t\t// other commands after exec.\n\t\t\texecCallbacks.push(function() {\n\t\t\t\tcommand.refresh(editor, editor.elementPath());\n\t\t\t});\n\n\t\t\tif (value in {right: 1, left: 1, center: 1}) {\n\t\t\t\tcommand.on('exec', function(evt) {\n\t\t\t\t\tlet widget = getFocusedWidget(editor);\n\n\t\t\t\t\tif (widget) {\n\t\t\t\t\t\tif (widget.data.align === value) {\n\t\t\t\t\t\t\tremoveWidgetAlignment(widget, value);\n\n\t\t\t\t\t\t\tdelete widget.data.align;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidget.setData('align', value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Once the widget changed its align, all the align commands\n\t\t\t\t\t\t// must be refreshed: the event is to be cancelled.\n\t\t\t\t\t\tfor (let i = execCallbacks.length; i--; )\n\t\t\t\t\t\t\texecCallbacks[i]();\n\n\t\t\t\t\t\tevt.cancel();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tcommand.on('refresh', function(evt) {\n\t\t\t\tlet widget = getFocusedWidget(editor);\n\n\t\t\t\tlet allowed = {right: 1, left: 1, center: 1};\n\n\t\t\t\tif (!widget) return;\n\n\t\t\t\t// Cache \"enabled\" on first use. This is because filter#checkFeature may\n\t\t\t\t// not be available during plugin's afterInit in the future — a moment when\n\t\t\t\t// alignCommandIntegrator is called.\n\t\t\t\tif (enabled === undefined)\n\t\t\t\t\tenabled = editor.filter.checkFeature(\n\t\t\t\t\t\teditor.widgets.registered.image.features.align\n\t\t\t\t\t);\n\n\t\t\t\t// Don't allow justify commands when widget alignment is disabled (#11004).\n\t\t\t\tif (!enabled) this.setState(CKEDITOR.TRISTATE_DISABLED);\n\t\t\t\telse {\n\t\t\t\t\tthis.setState(\n\t\t\t\t\t\twidget.data.align == value\n\t\t\t\t\t\t\t? CKEDITOR.TRISTATE_ON\n\t\t\t\t\t\t\t: value in allowed\n\t\t\t\t\t\t\t? CKEDITOR.TRISTATE_OFF\n\t\t\t\t\t\t\t: CKEDITOR.TRISTATE_DISABLED\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tevt.cancel();\n\t\t\t});\n\t\t};\n\t}\n\n\t// Returns the focused widget, if of the type specific for this plugin.\n\t// If no widget is focused, `null` is returned.\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {CKEDITOR.plugins.widget}\n\tfunction getFocusedWidget(editor) {\n\t\tlet widget = editor.widgets.focused;\n\n\t\tif (widget && widget.name == 'image') return widget;\n\n\t\treturn null;\n\t}\n\n\t// Returns a set of widget allowedContent rules, depending\n\t// on configurations like config#ae_dragresize_ie11_alignClasses or\n\t// config#ae_dragresize_ie11_captionedClass.\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction getWidgetAllowedContent(editor) {\n\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\tlet rules = {\n\t\t\t// Widget may need <div> or <p> centering wrapper.\n\t\t\tdiv: {\n\t\t\t\tmatch: centerWrapperChecker(editor),\n\t\t\t},\n\t\t\tp: {\n\t\t\t\tmatch: centerWrapperChecker(editor),\n\t\t\t},\n\t\t\timg: {\n\t\t\t\tattributes: '!src,alt,width,height',\n\t\t\t},\n\t\t\tfigure: {\n\t\t\t\tclasses: '!' + editor.config.ae_dragresize_ie11_captionedClass,\n\t\t\t},\n\t\t\tfigcaption: true,\n\t\t};\n\n\t\tif (alignClasses) {\n\t\t\t// Centering class from the config.\n\t\t\trules.div.classes = alignClasses[1];\n\t\t\trules.p.classes = rules.div.classes;\n\n\t\t\t// Left/right classes from the config.\n\t\t\trules.img.classes = alignClasses[0] + ',' + alignClasses[2];\n\t\t\trules.figure.classes += ',' + rules.img.classes;\n\t\t} else {\n\t\t\t// Centering with text-align.\n\t\t\trules.div.styles = 'text-align';\n\t\t\trules.p.styles = 'text-align';\n\n\t\t\trules.img.styles = 'float';\n\t\t\trules.figure.styles = 'float,display';\n\t\t}\n\n\t\treturn rules;\n\t}\n\n\t// Returns a set of widget feature rules, depending\n\t// on editor configuration. Note that the following may not cover\n\t// all the possible cases since requiredContent supports a single\n\t// tag only.\n\t//\n\t// @param {CKEDITOR.editor}\n\t// @returns {Object}\n\tfunction getWidgetFeatures(editor) {\n\t\tlet alignClasses = editor.config.ae_dragresize_ie11_alignClasses;\n\n\t\tlet features = {\n\t\t\tdimension: {\n\t\t\t\trequiredContent: 'img[width,height]',\n\t\t\t},\n\t\t\talign: {\n\t\t\t\trequiredContent:\n\t\t\t\t\t'img' +\n\t\t\t\t\t(alignClasses ? '(' + alignClasses[0] + ')' : '{float}'),\n\t\t\t},\n\t\t\tcaption: {\n\t\t\t\trequiredContent: 'figcaption',\n\t\t\t},\n\t\t};\n\n\t\treturn features;\n\t}\n\n\t// Returns element which is styled, considering current\n\t// state of the widget.\n\t//\n\t// @see CKEDITOR.plugins.widget#applyStyle\n\t// @param {CKEDITOR.plugins.widget} widget\n\t// @returns {CKEDITOR.dom.element}\n\tfunction getStyleableElement(widget) {\n\t\treturn widget.data.hasCaption ? widget.element : widget.parts.image;\n\t}\n})();\n\n/**\n * A CSS class applied to the `<figure>` element of a captioned image.\n *\n * Read more in the [documentation](#!/guide/dev_captionedimage) and see the\n * [SDK sample](http://sdk.ckeditor.com/samples/captionedimage.html).\n *\n *\t\t// Changes the class to \"captionedImage\".\n *\t\tconfig.ae_dragresize_ie11_captionedClass = 'captionedImage';\n *\n * @cfg {String} [ae_dragresize_ie11_captionedClass='image']\n * @member CKEDITOR.config\n */\nCKEDITOR.config.ae_dragresize_ie11_captionedClass = 'image';\n","(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_embed')) {\n\t\treturn;\n\t}\n\n\tlet REGEX_HTTP = /^https?/;\n\n\tlet REGEX_DEFAULT_LINK = /<a href=/;\n\n\tCKEDITOR.DEFAULT_AE_EMBED_URL_TPL =\n\t\t'http://alloy.iframe.ly/api/oembed?url={url}&callback={callback}';\n\tCKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL =\n\t\t'<div data-ae-embed-url=\"{url}\"></div>';\n\tCKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL = '<a href=\"{url}\">{url}</a>';\n\t/**\n\t * CKEditor plugin which adds the infrastructure to embed urls as media objects using an oembed\n\t * service. By default, and for demoing purposes only, the oembed service is hosted in iframe.ly\n\t * at //alloy.iframe.ly/api/oembed?url={url}&callback={callback}. Note this should be changed to\n\t * a self-hosted or paid service in production environments. Access to the alloy.iframe.ly endpoint\n\t * may be restricted per domain due to significant traffic.\n\t *\n\t * This plugin adds an `embedUrl` command that can be used to easily embed a URL and transform it\n\t * to an embedded content.\n\t *\n\t * @class CKEDITOR.plugins.ae_embed\n\t */\n\tCKEDITOR.plugins.add('ae_embed', {\n\t\trequires: 'widget',\n\t\tinit: function(editor) {\n\t\t\tlet AE_EMBED_URL_TPL = new CKEDITOR.template(\n\t\t\t\teditor.config.embedUrlTemplate ||\n\t\t\t\t\tCKEDITOR.DEFAULT_AE_EMBED_URL_TPL\n\t\t\t);\n\t\t\tlet AE_EMBED_WIDGET_TPL = new CKEDITOR.template(\n\t\t\t\teditor.config.embedWidgetTpl ||\n\t\t\t\t\tCKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL\n\t\t\t);\n\t\t\tlet AE_EMBED_DEFAULT_LINK_TPL = new CKEDITOR.template(\n\t\t\t\teditor.config.embedLinkDefaultTpl ||\n\t\t\t\t\tCKEDITOR.DEFAULT_AE_EMBED_DEFAULT_LINK_TPL\n\t\t\t);\n\n\t\t\t// Default function to upcast DOM elements to embed widgets.\n\t\t\t// It matches CKEDITOR.DEFAULT_AE_EMBED_WIDGET_TPL\n\t\t\tlet defaultEmbedWidgetUpcastFn = function(element, data) {\n\t\t\t\tif (\n\t\t\t\t\telement.name === 'div' &&\n\t\t\t\t\telement.attributes['data-ae-embed-url']\n\t\t\t\t) {\n\t\t\t\t\tdata.url = element.attributes['data-ae-embed-url'];\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Create a embedUrl command that can be invoked to easily embed media URLs\n\t\t\teditor.addCommand('embedUrl', {\n\t\t\t\texec: function(editor, data) {\n\t\t\t\t\teditor.insertHtml(\n\t\t\t\t\t\tAE_EMBED_WIDGET_TPL.output({\n\t\t\t\t\t\t\turl: data.url,\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t// Create a widget to properly handle embed operations\n\t\t\teditor.widgets.add('ae_embed', {\n\t\t\t\tmask: true,\n\t\t\t\trequiredContent: 'div[data-ae-embed-url]',\n\n\t\t\t\t/**\n\t\t\t\t * Listener to be executed every time the widget's data changes. It takes care of\n\t\t\t\t * requesting the embed object to the configured oembed service and render it in\n\t\t\t\t * the editor\n\t\t\t\t *\n\t\t\t\t * @method data\n\t\t\t\t * @param {event} event Data change event\n\t\t\t\t */\n\t\t\t\tdata: function(event) {\n\t\t\t\t\tlet widget = this;\n\n\t\t\t\t\tlet url = event.data.url;\n\n\t\t\t\t\tif (url) {\n\t\t\t\t\t\tCKEDITOR.tools.jsonp(\n\t\t\t\t\t\t\tAE_EMBED_URL_TPL,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\turl: encodeURIComponent(url),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction(response) {\n\t\t\t\t\t\t\t\tif (response.html) {\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tREGEX_DEFAULT_LINK.test(response.html)\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\twidget.createATag(url);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twidget.element.setHtml(response.html);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\twidget.createATag(url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction(_msg) {\n\t\t\t\t\t\t\t\twidget.createATag(url);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tcreateATag: function(url) {\n\t\t\t\t\tthis.editor.execCommand('undo');\n\n\t\t\t\t\tlet aTagHtml = AE_EMBED_DEFAULT_LINK_TPL.output({\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.editor.insertHtml(aTagHtml);\n\t\t\t\t\tthis.editor.fire('actionPerformed', this);\n\t\t\t\t},\n\n\t\t\t\t/**\n\t\t\t\t * Function used to upcast an element to ae_embed widgets.\n\t\t\t\t *\n\t\t\t\t * @method upcast\n\t\t\t\t * @param {CKEDITOR.htmlParser.element} element The element to be checked\n\t\t\t\t * @param {Object} data The object that will be passed to the widget\n\t\t\t\t */\n\t\t\t\tupcast: function(element, data) {\n\t\t\t\t\tlet embedWidgetUpcastFn =\n\t\t\t\t\t\teditor.config.embedWidgetUpcastFn ||\n\t\t\t\t\t\tdefaultEmbedWidgetUpcastFn;\n\n\t\t\t\t\treturn embedWidgetUpcastFn(element, data);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t// Add a listener to handle paste events and turn links into embed objects\n\t\t\teditor.once('contentDom', function() {\n\t\t\t\teditor.on('paste', function(event) {\n\t\t\t\t\tlet link = event.data.dataValue;\n\n\t\t\t\t\tif (REGEX_HTTP.test(link)) {\n\t\t\t\t\t\tevent.stop();\n\n\t\t\t\t\t\teditor.execCommand('embedUrl', {\n\t\t\t\t\t\t\turl: event.data.dataValue,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Add a listener to handle selection change events and properly detect editor\n\t\t\t// interactions on the widgets without messing with widget native selection\n\t\t\teditor.on('selectionChange', function(_event) {\n\t\t\t\tlet selection = editor.getSelection();\n\n\t\t\t\tif (selection) {\n\t\t\t\t\tlet element = selection.getSelectedElement();\n\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\tlet widgetElement = element.findOne(\n\t\t\t\t\t\t\t'[data-widget=\"ae_embed\"]'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (widgetElement) {\n\t\t\t\t\t\t\tlet region = element.getClientRect();\n\n\t\t\t\t\t\t\tlet scrollPosition = new CKEDITOR.dom.window(\n\t\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t).getScrollPosition();\n\t\t\t\t\t\t\tregion.left -= scrollPosition.x;\n\t\t\t\t\t\t\tregion.top += scrollPosition.y;\n\n\t\t\t\t\t\t\tregion.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\n\t\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\t\tnativeEvent: {},\n\t\t\t\t\t\t\t\tselectionData: {\n\t\t\t\t\t\t\t\t\telement: widgetElement,\n\t\t\t\t\t\t\t\t\tregion: region,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Add a filter to skip filtering widget elements\n\t\t\teditor.filter.addElementCallback(function(element) {\n\t\t\t\tif ('data-ae-embed-url' in element.attributes) {\n\t\t\t\t\treturn CKEDITOR.FILTER_SKIP_TREE;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t});\n})();\n","import Resizer from './Resizer.es';\n\nif (!CKEDITOR.plugins.get('embedurl')) {\n\tconst REGEX_HTTP = /^https?/;\n\n\tCKEDITOR.DEFAULT_LFR_EMBED_WIDGET_TPL =\n\t\t'<div data-embed-url=\"{url}\" class=\"embed-responsive embed-responsive-16by9\">{content}<div class=\"embed-help-message\">{helpMessageIcon}<span> {helpMessage}</span></div></div><br>';\n\n\t/**\n\t * Enum for supported embed alignments\n\t * @type {Object}\n\t */\n\n\tconst EMBED_ALIGNMENT = {\n\t\tCENTER: 'center',\n\t\tLEFT: 'left',\n\t\tRIGHT: 'right',\n\t};\n\n\t/**\n\t * Enum values for supported embed alignments\n\t * @type {Array}\n\t */\n\n\tconst ALIGN_VALUES = [\n\t\tEMBED_ALIGNMENT.CENTER,\n\t\tEMBED_ALIGNMENT.LEFT,\n\t\tEMBED_ALIGNMENT.RIGHT,\n\t];\n\n\t/**\n\t * Necessary styles for the center alignment\n\t * @type {Array.<Object>}\n\t */\n\n\tconst CENTERED_EMBED_STYLE = [\n\t\t{\n\t\t\tname: 'display',\n\t\t\tvalue: 'block',\n\t\t},\n\t\t{\n\t\t\tname: 'margin-left',\n\t\t\tvalue: 'auto',\n\t\t},\n\t\t{\n\t\t\tname: 'margin-right',\n\t\t\tvalue: 'auto',\n\t\t},\n\t];\n\n\t/**\n\t * Retrieves the alignment value of an embed element.\n\t *\n\t * @param {CKEDITOR.dom.element} embed The embed element\n\t * @return {String} The alignment value\n\t */\n\n\tconst getEmbedAlignment = function(embed) {\n\t\tlet embedAlignment = embed.getStyle('float');\n\n\t\tif (\n\t\t\t!embedAlignment ||\n\t\t\tembedAlignment === 'inherit' ||\n\t\t\tembedAlignment === 'none'\n\t\t) {\n\t\t\tembedAlignment = embed.getAttribute('align');\n\t\t}\n\n\t\tif (!embedAlignment) {\n\t\t\tconst centeredEmbed = CENTERED_EMBED_STYLE.every(style => {\n\t\t\t\tlet styleCheck = embed.getStyle(style.name) === style.value;\n\n\t\t\t\tif (!styleCheck && style.vendorPrefixes) {\n\t\t\t\t\tstyleCheck = style.vendorPrefixes.some(\n\t\t\t\t\t\tvendorPrefix =>\n\t\t\t\t\t\t\tembed.getStyle(vendorPrefix + style.name) ===\n\t\t\t\t\t\t\tstyle.value\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn styleCheck;\n\t\t\t});\n\n\t\t\tembedAlignment = centeredEmbed ? EMBED_ALIGNMENT.CENTER : null;\n\t\t}\n\n\t\treturn embedAlignment;\n\t};\n\n\t/**\n\t * Removes the alignment value of an embed\n\t *\n\t * @param {CKEDITOR.dom.element} embed The embed element\n\t * @param {String} embedAlignment The embed alignment value to be removed\n\t */\n\n\tconst removeEmbedAlignment = function(embed, embedAlignment) {\n\t\tif (\n\t\t\tembedAlignment === EMBED_ALIGNMENT.LEFT ||\n\t\t\tembedAlignment === EMBED_ALIGNMENT.RIGHT\n\t\t) {\n\t\t\tembed.removeStyle('float');\n\n\t\t\tif (embedAlignment === getEmbedAlignment(embed)) {\n\t\t\t\tembed.removeAttribute('align');\n\t\t\t}\n\t\t} else if (embedAlignment === EMBED_ALIGNMENT.CENTER) {\n\t\t\tCENTERED_EMBED_STYLE.forEach(style => {\n\t\t\t\tembed.removeStyle(style.name);\n\n\t\t\t\tif (style.vendorPrefixes) {\n\t\t\t\t\tstyle.vendorPrefixes.forEach(vendorPrefix =>\n\t\t\t\t\t\tembed.removeStyle(vendorPrefix + style.name)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * Sets the alignment value of an embed\n\t *\n\t * @param {CKEDITOR.dom.element} embed The embed element\n\t * @param {String} embedAlignment The embed alignment value to be set\n\t */\n\n\tconst setEmbedAlignment = function(embed, embedAlignment) {\n\t\tremoveEmbedAlignment(embed, getEmbedAlignment(embed));\n\n\t\tif (\n\t\t\tembedAlignment === EMBED_ALIGNMENT.LEFT ||\n\t\t\tembedAlignment === EMBED_ALIGNMENT.RIGHT\n\t\t) {\n\t\t\tembed.setStyle('float', embedAlignment);\n\t\t} else if (embedAlignment === EMBED_ALIGNMENT.CENTER) {\n\t\t\tCENTERED_EMBED_STYLE.forEach(style => {\n\t\t\t\tembed.setStyle(style.name, style.value);\n\n\t\t\t\tif (style.vendorPrefixes) {\n\t\t\t\t\tstyle.vendorPrefixes.forEach(vendorPrefix =>\n\t\t\t\t\t\tembed.setStyle(vendorPrefix + style.name, style.value)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst getSelectedElement = function(editor) {\n\t\tconst result = {\n\t\t\talignment: null,\n\t\t\telement: null,\n\t\t};\n\n\t\tconst selection = editor.getSelection();\n\n\t\tif (selection) {\n\t\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\t\tif (\n\t\t\t\tselectedElement &&\n\t\t\t\tselectedElement.getAttribute('data-cke-widget-wrapper')\n\t\t\t) {\n\t\t\t\tresult.alignment = getEmbedAlignment(selectedElement);\n\t\t\t\tresult.element = selectedElement;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tconst resizeElement = function(el, width, height) {\n\t\tconst wrapperElement = el.parentElement;\n\n\t\tif (wrapperElement && width > 0 && height > 0) {\n\t\t\tconst rect = wrapperElement.getBoundingClientRect();\n\n\t\t\tconst pwidth =\n\t\t\t\twidth >= rect.width\n\t\t\t\t\t? 100\n\t\t\t\t\t: Math.floor((width / rect.width) * 100);\n\t\t\tconst style = `width:${pwidth}%;`;\n\n\t\t\twrapperElement.setAttribute('style', style);\n\n\t\t\tconst widgetElement = wrapperElement.querySelector(\n\t\t\t\t'[data-widget=\"embedurl\"]'\n\t\t\t);\n\n\t\t\tif (widgetElement) {\n\t\t\t\tlet styles =\n\t\t\t\t\tJSON.parse(widgetElement.getAttribute('data-styles')) || {};\n\n\t\t\t\tstyles.width = `${width}px`;\n\t\t\t\tstyles.height = `${height}px`;\n\n\t\t\t\twidgetElement.setAttribute(\n\t\t\t\t\t'data-styles',\n\t\t\t\t\tJSON.stringify(styles)\n\t\t\t\t);\n\n\t\t\t\tconst iframeElement = widgetElement.querySelector('iframe');\n\n\t\t\t\tif (iframeElement) {\n\t\t\t\t\tiframeElement.setAttribute('width', width);\n\t\t\t\t\tiframeElement.setAttribute('height', height);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tconst selectWidget = function(editor) {\n\t\tsetTimeout(() => {\n\t\t\tconst selection = editor.getSelection();\n\n\t\t\tif (selection) {\n\t\t\t\tconst wrapperElement = selection.root.find(\n\t\t\t\t\t'[data-cke-widget-wrapper]'\n\t\t\t\t);\n\n\t\t\t\tif (wrapperElement) {\n\t\t\t\t\tconst elementList = wrapperElement.$;\n\t\t\t\t\tif (elementList.length > 0) {\n\t\t\t\t\t\tconst lastElement = new CKEDITOR.dom.element(\n\t\t\t\t\t\t\telementList[elementList.length - 1]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst imageElement = lastElement.findOne('img');\n\t\t\t\t\t\tconst widgetElement = lastElement.findOne(\n\t\t\t\t\t\t\t'[data-widget=\"embedurl\"]'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (imageElement && widgetElement) {\n\t\t\t\t\t\t\tconst range = editor.createRange();\n\n\t\t\t\t\t\t\trange.setStart(widgetElement, 0);\n\t\t\t\t\t\t\trange.setEnd(imageElement, 1);\n\n\t\t\t\t\t\t\tselection.selectRanges([range]);\n\t\t\t\t\t\t\tselection.selectElement(lastElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 0);\n\t};\n\n\tlet currentAlignment = null;\n\tlet currentElement = null;\n\tlet resizer = null;\n\n\t/**\n\t * CKEditor plugin which adds the infrastructure to embed urls as media objects\n\t *\n\t * This plugin adds an `embedUrl` command that can be used to easily embed a URL and transform it\n\t * to an embedded content.\n\t *\n\t * @class CKEDITOR.plugins.embedurl\n\t */\n\n\tCKEDITOR.plugins.add('embedurl', {\n\t\trequires: 'widget',\n\n\t\tinit: editor => {\n\t\t\tconst LFR_EMBED_WIDGET_TPL = new CKEDITOR.template(\n\t\t\t\teditor.config.embedWidgetTpl ||\n\t\t\t\t\tCKEDITOR.DEFAULT_LFR_EMBED_WIDGET_TPL\n\t\t\t);\n\n\t\t\tlet providers = editor.config.embedProviders || [];\n\n\t\t\tproviders = providers.map(provider => {\n\t\t\t\treturn {\n\t\t\t\t\tid: provider.id,\n\t\t\t\t\ttpl: new CKEDITOR.template(\n\t\t\t\t\t\t`<div data-embed-id=\"{embedId}\">${provider.tpl}</div>`\n\t\t\t\t\t),\n\t\t\t\t\ttype: provider.type,\n\t\t\t\t\turlSchemes: provider.urlSchemes.map(\n\t\t\t\t\t\tscheme => new RegExp(scheme)\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tconst generateEmbedContent = (url, content) => {\n\t\t\t\treturn LFR_EMBED_WIDGET_TPL.output({\n\t\t\t\t\tcontent: content,\n\t\t\t\t\thelpMessage: AlloyEditor.Strings.videoPlaybackDisabled,\n\t\t\t\t\thelpMessageIcon: Liferay.Util.getLexiconIconTpl(\n\t\t\t\t\t\t'info-circle'\n\t\t\t\t\t),\n\t\t\t\t\turl: url,\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst defaultEmbedWidgetUpcastFn = (element, data) => {\n\t\t\t\tlet upcastWidget = false;\n\n\t\t\t\tif (\n\t\t\t\t\telement.name === 'div' &&\n\t\t\t\t\telement.attributes['data-embed-url']\n\t\t\t\t) {\n\t\t\t\t\tdata.url = element.attributes['data-embed-url'];\n\n\t\t\t\t\tupcastWidget = true;\n\t\t\t\t} else if (\n\t\t\t\t\telement.name === 'div' &&\n\t\t\t\t\telement.attributes['data-embed-id']\n\t\t\t\t) {\n\t\t\t\t\tconst iframe = element.children[0];\n\n\t\t\t\t\tdata.url = iframe.attributes.src;\n\n\t\t\t\t\tconst embedContent = generateEmbedContent(\n\t\t\t\t\t\tdata.url,\n\t\t\t\t\t\telement.getOuterHtml()\n\t\t\t\t\t);\n\n\t\t\t\t\tconst widgetFragment = new CKEDITOR.htmlParser.fragment.fromHtml(\n\t\t\t\t\t\tembedContent\n\t\t\t\t\t);\n\n\t\t\t\t\tupcastWidget = widgetFragment.children[0];\n\n\t\t\t\t\tupcastWidget.attributes['data-styles'] = JSON.stringify(\n\t\t\t\t\t\telement.styles\n\t\t\t\t\t);\n\t\t\t\t\tupcastWidget.removeClass('embed-responsive');\n\t\t\t\t\tupcastWidget.removeClass('embed-responsive-16by9');\n\n\t\t\t\t\telement.replaceWith(upcastWidget);\n\t\t\t\t}\n\n\t\t\t\treturn upcastWidget;\n\t\t\t};\n\n\t\t\tconst showError = errorMsg => {\n\t\t\t\teditor.fire('error', errorMsg);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\teditor.getSelection().removeAllRanges();\n\n\t\t\t\t\teditor.focus();\n\n\t\t\t\t\tresizer.hide();\n\t\t\t\t}, 0);\n\t\t\t};\n\n\t\t\teditor.addCommand('embedUrl', {\n\t\t\t\texec: (editor, data) => {\n\t\t\t\t\tconst type = data.type;\n\t\t\t\t\tconst url = data.url;\n\t\t\t\t\tlet content;\n\n\t\t\t\t\tif (REGEX_HTTP.test(url)) {\n\t\t\t\t\t\tconst validProvider = providers\n\t\t\t\t\t\t\t.filter(provider => {\n\t\t\t\t\t\t\t\treturn type ? provider.type === type : true;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.some(provider => {\n\t\t\t\t\t\t\t\tconst scheme = provider.urlSchemes.find(\n\t\t\t\t\t\t\t\t\tscheme => scheme.test(url)\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (scheme) {\n\t\t\t\t\t\t\t\t\tconst embedId = scheme.exec(url)[1];\n\n\t\t\t\t\t\t\t\t\tcontent = provider.tpl.output({\n\t\t\t\t\t\t\t\t\t\tembedId: embedId,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn scheme;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (validProvider) {\n\t\t\t\t\t\t\teditor._selectEmbedWidget = url;\n\n\t\t\t\t\t\t\tconst embedContent = generateEmbedContent(\n\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\teditor.insertHtml(embedContent);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowError(AlloyEditor.Strings.platformNotSupported);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshowError(AlloyEditor.Strings.enterValidUrl);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\teditor.widgets.add('embedurl', {\n\t\t\t\tdraggable: false,\n\t\t\t\tmask: true,\n\t\t\t\trequiredContent: 'div[data-embed-url]',\n\n\t\t\t\tdata(event) {\n\t\t\t\t\tconst instance = this;\n\n\t\t\t\t\t// Sync dimensions and alignment with editor wrapper\n\n\t\t\t\t\tconst stylesJSON = instance.element.getAttribute(\n\t\t\t\t\t\t'data-styles'\n\t\t\t\t\t);\n\n\t\t\t\t\tlet styles = stylesJSON ? JSON.parse(stylesJSON) : null;\n\n\t\t\t\t\tif (!styles) {\n\t\t\t\t\t\tconst iframe = instance.wrapper.findOne('iframe');\n\n\t\t\t\t\t\tconst bounds = instance.wrapper.$.getBoundingClientRect();\n\t\t\t\t\t\tconst width = iframe.getAttribute('width');\n\n\t\t\t\t\t\tconst pwidth =\n\t\t\t\t\t\t\twidth >= bounds.width\n\t\t\t\t\t\t\t\t? 100\n\t\t\t\t\t\t\t\t: Math.round((width / bounds.width) * 100);\n\n\t\t\t\t\t\tstyles = {\n\t\t\t\t\t\t\twidth: `${pwidth}%`,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tinstance.wrapper.setAttribute(\n\t\t\t\t\t\t'style',\n\t\t\t\t\t\tCKEDITOR.tools.writeCssText(styles)\n\t\t\t\t\t);\n\n\t\t\t\t\tif (editor._selectEmbedWidget === event.data.url) {\n\t\t\t\t\t\tselectWidget(editor);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tdowncast(widget) {\n\t\t\t\t\tconst embedContent = widget.children[0];\n\n\t\t\t\t\tembedContent.attributes.class =\n\t\t\t\t\t\t'embed-responsive embed-responsive-16by9';\n\t\t\t\t\tembedContent.attributes.style = CKEDITOR.tools.writeCssText(\n\t\t\t\t\t\twidget.parent.styles\n\t\t\t\t\t);\n\n\t\t\t\t\treturn embedContent;\n\t\t\t\t},\n\n\t\t\t\tupcast(element, data) {\n\t\t\t\t\tconst embedWidgetUpcastFn =\n\t\t\t\t\t\teditor.config.embedWidgetUpcastFn ||\n\t\t\t\t\t\tdefaultEmbedWidgetUpcastFn;\n\n\t\t\t\t\treturn embedWidgetUpcastFn(element, data);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\twindow.addEventListener(\n\t\t\t\t'resize',\n\t\t\t\t() => {\n\t\t\t\t\tresizer.hide();\n\t\t\t\t\tselectWidget(editor);\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\n\t\t\teditor.on('selectionChange', _event => {\n\t\t\t\tconst selection = editor.getSelection();\n\n\t\t\t\tif (selection) {\n\t\t\t\t\tconst element = selection.getSelectedElement();\n\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\tconst widgetElement = element.findOne(\n\t\t\t\t\t\t\t'[data-widget=\"embedurl\"]'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (widgetElement) {\n\t\t\t\t\t\t\tconst scrollPosition = new CKEDITOR.dom.window(\n\t\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t).getScrollPosition();\n\n\t\t\t\t\t\t\tlet region = element.getClientRect();\n\n\t\t\t\t\t\t\tregion.direction = CKEDITOR.SELECTION_BOTTOM_TO_TOP;\n\t\t\t\t\t\t\tregion.left -= scrollPosition.x;\n\t\t\t\t\t\t\tregion.top += scrollPosition.y;\n\n\t\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\t\tnativeEvent: {},\n\t\t\t\t\t\t\t\tselectionData: {\n\t\t\t\t\t\t\t\t\telement: widgetElement,\n\t\t\t\t\t\t\t\t\tregion: region,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst imageElement = element.findOne(\n\t\t\t\t\t\t\t'img.cke_widget_mask'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (imageElement) {\n\t\t\t\t\t\t\tresizer.show(imageElement.$);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresizer.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\teditor.on('destroy', () => {\n\t\t\t\tconst resizeElement = document.getElementById('ckimgrsz');\n\n\t\t\t\tif (resizeElement) {\n\t\t\t\t\tresizeElement.remove();\n\t\t\t\t}\n\n\t\t\t\tdocument.removeEventListener('mousedown', mouseDownListener);\n\t\t\t});\n\n\t\t\teditor.on('blur', () => {\n\t\t\t\tresizer.hide();\n\t\t\t});\n\n\t\t\teditor.filter.addElementCallback(element => {\n\t\t\t\tif ('data-embed-url' in element.attributes) {\n\t\t\t\t\treturn CKEDITOR.FILTER_SKIP_TREE;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst mouseDownListener = event => {\n\t\t\t\tconst result = getSelectedElement(editor);\n\n\t\t\t\tcurrentAlignment = result.alignment;\n\t\t\t\tcurrentElement = result.element;\n\n\t\t\t\tif (resizer.isHandle(event.target)) {\n\t\t\t\t\tresizer.initDrag(event);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tresizer = new Resizer(editor, {\n\t\t\t\tonComplete(element, width, height) {\n\t\t\t\t\tresizeElement(element, width, height);\n\n\t\t\t\t\tif (currentAlignment && currentElement) {\n\t\t\t\t\t\tsetEmbedAlignment(currentElement, currentAlignment);\n\t\t\t\t\t}\n\t\t\t\t\tselectWidget(editor);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdocument.addEventListener('mousedown', mouseDownListener, false);\n\t\t},\n\n\t\tafterInit: editor => {\n\t\t\tALIGN_VALUES.forEach(alignValue => {\n\t\t\t\tconst command = editor.getCommand('justify' + alignValue);\n\n\t\t\t\tif (command) {\n\t\t\t\t\tcommand.on('exec', event => {\n\t\t\t\t\t\tconst selectedElement = editor\n\t\t\t\t\t\t\t.getSelection()\n\t\t\t\t\t\t\t.getSelectedElement();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tselectedElement &&\n\t\t\t\t\t\t\tselectedElement.getAttribute(\n\t\t\t\t\t\t\t\t'data-cke-widget-wrapper'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst selectedEmbed = selectedElement.findOne(\n\t\t\t\t\t\t\t\t'[data-widget=\"embedurl\"] [data-embed-id]'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (selectedEmbed) {\n\t\t\t\t\t\t\t\tconst embedAlignment = getEmbedAlignment(\n\t\t\t\t\t\t\t\t\tselectedElement\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (embedAlignment === alignValue) {\n\t\t\t\t\t\t\t\t\tremoveEmbedAlignment(\n\t\t\t\t\t\t\t\t\t\tselectedElement,\n\t\t\t\t\t\t\t\t\t\talignValue\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tsetEmbedAlignment(\n\t\t\t\t\t\t\t\t\t\tselectedElement,\n\t\t\t\t\t\t\t\t\t\talignValue\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tcurrentElement = selectedElement;\n\t\t\t\t\t\t\t\tcurrentAlignment = getEmbedAlignment(\n\t\t\t\t\t\t\t\t\tselectedElement\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tconst imageElement = selectedElement.findOne(\n\t\t\t\t\t\t\t\t\t'img'\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (imageElement) {\n\t\t\t\t\t\t\t\t\tresizer.show(imageElement.$);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tevent.cancel();\n\n\t\t\t\t\t\t\t\tconst elementPath = new CKEDITOR.dom.elementPath(\n\t\t\t\t\t\t\t\t\tselectedElement\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tALIGN_VALUES.forEach(alignValue => {\n\t\t\t\t\t\t\t\t\tconst command = editor.getCommand(\n\t\t\t\t\t\t\t\t\t\t'justify' + alignValue\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\tif (command) {\n\t\t\t\t\t\t\t\t\t\tcommand.refresh(editor, elementPath);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tcommand.on('refresh', event => {\n\t\t\t\t\t\tconst lastElement = event.data.path.lastElement;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tlastElement &&\n\t\t\t\t\t\t\tlastElement.getAttribute(\n\t\t\t\t\t\t\t\t'data-cke-widget-wrapper'\n\t\t\t\t\t\t\t) &&\n\t\t\t\t\t\t\tlastElement.findOne('[data-widget] [data-embed-id]')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst embedAlignment = getEmbedAlignment(\n\t\t\t\t\t\t\t\tlastElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tevent.sender.setState(\n\t\t\t\t\t\t\t\tembedAlignment === alignValue\n\t\t\t\t\t\t\t\t\t? CKEDITOR.TRISTATE_ON\n\t\t\t\t\t\t\t\t\t: CKEDITOR.TRISTATE_OFF\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tevent.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t});\n}\n\nexport default CKEDITOR.plugins.get('embedurl');\n","import DragEvent from './DragEvent.es';\n\nconst IMAGE_HANDLES = ['tl', 'tr', 'bl', 'br'];\n\nconst POSITION_ELEMENT_FN = {\n\tbl(handle, left, top, box) {\n\t\tpositionElement(handle, -3 + left, box.height - 4 + top);\n\t},\n\tbr(handle, left, top, box) {\n\t\tpositionElement(handle, box.width - 4 + left, box.height - 4 + top);\n\t},\n\trm(handle, left, top, box) {\n\t\tpositionElement(\n\t\t\thandle,\n\t\t\tbox.width - 4 + left,\n\t\t\tMath.round(box.height / 2) - 3 + top\n\t\t);\n\t},\n\ttl(handle, left, top, _box) {\n\t\tpositionElement(handle, left - 3, top - 3);\n\t},\n\ttr(handle, left, top, box) {\n\t\tpositionElement(handle, box.width - 4 + left, -3 + top);\n\t},\n};\n\nconst positionElement = (el, left, top) => {\n\tel.style.left = `${left}px`;\n\tel.style.top = `${top}px`;\n};\n\nconst getBoundingBox = (window, el) => {\n\tconst rect = el.getBoundingClientRect();\n\n\treturn {\n\t\theight: rect.height,\n\t\tleft: rect.left + window.pageXOffset,\n\t\ttop: rect.top + window.pageYOffset,\n\t\twidth: rect.width,\n\t};\n};\n\nclass Resizer {\n\tconstructor(editor, cfg = {}) {\n\t\tthis.cfg = cfg;\n\t\tthis.editor = editor;\n\n\t\tthis.document = editor.document ? editor.document.$ : document;\n\t\tthis.window = editor.window ? editor.window.$ : window;\n\n\t\tthis.box = null;\n\t\tthis.container = null;\n\t\tthis.handles = {};\n\t\tthis.preview = null;\n\t\tthis.previewBox = null;\n\t\tthis.result = null;\n\n\t\tthis.init();\n\t}\n\n\tinit() {\n\t\tthis.container = this.document.createElement('div');\n\t\tthis.container.id = 'ckimgrsz';\n\n\t\tthis.preview = this.document.createElement('span');\n\n\t\tthis.container.appendChild(this.preview);\n\n\t\tthis.handles = {};\n\n\t\tIMAGE_HANDLES.forEach(handleName => {\n\t\t\tthis.handles[handleName] = this.createHandle(handleName);\n\t\t});\n\n\t\tconst keys = Object.keys(this.handles);\n\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tthis.container.appendChild(this.handles[keys[i]]);\n\t\t}\n\t}\n\n\tcreateHandle(name) {\n\t\tconst el = this.document.createElement('i');\n\n\t\tel.classList.add(name);\n\n\t\treturn el;\n\t}\n\n\tisHandle(el) {\n\t\tconst keys = Object.keys(this.handles);\n\n\t\tlet result = false;\n\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tif (this.handles[keys[i]] === el) {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tshow(el) {\n\t\tconst uiNode = this.editor.config.uiNode || document.body;\n\n\t\tthis.el = el;\n\n\t\tthis.box = getBoundingBox(this.window, this.el);\n\n\t\tpositionElement(\n\t\t\tthis.container,\n\t\t\tthis.box.left,\n\t\t\tthis.box.top + uiNode.scrollTop\n\t\t);\n\n\t\tuiNode.appendChild(this.container);\n\n\t\tthis.el.classList.add('ckimgrsz');\n\n\t\tthis.showHandles();\n\t}\n\n\thide() {\n\t\tconst elements = this.document.getElementsByClassName('ckimgrsz');\n\n\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\telements[i].classList.remove('ckimgrsz');\n\t\t}\n\n\t\tthis.hideHandles();\n\n\t\tif (this.container.parentNode) {\n\t\t\tthis.container.parentNode.removeChild(this.container);\n\t\t}\n\t}\n\n\tinitDrag(event) {\n\t\tif (event.button !== 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst drag = new DragEvent(this.window, this.document);\n\n\t\tdrag.onStart = () => {\n\t\t\tthis.showPreview();\n\n\t\t\tthis.isDragging = true;\n\n\t\t\tthis.editor.getSelection().lock();\n\t\t};\n\n\t\tdrag.onDrag = () => {\n\t\t\tthis.calculateSize(drag);\n\n\t\t\tconst editorBounds = this.editor.element.$.getBoundingClientRect();\n\n\t\t\tif (this.previewBox.width >= editorBounds.width) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updatePreview();\n\n\t\t\tconst box = this.previewBox;\n\n\t\t\tthis.updateHandles(box, box.left, box.top);\n\t\t};\n\n\t\tdrag.onRelease = () => {\n\t\t\tthis.hidePreview();\n\n\t\t\tthis.isDragging = false;\n\n\t\t\tthis.hide();\n\n\t\t\tthis.editor.getSelection().unlock();\n\n\t\t\tthis.editor.fire('saveSnapshot');\n\t\t};\n\n\t\tdrag.onComplete = () => {\n\t\t\tthis.resizeComplete();\n\n\t\t\tthis.editor.fire('saveSnapshot');\n\t\t};\n\n\t\tdrag.start(event);\n\t}\n\n\tupdateHandles(box, left = 0, top = 0) {\n\t\tconst keys = Object.keys(this.handles);\n\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tPOSITION_ELEMENT_FN[keys[i]](this.handles[keys[i]], left, top, box);\n\t\t}\n\t}\n\n\tshowHandles() {\n\t\tthis.updateHandles(this.box);\n\n\t\tconst keys = Object.keys(this.handles);\n\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tthis.handles[keys[i]].style.display = 'block';\n\t\t}\n\t}\n\n\thideHandles() {\n\t\tconst keys = Object.keys(this.handles);\n\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tthis.handles[keys[i]].style.display = 'none';\n\t\t}\n\t}\n\n\tshowPreview() {\n\t\tthis.calculateSize();\n\n\t\tthis.updatePreview();\n\n\t\tthis.preview.style.display = 'block';\n\t}\n\n\tupdatePreview() {\n\t\tpositionElement(\n\t\t\tthis.preview,\n\t\t\tthis.previewBox.left,\n\t\t\tthis.previewBox.top\n\t\t);\n\n\t\tthis.preview.style.height = `${this.previewBox.height}px`;\n\t\tthis.preview.style.width = `${this.previewBox.width}px`;\n\t}\n\n\thidePreview() {\n\t\tconst box = getBoundingBox(this.window, this.preview);\n\n\t\tthis.result = {\n\t\t\theight: box.height,\n\t\t\twidth: box.width,\n\t\t};\n\n\t\tthis.preview.style.display = 'none';\n\t}\n\n\tcalculateSize(data) {\n\t\tthis.previewBox = {\n\t\t\theight: this.box.height,\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: this.box.width,\n\t\t};\n\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst className = data.target.className;\n\n\t\tif (className.indexOf('r') >= 0) {\n\t\t\tthis.previewBox.width = Math.max(32, this.box.width + data.delta.x);\n\t\t}\n\n\t\tif (className.indexOf('b') >= 0) {\n\t\t\tthis.previewBox.height = Math.max(\n\t\t\t\t32,\n\t\t\t\tthis.box.height + data.delta.y\n\t\t\t);\n\t\t}\n\n\t\tif (className.indexOf('l') >= 0) {\n\t\t\tthis.previewBox.width = Math.max(32, this.box.width - data.delta.x);\n\t\t}\n\n\t\tif (className.indexOf('t') >= 0) {\n\t\t\tthis.previewBox.height = Math.max(\n\t\t\t\t32,\n\t\t\t\tthis.box.height - data.delta.y\n\t\t\t);\n\t\t}\n\n\t\tif (className.indexOf('m') < 0 && !data.keys.shift) {\n\t\t\tconst ratio = this.box.width / this.box.height;\n\n\t\t\tif (this.previewBox.width / this.previewBox.height > ratio) {\n\t\t\t\tthis.previewBox.height = Math.round(\n\t\t\t\t\tthis.previewBox.width / ratio\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.previewBox.width = Math.round(\n\t\t\t\t\tthis.previewBox.height * ratio\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (className.indexOf('l') >= 0) {\n\t\t\tthis.previewBox.left = this.box.width - this.previewBox.width;\n\t\t}\n\n\t\tif (className.indexOf('t') >= 0) {\n\t\t\tthis.previewBox.top = this.box.height - this.previewBox.height;\n\t\t}\n\t}\n\n\tresizeComplete() {\n\t\tthis.cfg.onComplete(this.el, this.result.width, this.result.height);\n\t}\n}\n\nexport {Resizer};\nexport default Resizer;\n","class DragEvent {\n\tconstructor(window, document) {\n\t\tthis.document = document;\n\t\tthis.window = window;\n\n\t\tthis.events = {\n\t\t\tkeydown: this.keydown.bind(this),\n\t\t\tmousemove: this.mousemove.bind(this),\n\t\t\tmouseup: this.mouseup.bind(this),\n\t\t};\n\t}\n\n\tstart(event) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tthis.target = event.target;\n\n\t\tthis.className = this.target.className;\n\n\t\tthis.startPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY,\n\t\t};\n\n\t\tthis.update(event);\n\n\t\tthis.document.addEventListener('keydown', this.events.keydown, false);\n\t\tthis.document.addEventListener(\n\t\t\t'mousemove',\n\t\t\tthis.events.mousemove,\n\t\t\tfalse\n\t\t);\n\t\tthis.document.addEventListener('mouseup', this.events.mouseup, false);\n\n\t\tthis.document.body.classList.add(`dragging-${this.className}`);\n\n\t\tif (typeof this.onStart === 'function') {\n\t\t\tthis.onStart();\n\t\t}\n\t}\n\n\tupdate(event) {\n\t\tthis.currentPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY,\n\t\t};\n\n\t\tthis.delta = {\n\t\t\tx: event.clientX - this.startPos.x,\n\t\t\ty: event.clientY - this.startPos.y,\n\t\t};\n\n\t\tthis.keys = {\n\t\t\talt: event.altKey,\n\t\t\tctrl: event.ctrlKey,\n\t\t\tshift: event.shiftKey,\n\t\t};\n\t}\n\n\tmousemove(event) {\n\t\tthis.update(event);\n\n\t\tif (typeof this.onDrag === 'function') {\n\t\t\tthis.onDrag();\n\t\t}\n\n\t\tif (event.which === 0) {\n\t\t\tthis.mouseup(event);\n\t\t}\n\t}\n\n\tkeydown(event) {\n\t\tif (event.keyCode === 27) {\n\t\t\tthis.release();\n\t\t}\n\t}\n\n\tmouseup(event) {\n\t\tthis.update(event);\n\n\t\tthis.release();\n\n\t\tif (typeof this.onComplete === 'function') {\n\t\t\tthis.onComplete();\n\t\t}\n\t}\n\n\trelease() {\n\t\tthis.document.body.classList.remove(`dragging-${this.className}`);\n\n\t\tthis.document.removeEventListener(\n\t\t\t'keydown',\n\t\t\tthis.events.keydown,\n\t\t\tfalse\n\t\t);\n\t\tthis.document.removeEventListener(\n\t\t\t'mousemove',\n\t\t\tthis.events.mousemove,\n\t\t\tfalse\n\t\t);\n\t\tthis.document.removeEventListener(\n\t\t\t'mouseup',\n\t\t\tthis.events.mouseup,\n\t\t\tfalse\n\t\t);\n\n\t\tif (typeof this.onRelease === 'function') {\n\t\t\tthis.onRelease();\n\t\t}\n\t}\n}\n\nexport {DragEvent};\nexport default DragEvent;\n","import SelectionTest from '../selections/selection-test.js';\n\n(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_imagealignment')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * Enum for supported image alignments\n\t * @type {Object}\n\t */\n\tlet IMAGE_ALIGNMENT = {\n\t\tCENTER: 'center',\n\t\tLEFT: 'left',\n\t\tRIGHT: 'right',\n\t};\n\n\t/**\n\t * Enum values for supported image alignments\n\t * @type {Array}\n\t */\n\tlet ALIGN_VALUES = [\n\t\tIMAGE_ALIGNMENT.LEFT,\n\t\tIMAGE_ALIGNMENT.RIGHT,\n\t\tIMAGE_ALIGNMENT.CENTER,\n\t];\n\n\t/**\n\t * Necessary styles for the center alignment\n\t * @type {Array.<Object>}\n\t */\n\tlet CENTERED_IMAGE_STYLE = [\n\t\t{\n\t\t\tname: 'display',\n\t\t\tvalue: 'block',\n\t\t},\n\t\t{\n\t\t\tname: 'margin-left',\n\t\t\tvalue: 'auto',\n\t\t},\n\t\t{\n\t\t\tname: 'margin-right',\n\t\t\tvalue: 'auto',\n\t\t},\n\t];\n\n\t/**\n\t * Retrieves the alignment value of an image.\n\t *\n\t * @param {CKEDITOR.dom.element} image The image element\n\t * @return {String} The alignment value\n\t */\n\tlet getImageAlignment = function(image) {\n\t\tlet imageAlignment = image.getStyle('float');\n\n\t\tif (\n\t\t\t!imageAlignment ||\n\t\t\timageAlignment === 'inherit' ||\n\t\t\timageAlignment === 'none'\n\t\t) {\n\t\t\timageAlignment = image.getAttribute('align');\n\t\t}\n\n\t\tif (!imageAlignment) {\n\t\t\tlet centeredImage = CENTERED_IMAGE_STYLE.every(function(style) {\n\t\t\t\tlet styleCheck = image.getStyle(style.name) === style.value;\n\n\t\t\t\tif (!styleCheck && style.vendorPrefixes) {\n\t\t\t\t\tstyleCheck = style.vendorPrefixes.some(function(\n\t\t\t\t\t\tvendorPrefix\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\timage.getStyle(vendorPrefix + style.name) ===\n\t\t\t\t\t\t\tstyle.value\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn styleCheck;\n\t\t\t});\n\n\t\t\tif (!imageAlignment) {\n\t\t\t\tlet imageContainer = image.$.parentNode;\n\n\t\t\t\tif (imageContainer.style.textAlign == IMAGE_ALIGNMENT.CENTER) {\n\t\t\t\t\tCENTERED_IMAGE_STYLE.forEach(function(style) {\n\t\t\t\t\t\timage.setStyle(style.name, style.value);\n\n\t\t\t\t\t\tif (style.vendorPrefixes) {\n\t\t\t\t\t\t\tstyle.vendorPrefixes.forEach(function(\n\t\t\t\t\t\t\t\tvendorPrefix\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\timage.setStyle(\n\t\t\t\t\t\t\t\t\tvendorPrefix + style.name,\n\t\t\t\t\t\t\t\t\tstyle.value\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tcenteredImage = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\timageAlignment = centeredImage ? IMAGE_ALIGNMENT.CENTER : null;\n\t\t}\n\n\t\treturn imageAlignment;\n\t};\n\n\t/**\n\t * Removes the alignment value of an image\n\t *\n\t * @param {CKEDITOR.dom.element} image The image element\n\t * @param {String} imageAlignment The image alignment value to be removed\n\t */\n\tlet removeImageAlignment = function(image, imageAlignment) {\n\t\tif (\n\t\t\timageAlignment === IMAGE_ALIGNMENT.LEFT ||\n\t\t\timageAlignment === IMAGE_ALIGNMENT.RIGHT\n\t\t) {\n\t\t\timage.removeStyle('float');\n\n\t\t\tif (imageAlignment === getImageAlignment(image)) {\n\t\t\t\timage.removeAttribute('align');\n\t\t\t}\n\t\t} else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n\t\t\tCENTERED_IMAGE_STYLE.forEach(function(style) {\n\t\t\t\timage.removeStyle(style.name);\n\n\t\t\t\tif (style.vendorPrefixes) {\n\t\t\t\t\tstyle.vendorPrefixes.forEach(function(vendorPrefix) {\n\t\t\t\t\t\timage.removeStyle(vendorPrefix + style.name);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet imageContainer = image.$.parentNode;\n\n\t\t\tif (imageContainer.style.textAlign == IMAGE_ALIGNMENT.CENTER) {\n\t\t\t\timageContainer.style.textAlign = '';\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Sets the alignment value of an image\n\t *\n\t * @param {CKEDITOR.dom.element} image The image element\n\t * @param {String} imageAlignment The image alignment value to be set\n\t */\n\tlet setImageAlignment = function(image, imageAlignment) {\n\t\tremoveImageAlignment(image, getImageAlignment(image));\n\n\t\tif (\n\t\t\timageAlignment === IMAGE_ALIGNMENT.LEFT ||\n\t\t\timageAlignment === IMAGE_ALIGNMENT.RIGHT\n\t\t) {\n\t\t\timage.setStyle('float', imageAlignment);\n\t\t} else if (imageAlignment === IMAGE_ALIGNMENT.CENTER) {\n\t\t\tCENTERED_IMAGE_STYLE.forEach(function(style) {\n\t\t\t\timage.setStyle(style.name, style.value);\n\n\t\t\t\tif (style.vendorPrefixes) {\n\t\t\t\t\tstyle.vendorPrefixes.forEach(function(vendorPrefix) {\n\t\t\t\t\t\timage.setStyle(vendorPrefix + style.name, style.value);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet imageContainer = image.$.parentNode;\n\n\t\t\timageContainer.style.textAlign = IMAGE_ALIGNMENT.CENTER;\n\t\t}\n\t};\n\n\t/**\n\t * CKEditor plugin which modifies the justify commands to properly align images. This\n\t * plugin is an excerpt of CKEditor's original image one that can be found at\n\t * https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/image/plugin.js\n\t *\n\t * @class CKEDITOR.plugins.ae_imagealignment\n\t */\n\tCKEDITOR.plugins.add('ae_imagealignment', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function registers a 'paste' event on the editing area.\n\t\t *\n\t\t * @method afterInit\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tafterInit: function(editor) {\n\t\t\tlet self = this;\n\n\t\t\tALIGN_VALUES.forEach(function(value) {\n\t\t\t\tlet command = editor.getCommand('justify' + value);\n\n\t\t\t\tif (command) {\n\t\t\t\t\tcommand.on('exec', function(event) {\n\t\t\t\t\t\tlet selectionData = editor.getSelectionData();\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tselectionData &&\n\t\t\t\t\t\t\tSelectionTest.image({\n\t\t\t\t\t\t\t\tdata: {selectionData: selectionData},\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tlet image = selectionData.element;\n\n\t\t\t\t\t\t\tlet imageAlignment = getImageAlignment(image);\n\n\t\t\t\t\t\t\tif (imageAlignment === value) {\n\t\t\t\t\t\t\t\tremoveImageAlignment(image, value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetImageAlignment(image, value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tevent.cancel();\n\n\t\t\t\t\t\t\tself.refreshCommands(\n\t\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\t\tnew CKEDITOR.dom.elementPath(image)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tcommand.on('refresh', function(event) {\n\t\t\t\t\t\tlet selectionData = {\n\t\t\t\t\t\t\telement: event.data.path.lastElement,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tSelectionTest.image({\n\t\t\t\t\t\t\t\tdata: {selectionData: selectionData},\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tlet imageAlignment = getImageAlignment(\n\t\t\t\t\t\t\t\tselectionData.element\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tthis.setState(\n\t\t\t\t\t\t\t\timageAlignment === value\n\t\t\t\t\t\t\t\t\t? CKEDITOR.TRISTATE_ON\n\t\t\t\t\t\t\t\t\t: CKEDITOR.TRISTATE_OFF\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tevent.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Forces a refresh of the modified justify commands. This is needed because the applied changes\n\t\t * do not modify the selection, so the refresh is never triggered and the UI does not update\n\t\t * properly until the next selectionChange event.\n\t\t *\n\t\t * @param {CKEDITOR.editor} editor The editor instance\n\t\t * @param {CKEDITOR.dom.elementPath} elementPath The path of the selected image\n\t\t */\n\t\trefreshCommands: function(editor, elementPath) {\n\t\t\tALIGN_VALUES.forEach(function(value) {\n\t\t\t\tlet command = editor.getCommand('justify' + value);\n\n\t\t\t\tif (command) {\n\t\t\t\t\tcommand.refresh(editor, elementPath);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_pasteimages')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEditor plugin which allows pasting images directly into the editable area. The image will be encoded\n\t * as Data URI. An event `beforeImageAdd` will be fired with the list of pasted images. If any of the listeners\n\t * returns `false` or cancels the event, the images won't be added to the content. Otherwise,\n\t * an event `imageAdd` will be fired with the inserted element into the editable area.\n\t *\n\t * @class CKEDITOR.plugins.ae_pasteimages\n\t */\n\n\t/**\n\t * Fired before adding images to the editor.\n\t * @event beforeImageAdd\n\t * @param {Array} imageFiles Array of image files\n\t */\n\n\t/**\n\t * Fired when an image is being added to the editor successfully.\n\t *\n\t * @event imageAdd\n\t * @param {CKEDITOR.dom.element} el The created image with src as Data URI\n\t * @param {File} file The image file\n\t */\n\n\tCKEDITOR.plugins.add('ae_pasteimages', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function registers a 'paste' event on the editing area.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\teditor.once(\n\t\t\t\t'contentDom',\n\t\t\t\tfunction() {\n\t\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t\teditable.attachListener(\n\t\t\t\t\t\teditable,\n\t\t\t\t\t\t'paste',\n\t\t\t\t\t\tthis._onPaste,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * The function creates an img element with src the image data as Data URI.\n\t\t * Then, it fires an 'imageAdd' event via CKEditor's event system. The passed\n\t\t * params will be:\n\t\t * - `el` - the created img element\n\t\t * - `file` - the original pasted data\n\t\t *\n\t\t * @method _onPaste\n\t\t * @protected\n\t\t * @param {CKEDITOR.dom.event} event A `paste` event, as received natively from CKEditor\n\t\t */\n\t\t_onPaste: function(event) {\n\t\t\tif (event.data.$.clipboardData) {\n\t\t\t\tlet pastedData = event.data.$.clipboardData.items[0];\n\t\t\t\tlet editor = event.listenerData.editor;\n\n\t\t\t\tif (pastedData.type.indexOf('image') === 0) {\n\t\t\t\t\tlet reader = new FileReader();\n\t\t\t\t\tlet imageFile = pastedData.getAsFile();\n\n\t\t\t\t\treader.onload = function(event) {\n\t\t\t\t\t\tlet result = editor.fire('beforeImageAdd', {\n\t\t\t\t\t\t\timageFiles: imageFile,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\tlet el = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t\t\t\t\t'<img src=\"' + event.target.result + '\">'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\teditor.insertElement(el);\n\n\t\t\t\t\t\t\tlet imageData = {\n\t\t\t\t\t\t\t\tel: el,\n\t\t\t\t\t\t\t\tfile: imageFile,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\teditor.fire('imageAdd', imageData);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\treader.readAsDataURL(imageFile);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_placeholder')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEDITOR enterMode config set the behavior of paragraphs\n\t * When the content is empty CKEDITOR keeps the enterMode string\n\t * into the content\n\t * @property\n\t * @type {string}\n\t */\n\tlet brFiller = CKEDITOR.env.needsBrFiller ? '<br>' : '';\n\n\tlet enterModeEmptyValue = {\n\t\t1: ['<p>' + brFiller + '</p>'],\n\t\t2: ['', ' ', brFiller],\n\t\t3: ['<div>' + brFiller + '</div>'],\n\t};\n\n\t/**\n\t * CKEditor plugin which allows adding a placeholder to the editor. In this case, if there\n\t * is no content to the editor, there will be hint to the user.\n\t *\n\t * @class CKEDITOR.plugins.ae_placeholder\n\t */\n\n\t/**\n\t * Specifies the placeholder class which have to be aded to editor when editor is not focused.\n\t *\n\t * @attribute placeholderClass\n\t * @default ae_placeholder\n\t * @type String\n\t */\n\n\tCKEDITOR.plugins.add('ae_placeholder', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function registers a 'blur' and 'contentDom' event listeners.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\teditor.on('blur', this._checkEmptyData, this);\n\t\t\teditor.on('change', this._checkEmptyData, this);\n\t\t\teditor.on('focus', this._removePlaceholderClass, this);\n\t\t\teditor.once('contentDom', this._checkEmptyData, this);\n\t\t},\n\n\t\t/**\n\t\t * Removes any data from the content and adds a class,\n\t\t * specified by the \"placeholderClass\" config attribute.\n\t\t *\n\t\t * @protected\n\t\t * @method _checkEmptyData\n\t\t * @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n\t\t */\n\t\t_checkEmptyData: function(event) {\n\t\t\tlet editor = event.editor;\n\n\t\t\tlet editableNode = editor.editable();\n\n\t\t\tlet innerHtml = editableNode.$.innerHTML.trim();\n\n\t\t\tlet isEmpty = enterModeEmptyValue[editor.config.enterMode].some(\n\t\t\t\tfunction(element) {\n\t\t\t\t\treturn innerHtml === element;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (isEmpty) {\n\t\t\t\teditableNode.addClass(editor.config.placeholderClass);\n\t\t\t} else {\n\t\t\t\teditableNode.removeClass(editor.config.placeholderClass);\n\t\t\t}\n\t\t},\n\n\t\t/**\n             * Remove placeholder class when input is focused\n             *\n             * @protected\n             * @method _removePlaceholderClass\n             + @param {CKEDITOR.dom.event} editor event, fired from CKEditor\n             */\n\t\t_removePlaceholderClass: function(event) {\n\t\t\tlet editor = event.editor;\n\n\t\t\tlet editorNode = new CKEDITOR.dom.element(editor.element.$);\n\n\t\t\teditorNode.removeClass(editor.config.placeholderClass);\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_selectionkeystrokes')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEditor plugin that simulates editor interaction events based on manual keystrokes. This\n\t * can be used to trigger different reactions in the editor.\n\t *\n\t * @class CKEDITOR.plugins.ae_selectionkeystrokes\n\t */\n\tCKEDITOR.plugins.add('ae_selectionkeystrokes', {\n\t\trequires: 'ae_selectionregion',\n\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t * The function adds a command to the editor for every defined selectionKeystroke\n\t\t * in the configuration and maps it to the specified keystroke.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tinit: function(editor) {\n\t\t\tif (editor.config.selectionKeystrokes) {\n\t\t\t\teditor.config.selectionKeystrokes.forEach(function(\n\t\t\t\t\tselectionKeystroke\n\t\t\t\t) {\n\t\t\t\t\tlet command = new CKEDITOR.command(editor, {\n\t\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\t\teditor.fire('editorInteraction', {\n\t\t\t\t\t\t\t\tmanualSelection: selectionKeystroke.selection,\n\t\t\t\t\t\t\t\tnativeEvent: {},\n\t\t\t\t\t\t\t\tselectionData: editor.getSelectionData(),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tlet commandName =\n\t\t\t\t\t\t'selectionKeystroke' + selectionKeystroke.selection;\n\n\t\t\t\t\teditor.addCommand(commandName, command);\n\t\t\t\t\teditor.setKeystroke(selectionKeystroke.keys, commandName);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t});\n})();\n","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_tableresize')) {\n\t\treturn;\n\t}\n\n\tlet pxUnit = CKEDITOR.tools.cssLength;\n\n\tfunction getWidth(el) {\n\t\treturn CKEDITOR.env.ie\n\t\t\t? el.$.clientWidth\n\t\t\t: parseInt(el.getComputedStyle('width'), 10);\n\t}\n\n\tfunction getBorderWidth(element, side) {\n\t\tlet computed = element.getComputedStyle('border-' + side + '-width');\n\n\t\tlet borderMap = {\n\t\t\tthin: '0px',\n\t\t\tmedium: '1px',\n\t\t\tthick: '2px',\n\t\t};\n\n\t\tif (computed.indexOf('px') < 0) {\n\t\t\t// look up keywords\n\t\t\tif (\n\t\t\t\tcomputed in borderMap &&\n\t\t\t\telement.getComputedStyle('border-style') != 'none'\n\t\t\t) {\n\t\t\t\tcomputed = borderMap[computed];\n\t\t\t} else {\n\t\t\t\tcomputed = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn parseInt(computed, 10);\n\t}\n\n\t// Gets the table row that contains the most columns.\n\tfunction getMasterPillarRow(table) {\n\t\tlet $rows = table.$.rows;\n\n\t\tlet maxCells = 0;\n\n\t\tlet cellsCount;\n\n\t\tlet $elected;\n\n\t\tlet $tr;\n\n\t\tfor (let i = 0, len = $rows.length; i < len; i++) {\n\t\t\t$tr = $rows[i];\n\t\t\tcellsCount = $tr.cells.length;\n\n\t\t\tif (cellsCount > maxCells) {\n\t\t\t\tmaxCells = cellsCount;\n\t\t\t\t$elected = $tr;\n\t\t\t}\n\t\t}\n\n\t\treturn $elected;\n\t}\n\n\tfunction buildTableColumnPillars(table) {\n\t\tlet pillars = [];\n\n\t\tlet pillarIndex = -1;\n\n\t\tlet rtl = table.getComputedStyle('direction') === 'rtl';\n\n\t\t// Get the raw row element that cointains the most columns.\n\t\tlet $tr = getMasterPillarRow(table);\n\n\t\t// Get the tbody element and position, which will be used to set the\n\t\t// top and bottom boundaries.\n\t\tlet tbody = new CKEDITOR.dom.element(table.$.tBodies[0]);\n\n\t\tlet tbodyPosition = tbody.getDocumentPosition();\n\n\t\t// Loop thorugh all cells, building pillars after each one of them.\n\t\tfor (let i = 0, len = $tr.cells.length; i < len; i++) {\n\t\t\t// Both the current cell and the successive one will be used in the\n\t\t\t// pillar size calculation.\n\t\t\tlet td = new CKEDITOR.dom.element($tr.cells[i]);\n\n\t\t\tlet nextTd =\n\t\t\t\t$tr.cells[i + 1] && new CKEDITOR.dom.element($tr.cells[i + 1]);\n\n\t\t\tpillarIndex += td.$.colSpan || 1;\n\n\t\t\t// Calculate the pillar boundary positions.\n\t\t\tlet pillarLeft;\n\t\t\tlet pillarRight;\n\t\t\tlet pillarWidth;\n\n\t\t\tlet x = td.getDocumentPosition().x;\n\n\t\t\t// Calculate positions based on the current cell.\n\t\t\trtl\n\t\t\t\t? (pillarRight = x + getBorderWidth(td, 'left'))\n\t\t\t\t: (pillarLeft =\n\t\t\t\t\t\tx + td.$.offsetWidth - getBorderWidth(td, 'right'));\n\n\t\t\t// Calculate positions based on the next cell, if available.\n\t\t\tif (nextTd) {\n\t\t\t\tx = nextTd.getDocumentPosition().x;\n\n\t\t\t\trtl\n\t\t\t\t\t? (pillarLeft =\n\t\t\t\t\t\t\tx +\n\t\t\t\t\t\t\tnextTd.$.offsetWidth -\n\t\t\t\t\t\t\tgetBorderWidth(nextTd, 'right'))\n\t\t\t\t\t: (pillarRight = x + getBorderWidth(nextTd, 'left'));\n\t\t\t}\n\t\t\t// Otherwise calculate positions based on the table (for last cell).\n\t\t\telse {\n\t\t\t\tx = table.getDocumentPosition().x;\n\n\t\t\t\trtl\n\t\t\t\t\t? (pillarLeft = x)\n\t\t\t\t\t: (pillarRight = x + table.$.offsetWidth);\n\t\t\t}\n\n\t\t\tpillarWidth = Math.max(pillarRight - pillarLeft, 4);\n\n\t\t\t// The pillar should reflects exactly the shape of the hovered\n\t\t\t// column border line.\n\t\t\tpillars.push({\n\t\t\t\ttable: table,\n\t\t\t\tindex: pillarIndex,\n\t\t\t\tx: pillarLeft,\n\t\t\t\ty: tbodyPosition.y,\n\t\t\t\twidth: pillarWidth,\n\t\t\t\theight: tbody.$.offsetHeight,\n\t\t\t\trtl: rtl,\n\t\t\t});\n\t\t}\n\n\t\treturn pillars;\n\t}\n\n\tfunction getPillarAtPosition(pillars, positionX) {\n\t\tfor (let i = 0, len = pillars.length; i < len; i++) {\n\t\t\tlet pillar = pillars[i];\n\n\t\t\tif (positionX >= pillar.x && positionX <= pillar.x + pillar.width) {\n\t\t\t\treturn pillar;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction cancel(evt) {\n\t\t(evt.data || evt).preventDefault();\n\t}\n\n\tfunction ColumnResizer(editor, pillar) {\n\t\tlet document;\n\t\tlet isResizing;\n\t\tlet move;\n\t\tlet resizer;\n\t\tlet resizing;\n\t\tlet startOffset;\n\t\tlet currentShift;\n\n\t\tlet leftSideCells;\n\n\t\tlet rightSideCells;\n\n\t\tlet leftShiftBoundary;\n\n\t\tlet rightShiftBoundary;\n\n\t\tfunction detach() {\n\t\t\tresizer.removeListener('mouseup', onMouseUp);\n\t\t\tresizer.removeListener('mousedown', onMouseDown);\n\t\t\tresizer.removeListener('mousemove', onMouseMove);\n\t\t}\n\n\t\tfunction resizeStart() {\n\t\t\t// Before starting to resize, figure out which cells to change\n\t\t\t// and the boundaries of this resizing shift.\n\n\t\t\tlet columnIndex = pillar.index;\n\n\t\t\tlet map = CKEDITOR.tools.buildTableMap(pillar.table);\n\n\t\t\tlet leftColumnCells = [];\n\n\t\t\tlet rightColumnCells = [];\n\n\t\t\tlet leftMinSize = Number.MAX_VALUE;\n\n\t\t\tlet rightMinSize = leftMinSize;\n\n\t\t\tlet rtl = pillar.rtl;\n\n\t\t\tfor (let i = 0, len = map.length; i < len; i++) {\n\t\t\t\tlet row = map[i];\n\n\t\t\t\tlet leftCell = row[columnIndex + (rtl ? 1 : 0)];\n\n\t\t\t\tlet rightCell = row[columnIndex + (rtl ? 0 : 1)];\n\n\t\t\t\tleftCell = leftCell && new CKEDITOR.dom.element(leftCell);\n\t\t\t\trightCell = rightCell && new CKEDITOR.dom.element(rightCell);\n\n\t\t\t\tif (!leftCell || !rightCell || !leftCell.equals(rightCell)) {\n\t\t\t\t\tleftCell &&\n\t\t\t\t\t\t(leftMinSize = Math.min(\n\t\t\t\t\t\t\tleftMinSize,\n\t\t\t\t\t\t\tgetWidth(leftCell)\n\t\t\t\t\t\t));\n\t\t\t\t\trightCell &&\n\t\t\t\t\t\t(rightMinSize = Math.min(\n\t\t\t\t\t\t\trightMinSize,\n\t\t\t\t\t\t\tgetWidth(rightCell)\n\t\t\t\t\t\t));\n\n\t\t\t\t\tleftColumnCells.push(leftCell);\n\t\t\t\t\trightColumnCells.push(rightCell);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cache the list of cells to be resized.\n\t\t\tleftSideCells = leftColumnCells;\n\t\t\trightSideCells = rightColumnCells;\n\n\t\t\t// Cache the resize limit boundaries.\n\t\t\tleftShiftBoundary = pillar.x - leftMinSize;\n\t\t\trightShiftBoundary = pillar.x + rightMinSize;\n\n\t\t\tresizer.setOpacity(0.5);\n\t\t\tstartOffset = parseInt(resizer.getStyle('left'), 10);\n\t\t\tcurrentShift = 0;\n\t\t\tresizing = 1;\n\n\t\t\tresizer.on('mousemove', onMouseMove);\n\n\t\t\t// Prevent the native drag behavior otherwise 'mousemove' won't fire.\n\t\t\tdocument.on('dragstart', cancel);\n\t\t}\n\n\t\tfunction resizeEnd() {\n\t\t\tresizing = 0;\n\n\t\t\tresizer.setOpacity(0);\n\n\t\t\tcurrentShift && resizeColumn();\n\n\t\t\tlet table = pillar.table;\n\t\t\tsetTimeout(function() {\n\t\t\t\ttable.removeCustomData('_cke_table_pillars');\n\t\t\t}, 0);\n\n\t\t\tdocument.removeListener('dragstart', cancel);\n\t\t}\n\n\t\tfunction resizeColumn() {\n\t\t\tlet rtl = pillar.rtl;\n\n\t\t\tlet cellsCount = rtl ? rightSideCells.length : leftSideCells.length;\n\n\t\t\t// Perform the actual resize to table cells, only for those by side of the pillar.\n\t\t\tfor (let i = 0; i < cellsCount; i++) {\n\t\t\t\tlet leftCell = leftSideCells[i];\n\n\t\t\t\tlet rightCell = rightSideCells[i];\n\n\t\t\t\tconst table = pillar.table;\n\n\t\t\t\t// Defer the resizing to avoid any interference among cells.\n\t\t\t\tCKEDITOR.tools.setTimeout(\n\t\t\t\t\tfunction(\n\t\t\t\t\t\tleftCell,\n\t\t\t\t\t\tleftOldWidth,\n\t\t\t\t\t\trightCell,\n\t\t\t\t\t\trightOldWidth,\n\t\t\t\t\t\ttableWidth,\n\t\t\t\t\t\tsizeShift\n\t\t\t\t\t) {\n\t\t\t\t\t\t// 1px is the minimum valid width (#11626).\n\t\t\t\t\t\tleftCell &&\n\t\t\t\t\t\t\tleftCell.setStyle(\n\t\t\t\t\t\t\t\t'width',\n\t\t\t\t\t\t\t\tpxUnit(Math.max(leftOldWidth + sizeShift, 1))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\trightCell &&\n\t\t\t\t\t\t\trightCell.setStyle(\n\t\t\t\t\t\t\t\t'width',\n\t\t\t\t\t\t\t\tpxUnit(Math.max(rightOldWidth - sizeShift, 1))\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// If we're in the last cell, we need to resize the table as well\n\t\t\t\t\t\tif (tableWidth) {\n\t\t\t\t\t\t\ttable.setStyle(\n\t\t\t\t\t\t\t\t'width',\n\t\t\t\t\t\t\t\tpxUnit(tableWidth + sizeShift * (rtl ? -1 : 1))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t0,\n\t\t\t\t\tthis,\n\t\t\t\t\t[\n\t\t\t\t\t\tleftCell,\n\t\t\t\t\t\tleftCell && getWidth(leftCell),\n\t\t\t\t\t\trightCell,\n\t\t\t\t\t\trightCell && getWidth(rightCell),\n\t\t\t\t\t\t(!leftCell || !rightCell) &&\n\t\t\t\t\t\t\tgetWidth(table) +\n\t\t\t\t\t\t\t\tgetBorderWidth(table, 'left') +\n\t\t\t\t\t\t\t\tgetBorderWidth(table, 'right'),\n\t\t\t\t\t\tcurrentShift,\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseDown(evt) {\n\t\t\tcancel(evt);\n\n\t\t\tresizeStart();\n\n\t\t\tdocument.on('mouseup', onMouseUp, this);\n\t\t}\n\n\t\tfunction onMouseUp(evt) {\n\t\t\tevt.removeListener();\n\n\t\t\tresizeEnd();\n\t\t}\n\n\t\tfunction onMouseMove(evt) {\n\t\t\tmove(evt.data.getPageOffset().x);\n\t\t}\n\n\t\tdocument = editor.document;\n\n\t\tresizer = CKEDITOR.dom.element.createFromHtml(\n\t\t\t'<div data-cke-temp=1 contenteditable=false unselectable=on ' +\n\t\t\t\t'style=\"position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;' +\n\t\t\t\t'padding:0;background-color:#004;background-image:none;border:0px none;z-index:10\"></div>',\n\t\t\tdocument\n\t\t);\n\n\t\t// Clean DOM when editor is destroyed.\n\t\teditor.on('destroy', function() {\n\t\t\tdetach();\n\n\t\t\tresizer.remove();\n\t\t});\n\n\t\t// Place the resizer after body to prevent it\n\t\t// from being editable.\n\t\tdocument.getDocumentElement().append(resizer);\n\n\t\tresizer.setStyles({\n\t\t\twidth: pxUnit(pillar.width),\n\t\t\theight: pxUnit(pillar.height),\n\t\t\tleft: pxUnit(pillar.x),\n\t\t\ttop: pxUnit(pillar.y),\n\t\t});\n\n\t\tresizer.on('mousedown', onMouseDown, this);\n\n\t\tdocument.getBody().setStyle('cursor', 'col-resize');\n\n\t\t// Display the resizer to receive events but don't show it,\n\t\t// only change the cursor to resizable shape.\n\t\tresizer.show();\n\n\t\tmove = this.move = function(posX) {\n\t\t\tlet resizerNewPosition =\n\t\t\t\tposX - Math.round(resizer.$.offsetWidth / 2);\n\n\t\t\tif (isResizing) {\n\t\t\t\tif (\n\t\t\t\t\tresizerNewPosition === leftShiftBoundary ||\n\t\t\t\t\tresizerNewPosition === rightShiftBoundary\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresizerNewPosition = Math.max(\n\t\t\t\t\tresizerNewPosition,\n\t\t\t\t\tleftShiftBoundary\n\t\t\t\t);\n\t\t\t\tresizerNewPosition = Math.min(\n\t\t\t\t\tresizerNewPosition,\n\t\t\t\t\trightShiftBoundary\n\t\t\t\t);\n\n\t\t\t\tcurrentShift = resizerNewPosition - startOffset;\n\t\t\t}\n\n\t\t\tresizer.setStyle('left', pxUnit(resizerNewPosition));\n\t\t};\n\n\t\tthis.destroy = function() {\n\t\t\tdetach();\n\n\t\t\tdocument.getBody().setStyle('cursor', 'auto');\n\n\t\t\tresizer.remove();\n\t\t};\n\n\t\tisResizing = this.isResizing = function() {\n\t\t\treturn resizing;\n\t\t};\n\t}\n\n\tfunction clearPillarsCache(evt) {\n\t\tlet target = evt.data.getTarget();\n\n\t\tif (evt.name === 'mouseout') {\n\t\t\t// Bypass interal mouse move.\n\t\t\tif (!target.is('table')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet dest = new CKEDITOR.dom.element(\n\t\t\t\tevt.data.$.relatedTarget || evt.data.$.toElement\n\t\t\t);\n\t\t\twhile (dest && dest.$ && !dest.equals(target) && !dest.is('body')) {\n\t\t\t\tdest = dest.getParent();\n\t\t\t}\n\t\t\tif (!dest || dest.equals(target)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttarget.getAscendant('table', 1).removeCustomData('_cke_table_pillars');\n\t\tevt.removeListener();\n\t}\n\n\tCKEDITOR.plugins.add('ae_tableresize', {\n\t\trequires: 'ae_tabletools',\n\n\t\tinit: function(editor) {\n\t\t\teditor.on('contentDom', function() {\n\t\t\t\tlet resizer;\n\n\t\t\t\tlet editable = editor.editable();\n\n\t\t\t\t// In Classic editor it is better to use document\n\t\t\t\t// instead of editable so event will work below body.\n\t\t\t\teditable.attachListener(\n\t\t\t\t\teditable.isInline() ? editable : editor.document,\n\t\t\t\t\t'mousemove',\n\t\t\t\t\tfunction(evt) {\n\t\t\t\t\t\tevt = evt.data;\n\n\t\t\t\t\t\tlet target = evt.getTarget();\n\n\t\t\t\t\t\t// FF may return document and IE8 some UFO (object with no nodeType property...)\n\t\t\t\t\t\t// instead of an element (#11823).\n\t\t\t\t\t\tif (target.type !== CKEDITOR.NODE_ELEMENT) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet pageX = evt.getPageOffset().x;\n\n\t\t\t\t\t\t// If we're already attached to a pillar, simply move the\n\t\t\t\t\t\t// resizer.\n\t\t\t\t\t\tif (resizer) {\n\t\t\t\t\t\t\tif (resizer.isResizing()) {\n\t\t\t\t\t\t\t\tresizer.move(pageX);\n\n\t\t\t\t\t\t\t\tcancel(evt);\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresizer.destroy();\n\n\t\t\t\t\t\t\t\tresizer = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Considering table, tr, td, tbody but nothing else.\n\t\t\t\t\t\tlet table;\n\t\t\t\t\t\tlet pillars;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!target.is('table') &&\n\t\t\t\t\t\t\t!target.getAscendant('tbody', 1)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttable = target.getAscendant('table', 1);\n\n\t\t\t\t\t\t// Make sure the table we found is inside the container\n\t\t\t\t\t\t// (eg. we should not use tables the editor is embedded within)\n\t\t\t\t\t\tif (!editor.editable().contains(table)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!(pillars = table.getCustomData(\n\t\t\t\t\t\t\t\t'_cke_table_pillars'\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// Cache table pillars calculation result.\n\t\t\t\t\t\t\ttable.setCustomData(\n\t\t\t\t\t\t\t\t'_cke_table_pillars',\n\t\t\t\t\t\t\t\t(pillars = buildTableColumnPillars(table))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\ttable.on('mouseout', clearPillarsCache);\n\t\t\t\t\t\t\ttable.on('mousedown', clearPillarsCache);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet pillar = getPillarAtPosition(pillars, pageX);\n\n\t\t\t\t\t\tif (pillar) {\n\t\t\t\t\t\t\tresizer = new ColumnResizer(editor, pillar);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t});\n})();\n","/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n(function() {\n\t'use strict';\n\n\tif (CKEDITOR.plugins.get('ae_tabletools')) {\n\t\treturn;\n\t}\n\n\tlet cellNodeRegex = /^(?:td|th)$/;\n\n\tfunction getSelectedCells(selection) {\n\t\tlet ranges = selection.getRanges();\n\t\tlet retval = [];\n\t\tlet database = {};\n\n\t\tfunction moveOutOfCellGuard(node) {\n\t\t\t// Apply to the first cell only.\n\t\t\tif (retval.length > 0) return;\n\n\t\t\t// If we are exiting from the first </td>, then the td should definitely be\n\t\t\t// included.\n\t\t\tif (\n\t\t\t\tnode.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\tcellNodeRegex.test(node.getName()) &&\n\t\t\t\t!node.getCustomData('selected_cell')\n\t\t\t) {\n\t\t\t\tCKEDITOR.dom.element.setMarker(\n\t\t\t\t\tdatabase,\n\t\t\t\t\tnode,\n\t\t\t\t\t'selected_cell',\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t\tretval.push(node);\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < ranges.length; i++) {\n\t\t\tlet range = ranges[i];\n\n\t\t\tif (range.collapsed) {\n\t\t\t\t// Walker does not handle collapsed ranges yet - fall back to old API.\n\t\t\t\tlet startNode = range.getCommonAncestor();\n\t\t\t\tlet nearestCell =\n\t\t\t\t\tstartNode.getAscendant('td', true) ||\n\t\t\t\t\tstartNode.getAscendant('th', true);\n\t\t\t\tif (nearestCell) retval.push(nearestCell);\n\t\t\t} else {\n\t\t\t\tlet walker = new CKEDITOR.dom.walker(range);\n\t\t\t\tlet node;\n\t\t\t\twalker.guard = moveOutOfCellGuard;\n\n\t\t\t\twhile ((node = walker.next())) {\n\t\t\t\t\t// If may be possible for us to have a range like this:\n\t\t\t\t\t// <td>^1</td><td>^2</td>\n\t\t\t\t\t// The 2nd td shouldn't be included.\n\t\t\t\t\t//\n\t\t\t\t\t// So we have to take care to include a td we've entered only when we've\n\t\t\t\t\t// walked into its children.\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tnode.type != CKEDITOR.NODE_ELEMENT ||\n\t\t\t\t\t\t!node.is(CKEDITOR.dtd.table)\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet parent =\n\t\t\t\t\t\t\tnode.getAscendant('td', true) ||\n\t\t\t\t\t\t\tnode.getAscendant('th', true);\n\t\t\t\t\t\tif (parent && !parent.getCustomData('selected_cell')) {\n\t\t\t\t\t\t\tCKEDITOR.dom.element.setMarker(\n\t\t\t\t\t\t\t\tdatabase,\n\t\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\t\t'selected_cell',\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tretval.push(parent);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers(database);\n\n\t\treturn retval;\n\t}\n\n\tfunction getFocusElementAfterDelCells(cellsToDelete) {\n\t\tlet i = 0;\n\n\t\tlet last = cellsToDelete.length - 1;\n\n\t\tlet database = {};\n\n\t\tlet cell;\n\n\t\tlet focusedCell;\n\n\t\tlet tr;\n\n\t\twhile ((cell = cellsToDelete[i++]))\n\t\t\tCKEDITOR.dom.element.setMarker(database, cell, 'delete_cell', true);\n\n\t\t// 1.first we check left or right side focusable cell row by row;\n\t\ti = 0;\n\t\twhile ((cell = cellsToDelete[i++])) {\n\t\t\tif (\n\t\t\t\t((focusedCell = cell.getPrevious()) &&\n\t\t\t\t\t!focusedCell.getCustomData('delete_cell')) ||\n\t\t\t\t((focusedCell = cell.getNext()) &&\n\t\t\t\t\t!focusedCell.getCustomData('delete_cell'))\n\t\t\t) {\n\t\t\t\tCKEDITOR.dom.element.clearAllMarkers(database);\n\t\t\t\treturn focusedCell;\n\t\t\t}\n\t\t}\n\n\t\tCKEDITOR.dom.element.clearAllMarkers(database);\n\n\t\t// 2. then we check the toppest row (outside the selection area square) focusable cell\n\t\ttr = cellsToDelete[0].getParent();\n\t\tif ((tr = tr.getPrevious())) return tr.getLast();\n\n\t\t// 3. last we check the lowerest  row focusable cell\n\t\ttr = cellsToDelete[last].getParent();\n\t\tif ((tr = tr.getNext())) return tr.getChild(0);\n\n\t\treturn null;\n\t}\n\n\tfunction insertRow(selection, insertBefore) {\n\t\tlet cells = getSelectedCells(selection);\n\n\t\tlet firstCell = cells[0];\n\n\t\tlet table = firstCell.getAscendant('table');\n\n\t\tlet doc = firstCell.getDocument();\n\n\t\tlet startRow = cells[0].getParent();\n\n\t\tlet startRowIndex = startRow.$.rowIndex;\n\n\t\tlet lastCell = cells[cells.length - 1];\n\n\t\tlet endRowIndex =\n\t\t\tlastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1;\n\n\t\tlet endRow = new CKEDITOR.dom.element(table.$.rows[endRowIndex]);\n\n\t\tlet rowIndex = insertBefore ? startRowIndex : endRowIndex;\n\n\t\tlet row = insertBefore ? startRow : endRow;\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet cloneRow = map[rowIndex];\n\n\t\tlet nextRow = insertBefore ? map[rowIndex - 1] : map[rowIndex + 1];\n\n\t\tlet width = map[0].length;\n\n\t\tlet newRow = doc.createElement('tr');\n\t\tfor (let i = 0; cloneRow[i] && i < width; i++) {\n\t\t\tlet cell;\n\t\t\t// Check whether there's a spanning row here, do not break it.\n\t\t\tif (\n\t\t\t\tcloneRow[i].rowSpan > 1 &&\n\t\t\t\tnextRow &&\n\t\t\t\tcloneRow[i] == nextRow[i]\n\t\t\t) {\n\t\t\t\tcell = cloneRow[i];\n\t\t\t\tcell.rowSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element(cloneRow[i]).clone();\n\t\t\t\tcell.removeAttribute('rowSpan');\n\t\t\t\tcell.appendBogus();\n\t\t\t\tnewRow.append(cell);\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.colSpan - 1;\n\t\t}\n\n\t\tinsertBefore ? newRow.insertBefore(row) : newRow.insertAfter(row);\n\t}\n\n\tfunction deleteRows(selectionOrRow) {\n\t\tif (selectionOrRow instanceof CKEDITOR.dom.selection) {\n\t\t\tlet cells = getSelectedCells(selectionOrRow);\n\n\t\t\tlet firstCell = cells[0];\n\n\t\t\tconst table = firstCell.getAscendant('table');\n\n\t\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\t\tlet startRow = cells[0].getParent();\n\n\t\t\tlet startRowIndex = startRow.$.rowIndex;\n\n\t\t\tlet lastCell = cells[cells.length - 1];\n\n\t\t\tlet endRowIndex =\n\t\t\t\tlastCell.getParent().$.rowIndex + lastCell.$.rowSpan - 1;\n\n\t\t\tlet rowsToDelete = [];\n\n\t\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\t\tfor (let i = startRowIndex; i <= endRowIndex; i++) {\n\t\t\t\tlet mapRow = map[i];\n\n\t\t\t\tlet row = new CKEDITOR.dom.element(table.$.rows[i]);\n\n\t\t\t\tfor (let j = 0; j < mapRow.length; j++) {\n\t\t\t\t\tlet cell = new CKEDITOR.dom.element(mapRow[j]);\n\n\t\t\t\t\tlet cellRowIndex = cell.getParent().$.rowIndex;\n\n\t\t\t\t\tif (cell.$.rowSpan == 1) cell.remove();\n\t\t\t\t\t// Row spanned cell.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Span row of the cell, reduce spanning.\n\t\t\t\t\t\tcell.$.rowSpan -= 1;\n\t\t\t\t\t\t// Root row of the cell, root cell to next row.\n\t\t\t\t\t\tif (cellRowIndex == i) {\n\t\t\t\t\t\t\tlet nextMapRow = map[i + 1];\n\t\t\t\t\t\t\tnextMapRow[j - 1]\n\t\t\t\t\t\t\t\t? cell.insertAfter(\n\t\t\t\t\t\t\t\t\t\tnew CKEDITOR.dom.element(\n\t\t\t\t\t\t\t\t\t\t\tnextMapRow[j - 1]\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: new CKEDITOR.dom.element(\n\t\t\t\t\t\t\t\t\t\ttable.$.rows[i + 1]\n\t\t\t\t\t\t\t\t  ).append(cell, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tj += cell.$.colSpan - 1;\n\t\t\t\t}\n\n\t\t\t\trowsToDelete.push(row);\n\t\t\t}\n\n\t\t\tlet rows = table.$.rows;\n\n\t\t\t// Where to put the cursor after rows been deleted?\n\t\t\t// 1. Into next sibling row if any;\n\t\t\t// 2. Into previous sibling row if any;\n\t\t\t// 3. Into table's parent element if it's the very last row.\n\t\t\tlet cursorPosition = new CKEDITOR.dom.element(\n\t\t\t\trows[endRowIndex + 1] ||\n\t\t\t\t\t(startRowIndex > 0 ? rows[startRowIndex - 1] : null) ||\n\t\t\t\t\ttable.$.parentNode\n\t\t\t);\n\n\t\t\tfor (let i = rowsToDelete.length; i >= 0; i--)\n\t\t\t\tdeleteRows(rowsToDelete[i]);\n\n\t\t\treturn cursorPosition;\n\t\t} else if (selectionOrRow instanceof CKEDITOR.dom.element) {\n\t\t\tconst table = selectionOrRow.getAscendant('table');\n\n\t\t\tif (table.$.rows.length == 1) table.remove();\n\t\t\telse selectionOrRow.remove();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction getCellColIndex(cell, isStart) {\n\t\tlet row = cell.getParent();\n\n\t\tlet rowCells = row.$.cells;\n\n\t\tlet colIndex = 0;\n\t\tfor (let i = 0; i < rowCells.length; i++) {\n\t\t\tlet mapCell = rowCells[i];\n\t\t\tcolIndex += isStart ? 1 : mapCell.colSpan;\n\t\t\tif (mapCell == cell.$) break;\n\t\t}\n\n\t\treturn colIndex - 1;\n\t}\n\n\tfunction getColumnsIndices(cells, isStart) {\n\t\tlet retval = isStart ? Infinity : 0;\n\t\tfor (let i = 0; i < cells.length; i++) {\n\t\t\tlet colIndex = getCellColIndex(cells[i], isStart);\n\t\t\tif (isStart ? colIndex < retval : colIndex > retval)\n\t\t\t\tretval = colIndex;\n\t\t}\n\t\treturn retval;\n\t}\n\n\tfunction insertColumn(selection, insertBefore) {\n\t\tlet cells = getSelectedCells(selection);\n\n\t\tlet firstCell = cells[0];\n\n\t\tlet table = firstCell.getAscendant('table');\n\n\t\tlet startCol = getColumnsIndices(cells, 1);\n\n\t\tlet lastCol = getColumnsIndices(cells);\n\n\t\tlet colIndex = insertBefore ? startCol : lastCol;\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet cloneCol = [];\n\n\t\tlet nextCol = [];\n\n\t\tlet height = map.length;\n\n\t\tfor (let i = 0; i < height; i++) {\n\t\t\tcloneCol.push(map[i][colIndex]);\n\t\t\tlet nextCell = insertBefore\n\t\t\t\t? map[i][colIndex - 1]\n\t\t\t\t: map[i][colIndex + 1];\n\t\t\tnextCol.push(nextCell);\n\t\t}\n\n\t\tfor (let i = 0; i < height; i++) {\n\t\t\tlet cell;\n\n\t\t\tif (!cloneCol[i]) continue;\n\n\t\t\t// Check whether there's a spanning column here, do not break it.\n\t\t\tif (cloneCol[i].colSpan > 1 && nextCol[i] == cloneCol[i]) {\n\t\t\t\tcell = cloneCol[i];\n\t\t\t\tcell.colSpan += 1;\n\t\t\t} else {\n\t\t\t\tcell = new CKEDITOR.dom.element(cloneCol[i]).clone();\n\t\t\t\tcell.removeAttribute('colSpan');\n\t\t\t\tcell.appendBogus();\n\t\t\t\tcell[insertBefore ? 'insertBefore' : 'insertAfter'].call(\n\t\t\t\t\tcell,\n\t\t\t\t\tnew CKEDITOR.dom.element(cloneCol[i])\n\t\t\t\t);\n\t\t\t\tcell = cell.$;\n\t\t\t}\n\n\t\t\ti += cell.rowSpan - 1;\n\t\t}\n\t}\n\n\tfunction deleteColumns(selectionOrCell) {\n\t\tlet cells = getSelectedCells(selectionOrCell);\n\n\t\tlet firstCell = cells[0];\n\n\t\tlet lastCell = cells[cells.length - 1];\n\n\t\tlet table = firstCell.getAscendant('table');\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet startColIndex;\n\n\t\tlet endColIndex;\n\n\t\tlet rowsToDelete = [];\n\n\t\tlet rows;\n\n\t\t// Figure out selected cells' column indices.\n\t\tfor (let i = 0, rows = map.length; i < rows; i++) {\n\t\t\tfor (let j = 0, cols = map[i].length; j < cols; j++) {\n\t\t\t\tif (map[i][j] == firstCell.$) startColIndex = j;\n\t\t\t\tif (map[i][j] == lastCell.$) endColIndex = j;\n\t\t\t}\n\t\t}\n\n\t\t// Delete cell or reduce cell spans by checking through the table map.\n\t\tfor (let i = startColIndex; i <= endColIndex; i++) {\n\t\t\tfor (let j = 0; j < map.length; j++) {\n\t\t\t\tlet mapRow = map[j];\n\n\t\t\t\tlet row = new CKEDITOR.dom.element(table.$.rows[j]);\n\n\t\t\t\tlet cell = new CKEDITOR.dom.element(mapRow[i]);\n\n\t\t\t\tif (cell.$) {\n\t\t\t\t\tif (cell.$.colSpan == 1) cell.remove();\n\t\t\t\t\t// Reduce the col spans.\n\t\t\t\t\telse cell.$.colSpan -= 1;\n\n\t\t\t\t\tj += cell.$.rowSpan - 1;\n\n\t\t\t\t\tif (!row.$.cells.length) rowsToDelete.push(row);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet firstRowCells = table.$.rows[0] && table.$.rows[0].cells;\n\n\t\t// Where to put the cursor after columns been deleted?\n\t\t// 1. Into next cell of the first row if any;\n\t\t// 2. Into previous cell of the first row if any;\n\t\t// 3. Into table's parent element;\n\t\tlet cursorPosition = new CKEDITOR.dom.element(\n\t\t\tfirstRowCells[startColIndex] ||\n\t\t\t\t(startColIndex\n\t\t\t\t\t? firstRowCells[startColIndex - 1]\n\t\t\t\t\t: table.$.parentNode)\n\t\t);\n\n\t\t// Delete table rows only if all columns are gone (do not remove empty row).\n\t\tif (rowsToDelete.length == rows) table.remove();\n\n\t\treturn cursorPosition;\n\t}\n\n\tfunction insertCell(selection, insertBefore) {\n\t\tlet startElement = selection.getStartElement();\n\t\tlet cell =\n\t\t\tstartElement.getAscendant('td', 1) ||\n\t\t\tstartElement.getAscendant('th', 1);\n\n\t\tif (!cell) return;\n\n\t\t// Create the new cell element to be added.\n\t\tlet newCell = cell.clone();\n\t\tnewCell.appendBogus();\n\n\t\tif (insertBefore) newCell.insertBefore(cell);\n\t\telse newCell.insertAfter(cell);\n\t}\n\n\tfunction deleteCells(selectionOrCell) {\n\t\tif (selectionOrCell instanceof CKEDITOR.dom.selection) {\n\t\t\tlet cellsToDelete = getSelectedCells(selectionOrCell);\n\t\t\tlet table =\n\t\t\t\tcellsToDelete[0] && cellsToDelete[0].getAscendant('table');\n\t\t\tlet cellToFocus = getFocusElementAfterDelCells(cellsToDelete);\n\n\t\t\tfor (let i = cellsToDelete.length - 1; i >= 0; i--)\n\t\t\t\tdeleteCells(cellsToDelete[i]);\n\n\t\t\tif (cellToFocus) placeCursorInCell(cellToFocus, true);\n\t\t\telse if (table) table.remove();\n\t\t} else if (selectionOrCell instanceof CKEDITOR.dom.element) {\n\t\t\tlet tr = selectionOrCell.getParent();\n\t\t\tif (tr.getChildCount() == 1) tr.remove();\n\t\t\telse selectionOrCell.remove();\n\t\t}\n\t}\n\n\t// Remove filler at end and empty spaces around the cell content.\n\tfunction trimCell(cell) {\n\t\tlet bogus = cell.getBogus();\n\t\tbogus && bogus.remove();\n\t\tcell.trim();\n\t}\n\n\tfunction placeCursorInCell(cell, placeAtEnd) {\n\t\tlet docInner = cell.getDocument();\n\n\t\tlet docOuter = CKEDITOR.document;\n\n\t\t// Fixing \"Unspecified error\" thrown in IE10 by resetting\n\t\t// selection the dirty and shameful way (#10308).\n\t\t// We can not apply this hack to IE8 because\n\t\t// it causes error (#11058).\n\t\tif (CKEDITOR.env.ie && CKEDITOR.env.version == 10) {\n\t\t\tdocOuter.focus();\n\t\t\tdocInner.focus();\n\t\t}\n\n\t\tlet range = new CKEDITOR.dom.range(docInner);\n\t\tif (\n\t\t\t!range['moveToElementEdit' + (placeAtEnd ? 'End' : 'Start')](cell)\n\t\t) {\n\t\t\trange.selectNodeContents(cell);\n\t\t\trange.collapse(placeAtEnd ? false : true);\n\t\t}\n\t\trange.select(true);\n\t}\n\n\tfunction cellInRow(tableMap, rowIndex, cell) {\n\t\tlet oRow = tableMap[rowIndex];\n\t\tif (typeof cell == 'undefined') return oRow;\n\n\t\tfor (let c = 0; oRow && c < oRow.length; c++) {\n\t\t\tif (cell.is && oRow[c] == cell.$) return c;\n\t\t\telse if (c == cell) return new CKEDITOR.dom.element(oRow[c]);\n\t\t}\n\t\treturn cell.is ? -1 : null;\n\t}\n\n\tfunction cellInCol(tableMap, colIndex) {\n\t\tlet oCol = [];\n\t\tfor (let r = 0; r < tableMap.length; r++) {\n\t\t\tlet row = tableMap[r];\n\t\t\toCol.push(row[colIndex]);\n\n\t\t\t// Avoid adding duplicate cells.\n\t\t\tif (row[colIndex].rowSpan > 1) r += row[colIndex].rowSpan - 1;\n\t\t}\n\t\treturn oCol;\n\t}\n\n\tfunction mergeCells(selection, mergeDirection, isDetect) {\n\t\tlet cells = getSelectedCells(selection);\n\n\t\t// Invalid merge request if:\n\t\t// 1. In batch mode despite that less than two selected.\n\t\t// 2. In solo mode while not exactly only one selected.\n\t\t// 3. Cells distributed in different table groups (e.g. from both thead and tbody).\n\t\tlet commonAncestor;\n\t\tif (\n\t\t\t(mergeDirection ? cells.length != 1 : cells.length < 2) ||\n\t\t\t((commonAncestor = selection.getCommonAncestor()) &&\n\t\t\t\tcommonAncestor.type == CKEDITOR.NODE_ELEMENT &&\n\t\t\t\tcommonAncestor.is('table'))\n\t\t)\n\t\t\treturn false;\n\n\t\tlet cell;\n\n\t\tlet firstCell = cells[0];\n\n\t\tlet table = firstCell.getAscendant('table');\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet mapHeight = map.length;\n\n\t\tlet mapWidth = map[0].length;\n\n\t\tlet startRow = firstCell.getParent().$.rowIndex;\n\n\t\tlet startColumn = cellInRow(map, startRow, firstCell);\n\n\t\tif (mergeDirection) {\n\t\t\tlet targetCell;\n\t\t\ttry {\n\t\t\t\tlet rowspan =\n\t\t\t\t\tparseInt(firstCell.getAttribute('rowspan'), 10) || 1;\n\t\t\t\tlet colspan =\n\t\t\t\t\tparseInt(firstCell.getAttribute('colspan'), 10) || 1;\n\n\t\t\t\ttargetCell =\n\t\t\t\t\tmap[\n\t\t\t\t\t\tmergeDirection == 'up'\n\t\t\t\t\t\t\t? startRow - rowspan\n\t\t\t\t\t\t\t: mergeDirection == 'down'\n\t\t\t\t\t\t\t? startRow + rowspan\n\t\t\t\t\t\t\t: startRow\n\t\t\t\t\t][\n\t\t\t\t\t\tmergeDirection == 'left'\n\t\t\t\t\t\t\t? startColumn - colspan\n\t\t\t\t\t\t\t: mergeDirection == 'right'\n\t\t\t\t\t\t\t? startColumn + colspan\n\t\t\t\t\t\t\t: startColumn\n\t\t\t\t\t];\n\t\t\t} catch (er) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// 1. No cell could be merged.\n\t\t\t// 2. Same cell actually.\n\t\t\tif (!targetCell || firstCell.$ == targetCell) return false;\n\n\t\t\t// Sort in map order regardless of the DOM sequence.\n\t\t\tcells[\n\t\t\t\tmergeDirection == 'up' || mergeDirection == 'left'\n\t\t\t\t\t? 'unshift'\n\t\t\t\t\t: 'push'\n\t\t\t](new CKEDITOR.dom.element(targetCell));\n\t\t}\n\n\t\t// Start from here are merging way ignorance (merge up/right, batch merge).\n\t\tlet doc = firstCell.getDocument();\n\n\t\tlet lastRowIndex = startRow;\n\n\t\tlet totalRowSpan = 0;\n\n\t\tlet totalColSpan = 0;\n\n\t\t// Use a documentFragment as buffer when appending cell contents.\n\n\t\tlet frag = !isDetect && new CKEDITOR.dom.documentFragment(doc);\n\n\t\tlet dimension = 0;\n\n\t\tfor (let i = 0; i < cells.length; i++) {\n\t\t\tcell = cells[i];\n\n\t\t\tlet tr = cell.getParent();\n\n\t\t\tlet cellFirstChild = cell.getFirst();\n\n\t\t\tlet colSpan = cell.$.colSpan;\n\n\t\t\tlet rowSpan = cell.$.rowSpan;\n\n\t\t\tlet rowIndex = tr.$.rowIndex;\n\n\t\t\tlet colIndex = cellInRow(map, rowIndex, cell);\n\n\t\t\t// Accumulated the actual places taken by all selected cells.\n\t\t\tdimension += colSpan * rowSpan;\n\t\t\t// Accumulated the maximum virtual spans from column and row.\n\t\t\ttotalColSpan = Math.max(\n\t\t\t\ttotalColSpan,\n\t\t\t\tcolIndex - startColumn + colSpan\n\t\t\t);\n\t\t\ttotalRowSpan = Math.max(\n\t\t\t\ttotalRowSpan,\n\t\t\t\trowIndex - startRow + rowSpan\n\t\t\t);\n\n\t\t\tif (!isDetect) {\n\t\t\t\t// Trim all cell fillers and check to remove empty cells.\n\t\t\t\tif ((trimCell(cell), cell.getChildren().count())) {\n\t\t\t\t\t// Merge vertically cells as two separated paragraphs.\n\t\t\t\t\tif (\n\t\t\t\t\t\trowIndex != lastRowIndex &&\n\t\t\t\t\t\tcellFirstChild &&\n\t\t\t\t\t\t!(\n\t\t\t\t\t\t\tcellFirstChild.isBlockBoundary &&\n\t\t\t\t\t\t\tcellFirstChild.isBlockBoundary({br: 1})\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet last = frag.getLast(\n\t\t\t\t\t\t\tCKEDITOR.dom.walker.whitespaces(true)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (last && !(last.is && last.is('br')))\n\t\t\t\t\t\t\tfrag.append('br');\n\t\t\t\t\t}\n\n\t\t\t\t\tcell.moveChildren(frag);\n\t\t\t\t}\n\t\t\t\ti ? cell.remove() : cell.setHtml('');\n\t\t\t}\n\t\t\tlastRowIndex = rowIndex;\n\t\t}\n\n\t\tif (!isDetect) {\n\t\t\tfrag.moveChildren(firstCell);\n\n\t\t\tfirstCell.appendBogus();\n\n\t\t\tif (totalColSpan >= mapWidth) firstCell.removeAttribute('rowSpan');\n\t\t\telse firstCell.$.rowSpan = totalRowSpan;\n\n\t\t\tif (totalRowSpan >= mapHeight) firstCell.removeAttribute('colSpan');\n\t\t\telse firstCell.$.colSpan = totalColSpan;\n\n\t\t\t// Swip empty <tr> left at the end of table due to the merging.\n\t\t\tlet trs = new CKEDITOR.dom.nodeList(table.$.rows);\n\n\t\t\tlet count = trs.count();\n\n\t\t\tfor (let i = count - 1; i >= 0; i--) {\n\t\t\t\tlet tailTr = trs.getItem(i);\n\t\t\t\tif (!tailTr.$.cells.length) {\n\t\t\t\t\ttailTr.remove();\n\t\t\t\t\tcount++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn firstCell;\n\t\t}\n\t\t// Be able to merge cells only if actual dimension of selected\n\t\t// cells equals to the caculated rectangle.\n\t\telse {\n\t\t\treturn totalRowSpan * totalColSpan == dimension;\n\t\t}\n\t}\n\n\tfunction verticalSplitCell(selection, isDetect) {\n\t\tlet cells = getSelectedCells(selection);\n\t\tif (cells.length > 1) return false;\n\t\telse if (isDetect) return true;\n\n\t\tlet cell = cells[0];\n\n\t\tlet tr = cell.getParent();\n\n\t\tlet table = tr.getAscendant('table');\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet rowIndex = tr.$.rowIndex;\n\n\t\tlet colIndex = cellInRow(map, rowIndex, cell);\n\n\t\tlet rowSpan = cell.$.rowSpan;\n\n\t\tlet newCell;\n\n\t\tlet newRowSpan;\n\n\t\tlet newCellRowSpan;\n\n\t\tlet newRowIndex;\n\n\t\tif (rowSpan > 1) {\n\t\t\tnewRowSpan = Math.ceil(rowSpan / 2);\n\t\t\tnewCellRowSpan = Math.floor(rowSpan / 2);\n\t\t\tnewRowIndex = rowIndex + newRowSpan;\n\t\t\tconst newCellTr = new CKEDITOR.dom.element(\n\t\t\t\ttable.$.rows[newRowIndex]\n\t\t\t);\n\n\t\t\tlet newCellRow = cellInRow(map, newRowIndex);\n\n\t\t\tlet candidateCell;\n\n\t\t\tnewCell = cell.clone();\n\n\t\t\t// Figure out where to insert the new cell by checking the vitual row.\n\t\t\tfor (let c = 0; c < newCellRow.length; c++) {\n\t\t\t\tcandidateCell = newCellRow[c];\n\t\t\t\t// Catch first cell actually following the column.\n\t\t\t\tif (candidateCell.parentNode == newCellTr.$ && c > colIndex) {\n\t\t\t\t\tnewCell.insertBefore(\n\t\t\t\t\t\tnew CKEDITOR.dom.element(candidateCell)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tcandidateCell = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// The destination row is empty, append at will.\n\t\t\tif (!candidateCell) newCellTr.append(newCell);\n\t\t} else {\n\t\t\tnewCellRowSpan = newRowSpan = 1;\n\n\t\t\tconst newCellTr = tr.clone();\n\t\t\tnewCellTr.insertAfter(tr);\n\t\t\tnewCellTr.append((newCell = cell.clone()));\n\n\t\t\tlet cellsInSameRow = cellInRow(map, rowIndex);\n\t\t\tfor (let i = 0; i < cellsInSameRow.length; i++)\n\t\t\t\tcellsInSameRow[i].rowSpan++;\n\t\t}\n\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.rowSpan = newRowSpan;\n\t\tnewCell.$.rowSpan = newCellRowSpan;\n\t\tif (newRowSpan == 1) cell.removeAttribute('rowSpan');\n\t\tif (newCellRowSpan == 1) newCell.removeAttribute('rowSpan');\n\n\t\treturn newCell;\n\t}\n\n\tfunction horizontalSplitCell(selection, isDetect) {\n\t\tlet cells = getSelectedCells(selection);\n\t\tif (cells.length > 1) return false;\n\t\telse if (isDetect) return true;\n\n\t\tlet cell = cells[0];\n\n\t\tlet tr = cell.getParent();\n\n\t\tlet table = tr.getAscendant('table');\n\n\t\tlet map = CKEDITOR.tools.buildTableMap(table);\n\n\t\tlet rowIndex = tr.$.rowIndex;\n\n\t\tlet colIndex = cellInRow(map, rowIndex, cell);\n\n\t\tlet colSpan = cell.$.colSpan;\n\n\t\tlet newCell;\n\n\t\tlet newColSpan;\n\n\t\tlet newCellColSpan;\n\n\t\tif (colSpan > 1) {\n\t\t\tnewColSpan = Math.ceil(colSpan / 2);\n\t\t\tnewCellColSpan = Math.floor(colSpan / 2);\n\t\t} else {\n\t\t\tnewCellColSpan = newColSpan = 1;\n\t\t\tlet cellsInSameCol = cellInCol(map, colIndex);\n\t\t\tfor (let i = 0; i < cellsInSameCol.length; i++)\n\t\t\t\tcellsInSameCol[i].colSpan++;\n\t\t}\n\t\tnewCell = cell.clone();\n\t\tnewCell.insertAfter(cell);\n\t\tnewCell.appendBogus();\n\n\t\tcell.$.colSpan = newColSpan;\n\t\tnewCell.$.colSpan = newCellColSpan;\n\t\tif (newColSpan == 1) cell.removeAttribute('colSpan');\n\t\tif (newCellColSpan == 1) newCell.removeAttribute('colSpan');\n\n\t\treturn newCell;\n\t}\n\n\tCKEDITOR.plugins.add('ae_tabletools', {\n\t\tinit: function(editor) {\n\t\t\tfunction createDef(def) {\n\t\t\t\treturn CKEDITOR.tools.extend(def || {}, {\n\t\t\t\t\tcontextSensitive: 1,\n\t\t\t\t\trefresh: function(editor, path) {\n\t\t\t\t\t\tthis.setState(\n\t\t\t\t\t\t\tpath.contains({td: 1, th: 1}, 1)\n\t\t\t\t\t\t\t\t? CKEDITOR.TRISTATE_OFF\n\t\t\t\t\t\t\t\t: CKEDITOR.TRISTATE_DISABLED\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\tfunction addCmd(name, def) {\n\t\t\t\tlet cmd = editor.getCommand(name);\n\n\t\t\t\tif (cmd) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcmd = editor.addCommand(name, def);\n\t\t\t\teditor.addFeature(cmd);\n\t\t\t}\n\n\t\t\taddCmd(\n\t\t\t\t'rowDelete',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tplaceCursorInCell(deleteRows(selection));\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'rowInsertBefore',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertRow(selection, true);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'rowInsertAfter',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertRow(selection);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'columnDelete',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tlet element = deleteColumns(selection);\n\t\t\t\t\t\telement && placeCursorInCell(element, true);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'columnInsertBefore',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertColumn(selection, true);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'columnInsertAfter',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertColumn(selection);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellDelete',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tdeleteCells(selection);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellMerge',\n\t\t\t\tcreateDef({\n\t\t\t\t\tallowedContent: 'td[colspan,rowspan]',\n\t\t\t\t\trequiredContent: 'td[colspan,rowspan]',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tplaceCursorInCell(\n\t\t\t\t\t\t\tmergeCells(editor.getSelection()),\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellMergeRight',\n\t\t\t\tcreateDef({\n\t\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tplaceCursorInCell(\n\t\t\t\t\t\t\tmergeCells(editor.getSelection(), 'right'),\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellMergeDown',\n\t\t\t\tcreateDef({\n\t\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tplaceCursorInCell(\n\t\t\t\t\t\t\tmergeCells(editor.getSelection(), 'down'),\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellVerticalSplit',\n\t\t\t\tcreateDef({\n\t\t\t\t\tallowedContent: 'td[rowspan]',\n\t\t\t\t\trequiredContent: 'td[rowspan]',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tplaceCursorInCell(\n\t\t\t\t\t\t\tverticalSplitCell(editor.getSelection())\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellHorizontalSplit',\n\t\t\t\tcreateDef({\n\t\t\t\t\tallowedContent: 'td[colspan]',\n\t\t\t\t\trequiredContent: 'td[colspan]',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tplaceCursorInCell(\n\t\t\t\t\t\t\thorizontalSplitCell(editor.getSelection())\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellInsertBefore',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertCell(selection, true);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\n\t\t\taddCmd(\n\t\t\t\t'cellInsertAfter',\n\t\t\t\tcreateDef({\n\t\t\t\t\trequiredContent: 'table',\n\t\t\t\t\texec: function(editor) {\n\t\t\t\t\t\tlet selection = editor.getSelection();\n\t\t\t\t\t\tinsertCell(selection);\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\n\t\tgetSelectedCells: getSelectedCells,\n\t});\n})();\n\n/**\n * Create a two-dimension array that reflects the actual layout of table cells,\n * with cell spans, with mappings to the original td elements.\n *\n * @param {CKEDITOR.dom.element} table\n * @member CKEDITOR.tools\n */\nCKEDITOR.tools.buildTableMap = function(table) {\n\tlet aRows = table.$.rows;\n\n\t// Row and Column counters.\n\tlet r = -1;\n\n\tlet aMap = [];\n\n\tfor (let i = 0; i < aRows.length; i++) {\n\t\tr++;\n\t\t!aMap[r] && (aMap[r] = []);\n\n\t\tlet c = -1;\n\n\t\tfor (let j = 0; j < aRows[i].cells.length; j++) {\n\t\t\tlet oCell = aRows[i].cells[j];\n\n\t\t\tc++;\n\t\t\twhile (aMap[r][c]) c++;\n\n\t\t\tlet iColSpan = isNaN(oCell.colSpan) ? 1 : oCell.colSpan;\n\t\t\tlet iRowSpan = isNaN(oCell.rowSpan) ? 1 : oCell.rowSpan;\n\n\t\t\tfor (let rs = 0; rs < iRowSpan; rs++) {\n\t\t\t\tif (!aMap[r + rs]) aMap[r + rs] = [];\n\n\t\t\t\tfor (let cs = 0; cs < iColSpan; cs++) {\n\t\t\t\t\taMap[r + rs][c + cs] = aRows[i].cells[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc += iColSpan - 1;\n\t\t}\n\t}\n\treturn aMap;\n};\n","import button from './button.jsx';\nimport menuButton from './menu-button.jsx';\nimport menu from './menu.jsx';\nimport panelMenuButton from './panel-menu-button.jsx';\nimport richcombo from './richcombo.jsx';\nimport uibridge from './uibridge';\n\nexport {button, menuButton, menu, panelMenuButton, richcombo, uibridge};\n","import React from 'react';\n\n(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_buttonbridge')) {\n\t\treturn;\n\t}\n\n\tlet BUTTON_DEFS = {};\n\n\t/**\n\t * Generates a ButtonBridge React class for a given button definition if it has not been\n\t * already created based on the button name and definition.\n\t *\n\t * @private\n\t * @method generateButtonBridge\n\t * @param {String} buttonName The button's name\n\t * @param {Object} buttonDefinition The button's definition\n\t * @return {Object} The generated or already existing React Button Class\n\t */\n\n\tfunction generateButtonBridge(buttonName, buttonDefinition, editor) {\n\t\tlet ButtonBridge = AlloyEditor.Buttons[buttonName];\n\n\t\tBUTTON_DEFS[editor.name] = BUTTON_DEFS[editor.name] || {};\n\t\tBUTTON_DEFS[editor.name][buttonName] =\n\t\t\tBUTTON_DEFS[editor.name][buttonName] || buttonDefinition;\n\n\t\tif (!ButtonBridge) {\n\t\t\tButtonBridge = class extends React.Component {\n\t\t\t\tstatic displayName = buttonName;\n\n\t\t\t\tstatic key = buttonName;\n\n\t\t\t\t// API not yet implemented inside the button\n\t\t\t\t// bridge. By mocking the unsupported method, we prevent\n\t\t\t\t// plugins from crashing if they make use of it.\n\t\t\t\ttoFeature() {}\n\n\t\t\t\trender() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet buttonClassName = 'ae-button ae-button-bridge';\n\n\t\t\t\t\tlet buttonDisplayName =\n\t\t\t\t\t\tBUTTON_DEFS[editor.name][buttonName].name ||\n\t\t\t\t\t\tBUTTON_DEFS[editor.name][buttonName].command ||\n\t\t\t\t\t\tbuttonName;\n\n\t\t\t\t\tlet buttonLabel =\n\t\t\t\t\t\tBUTTON_DEFS[editor.name][buttonName].label;\n\n\t\t\t\t\tlet buttonType = 'button-' + buttonDisplayName;\n\n\t\t\t\t\tlet iconClassName = 'ae-icon-' + buttonDisplayName;\n\n\t\t\t\t\tlet iconStyle = {};\n\n\t\t\t\t\tlet cssStyle = CKEDITOR.skin.getIconStyle(\n\t\t\t\t\t\tbuttonDisplayName\n\t\t\t\t\t);\n\n\t\t\t\t\tif (cssStyle) {\n\t\t\t\t\t\tlet cssStyleParts = cssStyle.split(';');\n\n\t\t\t\t\t\ticonStyle.backgroundImage = cssStyleParts[0].substring(\n\t\t\t\t\t\t\tcssStyleParts[0].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundPosition = cssStyleParts[1].substring(\n\t\t\t\t\t\t\tcssStyleParts[1].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundSize = cssStyleParts[2].substring(\n\t\t\t\t\t\t\tcssStyleParts[2].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\taria-label={buttonLabel}\n\t\t\t\t\t\t\tclassName={buttonClassName}\n\t\t\t\t\t\t\tdata-type={buttonType}\n\t\t\t\t\t\t\tonClick={this._handleClick}\n\t\t\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\t\t\ttitle={buttonLabel}>\n\t\t\t\t\t\t\t<span className={iconClassName} style={iconStyle} />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t_handleClick = () => {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet buttonCommand =\n\t\t\t\t\t\tBUTTON_DEFS[editor.name][buttonName].command;\n\n\t\t\t\t\tlet buttonOnClick =\n\t\t\t\t\t\tBUTTON_DEFS[editor.name][buttonName].onClick;\n\n\t\t\t\t\tif (buttonOnClick) {\n\t\t\t\t\t\tbuttonOnClick.call(this);\n\t\t\t\t\t} else {\n\t\t\t\t\t\teditor.execCommand(buttonCommand);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.fire('actionPerformed', this);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tAlloyEditor.Buttons[buttonName] = ButtonBridge;\n\t\t}\n\n\t\treturn ButtonBridge;\n\t}\n\n\t/* istanbul ignore else */\n\tif (!CKEDITOR.plugins.get('button')) {\n\t\tCKEDITOR.UI_BUTTON = 'button';\n\n\t\tCKEDITOR.plugins.add('button', {});\n\t}\n\n\t/**\n\t * CKEditor plugin that bridges the support offered by CKEditor Button plugin. It takes over the\n\t * responsibility of registering and creating buttons via:\n\t * - editor.ui.addButton(name, definition)\n\t * - editor.ui.add(name, CKEDITOR.UI_BUTTON, definition)\n\t *\n\t * @class CKEDITOR.plugins.ae_buttonbridge\n\t * @requires CKEDITOR.plugins.ae_uibridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_buttonbridge', {\n\t\trequires: ['ae_uibridge'],\n\n\t\t/**\n\t\t * Set the add handler for UI_BUTTON to our own. We do this in the init phase to override\n\t\t * the one in the native plugin in case it's present.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The CKEditor instance being initialized\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\teditor.ui.addButton = function(buttonName, buttonDefinition) {\n\t\t\t\tthis.add(buttonName, CKEDITOR.UI_BUTTON, buttonDefinition);\n\t\t\t};\n\n\t\t\teditor.ui.addHandler(CKEDITOR.UI_BUTTON, {\n\t\t\t\tadd: generateButtonBridge,\n\t\t\t\tcreate: function(buttonDefinition) {\n\t\t\t\t\tlet buttonName =\n\t\t\t\t\t\t'buttonBridge' + ((Math.random() * 1e9) >>> 0);\n\t\t\t\t\tlet ButtonBridge = generateButtonBridge(\n\t\t\t\t\t\tbuttonName,\n\t\t\t\t\t\tbuttonDefinition\n\t\t\t\t\t);\n\n\t\t\t\t\treturn new ButtonBridge();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t});\n})();\n","import ButtonDropdown from '../buttons/button-dropdown.jsx';\nimport React from 'react';\n\n(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_menubuttonbridge')) {\n\t\treturn;\n\t}\n\n\tlet MENUBUTTON_DEFS = {};\n\n\t/**\n\t * Generates a MenuButtonBridge React class for a given menuButton definition if it has not been\n\t * already created based on the button name and definition.\n\t *\n\t * @private\n\t * @method generateMenuButtonBridge\n\t * @param {String} menuButtonName The menuButton's name\n\t * @param {Object} menuButtonDefinition The menuButton's definition\n\t * @return {Object} The generated or already existing React MenuButton Class\n\t */\n\tfunction generateMenuButtonBridge(\n\t\tmenuButtonName,\n\t\tmenuButtonDefinition,\n\t\teditor\n\t) {\n\t\tlet MenuButtonBridge = AlloyEditor.Buttons[menuButtonName];\n\n\t\tMENUBUTTON_DEFS[editor.name] = MENUBUTTON_DEFS[editor.name] || {};\n\t\tMENUBUTTON_DEFS[editor.name][menuButtonName] =\n\t\t\tMENUBUTTON_DEFS[editor.name][menuButtonName] ||\n\t\t\tmenuButtonDefinition;\n\n\t\tif (!MenuButtonBridge) {\n\t\t\tMenuButtonBridge = class extends React.Component {\n\t\t\t\tstatic displayName = menuButtonName;\n\n\t\t\t\tstatic key = menuButtonName;\n\n\t\t\t\t// API not yet implemented inside the menubutton\n\t\t\t\t// bridge. By mocking the unsupported method, we prevent\n\t\t\t\t// plugins from crashing if they make use of it.\n\t\t\t\ttoFeature() {}\n\n\t\t\t\trender() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet panelMenuButtonDisplayName =\n\t\t\t\t\t\tMENUBUTTON_DEFS[editor.name][menuButtonName].name ||\n\t\t\t\t\t\tMENUBUTTON_DEFS[editor.name][menuButtonName].command ||\n\t\t\t\t\t\tmenuButtonName;\n\n\t\t\t\t\tlet buttonClassName = 'ae-button ae-button-bridge';\n\n\t\t\t\t\tlet iconClassName = 'ae-icon-' + panelMenuButtonDisplayName;\n\n\t\t\t\t\tlet iconStyle = {};\n\n\t\t\t\t\tlet cssStyle = CKEDITOR.skin.getIconStyle(\n\t\t\t\t\t\tpanelMenuButtonDisplayName\n\t\t\t\t\t);\n\n\t\t\t\t\tif (cssStyle) {\n\t\t\t\t\t\tlet cssStyleParts = cssStyle.split(';');\n\n\t\t\t\t\t\ticonStyle.backgroundImage = cssStyleParts[0].substring(\n\t\t\t\t\t\t\tcssStyleParts[0].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundPosition = cssStyleParts[1].substring(\n\t\t\t\t\t\t\tcssStyleParts[1].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundSize = cssStyleParts[2].substring(\n\t\t\t\t\t\t\tcssStyleParts[2].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\t\t\t\taria-label={\n\t\t\t\t\t\t\t\t\tMENUBUTTON_DEFS[editor.name][menuButtonName]\n\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName={buttonClassName}\n\t\t\t\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\tMENUBUTTON_DEFS[editor.name][menuButtonName]\n\t\t\t\t\t\t\t\t\t\t.label\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={iconClassName}\n\t\t\t\t\t\t\t\t\tstyle={iconStyle}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{this.props.expanded && (\n\t\t\t\t\t\t\t\t<ButtonDropdown\n\t\t\t\t\t\t\t\t\tonDismiss={this.props.toggleDropdown}>\n\t\t\t\t\t\t\t\t\t{this._getMenuItems()}\n\t\t\t\t\t\t\t\t</ButtonDropdown>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t_getMenuItems() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\t\t\t\t\tlet items = menuButtonDefinition.onMenu();\n\t\t\t\t\tlet menuItems = Object.keys(items).map(function(key) {\n\t\t\t\t\t\tlet menuItem = editor.getMenuItem(key);\n\n\t\t\t\t\t\tif (!menuItem) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet menuItemDefinition =\n\t\t\t\t\t\t\tmenuItem.definition || menuItem;\n\t\t\t\t\t\tlet menuItemState = items[key];\n\n\t\t\t\t\t\tlet className =\n\t\t\t\t\t\t\t'ae-toolbar-element ' +\n\t\t\t\t\t\t\t(menuItemState === CKEDITOR.TRISTATE_ON\n\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t: '');\n\t\t\t\t\t\tlet disabled =\n\t\t\t\t\t\t\tmenuItemState === CKEDITOR.TRISTATE_DISABLED;\n\t\t\t\t\t\tlet onClick = function() {\n\t\t\t\t\t\t\tif (menuItemDefinition.command) {\n\t\t\t\t\t\t\t\teditor.execCommand(menuItemDefinition.command);\n\t\t\t\t\t\t\t} else if (menuItemDefinition.onClick) {\n\t\t\t\t\t\t\t\tmenuItemDefinition.onClick.apply(\n\t\t\t\t\t\t\t\t\tmenuItemDefinition\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li key={menuItem.name} role=\"option\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\t\tonClick={onClick}>\n\t\t\t\t\t\t\t\t\t{menuItemDefinition.label}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn menuItems;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tAlloyEditor.Buttons[menuButtonName] = MenuButtonBridge;\n\t\t}\n\n\t\treturn MenuButtonBridge;\n\t}\n\n\t/* istanbul ignore else */\n\tif (!CKEDITOR.plugins.get('menubutton')) {\n\t\tCKEDITOR.UI_MENU_BUTTON = 'menubutton';\n\n\t\tCKEDITOR.plugins.add('menubutton', {});\n\t}\n\n\t/**\n\t * CKEditor plugin that bridges the support offered by CKEditor MenuButton plugin. It takes over the\n\t * responsibility of registering and creating menuButtons via:\n\t * - editor.ui.addMenuButton(name, definition)\n\t * - editor.ui.add(name, CKEDITOR.UI_MENUBUTTON, definition)\n\t *\n\t * @class CKEDITOR.plugins.ae_menubuttonbridge\n\t * @requires CKEDITOR.plugins.ae_uibridge\n\t * @requires CKEDITOR.plugins.ae_menubridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_menubuttonbridge', {\n\t\trequires: ['ae_uibridge', 'ae_menubridge'],\n\n\t\t/**\n\t\t * Set the add handler for UI_MENUBUTTON to our own. We do this in the init phase to override\n\t\t * the one in the native plugin in case it's present.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The CKEditor instance being initialized\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\teditor.ui.addMenuButton = function(\n\t\t\t\tmenuButtonName,\n\t\t\t\tmenuButtonDefinition\n\t\t\t) {\n\t\t\t\tthis.add(\n\t\t\t\t\tmenuButtonName,\n\t\t\t\t\tCKEDITOR.UI_MENUBUTTON,\n\t\t\t\t\tmenuButtonDefinition\n\t\t\t\t);\n\t\t\t};\n\n\t\t\teditor.ui.addHandler(CKEDITOR.UI_MENUBUTTON, {\n\t\t\t\tadd: generateMenuButtonBridge,\n\t\t\t\tcreate: function(menuButtonDefinition) {\n\t\t\t\t\tlet menuButtonName =\n\t\t\t\t\t\t'buttonBridge' + ((Math.random() * 1e9) >>> 0);\n\t\t\t\t\tlet MenuButtonBridge = generateMenuButtonBridge(\n\t\t\t\t\t\tmenuButtonName,\n\t\t\t\t\t\tmenuButtonDefinition\n\t\t\t\t\t);\n\n\t\t\t\t\treturn new MenuButtonBridge();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_menubridge')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEditor plugin that bridges the support offered by CKEditor Menu plugin. It takes over the\n\t * responsibility of adding, removing and retrieving menu groups and items\n\t * - editor.addMenuGroup(name, order)\n\t * - editor.addMenuItem(name, definition)\n\t * - editor.addMenuItems(definitions)\n\t * - editor.getMenuItem(name)\n\t * - editor.removeMenuItem(name)\n\t *\n\t * @class CKEDITOR.plugins.ae_menubridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_menubridge', {\n\t\t/**\n\t\t * Set the add handler for UI_BUTTON to our own. We do this in the init phase to override\n\t\t * the one in the native plugin in case it's present.\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The CKEditor instance being initialized\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\t// Do nothing if the real menu plugin is present\n\t\t\tif (CKEDITOR.plugins.get('menu')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet groups = [];\n\t\t\tlet groupsOrder = (editor._.menuGroups = {});\n\t\t\tlet menuItems = (editor._.menuItems = {});\n\n\t\t\tfor (let i = 0; i < groups.length; i++) {\n\t\t\t\tgroupsOrder[groups[i]] = i + 1;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Registers an item group to the editor context menu in order to make it\n\t\t\t * possible to associate it with menu items later.\n\t\t\t *\n\t\t\t * @method addMenuGroup\n\t\t\t * @param {String} name Specify a group name.\n\t\t\t * @param {Number} [order=100] Define the display sequence of this group\n\t\t\t * inside the menu. A smaller value gets displayed first.\n\t\t\t */\n\t\t\teditor.addMenuGroup = function(name, order) {\n\t\t\t\tgroupsOrder[name] = order || 100;\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Adds an item from the specified definition to the editor context menu.\n\t\t\t *\n\t\t\t * @method addMenuItem\n\t\t\t * @param {String} name The menu item name.\n\t\t\t * @param {Object} definition The menu item definition.\n\t\t\t */\n\t\t\teditor.addMenuItem = function(name, definition) {\n\t\t\t\tif (groupsOrder[definition.group]) {\n\t\t\t\t\tmenuItems[name] = {\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\tdefinition: definition,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Adds one or more items from the specified definition object to the editor context menu.\n\t\t\t *\n\t\t\t * @method addMenuItems\n\t\t\t * @param {Object} definitions Object where keys are used as itemName and corresponding values as definition for a {@link #addMenuItem} call.\n\t\t\t */\n\t\t\teditor.addMenuItems = function(definitions) {\n\t\t\t\tfor (let itemName in definitions) {\n\t\t\t\t\tif (definitions.hasOwnProperty(itemName)) {\n\t\t\t\t\t\tthis.addMenuItem(itemName, definitions[itemName]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Retrieves a particular menu item definition from the editor context menu.\n\t\t\t *\n\t\t\t * @method getMenuItem\n\t\t\t * @param {String} name The name of the desired menu item.\n\t\t\t * @return {Object}\n\t\t\t */\n\t\t\teditor.getMenuItem = function(name) {\n\t\t\t\treturn menuItems[name];\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Removes a particular menu item added before from the editor context menu.\n\t\t\t *\n\t\t\t * @method  removeMenuItem\n\t\t\t * @param {String} name The name of the desired menu item.\n\t\t\t */\n\t\t\teditor.removeMenuItem = function(name) {\n\t\t\t\tdelete menuItems[name];\n\t\t\t};\n\t\t},\n\t});\n})();\n","import ButtonDropdown from '../buttons/button-dropdown.jsx';\nimport React from 'react';\n\n(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_panelmenubuttonbridge')) {\n\t\treturn;\n\t}\n\n\tlet PANEL_MENU_DEFS = {};\n\n\t/**\n\t * Generates a PanelMenuButtonBridge React class for a given panelmenubutton definition if it has not been\n\t * already created based on the panelmenubutton name and definition.\n\t *\n\t * @private\n\t * @method generatePanelMenuButtonBridge\n\t * @param {String} panelMenuButtonName The panel button name\n\t * @param {Object} panelMenuButtonDefinition The panel button definition\n\t * @return {Object} The generated or already existing React PanelMenuButton Class\n\t */\n\tlet generatePanelMenuButtonBridge = function(\n\t\tpanelMenuButtonName,\n\t\tpanelMenuButtonDefinition,\n\t\teditor\n\t) {\n\t\tlet PanelMenuButtonBridge = AlloyEditor.Buttons[panelMenuButtonName];\n\n\t\tPANEL_MENU_DEFS[editor.name] = PANEL_MENU_DEFS[editor.name] || {};\n\t\tPANEL_MENU_DEFS[editor.name][panelMenuButtonName] =\n\t\t\tPANEL_MENU_DEFS[editor.name][panelMenuButtonName] ||\n\t\t\tpanelMenuButtonDefinition;\n\n\t\tif (!PanelMenuButtonBridge) {\n\t\t\tPanelMenuButtonBridge = class extends React.Component {\n\t\t\t\tstatic displayName = panelMenuButtonName;\n\n\t\t\t\tstatic key = panelMenuButtonName;\n\n\t\t\t\t// API not yet implemented inside the panel menu button bridge. By mocking the unsupported methods, we\n\t\t\t\t// prevent plugins from crashing if they make use of them.\n\t\t\t\tcreatePanel() {}\n\n\t\t\t\trender() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet panelMenuButtonDisplayName =\n\t\t\t\t\t\tPANEL_MENU_DEFS[editor.name][panelMenuButtonName]\n\t\t\t\t\t\t\t.name ||\n\t\t\t\t\t\tPANEL_MENU_DEFS[editor.name][panelMenuButtonName]\n\t\t\t\t\t\t\t.command ||\n\t\t\t\t\t\tpanelMenuButtonName;\n\n\t\t\t\t\tlet buttonClassName = 'ae-button ae-button-bridge';\n\n\t\t\t\t\tlet iconClassName = 'ae-icon-' + panelMenuButtonDisplayName;\n\n\t\t\t\t\tlet iconStyle = {};\n\n\t\t\t\t\tlet cssStyle = CKEDITOR.skin.getIconStyle(\n\t\t\t\t\t\tpanelMenuButtonDisplayName\n\t\t\t\t\t);\n\n\t\t\t\t\tif (cssStyle) {\n\t\t\t\t\t\tlet cssStyleParts = cssStyle.split(';');\n\n\t\t\t\t\t\ticonStyle.backgroundImage = cssStyleParts[0].substring(\n\t\t\t\t\t\t\tcssStyleParts[0].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundPosition = cssStyleParts[1].substring(\n\t\t\t\t\t\t\tcssStyleParts[1].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t\ticonStyle.backgroundSize = cssStyleParts[2].substring(\n\t\t\t\t\t\t\tcssStyleParts[2].indexOf(':') + 1\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet panel;\n\n\t\t\t\t\tif (this.props.expanded) {\n\t\t\t\t\t\tpanel = this._getPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\t\t\t\taria-label={\n\t\t\t\t\t\t\t\t\tPANEL_MENU_DEFS[editor.name][\n\t\t\t\t\t\t\t\t\t\tpanelMenuButtonName\n\t\t\t\t\t\t\t\t\t].label\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName={buttonClassName}\n\t\t\t\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\tPANEL_MENU_DEFS[editor.name][\n\t\t\t\t\t\t\t\t\t\tpanelMenuButtonName\n\t\t\t\t\t\t\t\t\t].label\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={iconClassName}\n\t\t\t\t\t\t\t\t\tstyle={iconStyle}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{panel}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t_getPanel() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet panelMenuButtonOnBlock =\n\t\t\t\t\t\tPANEL_MENU_DEFS[editor.name][panelMenuButtonName]\n\t\t\t\t\t\t\t.onBlock;\n\n\t\t\t\t\tlet panel = {\n\t\t\t\t\t\thide: this.props.toggleDropdown,\n\t\t\t\t\t\tshow: this.props.toggleDropdown,\n\t\t\t\t\t};\n\n\t\t\t\t\tlet blockElement = new CKEDITOR.dom.element('div');\n\n\t\t\t\t\tlet block = {\n\t\t\t\t\t\telement: blockElement,\n\t\t\t\t\t\tkeys: {},\n\t\t\t\t\t};\n\n\t\t\t\t\t/* istanbul ignore else */\n\t\t\t\t\tif (panelMenuButtonOnBlock) {\n\t\t\t\t\t\tpanelMenuButtonOnBlock.call(this, panel, block);\n\t\t\t\t\t}\n\n\t\t\t\t\t// TODO\n\t\t\t\t\t// Use block.keys to configure the panel keyboard navigation\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<ButtonDropdown onDismiss={this.props.toggleDropdown}>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={blockElement.getAttribute('class')}\n\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t__html: blockElement.getHtml(),\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ButtonDropdown>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tAlloyEditor.Buttons[panelMenuButtonName] = PanelMenuButtonBridge;\n\t\t}\n\n\t\treturn PanelMenuButtonBridge;\n\t};\n\n\t/* istanbul ignore else */\n\tif (!CKEDITOR.plugins.get('panelmenubutton')) {\n\t\tCKEDITOR.UI_PANELBUTTON = 'panelmenubutton';\n\n\t\tCKEDITOR.plugins.add('panelmenubutton', {});\n\t}\n\n\t/* istanbul ignore else */\n\tif (!CKEDITOR.plugins.get('panelbutton')) {\n\t\tCKEDITOR.UI_PANELBUTTON = 'panelbutton';\n\n\t\tCKEDITOR.plugins.add('panelbutton', {});\n\t}\n\n\t/**\n\t * CKEditor plugin that bridges the support offered by CKEditor PanelButton plugin. It takes over the\n\t * responsibility of registering and creating buttons via:\n\t * - editor.ui.addPanelMenuButton(name, definition)\n\t * - editor.ui.add(name, CKEDITOR.UI_PANELBUTTON, definition)\n\t *\n\t * @class CKEDITOR.plugins.ae_panelmenubuttonbridge\n\t * @requires CKEDITOR.plugins.ae_uibridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_panelmenubuttonbridge', {\n\t\trequires: ['ae_uibridge'],\n\n\t\t/**\n\t\t * Set the add handler for UI_PANELBUTTON to our own. We do this in the init phase to override\n\t\t * the one in the native plugin in case it's present\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The CKEditor instance being initialized\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\teditor.ui.addPanelMenuButton = function(\n\t\t\t\tpanelMenuButtonName,\n\t\t\t\tpanelMenuButtonDefinition\n\t\t\t) {\n\t\t\t\tthis.add(\n\t\t\t\t\tpanelMenuButtonName,\n\t\t\t\t\tCKEDITOR.UI_PANELBUTTON,\n\t\t\t\t\tpanelMenuButtonDefinition\n\t\t\t\t);\n\t\t\t};\n\n\t\t\teditor.ui.addHandler(CKEDITOR.UI_PANELBUTTON, {\n\t\t\t\tadd: generatePanelMenuButtonBridge,\n\t\t\t\tcreate: function(panelMenuButtonDefinition) {\n\t\t\t\t\tlet panelMenuButtonName =\n\t\t\t\t\t\t'panelMenuButtonBridge' + ((Math.random() * 1e9) >>> 0);\n\t\t\t\t\tlet PanelMenuButtonBridge = generatePanelMenuButtonBridge(\n\t\t\t\t\t\tpanelMenuButtonName,\n\t\t\t\t\t\tpanelMenuButtonDefinition\n\t\t\t\t\t);\n\n\t\t\t\t\treturn new PanelMenuButtonBridge();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t});\n})();\n","import ButtonDropdown from '../buttons/button-dropdown.jsx';\nimport ButtonIcon from '../buttons/button-icon.jsx';\nimport React from 'react';\n\n(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_richcombobridge')) {\n\t\treturn;\n\t}\n\n\tlet RICH_COMBO_DEFS = {};\n\n\t/**\n\t * Generates a RichComboBridge React class for a given richcombo definition if it has not been\n\t * already created based on the richcombo name and definition.\n\t *\n\t * @method generateRichComboBridge\n\t * @private\n\t * @param {String} richComboName The rich combo name\n\t * @param {Object} richComboDefinition The rich combo definition\n\t * @return {Object} The generated or already existing React RichCombo Class\n\t */\n\tlet generateRichComboBridge = function(\n\t\trichComboName,\n\t\trichComboDefinition,\n\t\teditor\n\t) {\n\t\tlet RichComboBridge = AlloyEditor.Buttons[richComboName];\n\n\t\tRICH_COMBO_DEFS[editor.name] = RICH_COMBO_DEFS[editor.name] || {};\n\t\tRICH_COMBO_DEFS[editor.name][richComboName] =\n\t\t\tRICH_COMBO_DEFS[editor.name][richComboName] || richComboDefinition;\n\t\tRICH_COMBO_DEFS[editor.name][richComboName].currentValue = undefined;\n\n\t\tif (!RichComboBridge) {\n\t\t\tRichComboBridge = class extends React.Component {\n\t\t\t\tstatic displayName = richComboName;\n\n\t\t\t\tstatic key = richComboName;\n\n\t\t\t\tconstructor(props) {\n\t\t\t\t\tsuper(props);\n\t\t\t\t\tthis.state = {\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\tRICH_COMBO_DEFS[editor.name][richComboName]\n\t\t\t\t\t\t\t\t.currentValue,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// API not yet implemented inside the richcombo bridge. By mocking the unsupported methods, we\n\t\t\t\t// prevent plugins from crashing if they make use of them.\n\t\t\t\tcommit() {}\n\t\t\t\tcreatePanel() {}\n\t\t\t\tdisable() {}\n\t\t\t\tenable() {}\n\t\t\t\tgetState() {}\n\t\t\t\thideGroup() {}\n\t\t\t\thideItem() {}\n\t\t\t\tmark() {}\n\t\t\t\tshowAll() {}\n\t\t\t\tstartGroup() {}\n\t\t\t\tunmarkAll() {}\n\n\t\t\t\tadd(value, preview, title) {\n\t\t\t\t\tthis._items.push({\n\t\t\t\t\t\tpreview: preview,\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcomponentWillMount() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet editorCombo =\n\t\t\t\t\t\tRICH_COMBO_DEFS[editor.name][richComboName];\n\n\t\t\t\t\tthis._items = [];\n\n\t\t\t\t\tthis.setValue = this._setValue;\n\n\t\t\t\t\tif (editorCombo.init) {\n\t\t\t\t\t\teditorCombo.init.call(this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (editorCombo.onRender) {\n\t\t\t\t\t\teditorCombo.onRender.call(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcomponentWillUnmount() {\n\t\t\t\t\tthis._cacheValue(this.state.value);\n\n\t\t\t\t\tthis.setValue = this._cacheValue;\n\t\t\t\t}\n\n\t\t\t\tgetValue() {\n\t\t\t\t\treturn this.state.value;\n\t\t\t\t}\n\n\t\t\t\trender() {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet richComboLabel =\n\t\t\t\t\t\tRICH_COMBO_DEFS[editor.name][richComboName]\n\t\t\t\t\t\t\t.currentValue || richComboDefinition.label;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"ae-container-dropdown ae-has-dropdown\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\t\t\t\taria-label={richComboLabel}\n\t\t\t\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\t\t\t\ttitle={richComboLabel}>\n\t\t\t\t\t\t\t\t<div className=\"ae-container\">\n\t\t\t\t\t\t\t\t\t<span className=\"ae-container-dropdown-selected-item\">\n\t\t\t\t\t\t\t\t\t\t{richComboLabel}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\t\t\t\tsymbol=\"caret-bottom\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{this.props.expanded && (\n\t\t\t\t\t\t\t\t<ButtonDropdown\n\t\t\t\t\t\t\t\t\tonDismiss={this.props.toggleDropdown}>\n\t\t\t\t\t\t\t\t\t{this._getItems()}\n\t\t\t\t\t\t\t\t</ButtonDropdown>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t_cacheValue(value) {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tRICH_COMBO_DEFS[editor.name][\n\t\t\t\t\t\trichComboName\n\t\t\t\t\t].currentValue = value;\n\t\t\t\t}\n\n\t\t\t\t_getItems() {\n\t\t\t\t\tlet richCombo = this;\n\n\t\t\t\t\tlet items = this._items.map(\n\t\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\t\tlet className =\n\t\t\t\t\t\t\t\t'ae-toolbar-element ' +\n\t\t\t\t\t\t\t\t(item.value === this.state.value\n\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t: '');\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<li key={item.title} role=\"option\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={className}\n\t\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t\t__html: item.preview,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tdata-value={item.value}\n\t\t\t\t\t\t\t\t\t\tonClick={richCombo._onClick}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t);\n\n\t\t\t\t\treturn items;\n\t\t\t\t}\n\n\t\t\t\t_onClick = event => {\n\t\t\t\t\tlet editor = this.props.editor.get('nativeEditor');\n\n\t\t\t\t\tlet editorCombo =\n\t\t\t\t\t\tRICH_COMBO_DEFS[editor.name][richComboName];\n\n\t\t\t\t\tif (editorCombo.onClick) {\n\t\t\t\t\t\tlet newValue = event.currentTarget.getAttribute(\n\t\t\t\t\t\t\t'data-value'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\teditorCombo.onClick.call(this, newValue);\n\n\t\t\t\t\t\tRICH_COMBO_DEFS[editor.name][\n\t\t\t\t\t\t\trichComboName\n\t\t\t\t\t\t].currentValue = newValue;\n\n\t\t\t\t\t\teditor.fire('actionPerformed', this);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t_setValue(value) {\n\t\t\t\t\tthis._cacheValue(value);\n\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tAlloyEditor.Buttons[richComboName] = RichComboBridge;\n\t\t}\n\n\t\treturn RichComboBridge;\n\t};\n\n\t/* istanbul ignore else */\n\tif (!CKEDITOR.plugins.get('richcombo')) {\n\t\tCKEDITOR.UI_RICHCOMBO = 'richcombo';\n\n\t\tCKEDITOR.plugins.add('richcombo', {});\n\t}\n\n\t/**\n\t * CKEditor plugin that bridges the support offered by CKEditor RichCombo plugin. It takes over the\n\t * responsibility of registering and creating rich combo elements via:\n\t * - editor.ui.addRichCombo(name, definition)\n\t * - editor.ui.add(name, CKEDITOR.UI_RICHCOMBO, definition)\n\t *\n\t * @class CKEDITOR.plugins.ae_richcombobridge\n\t * @requires CKEDITOR.plugins.ae_uibridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_richcombobridge', {\n\t\trequires: ['ae_uibridge'],\n\n\t\t/**\n\t\t * Set the add handler for UI_RICHCOMBO to our own. We do this in the init phase to override\n\t\t * the one in the original plugin in case it's present\n\t\t *\n\t\t * @method init\n\t\t * @param {Object} editor The CKEditor instance being initialized\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\teditor.ui.addRichCombo = function(\n\t\t\t\trichComboName,\n\t\t\t\trichComboDefinition\n\t\t\t) {\n\t\t\t\tthis.add(\n\t\t\t\t\trichComboName,\n\t\t\t\t\tCKEDITOR.UI_RICHCOMBO,\n\t\t\t\t\trichComboDefinition\n\t\t\t\t);\n\t\t\t};\n\n\t\t\teditor.ui.addHandler(CKEDITOR.UI_RICHCOMBO, {\n\t\t\t\tadd: generateRichComboBridge,\n\t\t\t\tcreate: function(richComboDefinition) {\n\t\t\t\t\tlet richComboName =\n\t\t\t\t\t\t'richComboBridge' + ((Math.random() * 1e9) >>> 0);\n\t\t\t\t\tlet RichComboBridge = generateRichComboBridge(\n\t\t\t\t\t\trichComboName,\n\t\t\t\t\t\trichComboDefinition\n\t\t\t\t\t);\n\n\t\t\t\t\treturn new RichComboBridge();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t});\n})();\n","(function() {\n\t'use strict';\n\n\t/* istanbul ignore if */\n\tif (CKEDITOR.plugins.get('ae_uibridge')) {\n\t\treturn;\n\t}\n\n\t/**\n\t * CKEditor plugin that extends CKEDITOR.ui.add function so an add handler can be specified\n\t * on top of the original ones. It bridges the calls to add components via:\n\t * - editor.ui.add(name, type, definition)\n\t *\n\t * @class CKEDITOR.plugins.ae_uibridge\n\t * @constructor\n\t */\n\tCKEDITOR.plugins.add('ae_uibridge', {\n\t\t/**\n\t\t * Initialization of the plugin, part of CKEditor plugin lifecycle.\n\t\t *\n\t\t * @method beforeInit\n\t\t * @param {Object} editor The current editor instance\n\t\t */\n\t\tbeforeInit: function(editor) {\n\t\t\tlet originalUIAddFn = editor.ui.add;\n\n\t\t\teditor.ui.add = function(name, type, definition) {\n\t\t\t\toriginalUIAddFn.call(this, name, type, definition);\n\n\t\t\t\tlet typeHandler = this._.handlers[type];\n\n\t\t\t\tif (typeHandler && typeHandler.add) {\n\t\t\t\t\ttypeHandler.add(name, definition, editor);\n\t\t\t\t\tAlloyEditor.registerBridgeButton(\n\t\t\t\t\t\tname,\n\t\t\t\t\t\teditor.__processingPlugin__.plugin.name\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t});\n})();\n","import Attribute from './attribute.js';\nimport Lang from './lang.js';\nimport extend from './oop.js';\n\n/**\n * Quick and dirty impl of Base class.\n *\n * @class Base\n * @constructor\n */\nfunction Base(config) {\n\tBase.superclass.constructor.call(this, config);\n\n\tthis.init(config);\n}\n\nextend(Base, Attribute, {\n\t/**\n\t * Calls the `initializer` method of each class which extends Base starting from the parent to the child.\n\t * Will pass the configuration object to each initializer method.\n\t *\n\t * @instance\n\t * @memberof Base\n\t * @method init\n\t * @param {Object} config Configuration object\n\t */\n\tinit: function(config) {\n\t\tthis._callChain('initializer', config);\n\t},\n\n\t/**\n\t * Calls the `destructor` method of each class which extends Base starting from the parent to the child.\n\t *\n\t * @instance\n\t * @memberof Base\n\t * @method destroy\n\t */\n\tdestroy: function() {\n\t\tthis._callChain('destructor');\n\t},\n\n\t/**\n\t * Calls a method of each class, which is being present in the hierarchy starting from parent to the child.\n\t *\n\t * @instance\n\t * @memberof Base\n\t * @method _callChain\n\t * @param {Object|Array} args The arguments with which the method should be invoked\n\t * @param {String} wat  The method, which should be invoked\n\t * @protected\n\t */\n\t_callChain: function(wat, args) {\n\t\tlet arr = [];\n\n\t\tlet ctor = this.constructor;\n\n\t\twhile (ctor) {\n\t\t\tif (Lang.isFunction(ctor.prototype[wat])) {\n\t\t\t\tarr.push(ctor.prototype[wat]);\n\t\t\t}\n\n\t\t\tctor = ctor.superclass ? ctor.superclass.constructor : null;\n\t\t}\n\n\t\tarr = arr.reverse();\n\n\t\targs = Lang.isArray(args) ? args : [args];\n\n\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\tlet item = arr[i];\n\n\t\t\titem.apply(this, args);\n\t\t}\n\t},\n});\n\nexport default Base;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport WidgetExclusive from './base/widget-exclusive.js';\nimport WidgetFocusManager from './base/widget-focus-manager.js';\nimport PropTypes from 'prop-types';\n\n/**\n * The main editor UI class manages a hierarchy of widgets (toolbars and buttons).\n *\n * @class UI\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n */\nclass UI extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\thidden: false,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client, immediately after the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\teditor.on('editorInteraction', this._onEditorInteraction, this);\n\t\teditor.on('actionPerformed', this._onActionPerformed, this);\n\t\teditor.on('key', this._onEditorKey, this);\n\n\t\t// Set up events for hiding the UI when user stops interacting with the editor.\n\t\t// This may happen when he just clicks outside of the editor. However,\n\t\t// this does not include a situation when he clicks on some button, part of\n\t\t// editor's UI.\n\n\t\t// It is not easy to debounce _setUIHidden on mousedown, because if we\n\t\t// debounce it, when the handler is being invoked, the target might be no more part\n\t\t// of the editor's UI - onActionPerformed causes re-render.\n\t\tthis._mousedownListener = event => {\n\t\t\tthis._setUIHidden(event.target);\n\t\t};\n\n\t\tthis._keyDownListener = CKEDITOR.tools.debounce(\n\t\t\t_event => {\n\t\t\t\tthis._setUIHidden(document.activeElement);\n\t\t\t},\n\t\t\tthis.props.eventsDelay,\n\t\t\tthis\n\t\t);\n\n\t\tdocument.addEventListener('mousedown', this._mousedownListener);\n\t\tdocument.addEventListener('keydown', this._keyDownListener);\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n\t * Fires `ariaUpdate` event passing ARIA related messages.\n\t * Fires `editorUpdate` event passing the previous and current properties and state.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @method componentDidUpdate\n\t */\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tconst domNode = ReactDOM.findDOMNode(this);\n\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tif (domNode) {\n\t\t\teditor.fire('ariaUpdate', {\n\t\t\t\tmessage: this._getAvailableToolbarsMessage(domNode),\n\t\t\t});\n\t\t}\n\n\t\teditor.fire('editorUpdate', {\n\t\t\tprevProps: prevProps,\n\t\t\tprevState: prevState,\n\t\t\tprops: this.props,\n\t\t\tstate: this.state,\n\t\t});\n\t}\n\n\t_getAriaUpdateTemplate(ariaUpdate) {\n\t\tif (!this._ariaUpdateTemplates) {\n\t\t\tthis._ariaUpdateTemplates = {};\n\t\t}\n\n\t\tif (!this._ariaUpdateTemplates[ariaUpdate]) {\n\t\t\tthis._ariaUpdateTemplates[ariaUpdate] = new CKEDITOR.template(\n\t\t\t\tthis._getAriaUpdates()[ariaUpdate]\n\t\t\t);\n\t\t}\n\n\t\treturn this._ariaUpdateTemplates[ariaUpdate];\n\t}\n\n\t/**\n\t * Returns the templates for ARIA messages.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _getAriaUpdates\n\t * @return {Object} ARIA relates messages. Default:\n\t * {\n\t *      noToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n\t *      oneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n\t *      manyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars\n\t *  }\n\t */\n\t_getAriaUpdates() {\n\t\treturn (\n\t\t\tthis.props.ariaUpdates || {\n\t\t\t\tnoToolbar: AlloyEditor.Strings.ariaUpdateNoToolbar,\n\t\t\t\toneToolbar: AlloyEditor.Strings.ariaUpdateOneToolbar,\n\t\t\t\tmanyToolbars: AlloyEditor.Strings.ariaUpdateManyToolbars,\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Returns an ARIA message which represents the number of currently available toolbars.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @method _getAvailableToolbarsMessage\n\t * @protected\n\t * @param {CKEDITOR.dom.element} domNode The DOM node from which the available toolbars will be retrieved.\n\t * @return {String} The ARIA message for the number of available toolbars\n\t */\n\t_getAvailableToolbarsMessage(domNode) {\n\t\tconst toolbarsNodeList = domNode.querySelectorAll('[role=\"toolbar\"]');\n\n\t\tif (!toolbarsNodeList.length) {\n\t\t\treturn this._getAriaUpdates().noToolbar;\n\t\t} else {\n\t\t\tconst toolbarNames = Array.prototype.slice\n\t\t\t\t.call(toolbarsNodeList)\n\t\t\t\t.map(toolbar => {\n\t\t\t\t\treturn toolbar.getAttribute('aria-label');\n\t\t\t\t});\n\n\t\t\tconst ariaUpdate =\n\t\t\t\ttoolbarNames.length === 1 ? 'oneToolbar' : 'manyToolbars';\n\n\t\t\treturn this._getAriaUpdateTemplate(ariaUpdate).output({\n\t\t\t\ttoolbars: toolbarNames\n\t\t\t\t\t.join(',')\n\t\t\t\t\t.replace(/,([^,]*)$/, ' and ' + '$1'),\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately before a component is unmounted from the DOM.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @method componentWillUnmount\n\t */\n\tcomponentWillUnmount() {\n\t\tif (this._mousedownListener) {\n\t\t\tdocument.removeEventListener('mousedown', this._mousedownListener);\n\t\t}\n\n\t\tif (this._keyDownListener) {\n\t\t\tthis._keyDownListener.detach();\n\t\t\tdocument.removeEventListener('keydown', this._keyDownListener);\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the editor. This may include several toolbars and buttons.\n\t * The editor's UI also takes care of rendering the items in exclusive mode.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.state.hidden) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet toolbars = Object.keys(this.props.toolbars).map(toolbar => {\n\t\t\treturn AlloyEditor.Toolbars[toolbar] || window[toolbar];\n\t\t});\n\n\t\ttoolbars = this.filterExclusive(toolbars).map(toolbar => {\n\t\t\tconst props = this.mergeExclusiveProps(\n\t\t\t\t{\n\t\t\t\t\tconfig: this.props.toolbars[toolbar.key],\n\t\t\t\t\teditor: this.props.editor,\n\t\t\t\t\teditorEvent: this.state.editorEvent,\n\t\t\t\t\tkey: toolbar.key,\n\t\t\t\t\tonDismiss: this._onDismissToolbarFocus,\n\t\t\t\t\tselectionData: this.state.selectionData,\n\t\t\t\t},\n\t\t\t\ttoolbar.key\n\t\t\t);\n\n\t\t\treturn React.createElement(toolbar, props);\n\t\t});\n\n\t\treturn (\n\t\t\t<div className=\"ae-toolbars\" onKeyDown={this.handleKey}>\n\t\t\t\t{toolbars}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Listener to the editor's `actionPerformed` event. Sets state and redraws the UI of the editor.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _onActionPerformed\n\t * @param {SynteticEvent} event The provided event\n\t */\n\t_onActionPerformed(_event) {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\teditor.focus();\n\n\t\tthis.setState({\n\t\t\titemExclusive: null,\n\t\t\tselectionData: editor.getSelectionData(),\n\t\t});\n\t}\n\n\t/**\n\t * Executed when a dismiss key is pressed over a toolbar to return the focus to the editor.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _onDismissToolbarFocus\n\t */\n\t_onDismissToolbarFocus = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\teditor.focus();\n\t};\n\n\t/**\n\t * Listener to the editor's `userInteraction` event. Retrieves the data about the user selection and\n\t * provides it via component's state property.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _onEditorInteraction\n\t * @param {SynteticEvent} event The provided event\n\t */\n\t_onEditorInteraction(event) {\n\t\tthis.setState({\n\t\t\teditorEvent: event,\n\t\t\thidden: false,\n\t\t\titemExclusive: null,\n\t\t\tselectionData: event.data.selectionData,\n\t\t});\n\t}\n\n\t/**\n\t * Focuses on the active toolbar when the combination ALT+F10 is pressed inside the editor.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _onEditorKey\n\t */\n\t_onEditorKey(event) {\n\t\tconst nativeEvent = event.data.domEvent.$;\n\n\t\tif (nativeEvent.altKey && nativeEvent.keyCode === 121) {\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the target with which the user interacted is part of editor's UI or it is\n\t * the editable area. If none of these, sets the state of editor's UI to be hidden.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @protected\n\t * @method _setUIHidden\n\t * @param {DOMElement} target The DOM element with which user interacted lastly.\n\t */\n\t_setUIHidden(target) {\n\t\tconst domNode = ReactDOM.findDOMNode(this);\n\n\t\tif (domNode) {\n\t\t\tconst editable = this.props.editor.get('nativeEditor').editable();\n\t\t\tconst parentNode = target.parentNode;\n\t\t\tconst targetNode = new CKEDITOR.dom.node(target);\n\n\t\t\tif (!editable) {\n\t\t\t\tthis.setState({\n\t\t\t\t\thidden: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet res =\n\t\t\t\t\teditable.$ === target ||\n\t\t\t\t\teditable.contains(targetNode) ||\n\t\t\t\t\tnew CKEDITOR.dom.element(domNode).contains(targetNode);\n\n\t\t\t\tif (parentNode) {\n\t\t\t\t\tres = res || parentNode.id === 'ckimgrsz';\n\t\t\t\t}\n\n\t\t\t\tif (!res) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\thidden: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof UI\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nUI.defaultProps = {\n\tcircular: true,\n\tdescendants: '[class^=ae-toolbar-]',\n\teventsDelay: 0,\n\tkeys: {\n\t\tnext: 9,\n\t},\n};\n\n/**\n * Fired when component updates and when it is rendered in the DOM.\n * The payload consists from a `message` property containing the ARIA message.\n *\n * @event ariaUpdate\n */\n\n/**\n * Fired when component updates. The payload consists from an object with the following\n * properties:\n * - prevProps - The previous properties of the component\n * - prevState - The previous state of the component\n * - props - The current properties of the component\n * - state - The current state of the component\n *\n * @event ariaUpdate\n */\n\nUI.propTypes = {\n\t/**\n\t * Localized messages for live aria updates. Should include the following messages:\n\t * - noToolbar: Notification for no available toolbar in the editor.\n\t * - oneToolbar: Notification for just one available toolbar in the editor.\n\t * - manyToolbars: Notification for more than one available toolbar in the editor.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @property {Object} ariaUpdates\n\t */\n\tariaUpdates: PropTypes.object,\n\n\t/**\n\t * The editor instance where the component is being used.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @property {Object} editor\n\t */\n\teditor: PropTypes.object.isRequired,\n\n\t/**\n\t * The delay (ms), after which key or mouse events will be processed.\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @property {Number} eventsDelay\n\t */\n\teventsDelay: PropTypes.number,\n\n\t/**\n\t * The toolbars configuration for this editor instance\n\t *\n\t * @instance\n\t * @memberof UI\n\t * @property {Object} toolbars\n\t */\n\ttoolbars: PropTypes.object.isRequired,\n};\n\nexport default WidgetExclusive(WidgetFocusManager(UI));\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","import ButtonAccessibilityImageAlt from './button-accessibility-image-alt.jsx';\nimport ButtonBackgroundColor from './button-background-color.jsx';\nimport ButtonBold from './button-bold.jsx';\nimport ButtonCameraImage from './button-camera-image.jsx';\nimport ButtonCamera from './button-camera.jsx';\nimport ButtonCode from './button-code.jsx';\nimport ButtonColor from './button-color.jsx';\nimport ButtonCommandListItem from './button-command-list-item.jsx';\nimport ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonDropdown from './button-dropdown.jsx';\nimport ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonEmbed from './button-embed.jsx';\nimport ButtonEmbedVideoEdit from './button-embed-video-edit.jsx';\nimport ButtonEmbedVideo from './button-embed-video.jsx';\nimport ButtonH1 from './button-h1.jsx';\nimport ButtonH2 from './button-h2.jsx';\nimport ButtonHline from './button-hline.jsx';\nimport ButtonImageAlignCenter from './button-image-align-center.jsx';\nimport ButtonImageAlignLeft from './button-image-align-left.jsx';\nimport ButtonImageAlignRight from './button-image-align-right.jsx';\nimport ButtonImage from './button-image.jsx';\nimport ButtonIndentBlock from './button-indent-block.jsx';\nimport ButtonItalic from './button-italic.jsx';\nimport ButtonItemSelectorAudio from './button-item-selector-audio.jsx';\nimport ButtonItemSelectorImage from './button-item-selector-image.jsx';\nimport ButtonItemSelectorVideo from './button-item-selector-video.jsx';\nimport ButtonLinkAutocompleteList from './button-link-autocomplete-list.jsx';\nimport ButtonLinkBrowse from './button-link-browse.jsx';\nimport ButtonLinkEditBrowse from './button-link-edit-browse.jsx';\nimport ButtonLinkEdit from './button-link-edit.jsx';\nimport ButtonLinkTargetEdit from './button-link-target-edit.jsx';\nimport ButtonLink from './button-link.jsx';\nimport ButtonOl from './button-ol.jsx';\nimport ButtonOutdentBlock from './button-outdent-block.jsx';\nimport ButtonParagraphAlign from './button-paragraph-align.jsx';\nimport ButtonParagraphAlignLeft from './button-paragraph-align-left.jsx';\nimport ButtonParagraphAlignRight from './button-paragraph-align-right.jsx';\nimport ButtonParagraphCenter from './button-paragraph-center.jsx';\nimport ButtonParagraphJustify from './button-paragraph-justify.jsx';\nimport ButtonQuote from './button-quote.jsx';\nimport ButtonRemoveFormat from './button-remove-format.jsx';\nimport ButtonSeparator from './button-separator.jsx';\nimport ButtonSpacing from './button-spacing.jsx';\nimport ButtonStrike from './button-strike.jsx';\nimport ButtonStylesListHeader from './button-styles-list-header.jsx';\nimport ButtonStylesListItemRemove from './button-styles-list-item-remove.jsx';\nimport ButtonStylesListItem from './button-styles-list-item.jsx';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport ButtonStyles from './button-styles.jsx';\nimport ButtonSubscript from './button-subscript.jsx';\nimport ButtonSuperscript from './button-superscript.jsx';\nimport ButtonTableCell from './button-table-cell.jsx';\nimport ButtonTableColumn from './button-table-column.jsx';\nimport ButtonTableEdit from './button-table-edit.jsx';\nimport ButtonTableHeading from './button-table-heading.jsx';\nimport ButtonTableRemove from './button-table-remove.jsx';\nimport ButtonTableRow from './button-table-row.jsx';\nimport ButtonTable from './button-table.jsx';\nimport ButtonTargetList from './button-target-list.jsx';\nimport ButtonTwitter from './button-twitter.jsx';\nimport ButtonUl from './button-ul.jsx';\nimport ButtonUnderline from './button-underline.jsx';\n\nexport default {\n\t[ButtonAccessibilityImageAlt.key]: ButtonAccessibilityImageAlt,\n\t[ButtonBackgroundColor.key]: ButtonBackgroundColor,\n\t[ButtonBold.key]: ButtonBold,\n\t[ButtonCameraImage.key]: ButtonCameraImage,\n\t[ButtonCamera.key]: ButtonCamera,\n\t[ButtonCode.key]: ButtonCode,\n\t[ButtonColor.key]: ButtonColor,\n\t[ButtonCommandListItem.key]: ButtonCommandListItem,\n\t[ButtonCommandsList.key]: ButtonCommandsList,\n\t[ButtonDropdown.key]: ButtonDropdown,\n\t[ButtonEmbedEdit.key]: ButtonEmbedEdit,\n\t[ButtonEmbed.key]: ButtonEmbed,\n\t[ButtonEmbedVideoEdit.key]: ButtonEmbedVideoEdit,\n\t[ButtonEmbedVideo.key]: ButtonEmbedVideo,\n\t[ButtonH1.key]: ButtonH1,\n\t[ButtonH2.key]: ButtonH2,\n\t[ButtonHline.key]: ButtonHline,\n\t[ButtonImageAlignCenter.key]: ButtonImageAlignCenter,\n\t[ButtonImageAlignLeft.key]: ButtonImageAlignLeft,\n\t[ButtonImageAlignRight.key]: ButtonImageAlignRight,\n\t[ButtonImage.key]: ButtonImage,\n\t[ButtonIndentBlock.key]: ButtonIndentBlock,\n\t[ButtonItalic.key]: ButtonItalic,\n\t[ButtonItemSelectorAudio.key]: ButtonItemSelectorAudio,\n\t[ButtonItemSelectorImage.key]: ButtonItemSelectorImage,\n\t[ButtonItemSelectorVideo.key]: ButtonItemSelectorVideo,\n\t[ButtonLinkAutocompleteList.key]: ButtonLinkAutocompleteList,\n\t[ButtonLinkBrowse.key]: ButtonLinkBrowse,\n\t[ButtonLinkEditBrowse.key]: ButtonLinkEditBrowse,\n\t[ButtonLinkEdit.key]: ButtonLinkEdit,\n\t[ButtonLinkTargetEdit.key]: ButtonLinkTargetEdit,\n\t[ButtonLink.key]: ButtonLink,\n\t[ButtonOl.key]: ButtonOl,\n\t[ButtonOutdentBlock.key]: ButtonOutdentBlock,\n\t[ButtonParagraphAlign.key]: ButtonParagraphAlign,\n\t[ButtonParagraphAlignLeft.key]: ButtonParagraphAlignLeft,\n\t[ButtonParagraphAlignRight.key]: ButtonParagraphAlignRight,\n\t[ButtonParagraphCenter.key]: ButtonParagraphCenter,\n\t[ButtonParagraphJustify.key]: ButtonParagraphJustify,\n\t[ButtonQuote.key]: ButtonQuote,\n\t[ButtonRemoveFormat.key]: ButtonRemoveFormat,\n\t[ButtonSeparator.key]: ButtonSeparator,\n\t[ButtonSpacing.key]: ButtonSpacing,\n\t[ButtonStrike.key]: ButtonStrike,\n\t[ButtonStylesListHeader.key]: ButtonStylesListHeader,\n\t[ButtonStylesListItemRemove.key]: ButtonStylesListItemRemove,\n\t[ButtonStylesListItem.key]: ButtonStylesListItem,\n\t[ButtonStylesList.key]: ButtonStylesList,\n\t[ButtonStyles.key]: ButtonStyles,\n\t[ButtonSubscript.key]: ButtonSubscript,\n\t[ButtonSuperscript.key]: ButtonSuperscript,\n\t[ButtonTableCell.key]: ButtonTableCell,\n\t[ButtonTableColumn.key]: ButtonTableColumn,\n\t[ButtonTableEdit.key]: ButtonTableEdit,\n\t[ButtonTableHeading.key]: ButtonTableHeading,\n\t[ButtonTableRemove.key]: ButtonTableRemove,\n\t[ButtonTableRow.key]: ButtonTableRow,\n\t[ButtonTable.key]: ButtonTable,\n\t[ButtonTargetList.key]: ButtonTargetList,\n\t[ButtonTwitter.key]: ButtonTwitter,\n\t[ButtonUl.key]: ButtonUl,\n\t[ButtonUnderline.key]: ButtonUnderline,\n};\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonProps from '../base/button-props.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\n/**\n * The ButtonAccessibilityImageAlt class provides functionality for changing text color in a document.\n *\n * @class ButtonAccessibilityImageAlt\n * @uses ButtonProps\n * @uses ButtonStateClasses\n *\n */\nclass ButtonAccessibilityImageAlt extends React.Component {\n\tstatic key = 'AccessibilityImageAlt';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonAccessibilityImageAlt\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\tconstructor(prop, context) {\n\t\tsuper(prop, context);\n\n\t\tconst element = this.props.editor\n\t\t\t.get('nativeEditor')\n\t\t\t.getSelection()\n\t\t\t.getSelectedElement();\n\n\t\tconst imageAlt = (element && element.getAttribute('alt')) || '';\n\n\t\tthis.state = {\n\t\t\telement,\n\t\t\timageAlt,\n\t\t};\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = 'ae-button ' + this.getStateClasses();\n\n\t\tif (this.props.renderExclusive) {\n\t\t\treturn (\n\t\t\t\t<div className=\"ae-container-edit-link\">\n\t\t\t\t\t<div className=\"ae-container-input xxl\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\taria-label=\"alt\"\n\t\t\t\t\t\t\tclassName=\"ae-input\"\n\t\t\t\t\t\t\tonChange={this._handleAltChange}\n\t\t\t\t\t\t\tonKeyDown={this._handleKeyDown}\n\t\t\t\t\t\t\tplaceholder=\"alt\"\n\t\t\t\t\t\t\tref=\"refAltInput\"\n\t\t\t\t\t\t\ttitle=\"alt\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvalue={this.state.imageAlt}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label={AlloyEditor.Strings.confirm}\n\t\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\t\tonClick={this._updateImageAlt}\n\t\t\t\t\t\ttitle={AlloyEditor.Strings.confirm}>\n\t\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"check\" />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\tclassName={cssClass}\n\t\t\t\t\tonClick={this._requestExclusive}\n\t\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t\t<small className=\"ae-icon small\">Alt</small>\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Focuses the user cursor on the widget's input.\n\t *\n\t * @protected\n\t * @method _focusAltInput\n\t */\n\t_focusAltInput() {\n\t\tconst instance = this;\n\n\t\tconst focusAltEl = function() {\n\t\t\tReactDOM.findDOMNode(instance.refs.refAltInput).focus();\n\t\t};\n\n\t\tif (window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame(focusAltEl);\n\t\t} else {\n\t\t\tsetTimeout(focusAltEl, 0);\n\t\t}\n\t}\n\n\t/**\n\t * Event attached to alt input that fires when its value is changed\n\t *\n\t * @protected\n\t * @method  _handleAltChange\n\t * @param {MouseEvent} event\n\t */\n\t_handleAltChange = event => {\n\t\tthis.setState({\n\t\t\timageAlt: event.target.value,\n\t\t});\n\n\t\tthis._focusAltInput();\n\t};\n\n\t/**\n\t * Event attached to al tinput that fires when key is down\n\t * This method check that enter key is pushed to update the component´s state\n\t *\n\t * @protected\n\t * @method  _handleKeyDown\n\t * @param {MouseEvent} event\n\t */\n\t_handleKeyDown = event => {\n\t\tif (event.keyCode === 13) {\n\t\t\tevent.preventDefault();\n\n\t\t\tthis._updateImageAlt();\n\t\t}\n\t};\n\n\t/**\n\t * Requests the link button to be rendered in exclusive mode to allow the creation of a link.\n\t *\n\t * @protected\n\t * @method _requestExclusive\n\t */\n\t_requestExclusive = () => {\n\t\tthis.props.requestExclusive(ButtonAccessibilityImageAlt.key);\n\t};\n\n\t/**\n\t * Method called by clicking ok button or pushing key enter to update imageAlt state and to update alt property from the image that is selected\n\t * This method calls cancelExclusive to show the previous toolbar before enter to edit alt property\n\t *\n\t * @protected\n\t * @method  _updateImageAlt\n\t */\n\t_updateImageAlt = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst imageAlt = this.refs.refAltInput.value;\n\n\t\tthis.setState({\n\t\t\timageAlt,\n\t\t});\n\n\t\tthis.state.element.setAttribute('alt', imageAlt);\n\n\t\teditor.fire('actionPerformed', this);\n\n\t\t// We need to cancelExclusive with the bound parameters in case the button is used\n\t\t// inside another in exclusive mode (such is the case of the alt button)\n\t\tthis.props.cancelExclusive();\n\t};\n}\n\nexport default ButtonProps(ButtonStateClasses(ButtonAccessibilityImageAlt));\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonProps from '../base/button-props.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nclass ButtonBackgroundColor extends React.Component {\n\tstatic key = 'backgroundColor';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\n\t\t/**\n\t\t * Indicates whether the styles list is expanded or not.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Boolean} expanded\n\t\t */\n\t\texpanded: PropTypes.bool,\n\n\t\t/**\n\t\t * The label that should be used for accessibility purposes.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {String} label\n\t\t */\n\t\tlabel: PropTypes.string,\n\n\t\t/**\n\t\t * Indicates whether the remove styles item should appear in the styles list.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Boolean} showRemoveStylesItem\n\t\t */\n\t\tshowRemoveStylesItem: PropTypes.bool,\n\n\t\t/**\n\t\t * List of the styles the button is able to handle.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Array} styles\n\t\t */\n\t\tstyles: PropTypes.arrayOf(PropTypes.object),\n\n\t\t/**\n\t\t * The tabIndex of the button in its toolbar current state. A value other than -1\n\t\t * means that the button has focus and is the active element.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Number} tabIndex\n\t\t */\n\t\ttabIndex: PropTypes.number,\n\n\t\t/**\n\t\t * Callback provided by the button host to notify when the styles list has been expanded.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonBackgroundColor\n\t\t * @property {Function} toggleDropdown\n\t\t */\n\t\ttoggleDropdown: PropTypes.func,\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet activeColor = AlloyEditor.Strings.normal;\n\n\t\tlet activeColorClass = '';\n\n\t\tconst colors = this._getColors();\n\n\t\tconst itemStyle = {\n\t\t\telement: 'span',\n\t\t\tattributes: {\n\t\t\t\tclass: '',\n\t\t\t},\n\t\t};\n\n\t\tcolors.forEach(item => {\n\t\t\titemStyle.attributes.class = item.styleClass;\n\n\t\t\tif (this._checkActive(itemStyle)) {\n\t\t\t\tactiveColor = item.name;\n\n\t\t\t\tactiveColorClass = item.style.attributes.class;\n\t\t\t}\n\t\t});\n\n\t\tconst {editor, expanded, tabIndex, toggleDropdown} = this.props;\n\n\t\tconst buttonStylesProps = {\n\t\t\tactiveStyle: activeColor,\n\t\t\teditor,\n\t\t\tonDismiss: toggleDropdown,\n\t\t\tshowRemoveStylesItem: false,\n\t\t\tstyles: colors,\n\t\t};\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={expanded}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={tabIndex}>\n\t\t\t\t\t<span className={activeColorClass}>\n\t\t\t\t\t\t<ButtonIcon editor={editor} symbol=\"textbox\" />\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t{expanded && <ButtonStylesList {...buttonStylesProps} />}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t_applyStyle(className) {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst styleConfig = {\n\t\t\telement: 'span',\n\t\t\tattributes: {\n\t\t\t\tclass: className,\n\t\t\t},\n\t\t};\n\n\t\teditor.getSelection().lock();\n\n\t\tthis._getColors().forEach(item => {\n\t\t\tstyleConfig.attributes.class = item.styleClass;\n\n\t\t\tif (this._checkActive(styleConfig)) {\n\t\t\t\teditor.removeStyle(new CKEDITOR.style(styleConfig));\n\t\t\t}\n\t\t});\n\n\t\tstyleConfig.attributes.class = className;\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\teditor.applyStyle(style);\n\n\t\teditor.getSelection().unlock();\n\n\t\teditor.fire('actionPerformed', this);\n\t}\n\n\t/**\n\t * Checks if the given color definition is applied to the current selection in the editor.\n\t *\n\t * @instance\n\t * @memberof ButtonBackgroundColor\n\t * @method _checkActive\n\t * @param {Object} styleConfig color definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n\t * @protected\n\t * @return {Boolean} Returns true if the color is applied to the selection, false otherwise.\n\t */\n\t_checkActive(styleConfig) {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\t// Styles with wildcard element (*) won't be considered active by CKEditor. Defaulting\n\t\t// to a 'span' element works for most of those cases with no defined element.\n\t\tstyleConfig = CKEDITOR.tools.merge({element: 'span'}, styleConfig);\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\treturn style.checkActive(nativeEditor.elementPath(), nativeEditor);\n\t}\n\n\t/**\n\t * Returns an array of colors. Each color consists of two properties:\n\t * - name - the style name, for example \"default\"\n\t * - style - an object with one property, called `element` which value\n\t * represents the style which have to be applied to the element.\n\t *\n\t * @instance\n\t * @memberof ButtonBackgroundColor\n\t * @method _getColor\n\t * @protected\n\t * @return {Array<object>} An array of objects containing the colors.\n\t */\n\t_getColors() {\n\t\treturn (\n\t\t\tthis.props.styles || [\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.normal,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-body',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: '',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, ''),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.primary,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-primary',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-primary',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-primary'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.disabled,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-secondary',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-secondary',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-secondary'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.success,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-success',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-success',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-success'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.danger,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-danger',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-danger',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-danger'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.warning,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-warning',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-warning',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-warning'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.info,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-info',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleClass: 'bg-info',\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'bg-info'),\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonProps(ButtonStateClasses(ButtonBackgroundColor));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonBold class provides functionality for styling an selection with strong (bold) style.\n *\n * @class ButtonBold\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonBold extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonBold\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'bold',\n\t\tkeystroke: {\n\t\t\tfn: 'execCommand',\n\t\t\tkeys: CKEDITOR.CTRL + 66 /* B*/,\n\t\t},\n\t\tstyle: 'coreStyles_bold',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default bold\n\t * @memberof ButtonBold\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'bold';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonBold\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button  ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.bold}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-bold\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.bold}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"bold\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonKeystroke(ButtonStateClasses(ButtonStyle(ButtonBold)))\n);\n","import ButtonCameraImage from './button-camera-image.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonCamera class renders in two different ways:\n *\n * - Normal: Just a button that allows to switch to the edition mode.\n * - Exclusive: Renders ButtonCameraImage in order to take photo from the camera.\n *\n * @class ButtonCamera\n */\nclass ButtonCamera extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default camera\n\t * @memberof ButtonCamera\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'camera';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonCamera\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.renderExclusive) {\n\t\t\treturn <ButtonCameraImage {...this.props} />;\n\t\t} else {\n\t\t\tconst disabled = !(\n\t\t\t\tnavigator.getUserMedia ||\n\t\t\t\t(navigator.webkitGetUserMedia &&\n\t\t\t\t\tlocation.protocol === 'https') ||\n\t\t\t\tnavigator.mozGetUserMedia ||\n\t\t\t\tnavigator.msGetUserMedia\n\t\t\t);\n\n\t\t\tconst label = disabled\n\t\t\t\t? AlloyEditor.Strings.cameraDisabled\n\t\t\t\t: AlloyEditor.Strings.camera;\n\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\taria-label={label}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-image-camera\"\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tonClick={this.props.requestExclusive.bind(ButtonCamera.key)}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={label}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"camera\" />\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport default ButtonCamera;\n","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonCode class provides wraps a selection in `pre` element.\n *\n * @class ButtonCode\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonCode extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonCode\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tstyle: {\n\t\t\telement: 'pre',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default code\n\t * @memberof ButtonCode\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'code';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonCode\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.code}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-code\"\n\t\t\t\tonClick={this.applyStyle}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.code}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"code\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonActionStyle(ButtonStateClasses(ButtonStyle(ButtonCode)));\n","import ButtonProps from '../base/button-props.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n/**\n * The ButtonColor class provides functionality for changing text color in a document.\n *\n *\n * @class ButtonColor\n * @uses ButtonProps\n * @uses ButtonStateClasses\n */\nclass ButtonColor extends React.Component {\n\tstatic key = 'color';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\n\t\t/**\n\t\t * Indicates whether the styles list is expanded or not.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Boolean} expanded\n\t\t */\n\t\texpanded: PropTypes.bool,\n\n\t\t/**\n\t\t * The label that should be used for accessibility purposes.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {String} label\n\t\t */\n\t\tlabel: PropTypes.string,\n\n\t\t/**\n\t\t * Indicates whether the remove styles item should appear in the styles list.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Boolean} showRemoveStylesItem\n\t\t */\n\t\tshowRemoveStylesItem: PropTypes.bool,\n\n\t\t/**\n\t\t * List of the styles the button is able to handle.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Array} styles\n\t\t */\n\t\tstyles: PropTypes.arrayOf(PropTypes.object),\n\n\t\t/**\n\t\t * The tabIndex of the button in its toolbar current state. A value other than -1\n\t\t * means that the button has focus and is the active element.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Number} tabIndex\n\t\t */\n\t\ttabIndex: PropTypes.number,\n\n\t\t/**\n\t\t * Callback provided by the button host to notify when the styles list has been expanded.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonColor\n\t\t * @property {Function} toggleDropdown\n\t\t */\n\t\ttoggleDropdown: PropTypes.func,\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet activeColor = AlloyEditor.Strings.normal;\n\n\t\tlet activeColorClass = 'text-body';\n\n\t\tconst colors = this._getColors();\n\n\t\tcolors.some(item => {\n\t\t\tif (this._checkActive(item.style)) {\n\t\t\t\tactiveColor = item.name;\n\n\t\t\t\tactiveColorClass = item.style.attributes.class;\n\t\t\t}\n\t\t});\n\n\t\tconst {editor, expanded, tabIndex, toggleDropdown} = this.props;\n\n\t\tconst buttonStylesProps = {\n\t\t\tactiveStyle: activeColor,\n\t\t\teditor,\n\t\t\tonDismiss: toggleDropdown,\n\t\t\tshowRemoveStylesItem: false,\n\t\t\tstyles: colors,\n\t\t};\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={expanded}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={tabIndex}>\n\t\t\t\t\t<span className={activeColorClass}>\n\t\t\t\t\t\t<ButtonIcon editor={editor} symbol=\"text-editor\" />\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t{expanded && <ButtonStylesList {...buttonStylesProps} />}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t_applyStyle(className) {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst styleConfig = {\n\t\t\telement: 'span',\n\t\t\tattributes: {\n\t\t\t\tclass: className,\n\t\t\t},\n\t\t};\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\teditor.getSelection().lock();\n\n\t\tthis._getColors().forEach(item => {\n\t\t\tif (this._checkActive(item.style)) {\n\t\t\t\teditor.removeStyle(new CKEDITOR.style(item.style));\n\t\t\t}\n\t\t});\n\n\t\teditor.applyStyle(style);\n\n\t\teditor.getSelection().unlock();\n\n\t\teditor.fire('actionPerformed', this);\n\t}\n\n\t/**\n\t * Checks if the given color definition is applied to the current selection in the editor.\n\t *\n\t * @instance\n\t * @memberof ButtonColor\n\t * @method _checkActive\n\t * @param {Object} styleConfig Color definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n\t * @protected\n\t * @return {Boolean} Returns true if the color is applied to the selection, false otherwise.\n\t */\n\t_checkActive(styleConfig) {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\t// Styles with wildcard element (*) won't be considered active by CKEditor. Defaulting\n\t\t// to a 'span' element works for most of those cases with no defined element.\n\t\tstyleConfig = CKEDITOR.tools.merge({element: 'span'}, styleConfig);\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\treturn style.checkActive(nativeEditor.elementPath(), nativeEditor);\n\t}\n\n\t/**\n\t * Returns an array of colors. Each color consists of two properties:\n\t * - name - The style name, for example \"default\".\n\t * - style - An object with one property, called `element` which value\n\t *          represents the style which have to be applied to the element.\n\t * - styleFn - The function that is invoked to apply the style to the element.\n\t *\n\t * @instance\n\t * @memberof ButtonColor\n\t * @method _getColor\n\t * @protected\n\t * @return {Array<object>} An array of objects containing the colors.\n\t */\n\t_getColors() {\n\t\treturn (\n\t\t\tthis.props.styles || [\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.normal,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-body',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, ''),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.primary,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-primary',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-primary'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.disabled,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-secondary',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-secondary'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.success,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-success',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-success'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.danger,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-danger',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-danger'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.warning,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-warning',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-warning'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.info,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'span',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'text-info',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'text-info'),\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonProps(ButtonStateClasses(ButtonColor));\n","import ButtonEmbedEdit from './button-embed-edit.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport React from 'react';\n\n/**\n * The ButtonEmbed class provides functionality for creating and editing an embed link in a document.\n * ButtonEmbed renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonEmbedEdit UI with all the link edition controls.\n *\n * @class ButtonEmbed\n * @uses ButtonKeystroke\n */\nclass ButtonEmbed extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbed\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tkeystroke: {\n\t\t\tfn: '_requestExclusive',\n\t\t\tkeys: CKEDITOR.CTRL + CKEDITOR.SHIFT + 76 /* L*/,\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default embed\n\t * @memberof ButtonEmbed\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'embed';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbed\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.renderExclusive) {\n\t\t\treturn <ButtonEmbedEdit {...this.props} />;\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.link}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-embed\"\n\t\t\t\t\tonClick={this._requestExclusive}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.link}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"plus\" />\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Requests the link button to be rendered in exclusive mode to allow the embedding of a link.\n\t *\n\t * @instance\n\t * @memberof ButtonEmbed\n\t * @method _requestExclusive\n\t * @protected\n\t */\n\t_requestExclusive = () => {\n\t\tthis.props.requestExclusive(ButtonEmbed.key);\n\t};\n}\n\nexport default ButtonKeystroke(ButtonEmbed);\n","import ButtonEmbedVideoEdit from './button-embed-video-edit.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonProps from '../base/button-props.js';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * The ButtonEmbedVideo class provides functionality for changing text color in a document.\n *\n * @class ButtonEmbedVideo\n * @uses ButtonProps\n */\nclass ButtonEmbedVideo extends React.Component {\n\tstatic key = 'embedVideo';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonEmbedVideo\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\n\t\t/**\n\t\t * The label that should be used for accessibility purposes.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonEmbedVideo\n\t\t * @property {String} label\n\t\t */\n\t\tlabel: PropTypes.string,\n\n\t\t/**\n\t\t * The tabIndex of the button in its toolbar current state. A value other than -1\n\t\t * means that the button has focus and is the active element.\n\t\t *\n\t\t * @instance\n\t\t * @memberof ButtonEmbedVideo\n\t\t * @property {Number} tabIndex\n\t\t */\n\t\ttabIndex: PropTypes.number,\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.renderExclusive) {\n\t\t\treturn <ButtonEmbedVideoEdit {...this.props} />;\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-embed-video\"\n\t\t\t\t\tonClick={this.props.requestExclusive}\n\t\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"video\" />\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport default ButtonProps(ButtonEmbedVideo);\n","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonH1 class provides wraps a selection in `h1` element.\n *\n * @class ButtonH1\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH1 extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonH1\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tstyle: {\n\t\t\telement: 'h1',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default h1\n\t * @memberof ButtonH1\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'h1';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonH1\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.h1}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-h1\"\n\t\t\t\tonClick={this.applyStyle}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.h1}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"h1\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonActionStyle(ButtonStateClasses(ButtonStyle(ButtonH1)));\n","import ButtonActionStyle from '../base/button-action-style.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonH2 class provides wraps a selection in `h2` element.\n *\n * @class ButtonH2\n * @uses ButtonActionStyle\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonH2 extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonH2\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tstyle: {\n\t\t\telement: 'h2',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default h2\n\t * @memberof ButtonH2\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'h2';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonH2\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.h2}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-h2\"\n\t\t\t\tonClick={this.applyStyle}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.h2}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"h2\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonActionStyle(ButtonStateClasses(ButtonStyle(ButtonH2)));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonStyle from '../base/button-style.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonHline class provides inserts horizontal line.\n *\n * @class ButtonHline\n * @uses ButtonCommand\n * @uses ButtonStyle\n */\nclass ButtonHline extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonHline\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'horizontalrule',\n\t\tstyle: {\n\t\t\telement: 'hr',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default hline\n\t * @memberof ButtonHline\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'hline';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonHline\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.horizontalrule}\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-hline\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.horizontalrule}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"hr\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(ButtonStyle(ButtonHline));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignCenter class provides functionality for aligning an image in the center.\n *\n * @class ButtonImageAlignCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignCenter extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignCenter\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifycenter',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default imageCenter\n\t * @memberof ButtonImageAlignCenter\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'imageCenter';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignCenter\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignCenter}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-image-align-center\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignCenter}>\n\t\t\t\t<ButtonIcon\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tsymbol=\"align-image-center\"\n\t\t\t\t/>\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonImageAlignCenter))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignLeft class provides functionality for aligning an image on left.\n *\n * @class ButtonImageAlignLeft\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignLeft extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignLeft\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifyleft',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default imageLeft\n\t * @memberof ButtonImageAlignLeft\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'imageLeft';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignLeft\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignLeft}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-image-align-left\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignLeft}>\n\t\t\t\t<ButtonIcon\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tsymbol=\"align-image-left\"\n\t\t\t\t/>\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonImageAlignLeft))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonImageAlignRight class provides functionality for aligning an image on right.\n *\n * @class ButtonImageAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonImageAlignRight extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignRight\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifyright',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default imageRight\n\t * @memberof ButtonImageAlignRight\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'imageRight';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonImageAlignRight\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignRight}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-image-align-right\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignRight}>\n\t\t\t\t<ButtonIcon\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tsymbol=\"align-image-right\"\n\t\t\t\t/>\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonImageAlignRight))\n);\n","import ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonImage class inserts an image to the content.\n *\n * @class ButtonImage\n */\nclass ButtonImage extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default image\n\t * @memberof ButtonImage\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'image';\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.fileInput = React.createRef();\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonImage\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst inputSyle = {display: 'none'};\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.image}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-image\"\n\t\t\t\t\tonClick={this.handleClick}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.image}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tsymbol=\"document-image\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\n\t\t\t\t<input\n\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\tonChange={this._onInputChange}\n\t\t\t\t\tref={this.fileInput}\n\t\t\t\t\tstyle={inputSyle}\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Simulates click on the input element. This will open browser's native file open dialog.\n\t *\n\t * @instance\n\t * @memberof ButtonImage\n\t * @method handleClick\n\t * @param {SyntheticEvent} event The received click event on the button.\n\t */\n\thandleClick = () => {\n\t\tthis.fileInput.current.click();\n\t};\n\n\t/**\n\t * On input change, reads the chosen file and fires an event `beforeImageAdd` with the image which will be added\n\t * to the content. The image file will be passed in the `imageFiles` property.\n\t * If any of the listeners returns `false` or cancels the event, the image won't be added to the content.\n\t * Otherwise, an event `imageAdd` will be fired with the inserted element into the editable area.\n\t * The passed params will be:\n\t * - `el` - the created img element\n\t * - `file` - the original image file from the input element\n\t *\n\t * @fires ButtonImage#beforeImageAdd\n\t * @fires ButtonImage#imageAdd\n\t * @instance\n\t * @memberof ButtonImage\n\t * @method _onInputChange\n\t * @protected\n\t */\n\t_onInputChange() {\n\t\tconst inputEl = this.fileInput.current;\n\n\t\t// On IE11 the function might be called with an empty array of\n\t\t// files. In such a case, no actions will be taken.\n\t\tif (!inputEl.files.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst reader = new FileReader();\n\t\tconst file = inputEl.files[0];\n\n\t\treader.onload = event => {\n\t\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\t\tconst result = editor.fire('beforeImageAdd', {\n\t\t\t\timageFiles: file,\n\t\t\t});\n\n\t\t\tif (result) {\n\t\t\t\tconst el = CKEDITOR.dom.element.createFromHtml(\n\t\t\t\t\t`<img src=\"${event.target.result}\">`\n\t\t\t\t);\n\n\t\t\t\teditor.insertElement(el);\n\n\t\t\t\teditor.fire('actionPerformed', this);\n\n\t\t\t\tconst imageData = {\n\t\t\t\t\tel: el,\n\t\t\t\t\tfile: file,\n\t\t\t\t};\n\n\t\t\t\teditor.fire('imageAdd', imageData);\n\t\t\t}\n\t\t};\n\n\t\treader.readAsDataURL(file);\n\n\t\tinputEl.value = '';\n\t}\n}\n\nexport default ButtonImage;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonIndentBlock class provides functionality for indenting the selected blocks.\n *\n * @class ButtonIndentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonIndentBlock extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonIndentBlock\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'indent',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default indentBlock\n\t * @memberof ButtonIndentBlock\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'indentBlock';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonIndentBlock\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.indent}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-indent-block\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.indent}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"indent-less\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonIndentBlock))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonItalic class provides functionality for styling an selection with italic (em) style.\n *\n * @class ButtonItalic\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonItalic extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonItalic\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'italic',\n\t\tkeystroke: {\n\t\t\tfn: 'execCommand',\n\t\t\tkeys: CKEDITOR.CTRL + 73 /* I*/,\n\t\t},\n\t\tstyle: 'coreStyles_italic',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default italic\n\t * @memberof ButtonItalic\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'italic';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonItalic\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.italic}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-italic\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.italic}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"italic\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonKeystroke(ButtonStateClasses(ButtonStyle(ButtonItalic)))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * @class ButtonItemSelectorAudio\n * @uses ButtonCommand\n */\nclass ButtonItemSelectorAudio extends React.Component {\n\tstatic defaultProps = {\n\t\tcommand: 'audioselector',\n\t};\n\n\tstatic key = 'audio';\n\n\tstatic propTypes = {\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-audio\"\n\t\t\t\tonClick={this._handleClick}\n\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"audio\" />\n\t\t\t</button>\n\t\t);\n\t}\n\n\t_handleClick = () => {\n\t\tthis.execCommand(null);\n\t};\n}\n\nexport default ButtonCommand(ButtonItemSelectorAudio);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * @class ButtonItemSelectorImage\n * @uses ButtonCommand\n */\nclass ButtonItemSelectorImage extends React.Component {\n\tstatic defaultProps = {\n\t\tcommand: 'imageselector',\n\t};\n\n\tstatic key = 'image';\n\n\tstatic propTypes = {\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-image\"\n\t\t\t\tonClick={this._handleClick}\n\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"picture\" />\n\t\t\t</button>\n\t\t);\n\t}\n\n\t_handleClick = () => {\n\t\tthis.execCommand(null);\n\t};\n}\n\nexport default ButtonCommand(ButtonItemSelectorImage);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * @class ButtonItemSelectorVideo\n * @uses ButtonCommand\n */\nclass ButtonItemSelectorVideo extends React.Component {\n\tstatic defaultProps = {\n\t\tcommand: 'videoselector',\n\t};\n\n\tstatic key = 'video';\n\n\tstatic propTypes = {\n\t\teditor: PropTypes.object.isRequired,\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-video\"\n\t\t\t\tonClick={this._handleClick}\n\t\t\t\ttabIndex={this.props.tabIndex}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"video\" />\n\t\t\t</button>\n\t\t);\n\t}\n\n\t_handleClick = () => {\n\t\tthis.execCommand(null);\n\t};\n}\n\nexport default ButtonCommand(ButtonItemSelectorVideo);\n","import ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonLink from './button-link.jsx';\nimport ButtonLinkEditBrowse from './button-link-edit-browse.jsx';\nimport ButtonProps from '../base/button-props.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * The ButtonLinkBrowse class provides functionality for changing text color in a document.\n *\n * @uses ButtonKeystroke\n * @uses ButtonProps\n * @uses ButtonStateClasses\n *\n * @class ButtonLinkBrowse\n */\nclass ButtonLinkBrowse extends React.Component {\n\tstatic defaultProps = {\n\t\tkeystroke: {\n\t\t\tfn: '_requestExclusive',\n\t\t\tkeys: CKEDITOR.CTRL + 76 /* L*/,\n\t\t},\n\t};\n\n\tstatic key = 'linkBrowse';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\n\t\t/**\n\t\t * The label that should be used for accessibility purposes.\n\t\t *\n\t\t * @property {String} label\n\t\t */\n\t\tlabel: PropTypes.string,\n\n\t\t/**\n\t\t * The tabIndex of the button in its toolbar current state. A value other than -1\n\t\t * means that the button has focus and is the active element.\n\t\t *\n\t\t * @property {Number} tabIndex\n\t\t */\n\t\ttabIndex: PropTypes.number,\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.renderExclusive) {\n\t\t\tthis.props = this.mergeButtonCfgProps();\n\n\t\t\treturn <ButtonLinkEditBrowse {...this.props} />;\n\t\t} else {\n\t\t\treturn <ButtonLink {...this.props} />;\n\t\t}\n\t}\n\n\t/**\n\t * Requests the link button to be rendered in exclusive mode to allow the creation of a link.\n\t *\n\t * @protected\n\t * @method _requestExclusive\n\t */\n\t_requestExclusive() {\n\t\tthis.props.requestExclusive(ButtonLinkBrowse.key);\n\t}\n}\n\nexport default ButtonProps(\n\tButtonStateClasses(ButtonKeystroke(ButtonLinkBrowse))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonOrderedList class provides functionality for creating ordered lists in an editor.\n *\n * @class ButtonOrderedList\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonOrderedList extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonOrderedList\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'numberedlist',\n\t\tstyle: {\n\t\t\telement: 'ol',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default ol\n\t * @memberof ButtonOrderedList\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'ol';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonOrderedList\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.numberedlist}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-ol\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.numberedlist}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"list-ol\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonStateClasses(ButtonStyle(ButtonOrderedList))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonOutdentBlock class provides functionality for outdenting blocks.\n *\n * @class ButtonOutdentBlock\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonOutdentBlock extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonOutdentBlock\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'outdent',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default indentBlock\n\t * @memberof ButtonOutdentBlock\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'outdentBlock';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonOutdentBlock\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.outdent}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-outdent-block\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.outdent}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"indent-more\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonOutdentBlock))\n);\n","import ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonParagraphAlign class provides functionality to work with table rows.\n *\n * @class ButtonParagraphAlign\n */\nclass ButtonParagraphAlign extends React.Component {\n\tstatic key = 'paragraphAlign';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlign\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet buttonCommandsList;\n\t\tlet buttonCommandsListId;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonCommandsListId = ButtonParagraphAlign.key + 'List';\n\t\t\tbuttonCommandsList = (\n\t\t\t\t<ButtonCommandsList\n\t\t\t\t\tcommands={this._getCommands()}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tlistId={buttonCommandsListId}\n\t\t\t\t\tinlineIcons={false}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst activeCommand = this._getCommands()\n\t\t\t.filter(alignment => {\n\t\t\t\tconst command = editor.getCommand(alignment.command);\n\n\t\t\t\treturn command ? command.state === CKEDITOR.TRISTATE_ON : false;\n\t\t\t})\n\t\t\t.pop();\n\n\t\tconst iconClassName = activeCommand.icon;\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-dropdown ae-container-dropdown-xsmall ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={activeCommand.label}\n\t\t\t\t\taria-owns={buttonCommandsListId}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.row}>\n\t\t\t\t\t<div className=\"ae-container\">\n\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\tsymbol={iconClassName}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\tsymbol=\"caret-bottom\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t\t{buttonCommandsList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of commands. If a list of commands was passed\n\t * as property `commands`, it will take a precedence over the default ones.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlign\n\t * @method _getCommands\n\t * @protected\n\t * @return {Array} The list of available commands.\n\t */\n\t_getCommands() {\n\t\treturn (\n\t\t\tthis.props.commands || [\n\t\t\t\t{\n\t\t\t\t\tcommand: 'justifyleft',\n\t\t\t\t\ticon: 'align-left',\n\t\t\t\t\tlabel: AlloyEditor.Strings.alignLeft,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'justifycenter',\n\t\t\t\t\ticon: 'align-center',\n\t\t\t\t\tlabel: AlloyEditor.Strings.alignCenter,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'justifyright',\n\t\t\t\t\ticon: 'align-right',\n\t\t\t\t\tlabel: AlloyEditor.Strings.alignRight,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'justifyblock',\n\t\t\t\t\ticon: 'align-justify',\n\t\t\t\t\tlabel: AlloyEditor.Strings.alignJustify,\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonParagraphAlign;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphAlignLeft class provides functionality for aligning a paragraph on left.\n *\n * @class ButtonParagraphAlignLeft\n *\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignLeft extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlignLeft\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifyleft',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default paragraphLeft\n\t * @memberof ButtonParagraphAlignLeft\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'paragraphLeft';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlignLeft\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignLeft}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-paragraph-align-left\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignLeft}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"align-left\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonParagraphAlignLeft))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphAlignRight class provides functionality for aligning a paragraph on right.\n *\n * @class ButtonParagraphAlignRight\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphAlignRight extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlignRight\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifyright',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default paragraphRight\n\t * @memberof ButtonParagraphAlignRight\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'paragraphRight';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphAlignRight\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignRight}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-paragraph-align-right\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignRight}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"align-right\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonParagraphAlignRight))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphCenter class provides functionality for centering a paragraph.\n *\n * @class ButtonParagraphCenter\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphCenter extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphCenter\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifycenter',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default paragraphCenter\n\t * @memberof ButtonParagraphCenter\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'paragraphCenter';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphCenter\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignCenter}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-paragraph-center\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignCenter}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"align-center\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonParagraphCenter))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonCommandActive from '../base/button-command-active.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\n/**\n * The ButtonParagraphJustify class provides functionality for justfying a paragraph.\n *\n * @class ButtonParagraphJustify\n * @uses ButtonCommand\n * @uses ButtonCommandActive\n * @uses ButtonStateClasses\n */\nclass ButtonParagraphJustify extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphJustify\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'justifyblock',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default paragraphJustify\n\t * @memberof ButtonParagraphJustify\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'paragraphJustify';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonParagraphJustify\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.alignJustify}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-paragraph-justify\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.alignJustify}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"align-justify\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonCommandActive(ButtonStateClasses(ButtonParagraphJustify))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonQuote class wraps a selection in `blockquote` element.\n *\n * @class ButtonQuote\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonQuote extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonQuote\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'blockquote',\n\t\tstyle: {\n\t\t\telement: 'blockquote',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default quote\n\t * @memberof ButtonQuote\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'quote';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonQuote\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.quote}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-quote\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.quote}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"quote-right\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(ButtonStateClasses(ButtonStyle(ButtonQuote)));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonRemoveFormat class removes style formatting.\n *\n * @class ButtonRemoveFormat\n * @uses ButtonCommand\n */\nclass ButtonRemoveFormat extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonRemoveFormat\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'removeFormat',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default removeFormat\n\t * @memberof ButtonRemoveFormat\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'removeFormat';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonRemoveFormat\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.removeformat}\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-removeformat\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.removeformat}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"remove-style\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(ButtonRemoveFormat);\n","import React from 'react';\n\n/**\n * The ButtonSeparator function renders a simple separator.\n */\nfunction ButtonSeparator(_props) {\n\treturn <span className=\"ae-separator\" />;\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default separator\n * @memberof ButtonSeparator\n * @property {String} key\n * @static\n */\nButtonSeparator.key = 'separator';\n\nexport default ButtonSeparator;\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonProps from '../base/button-props.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\n/**\n * The ButtonSpacing class provides functionality for changing text color in a document.\n *\n * @uses ButtonProps\n * @uses ButtonStateClasses\n *\n * @class ButtonSpacing\n */\nclass ButtonSpacing extends React.Component {\n\tstatic key = 'spacing';\n\n\tstatic propTypes = {\n\t\t/**\n\t\t * The editor instance where the component is being used.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Object} editor\n\t\t */\n\t\teditor: PropTypes.object.isRequired,\n\n\t\t/**\n\t\t * Indicates whether the styles list is expanded or not.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Boolean} expanded\n\t\t */\n\t\texpanded: PropTypes.bool,\n\n\t\t/**\n\t\t * The label that should be used for accessibility purposes.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {String} label\n\t\t */\n\t\tlabel: PropTypes.string,\n\n\t\t/**\n\t\t * Indicates whether the remove styles item should appear in the styles list.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Boolean} showRemoveStylesItem\n\t\t */\n\t\tshowRemoveStylesItem: PropTypes.bool,\n\n\t\t/**\n\t\t * List of the styles the button is able to handle.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Array} styles\n\t\t */\n\t\tstyles: PropTypes.arrayOf(PropTypes.object),\n\n\t\t/**\n\t\t * The tabIndex of the button in its toolbar current state. A value other than -1\n\t\t * means that the button has focus and is the active element.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Number} tabIndex\n\t\t */\n\t\ttabIndex: PropTypes.number,\n\n\t\t/**\n\t\t * Callback provided by the button host to notify when the styles list has been expanded.\n\t\t *\n\t\t * @instance\n\t\t * @memberof Spacing\n\t\t * @property {Function} toggleDropdown\n\t\t */\n\t\ttoggleDropdown: PropTypes.func,\n\t};\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet activeSpacing = '1.0x';\n\n\t\tconst spacings = this._getSpacings();\n\n\t\tspacings.forEach(item => {\n\t\t\tif (this._checkActive(item.style)) {\n\t\t\t\tactiveSpacing = item.name;\n\t\t\t}\n\t\t});\n\n\t\tconst {editor, expanded, tabIndex, toggleDropdown} = this.props;\n\n\t\tconst buttonStylesProps = {\n\t\t\tactiveStyle: activeSpacing,\n\t\t\teditor: editor,\n\t\t\tonDismiss: toggleDropdown,\n\t\t\tshowRemoveStylesItem: false,\n\t\t\tstyles: spacings,\n\t\t};\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-container-dropdown-small ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={expanded}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={tabIndex}>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<ButtonIcon editor={editor} symbol=\"separator\" />\n\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t{activeSpacing}\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t{expanded && <ButtonStylesList {...buttonStylesProps} />}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t_applyStyle(className) {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst styleConfig = {\n\t\t\telement: 'div',\n\t\t\tattributes: {\n\t\t\t\tclass: className,\n\t\t\t},\n\t\t};\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\teditor.getSelection().lock();\n\n\t\tthis._getSpacings().forEach(item => {\n\t\t\tif (this._checkActive(item.style)) {\n\t\t\t\teditor.removeStyle(new CKEDITOR.style(item.style));\n\t\t\t}\n\t\t});\n\n\t\teditor.applyStyle(style);\n\n\t\teditor.getSelection().unlock();\n\n\t\teditor.fire('actionPerformed', this);\n\t}\n\n\t/**\n\t * Checks if the given spacing definition is applied to the current selection in the editor.\n\t *\n\t * @instance\n\t * @memberof Spacing\n\t * @method _checkActive\n\t * @param {Object} styleConfig Spacing definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n\t * @protected\n\t * @return {Boolean} Returns true if the spacing is applied to the selection, false otherwise.\n\t */\n\t_checkActive(styleConfig) {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\tlet active = true;\n\n\t\tconst elementPath = nativeEditor.elementPath();\n\n\t\tif (elementPath && elementPath.lastElement) {\n\t\t\tstyleConfig.attributes.class\n\t\t\t\t.split(' ')\n\t\t\t\t.forEach(function(className) {\n\t\t\t\t\tactive =\n\t\t\t\t\t\tactive && elementPath.lastElement.hasClass(className);\n\t\t\t\t});\n\t\t} else {\n\t\t\tactive = false;\n\t\t}\n\n\t\treturn active;\n\t}\n\n\t/**\n\t * Returns an array of spacings. Each spacing consists from three properties:\n\t * - name - the style name, for example \"default\"\n\t * - style - an object with one property, called `element` which value\n\t * represents the style which have to be applied to the element.\n\t * - styleFn - a function which applies selected style to the editor selection\n\t *\n\t * @instance\n\t * @memberof Spacing\n\t * @method _getSpacings\n\t * @protected\n\t * @return {Array<object>} An array of objects containing the spacings.\n\t */\n\t_getSpacings() {\n\t\treturn (\n\t\t\tthis.props.styles || [\n\t\t\t\t{\n\t\t\t\t\tname: '1.0x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, ''),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '1.5x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'mt-1 mb-1',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'mt-1 mb-1'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '2.0x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'mt-2 mb-2',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'mt-2 mb-2'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '3.0x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'mt-3 mb-3',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'mt-3 mb-3'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '4.0x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'mt-4 mb-4',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'mt-4 mb-4'),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: '5.0x',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'div',\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\tclass: 'mt-5 mb-5',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 1,\n\t\t\t\t\t},\n\t\t\t\t\tstyleFn: this._applyStyle.bind(this, 'mt-5 mb-5'),\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonProps(ButtonStateClasses(ButtonSpacing));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonStrike class styles a selection with strike style.\n *\n * @class ButtonStrike\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonStrike extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonStrike\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'strike',\n\t\tstyle: 'coreStyles_strike',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default strike\n\t * @memberof ButtonStrike\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'strike';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t * @instance\n\t * @memberof ButtonStrike\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.strike}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-strike\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.strike}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"strikethrough\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(ButtonStateClasses(ButtonStyle(ButtonStrike)));\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonStylesList from './button-styles-list.jsx';\nimport React from 'react';\n\n/**\n * The ButtonStyles class provides functionality for styling a selection with a list of\n * configurable and customizable styles. The allowed styles follow CKEDITOR.Style configuration\n * (http://docs.ckeditor.com/#!/api/CKEDITOR.style)\n *\n * @class ButtonStyles\n */\nclass ButtonStyles extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default styles\n\t * @memberof ButtonStyles\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'styles';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonStyles\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet activeStyle = AlloyEditor.Strings.normal;\n\n\t\tconst styles = this._getStyles();\n\n\t\tstyles.forEach(item => {\n\t\t\tif (this._checkActive(item.style)) {\n\t\t\t\tactiveStyle = item.name;\n\t\t\t}\n\t\t});\n\n\t\tlet buttonStylesList;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonStylesList = (\n\t\t\t\t<ButtonStylesList\n\t\t\t\t\tactiveStyle={activeStyle}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t\tshowRemoveStylesItem={this.props.showRemoveStylesItem}\n\t\t\t\t\tstyles={styles}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-dropdown ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={AlloyEditor.Strings.styles + ' ' + activeStyle}\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.styles + ' ' + activeStyle}>\n\t\t\t\t\t<div className=\"ae-container\">\n\t\t\t\t\t\t<span className=\"ae-container-dropdown-selected-item\">\n\t\t\t\t\t\t\t{activeStyle}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\tsymbol=\"caret-bottom\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t\t{buttonStylesList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Checks if the given style definition is applied to the current selection in the editor.\n\t *\n\t * @instance\n\t * @memberof ButtonStyles\n\t * @method _checkActive\n\t * @param {Object} styleConfig Style definition as per http://docs.ckeditor.com/#!/api/CKEDITOR.style.\n\t * @protected\n\t * @return {Boolean} Returns true if the style is applied to the selection, false otherwise.\n\t */\n\t_checkActive(styleConfig) {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\t// Styles with wildcard element (*) won't be considered active by CKEditor. Defaulting\n\t\t// to a 'span' element works for most of those cases with no defined element.\n\t\tstyleConfig = CKEDITOR.tools.merge({element: 'span'}, styleConfig);\n\n\t\tconst style = new CKEDITOR.style(styleConfig);\n\n\t\treturn style.checkActive(nativeEditor.elementPath(), nativeEditor);\n\t}\n\n\t/**\n\t * Returns an array of styles. Each style consists from two properties:\n\t * - name - the style name, for example \"h1\"\n\t * - style - an object with one property, called `element` which value\n\t * represents the style which have to be applied to the element.\n\t *\n\t * @instance\n\t * @memberof ButtonStyles\n\t * @method _getStyles\n\t * @protected\n\t * @return {Array<object>} An array of objects containing the styles.\n\t */\n\t_getStyles() {\n\t\treturn (\n\t\t\tthis.props.styles || [\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.h1,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'h1',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.h2,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'h2',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.formatted,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'pre',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.cite,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'cite',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: AlloyEditor.Strings.code,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\telement: 'code',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonStyles;\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSubscript class provides functionality for applying subscript style to a text selection.\n *\n * @class ButtonSubscript\n *\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSubscript extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonSubscript\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'subscript',\n\t\tstyle: 'coreStyles_subscript',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default subscript\n\t * @memberof ButtonSubscript\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'subscript';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonSubscript\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.subscript}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-subscript\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.subscript}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"subscript\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(ButtonStateClasses(ButtonStyle(ButtonSubscript)));\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonSuperscript class provides functionality for applying superscript style to a text selection.\n *\n * @class ButtonSuperscript\n *\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonSuperscript extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonSuperscript\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'superscript',\n\t\tstyle: 'coreStyles_superscript',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default superscript\n\t * @memberof ButtonSuperscript\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'superscript';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonSuperscript\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.superscript}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-superscript\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.superscript}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"superscript\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonStateClasses(ButtonStyle(ButtonSuperscript))\n);\n","import ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableCell class provides functionality to work with table cells.\n *\n * @class ButtonTableCell\n */\nclass ButtonTableCell extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableCell\n\t * @memberof ButtonTableCell\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableCell';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableCell\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet buttonCommandsList;\n\t\tlet buttonCommandsListId;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonCommandsListId = ButtonTableCell.key + 'List';\n\t\t\tbuttonCommandsList = (\n\t\t\t\t<ButtonCommandsList\n\t\t\t\t\tcommands={this._getCommands()}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tlistId={buttonCommandsListId}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={AlloyEditor.Strings.cell}\n\t\t\t\t\taria-owns={buttonCommandsListId}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.cell}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"add-cell\" />\n\t\t\t\t</button>\n\t\t\t\t{buttonCommandsList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of commands. If a list of commands was passed\n\t * as property `commands`, it will take a precedence over the default ones.\n\t *\n\t * @instance\n\t * @memberof ButtonTableCell\n\t * @method _getCommands\n\t * @protected\n\t * @return {Array} The list of available commands.\n\t */\n\t_getCommands() {\n\t\treturn (\n\t\t\tthis.props.commands || [\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellInsertBefore',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellInsertBefore,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellInsertAfter',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellInsertAfter,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellDelete',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellDelete,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellMerge',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellMerge,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellMergeDown',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellMergeDown,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellMergeRight',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellMergeRight,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellHorizontalSplit',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellSplitHorizontal,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'cellVerticalSplit',\n\t\t\t\t\tlabel: AlloyEditor.Strings.cellSplitVertical,\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonTableCell;\n","import ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableColumn class provides functionality to work with table columns.\n *\n * @class ButtonTableColumn\n */\nclass ButtonTableColumn extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableColumn\n\t * @memberof ButtonTableColumn\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableColumn';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableColumn\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet buttonCommandsList;\n\t\tlet buttonCommandsListId;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonCommandsListId = ButtonTableColumn.key + 'List';\n\t\t\tbuttonCommandsList = (\n\t\t\t\t<ButtonCommandsList\n\t\t\t\t\tcommands={this._getCommands()}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tlistId={buttonCommandsListId}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={AlloyEditor.Strings.column}\n\t\t\t\t\taria-owns={buttonCommandsListId}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"listbox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.column}>\n\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\tsymbol=\"add-column\"\n\t\t\t\t\t/>\n\t\t\t\t</button>\n\t\t\t\t{buttonCommandsList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of commands. If a list of commands was passed\n\t * as property `commands`, it will take a precedence over the default ones.\n\t *\n\t * @instance\n\t * @memberof ButtonTableColumn\n\t * @method _getCommands\n\t * @protected\n\t * @return {Array} The list of available commands.\n\t */\n\t_getCommands() {\n\t\treturn (\n\t\t\tthis.props.commands || [\n\t\t\t\t{\n\t\t\t\t\tcommand: 'columnInsertBefore',\n\t\t\t\t\tlabel: AlloyEditor.Strings.columnInsertBefore,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'columnInsertAfter',\n\t\t\t\t\tlabel: AlloyEditor.Strings.columnInsertAfter,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'columnDelete',\n\t\t\t\t\tlabel: AlloyEditor.Strings.columnDelete,\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonTableColumn;\n","import ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableHeading class provides functionality to work with table heading.\n *\n * @class ButtonTableHeading\n */\nclass ButtonTableHeading extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableRow\n\t * @memberof ButtonTableHeading\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableHeading';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableHeading\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet buttonCommandsList;\n\t\tlet buttonCommandsListId;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonCommandsListId = ButtonTableHeading.key + 'List';\n\t\t\tbuttonCommandsList = (\n\t\t\t\t<ButtonCommandsList\n\t\t\t\t\tcommands={this._getCommands()}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tlistId={buttonCommandsListId}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tconst activeHeading = new CKEDITOR.Table(\n\t\t\tthis.props.editor.get('nativeEditor')\n\t\t).getHeading();\n\t\tconst activeHeadingIntro = AlloyEditor.Strings.headers + ':';\n\t\tconst activeHeadingLabel =\n\t\t\tAlloyEditor.Strings['headers' + activeHeading];\n\n\t\treturn (\n\t\t\t<div className=\"ae-container-dropdown-xl ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label=\"\"\n\t\t\t\t\tclassName=\"ae-toolbar-element\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle=\"\">\n\t\t\t\t\t<div className=\"ae-container\">\n\t\t\t\t\t\t<span className=\"ae-container-dropdown-selected-item\">\n\t\t\t\t\t\t\t{activeHeadingIntro}{' '}\n\t\t\t\t\t\t\t<strong>{activeHeadingLabel}</strong>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ButtonIcon\n\t\t\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\t\t\tsymbol=\"caret-bottom\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t\t{buttonCommandsList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of commands. If a list of commands was passed\n\t * as property `commands`, it will take a precedence over the default ones.\n\t *\n\t * @instance\n\t * @memberof ButtonTableHeading\n\t * @method _getCommands\n\t * @protected\n\t * @return {Array} The list of available commands.\n\t */\n\t_getCommands() {\n\t\treturn (\n\t\t\tthis.props.commands || [\n\t\t\t\t{\n\t\t\t\t\tcommand: 'tableHeadingNone',\n\t\t\t\t\tlabel: AlloyEditor.Strings.headersNone,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'tableHeadingRow',\n\t\t\t\t\tlabel: AlloyEditor.Strings.headersRow,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'tableHeadingColumn',\n\t\t\t\t\tlabel: AlloyEditor.Strings.headersColumn,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'tableHeadingBoth',\n\t\t\t\t\tlabel: AlloyEditor.Strings.headersBoth,\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonTableHeading;\n","import ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableRemove class provides functionality for removing a table\n *\n * @class ButtonTableRemove\n */\nclass ButtonTableRemove extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableRemove\n\t * @memberof ButtonTableRemove\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableRemove';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableRemove\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.deleteTable}\n\t\t\t\tclassName=\"ae-button\"\n\t\t\t\tdata-type=\"button-table-remove\"\n\t\t\t\tonClick={this._removeTable}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.deleteTable}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"trash\" />\n\t\t\t</button>\n\t\t);\n\t}\n\n\t/**\n\t * Removes the table in the editor element.\n\t *\n\t * @instance\n\t * @memberof ButtonTableRemove\n\t * @method _removeTable\n\t * @protected\n\t */\n\t_removeTable = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\t\tconst tableUtils = new CKEDITOR.Table(editor);\n\n\t\ttableUtils.remove();\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n}\n\nexport default ButtonTableRemove;\n","import ButtonCommandsList from './button-commands-list.jsx';\nimport ButtonIcon from './button-icon.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTableRow class provides functionality to work with table rows.\n *\n * @class ButtonTableRow\n */\nclass ButtonTableRow extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default tableRow\n\t * @memberof ButtonTableRow\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'tableRow';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTableRow\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet buttonCommandsList;\n\t\tlet buttonCommandsListId;\n\n\t\tif (this.props.expanded) {\n\t\t\tbuttonCommandsListId = ButtonTableRow.key + 'List';\n\t\t\tbuttonCommandsList = (\n\t\t\t\t<ButtonCommandsList\n\t\t\t\t\tcommands={this._getCommands()}\n\t\t\t\t\teditor={this.props.editor}\n\t\t\t\t\tlistId={buttonCommandsListId}\n\t\t\t\t\tonDismiss={this.props.toggleDropdown}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"ae-container ae-has-dropdown\">\n\t\t\t\t<button\n\t\t\t\t\taria-expanded={this.props.expanded}\n\t\t\t\t\taria-label={AlloyEditor.Strings.row}\n\t\t\t\t\taria-owns={buttonCommandsListId}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tonClick={this.props.toggleDropdown}\n\t\t\t\t\trole=\"combobox\"\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.row}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"add-row\" />\n\t\t\t\t</button>\n\t\t\t\t{buttonCommandsList}\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of commands. If a list of commands was passed\n\t * as property `commands`, it will take a precedence over the default ones.\n\t *\n\t * @instance\n\t * @memberof ButtonTableRow\n\t * @method _getCommands\n\t * @protected\n\t * @return {Array} The list of available commands.\n\t */\n\t_getCommands() {\n\t\treturn (\n\t\t\tthis.props.commands || [\n\t\t\t\t{\n\t\t\t\t\tcommand: 'rowInsertBefore',\n\t\t\t\t\tlabel: AlloyEditor.Strings.rowInsertBefore,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'rowInsertAfter',\n\t\t\t\t\tlabel: AlloyEditor.Strings.rowInsertAfter,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcommand: 'rowDelete',\n\t\t\t\t\tlabel: AlloyEditor.Strings.rowDelete,\n\t\t\t\t},\n\t\t\t]\n\t\t);\n\t}\n}\n\nexport default ButtonTableRow;\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonTableEdit from './button-table-edit.jsx';\nimport React from 'react';\n\n/**\n * The ButtonTable class provides functionality for creating and editing a table in a document. ButtonTable\n * renders in two different modes:\n *\n * - Normal: Just a button that allows to switch to the edition mode\n * - Exclusive: The ButtonTableEdit UI with all the table edition controls.\n *\n * @class ButtonTable\n */\nclass ButtonTable extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default table\n\t * @memberof ButtonTable\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'table';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTable\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tif (this.props.renderExclusive) {\n\t\t\treturn <ButtonTableEdit {...this.props} />;\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<button\n\t\t\t\t\taria-label={AlloyEditor.Strings.table}\n\t\t\t\t\tclassName=\"ae-button\"\n\t\t\t\t\tdata-type=\"button-table\"\n\t\t\t\t\tonClick={this.props.requestExclusive}\n\t\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\t\ttitle={AlloyEditor.Strings.table}>\n\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"table\" />\n\t\t\t\t</button>\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport default ButtonTable;\n","import ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport React from 'react';\n\nconst MAX_TWEET_LENGTH = 280;\n\n/**\n * The ButtonTwitter class provides functionality for creating a link which\n * allows people to tweet part of the content in the editor.\n *\n * @class ButtonTwitter\n * @uses ButtonStateClasses\n */\nclass ButtonTwitter extends React.Component {\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default twitter\n\t * @memberof ButtonTwitter\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'twitter';\n\n\t/**\n\t * Creates or removes the twitter link on the selection.\n\t *\n\t * @instance\n\t * @memberof ButtonTwitter\n\t * @method handleClick\n\t */\n\thandleClick = () => {\n\t\tconst editor = this.props.editor.get('nativeEditor');\n\n\t\tconst linkUtils = new CKEDITOR.Link(editor);\n\n\t\tif (this.isActive()) {\n\t\t\tlinkUtils.remove(linkUtils.getFromSelection());\n\t\t} else {\n\t\t\tlinkUtils.create(this._getHref(), {\n\t\t\t\tclass: 'ae-twitter-link',\n\t\t\t\ttarget: '_blank',\n\t\t\t});\n\t\t}\n\n\t\teditor.fire('actionPerformed', this);\n\t};\n\n\t/**\n\t * Checks if the current selection is contained within a link that points to twitter.com/intent/tweet.\n\t *\n\t * @instance\n\t * @memberof ButtonTwitter\n\t * @method isActive\n\t * @return {Boolean} True if the selection is inside a twitter link, false otherwise.\n\t */\n\tisActive() {\n\t\tconst link = new CKEDITOR.Link(\n\t\t\tthis.props.editor.get('nativeEditor')\n\t\t).getFromSelection();\n\n\t\treturn (\n\t\t\tlink &&\n\t\t\tlink.getAttribute('href').indexOf('twitter.com/intent/tweet') !== -1\n\t\t);\n\t}\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonTwitter\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.twitter}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-twitter\"\n\t\t\t\tonClick={this.handleClick}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.twitter}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"twitter\" />\n\t\t\t</button>\n\t\t);\n\t}\n\n\t/**\n\t * Generates the appropriate twitter url based on the selected text and the configuration\n\t * options received via props.\n\t *\n\t * @instance\n\t * @memberof ButtonTwitter\n\t * @method _getHref\n\t * @protected\n\t * @return {String} A valid twitter url with the selected text and given configuration.\n\t */\n\t_getHref() {\n\t\tconst nativeEditor = this.props.editor.get('nativeEditor');\n\t\tconst selectedText = nativeEditor\n\t\t\t.getSelection()\n\t\t\t.getSelectedText()\n\t\t\t.substring(0, MAX_TWEET_LENGTH);\n\t\tconst url = this.props.url;\n\t\tlet via = this.props.via;\n\t\tlet twitterHref =\n\t\t\t'https://twitter.com/intent/tweet?text=' + selectedText;\n\n\t\tif (url) {\n\t\t\ttwitterHref += '&url=' + url;\n\t\t}\n\n\t\tif (via) {\n\t\t\ttwitterHref += '&via=' + via;\n\t\t}\n\n\t\treturn twitterHref;\n\t}\n}\n\nexport default ButtonStateClasses(ButtonTwitter);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnorderedlist class provides functionality for creating unordered lists in an editor.\n *\n * @class ButtonUnorderedlist\n * @uses ButtonCommand\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnorderedlist extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonUnorderedlist\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'bulletedlist',\n\t\tstyle: {\n\t\t\telement: 'ul',\n\t\t},\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default ul\n\t * @memberof ButtonUnorderedlist\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'ul';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonUnorderedlist\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.bulletedlist}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-ul\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.bulletedlist}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"list-ul\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonStateClasses(ButtonStyle(ButtonUnorderedlist))\n);\n","import ButtonCommand from '../base/button-command.js';\nimport ButtonIcon from './button-icon.jsx';\nimport ButtonKeystroke from '../base/button-keystroke.js';\nimport ButtonStateClasses from '../base/button-state-classes.js';\nimport ButtonStyle from '../base/button-style.js';\nimport React from 'react';\n\n/**\n * The ButtonUnderline class provides functionality for underlying a text selection.\n *\n * @class ButtonUnderline\n * @uses ButtonCommand\n * @uses ButtonKeystroke\n * @uses ButtonStateClasses\n * @uses ButtonStyle\n */\nclass ButtonUnderline extends React.Component {\n\t/**\n\t * Lifecycle. Returns the default values of the properties used in the widget.\n\t *\n\t * @instance\n\t * @memberof ButtonUnderline\n\t * @method getDefaultProps\n\t * @return {Object} The default properties.\n\t */\n\tstatic defaultProps = {\n\t\tcommand: 'underline',\n\t\tkeystroke: {\n\t\t\tfn: 'execCommand',\n\t\t\tkeys: CKEDITOR.CTRL + 85 /* U*/,\n\t\t},\n\t\tstyle: 'coreStyles_underline',\n\t};\n\n\t/**\n\t * The name which will be used as an alias of the button in the configuration.\n\t *\n\t * @default underline\n\t * @memberof ButtonUnderline\n\t * @property {String} key\n\t * @static\n\t */\n\tstatic key = 'underline';\n\n\t/**\n\t * Lifecycle. Renders the UI of the button.\n\t *\n\t * @instance\n\t * @memberof ButtonUnderline\n\t * @method render\n\t * @return {Object} The content which should be rendered.\n\t */\n\trender() {\n\t\tconst cssClass = `ae-button ${this.getStateClasses()}`;\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\taria-label={AlloyEditor.Strings.underline}\n\t\t\t\taria-pressed={cssClass.indexOf('pressed') !== -1}\n\t\t\t\tclassName={cssClass}\n\t\t\t\tdata-type=\"button-underline\"\n\t\t\t\tonClick={this.execCommand}\n\t\t\t\ttabIndex={this.props.tabIndex}\n\t\t\t\ttitle={AlloyEditor.Strings.underline}>\n\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"underline\" />\n\t\t\t</button>\n\t\t);\n\t}\n}\n\nexport default ButtonCommand(\n\tButtonKeystroke(ButtonStateClasses(ButtonStyle(ButtonUnderline)))\n);\n","import ToolbarAdd from './toolbar-add.jsx';\nimport ToolbarStyles from './toolbar-styles.jsx';\n\nexport default {\n\t[ToolbarAdd.key]: ToolbarAdd,\n\t[ToolbarStyles.key]: ToolbarStyles,\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\nimport ButtonIcon from '../buttons/button-icon.jsx';\n\nlet POSITION_LEFT = 1;\nlet POSITION_RIGHT = 2;\n\n/**\n * The ToolbarAdd class provides functionality for adding content to the editor.\n *\n * @class ToolbarAdd\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarAdd extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {};\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client (not on the server),\n\t * immediately after the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tthis._updatePosition();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method componentDidUpdate\n\t * @param {Object} prevProps The previous state of the component's properties.\n\t * @param {Object} prevState Component's previous state.\n\t */\n\tcomponentDidUpdate(_prevProps, _prevState) {\n\t\tthis._updatePosition();\n\n\t\t// In case of exclusive rendering, focus the first descendant (button)\n\t\t// so the user will be able to start interacting with the buttons immediately.\n\t\tif (this.props.renderExclusive) {\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Lifecycle. Renders the buttons for adding content or hides the toolbar\n\t * if user interacted with a non-editable element.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method render\n\t * @return {Object|null} The content which should be rendered.\n\t */\n\trender() {\n\t\t// Some operations such as `requestExclusive` may force editor to blur which will\n\t\t// invalidate the `props.editorEvent` stored value, without causing a `props` change.\n\t\t// For example, if the editor is empty, `ae_placeholder` plugin will remove\n\t\t// the target from the DOM and will prevent `add` toolbar from rendering.\n\t\t//\n\t\t// It should be safe to assume that if you have been able to render the toolbar\n\t\t// and request the exclusive mode, then rendering might be kept until the exclusive mode is left.\n\t\tif (\n\t\t\t!this.state.itemExclusive &&\n\t\t\tthis.props.editorEvent &&\n\t\t\tthis.props.editorEvent.data.nativeEvent.target &&\n\t\t\t!this.props.editorEvent.data.nativeEvent.target.isContentEditable\n\t\t) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet buttons = this._getButtons();\n\t\tlet className = this._getToolbarClassName();\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\taria-label={AlloyEditor.Strings.add}\n\t\t\t\tclassName={className}\n\t\t\t\tdata-tabindex={this.props.config.tabIndex || 0}\n\t\t\t\tonFocus={this.focus.bind(this)}\n\t\t\t\tonKeyDown={this.handleKey.bind(this)}\n\t\t\t\trole=\"toolbar\"\n\t\t\t\ttabIndex=\"-1\">\n\t\t\t\t<div className=\"ae-container\">{buttons}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t/**\n\t * Returns a list of buttons that will eventually render to HTML.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method _getButtons\n\t * @protected\n\t * @return {Object} The buttons which have to be rendered.\n\t */\n\t_getButtons() {\n\t\tlet buttons;\n\n\t\tif (this.props.renderExclusive) {\n\t\t\tbuttons = this.getToolbarButtons(this.props.config.buttons);\n\t\t} else {\n\t\t\tif (this.props.selectionData && this.props.selectionData.region) {\n\t\t\t\tbuttons = (\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label={AlloyEditor.Strings.add}\n\t\t\t\t\t\tclassName=\"ae-button ae-button-add\"\n\t\t\t\t\t\tonClick={this.props.requestExclusive.bind(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\tToolbarAdd.key\n\t\t\t\t\t\t)}\n\t\t\t\t\t\ttitle={AlloyEditor.Strings.add}>\n\t\t\t\t\t\t<ButtonIcon editor={this.props.editor} symbol=\"plus\" />\n\t\t\t\t\t</button>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\t/**\n\t * Returns the class name of the toolbar in case of both exclusive and normal mode.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method _getToolbarClassName\n\t * @protected\n\t * @return {String} The class name which have to be applied to the DOM element.\n\t */\n\t_getToolbarClassName() {\n\t\tlet cssClass = 'ae-toolbar-add';\n\n\t\tif (this.props.renderExclusive) {\n\t\t\tcssClass = 'ae-toolbar ' + this.getArrowBoxClasses();\n\t\t}\n\n\t\treturn cssClass;\n\t}\n\n\t/**\n\t * Calculates and sets the position of the toolbar in exclusive or normal mode.\n\t *\n\t * @instance\n\t * @memberof ToolbarAdd\n\t * @method _updatePosition\n\t * @protected\n\t */\n\t_updatePosition() {\n\t\tlet region;\n\n\t\t// If component is not mounted, there is nothing to do\n\t\tif (!ReactDOM.findDOMNode(this)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.props.renderExclusive) {\n\t\t\tthis.updatePosition();\n\t\t\tthis.show();\n\t\t} else {\n\t\t\tif (this.props.selectionData) {\n\t\t\t\tregion = this.props.selectionData.region;\n\t\t\t}\n\n\t\t\tif (region) {\n\t\t\t\tlet domNode = ReactDOM.findDOMNode(this);\n\n\t\t\t\tlet domElement = new CKEDITOR.dom.element(domNode);\n\n\t\t\t\tlet startRect = region.startRect || region;\n\n\t\t\t\tlet nativeEditor = this.props.editor.get('nativeEditor');\n\n\t\t\t\tlet clientRect = nativeEditor.editable().getClientRect();\n\n\t\t\t\tlet offsetLeft;\n\n\t\t\t\tlet position =\n\t\t\t\t\tthis.props.config.position || this.props.position;\n\n\t\t\t\tif (position === POSITION_LEFT) {\n\t\t\t\t\toffsetLeft =\n\t\t\t\t\t\tclientRect.left -\n\t\t\t\t\t\tdomNode.offsetWidth -\n\t\t\t\t\t\tthis.props.gutterExclusive.left +\n\t\t\t\t\t\t'px';\n\t\t\t\t} else {\n\t\t\t\t\toffsetLeft =\n\t\t\t\t\t\tclientRect.right +\n\t\t\t\t\t\tthis.props.gutterExclusive.left +\n\t\t\t\t\t\t'px';\n\t\t\t\t}\n\n\t\t\t\tdomNode.style.left = offsetLeft;\n\n\t\t\t\tdomNode.style.top =\n\t\t\t\t\tMath.floor((region.bottom + region.top) / 2) + 'px';\n\n\t\t\t\tconst uiNode = this.props.editor.get('uiNode');\n\n\t\t\t\tconst scrollTop = uiNode ? uiNode.scrollTop : 0;\n\n\t\t\t\tif (nativeEditor.element.getStyle('overflow') !== 'auto') {\n\t\t\t\t\tdomNode.style.top =\n\t\t\t\t\t\tMath.floor(\n\t\t\t\t\t\t\tregion.top -\n\t\t\t\t\t\t\t\tdomNode.offsetHeight / 2 +\n\t\t\t\t\t\t\t\tstartRect.height / 2 +\n\t\t\t\t\t\t\t\tscrollTop\n\t\t\t\t\t\t) + 'px';\n\t\t\t\t} else {\n\t\t\t\t\tdomNode.style.top =\n\t\t\t\t\t\tMath.floor(\n\t\t\t\t\t\t\tnativeEditor.element.$.offsetTop +\n\t\t\t\t\t\t\t\tstartRect.height / 2 -\n\t\t\t\t\t\t\t\tdomNode.offsetHeight / 2\n\t\t\t\t\t\t) + 'px';\n\t\t\t\t}\n\n\t\t\t\tdomNode.style.opacity = 1;\n\n\t\t\t\tdomElement.removeClass('ae-arrow-box');\n\n\t\t\t\tthis.cancelAnimation();\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default add\n * @memberof ToolbarAdd\n * @property {String} key\n * @static\n */\nToolbarAdd.key = 'add';\n\n/**\n * Defines the constant for positioning the Toolbar on left of the editable area.\n *\n * @default 1\n * @memberof ToolbarAdd\n * @property {String} left\n * @static\n */\nToolbarAdd.left = POSITION_LEFT;\n\n/**\n * Defines the constant for positioning the Toolbar on right of the editable area.\n *\n * @default 2\n * @memberof ToolbarAdd\n * @property {String} right\n * @static\n */\nToolbarAdd.right = POSITION_RIGHT;\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarAdd\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarAdd.defaultProps = {\n\tcircular: true,\n\tdescendants: '.ae-button',\n\tgutterExclusive: {\n\t\tleft: 10,\n\t\ttop: 0,\n\t},\n\tkeys: {\n\t\tdismiss: [27],\n\t\tnext: [39, 40],\n\t\tprev: [37, 38],\n\t},\n\tposition: POSITION_LEFT,\n};\n\nexport default WidgetArrowBox(\n\tWidgetDropdown(\n\t\tWidgetExclusive(\n\t\t\tWidgetFocusManager(WidgetPosition(ToolbarButtons(ToolbarAdd)))\n\t\t)\n\t)\n);\n","import Lang from '../../oop/lang.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ToolbarButtons from '../base/toolbar-buttons.js';\nimport WidgetArrowBox from '../base/widget-arrow-box.js';\nimport WidgetDropdown from '../base/widget-dropdown.js';\nimport WidgetExclusive from '../base/widget-exclusive.js';\nimport WidgetFocusManager from '../base/widget-focus-manager.js';\nimport WidgetPosition from '../base/widget-position.js';\n\n/**\n * The ToolbarStyles class hosts the buttons for styling a text selection.\n *\n * @class ToolbarStyles\n * @uses ToolbarButtons\n * @uses WidgetArrowBox\n * @uses WidgetDropdown\n * @uses WidgetExclusive\n * @uses WidgetFocusManager\n * @uses WidgetPosition\n */\nclass ToolbarStyles extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {};\n\t}\n\n\t/**\n\t * Lifecycle. Invoked once, only on the client (not on the server),\n\t * immediately after the initial rendering occurs.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method componentDidMount\n\t */\n\tcomponentDidMount() {\n\t\tthis._updatePosition();\n\t}\n\n\t/**\n\t * Lifecycle. Invoked immediately after the component's updates are flushed to the DOM.\n\t * This method is not called for the initial render.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method componentDidUpdate\n\t * @param {Object} prevProps The previous state of the component's properties.\n\t * @param {Object} prevState Component's previous state.\n\t */\n\tcomponentDidUpdate(_prevProps, _prevState) {\n\t\tthis._updatePosition();\n\t}\n\n\t/**\n\t * Lifecycle. Renders the buttons for adding content or hides the toolbar\n\t * if user interacted with a non-editable element.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method render\n\t * @return {Object|null} The content which should be rendered.\n\t */\n\trender() {\n\t\tlet currentSelection = this._getCurrentSelection();\n\n\t\tif (currentSelection) {\n\t\t\tlet getArrowBoxClassesFn = this._getSelectionFunction(\n\t\t\t\tcurrentSelection.getArrowBoxClasses\n\t\t\t);\n\t\t\tlet arrowBoxClasses;\n\n\t\t\tif (getArrowBoxClassesFn) {\n\t\t\t\tarrowBoxClasses = getArrowBoxClassesFn();\n\t\t\t} else {\n\t\t\t\tarrowBoxClasses = this.getArrowBoxClasses();\n\t\t\t}\n\n\t\t\tlet cssClasses = 'ae-toolbar-styles ' + arrowBoxClasses;\n\n\t\t\tlet buttons = currentSelection.buttons;\n\n\t\t\tif (typeof buttons === 'object' && !Array.isArray(buttons)) {\n\t\t\t\tbuttons =\n\t\t\t\t\tbuttons[this.props.editor.get('mode')] || buttons['simple'];\n\t\t\t}\n\n\t\t\tlet buttonsGroup = this.getToolbarButtonGroups(buttons, {\n\t\t\t\tmanualSelection: this.props.editorEvent\n\t\t\t\t\t? this.props.editorEvent.data.manualSelection\n\t\t\t\t\t: null,\n\t\t\t\tselectionType: currentSelection.name,\n\t\t\t});\n\n\t\t\tlet hasGroups =\n\t\t\t\tbuttonsGroup.filter(function(button) {\n\t\t\t\t\treturn Array.isArray(button);\n\t\t\t\t}).length > 0;\n\n\t\t\tlet className = 'ae-container';\n\n\t\t\tif (hasGroups) {\n\t\t\t\tclassName += ' ae-container-column';\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\taria-label={AlloyEditor.Strings.styles}\n\t\t\t\t\tclassName={cssClasses}\n\t\t\t\t\tdata-tabindex={this.props.config.tabIndex || 0}\n\t\t\t\t\tonFocus={this.focus.bind(this)}\n\t\t\t\t\tonKeyDown={this.handleKey.bind(this)}\n\t\t\t\t\trole=\"toolbar\"\n\t\t\t\t\ttabIndex=\"-1\">\n\t\t\t\t\t<div className={className}>\n\t\t\t\t\t\t{buttonsGroup.map(function(value, index) {\n\t\t\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"ae-row\" key={index}>\n\t\t\t\t\t\t\t\t\t\t{value.map(function(button) {\n\t\t\t\t\t\t\t\t\t\t\treturn button;\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Retrieve a function from String. It converts a fully qualified string into the mapped function.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method _getSelectionFunction\n\t * @param {Function|String} selectionFn A function, or a fully qualified string pointing to the desired one (e.g. 'AlloyEditor.SelectionTest.image').\n\t * @protected\n\t * @return {Function} The mapped function.\n\t */\n\t_getSelectionFunction(selectionFn) {\n\t\tlet selectionFunction;\n\n\t\tif (Lang.isFunction(selectionFn)) {\n\t\t\tselectionFunction = selectionFn;\n\t\t} else if (Lang.isString(selectionFn)) {\n\t\t\tlet parts = selectionFn.split('.');\n\t\t\tlet currentMember = window;\n\t\t\tlet property = parts.shift();\n\n\t\t\twhile (\n\t\t\t\tproperty &&\n\t\t\t\tLang.isObject(currentMember) &&\n\t\t\t\tLang.isObject(currentMember[property])\n\t\t\t) {\n\t\t\t\tcurrentMember = currentMember[property];\n\t\t\t\tproperty = parts.shift();\n\t\t\t}\n\n\t\t\tif (Lang.isFunction(currentMember)) {\n\t\t\t\tselectionFunction = currentMember;\n\t\t\t}\n\t\t}\n\n\t\treturn selectionFunction;\n\t}\n\n\t/**\n\t * Analyzes the current editor selection and returns the selection configuration that matches.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method _getCurrentSelection\n\t * @protected\n\t * @return {Object} The matched selection configuration.\n\t */\n\t_getCurrentSelection() {\n\t\tlet eventPayload = this.props.editorEvent\n\t\t\t? this.props.editorEvent.data\n\t\t\t: null;\n\t\tlet selection;\n\n\t\tif (eventPayload) {\n\t\t\tthis.props.config.selections.some(function(item) {\n\t\t\t\tlet testFn = this._getSelectionFunction(item.test);\n\t\t\t\tlet result;\n\n\t\t\t\tif (testFn) {\n\t\t\t\t\tresult =\n\t\t\t\t\t\teventPayload.manualSelection === item.name ||\n\t\t\t\t\t\ttestFn({\n\t\t\t\t\t\t\tdata: eventPayload,\n\t\t\t\t\t\t\teditor: this.props.editor,\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (result) {\n\t\t\t\t\tselection = item;\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}, this);\n\t\t}\n\n\t\treturn selection;\n\t}\n\n\t/**\n\t * Calculates and sets the position of the toolbar.\n\t *\n\t * @instance\n\t * @memberof ToolbarStyles\n\t * @method _updatePosition\n\t * @protected\n\t */\n\t_updatePosition() {\n\t\t// If component is not mounted, there is nothing to do\n\t\tif (!ReactDOM.findDOMNode(this)) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet currentSelection = this._getCurrentSelection();\n\t\tlet result;\n\n\t\t// If current selection has a function called `setPosition`, call it\n\t\t// and check the returned value. If false, fallback to the default positioning logic.\n\t\tif (currentSelection) {\n\t\t\tlet setPositionFn = this._getSelectionFunction(\n\t\t\t\tcurrentSelection.setPosition\n\t\t\t);\n\n\t\t\tif (setPositionFn) {\n\t\t\t\tresult = setPositionFn.call(this, {\n\t\t\t\t\teditor: this.props.editor,\n\t\t\t\t\teditorEvent: this.props.editorEvent,\n\t\t\t\t\tselectionData: this.props.selectionData,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (!result) {\n\t\t\tthis.updatePosition();\n\t\t\tthis.show();\n\t\t}\n\t}\n}\n\n/**\n * Lifecycle. Returns the default values of the properties used in the widget.\n *\n * @instance\n * @memberof ToolbarStyles\n * @method getDefaultProps\n * @return {Object} The default properties.\n */\nToolbarStyles.defaultProps = {\n\tcircular: true,\n\tdescendants: '.ae-input, .ae-button:not([disabled]), .ae-toolbar-element',\n\tkeys: {\n\t\tdismiss: [27],\n\t\tnext: [39, 40],\n\t\tprev: [37, 38],\n\t},\n};\n\n/**\n * The name which will be used as an alias of the button in the configuration.\n *\n * @default styles\n * @memberof ToolbarStyles\n * @property {String} key\n * @static\n */\nToolbarStyles.key = 'styles';\n\nexport default WidgetArrowBox(\n\tWidgetDropdown(\n\t\tWidgetExclusive(\n\t\t\tWidgetFocusManager(WidgetPosition(ToolbarButtons(ToolbarStyles)))\n\t\t)\n\t)\n);\n"],"sourceRoot":""}